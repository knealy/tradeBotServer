var Za=Object.defineProperty;var Xa=(i,t,e)=>t in i?Za(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var oe=(i,t,e)=>Xa(i,typeof t!="symbol"?t+"":t,e);import{r as _,a as to,b as eo,R as Ct,L as _i,u as so,B as io,d as no,e as fs}from"./react-vendor-kWENTzfD.js";import{_ as G,a as qe,R as ro,L as ao,C as oo,X as lo,Y as nn,T as ho,b as co,c as ii}from"./chart-vendor-BXD5TvhH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();var Ar={exports:{}},qs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uo=_,fo=Symbol.for("react.element"),mo=Symbol.for("react.fragment"),po=Object.prototype.hasOwnProperty,go=uo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xo={key:!0,ref:!0,__self:!0,__source:!0};function Ir(i,t,e){var s,n={},r=null,o=null;e!==void 0&&(r=""+e),t.key!==void 0&&(r=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)po.call(t,s)&&!xo.hasOwnProperty(s)&&(n[s]=t[s]);if(i&&i.defaultProps)for(s in t=i.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:fo,type:i,key:r,ref:o,props:n,_owner:go.current}}qs.Fragment=mo;qs.jsx=Ir;qs.jsxs=Ir;Ar.exports=qs;var a=Ar.exports,ji={},rn=to;ji.createRoot=rn.createRoot,ji.hydrateRoot=rn.hydrateRoot;var Ye=function(){function i(){this.listeners=[]}var t=i.prototype;return t.subscribe=function(s){var n=this,r=s||function(){};return this.listeners.push(r),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(o){return o!==r}),n.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},i}(),Os=typeof window>"u";function Ft(){}function bo(i,t){return typeof i=="function"?i(t):i}function Ci(i){return typeof i=="number"&&i>=0&&i!==1/0}function Ts(i){return Array.isArray(i)?i:[i]}function zr(i,t){return Math.max(i+(t||0)-Date.now(),0)}function _s(i,t,e){return os(i)?typeof t=="function"?G({},e,{queryKey:i,queryFn:t}):G({},t,{queryKey:i}):i}function vo(i,t,e){return os(i)?typeof t=="function"?G({},e,{mutationKey:i,mutationFn:t}):G({},t,{mutationKey:i}):typeof i=="function"?G({},t,{mutationFn:i}):G({},i)}function me(i,t,e){return os(i)?[G({},t,{queryKey:i}),e]:[i||{},t]}function yo(i,t){if(i===!0&&t===!0||i==null&&t==null)return"all";if(i===!1&&t===!1)return"none";var e=i??!t;return e?"active":"inactive"}function an(i,t){var e=i.active,s=i.exact,n=i.fetching,r=i.inactive,o=i.predicate,l=i.queryKey,h=i.stale;if(os(l)){if(s){if(t.queryHash!==$i(l,t.options))return!1}else if(!Fs(t.queryKey,l))return!1}var c=yo(e,r);if(c==="none")return!1;if(c!=="all"){var u=t.isActive();if(c==="active"&&!u||c==="inactive"&&u)return!1}return!(typeof h=="boolean"&&t.isStale()!==h||typeof n=="boolean"&&t.isFetching()!==n||o&&!o(t))}function on(i,t){var e=i.exact,s=i.fetching,n=i.predicate,r=i.mutationKey;if(os(r)){if(!t.options.mutationKey)return!1;if(e){if(ve(t.options.mutationKey)!==ve(r))return!1}else if(!Fs(t.options.mutationKey,r))return!1}return!(typeof s=="boolean"&&t.state.status==="loading"!==s||n&&!n(t))}function $i(i,t){var e=(t==null?void 0:t.queryKeyHashFn)||ve;return e(i)}function ve(i){var t=Ts(i);return wo(t)}function wo(i){return JSON.stringify(i,function(t,e){return Mi(e)?Object.keys(e).sort().reduce(function(s,n){return s[n]=e[n],s},{}):e})}function Fs(i,t){return Br(Ts(i),Ts(t))}function Br(i,t){return i===t?!0:typeof i!=typeof t?!1:i&&t&&typeof i=="object"&&typeof t=="object"?!Object.keys(t).some(function(e){return!Br(i[e],t[e])}):!1}function Ls(i,t){if(i===t)return i;var e=Array.isArray(i)&&Array.isArray(t);if(e||Mi(i)&&Mi(t)){for(var s=e?i.length:Object.keys(i).length,n=e?t:Object.keys(t),r=n.length,o=e?[]:{},l=0,h=0;h<r;h++){var c=e?h:n[h];o[c]=Ls(i[c],t[c]),o[c]===i[c]&&l++}return s===r&&l===s?i:o}return t}function No(i,t){if(i&&!t||t&&!i)return!1;for(var e in i)if(i[e]!==t[e])return!1;return!0}function Mi(i){if(!ln(i))return!1;var t=i.constructor;if(typeof t>"u")return!0;var e=t.prototype;return!(!ln(e)||!e.hasOwnProperty("isPrototypeOf"))}function ln(i){return Object.prototype.toString.call(i)==="[object Object]"}function os(i){return typeof i=="string"||Array.isArray(i)}function So(i){return new Promise(function(t){setTimeout(t,i)})}function hn(i){Promise.resolve().then(i).catch(function(t){return setTimeout(function(){throw t})})}function $r(){if(typeof AbortController=="function")return new AbortController}var _o=function(i){qe(t,i);function t(){var s;return s=i.call(this)||this,s.setup=function(n){var r;if(!Os&&((r=window)!=null&&r.addEventListener)){var o=function(){return n()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var e=t.prototype;return e.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},e.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},e.setEventListener=function(n){var r,o=this;this.setup=n,(r=this.cleanup)==null||r.call(this),this.cleanup=n(function(l){typeof l=="boolean"?o.setFocused(l):o.onFocus()})},e.setFocused=function(n){this.focused=n,n&&this.onFocus()},e.onFocus=function(){this.listeners.forEach(function(n){n()})},e.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},t}(Ye),Ge=new _o,jo=function(i){qe(t,i);function t(){var s;return s=i.call(this)||this,s.setup=function(n){var r;if(!Os&&((r=window)!=null&&r.addEventListener)){var o=function(){return n()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var e=t.prototype;return e.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},e.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},e.setEventListener=function(n){var r,o=this;this.setup=n,(r=this.cleanup)==null||r.call(this),this.cleanup=n(function(l){typeof l=="boolean"?o.setOnline(l):o.onOnline()})},e.setOnline=function(n){this.online=n,n&&this.onOnline()},e.onOnline=function(){this.listeners.forEach(function(n){n()})},e.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},t}(Ye),js=new jo;function Co(i){return Math.min(1e3*Math.pow(2,i),3e4)}function Ds(i){return typeof(i==null?void 0:i.cancel)=="function"}var Vr=function(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent};function Cs(i){return i instanceof Vr}var Ur=function(t){var e=this,s=!1,n,r,o,l;this.abort=t.abort,this.cancel=function(f){return n==null?void 0:n(f)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return r==null?void 0:r()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(f,p){o=f,l=p});var h=function(p){e.isResolved||(e.isResolved=!0,t.onSuccess==null||t.onSuccess(p),r==null||r(),o(p))},c=function(p){e.isResolved||(e.isResolved=!0,t.onError==null||t.onError(p),r==null||r(),l(p))},u=function(){return new Promise(function(p){r=p,e.isPaused=!0,t.onPause==null||t.onPause()}).then(function(){r=void 0,e.isPaused=!1,t.onContinue==null||t.onContinue()})},d=function f(){if(!e.isResolved){var p;try{p=t.fn()}catch(m){p=Promise.reject(m)}n=function(b){if(!e.isResolved&&(c(new Vr(b)),e.abort==null||e.abort(),Ds(p)))try{p.cancel()}catch{}},e.isTransportCancelable=Ds(p),Promise.resolve(p).then(h).catch(function(m){var b,g;if(!e.isResolved){var S=(b=t.retry)!=null?b:3,j=(g=t.retryDelay)!=null?g:Co,N=typeof j=="function"?j(e.failureCount,m):j,M=S===!0||typeof S=="number"&&e.failureCount<S||typeof S=="function"&&S(e.failureCount,m);if(s||!M){c(m);return}e.failureCount++,t.onFail==null||t.onFail(e.failureCount,m),So(N).then(function(){if(!Ge.isFocused()||!js.isOnline())return u()}).then(function(){s?c(m):f()})}})}};d()},Mo=function(){function i(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=i.prototype;return t.batch=function(s){var n;this.transactions++;try{n=s()}finally{this.transactions--,this.transactions||this.flush()}return n},t.schedule=function(s){var n=this;this.transactions?this.queue.push(s):hn(function(){n.notifyFn(s)})},t.batchCalls=function(s){var n=this;return function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];n.schedule(function(){s.apply(void 0,o)})}},t.flush=function(){var s=this,n=this.queue;this.queue=[],n.length&&hn(function(){s.batchNotifyFn(function(){n.forEach(function(r){s.notifyFn(r)})})})},t.setNotifyFunction=function(s){this.notifyFn=s},t.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},i}(),xt=new Mo,qr=console;function As(){return qr}function Po(i){qr=i}var ko=function(){function i(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=i.prototype;return t.setOptions=function(s){var n;this.options=G({},this.defaultOptions,s),this.meta=s==null?void 0:s.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},t.setDefaultOptions=function(s){this.defaultOptions=s},t.scheduleGc=function(){var s=this;this.clearGcTimeout(),Ci(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(s,n){var r,o,l=this.state.data,h=bo(s,l);return(r=(o=this.options).isDataEqual)!=null&&r.call(o,l,h)?h=l:this.options.structuralSharing!==!1&&(h=Ls(l,h)),this.dispatch({data:h,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt}),h},t.setState=function(s,n){this.dispatch({type:"setState",state:s,setStateOptions:n})},t.cancel=function(s){var n,r=this.promise;return(n=this.retryer)==null||n.cancel(s),r?r.then(Ft).catch(Ft):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},t.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!zr(this.state.dataUpdatedAt,s)},t.onFocus=function(){var s,n=this.observers.find(function(r){return r.shouldFetchOnWindowFocus()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},t.onOnline=function(){var s,n=this.observers.find(function(r){return r.shouldFetchOnReconnect()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},t.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},t.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(n){return n!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(s,n){var r=this,o,l,h;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var c;return(c=this.retryer)==null||c.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var u=this.observers.find(function(j){return j.options.queryFn});u&&this.setOptions(u.options)}var d=Ts(this.queryKey),f=$r(),p={queryKey:d,pageParam:void 0,meta:this.meta};Object.defineProperty(p,"signal",{enumerable:!0,get:function(){if(f)return r.abortSignalConsumed=!0,f.signal}});var m=function(){return r.options.queryFn?(r.abortSignalConsumed=!1,r.options.queryFn(p)):Promise.reject("Missing queryFn")},b={fetchOptions:n,options:this.options,queryKey:d,state:this.state,fetchFn:m,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var g;(g=this.options.behavior)==null||g.onFetch(b)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((l=b.fetchOptions)==null?void 0:l.meta)){var S;this.dispatch({type:"fetch",meta:(S=b.fetchOptions)==null?void 0:S.meta})}return this.retryer=new Ur({fn:b.fetchFn,abort:f==null||(h=f.abort)==null?void 0:h.bind(f),onSuccess:function(N){r.setData(N),r.cache.config.onSuccess==null||r.cache.config.onSuccess(N,r),r.cacheTime===0&&r.optionalRemove()},onError:function(N){Cs(N)&&N.silent||r.dispatch({type:"error",error:N}),Cs(N)||(r.cache.config.onError==null||r.cache.config.onError(N,r),As().error(N)),r.cacheTime===0&&r.optionalRemove()},onFail:function(){r.dispatch({type:"failed"})},onPause:function(){r.dispatch({type:"pause"})},onContinue:function(){r.dispatch({type:"continue"})},retry:b.options.retry,retryDelay:b.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(s){var n=this;this.state=this.reducer(this.state,s),xt.batch(function(){n.observers.forEach(function(r){r.onQueryUpdate(s)}),n.cache.notify({query:n,type:"queryUpdated",action:s})})},t.getDefaultState=function(s){var n=typeof s.initialData=="function"?s.initialData():s.initialData,r=typeof s.initialData<"u",o=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,l=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:l?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:l?"success":"idle"}},t.reducer=function(s,n){var r,o;switch(n.type){case"failed":return G({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return G({},s,{isPaused:!0});case"continue":return G({},s,{isPaused:!1});case"fetch":return G({},s,{fetchFailureCount:0,fetchMeta:(r=n.meta)!=null?r:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return G({},s,{data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=n.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var l=n.error;return Cs(l)&&l.revert&&this.revertState?G({},this.revertState):G({},s,{error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return G({},s,{isInvalidated:!0});case"setState":return G({},s,n.state);default:return s}},i}(),Eo=function(i){qe(t,i);function t(s){var n;return n=i.call(this)||this,n.config=s||{},n.queries=[],n.queriesMap={},n}var e=t.prototype;return e.build=function(n,r,o){var l,h=r.queryKey,c=(l=r.queryHash)!=null?l:$i(h,r),u=this.get(c);return u||(u=new ko({cache:this,queryKey:h,queryHash:c,options:n.defaultQueryOptions(r),state:o,defaultOptions:n.getQueryDefaults(h),meta:r.meta}),this.add(u)),u},e.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},e.remove=function(n){var r=this.queriesMap[n.queryHash];r&&(n.destroy(),this.queries=this.queries.filter(function(o){return o!==n}),r===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},e.clear=function(){var n=this;xt.batch(function(){n.queries.forEach(function(r){n.remove(r)})})},e.get=function(n){return this.queriesMap[n]},e.getAll=function(){return this.queries},e.find=function(n,r){var o=me(n,r),l=o[0];return typeof l.exact>"u"&&(l.exact=!0),this.queries.find(function(h){return an(l,h)})},e.findAll=function(n,r){var o=me(n,r),l=o[0];return Object.keys(l).length>0?this.queries.filter(function(h){return an(l,h)}):this.queries},e.notify=function(n){var r=this;xt.batch(function(){r.listeners.forEach(function(o){o(n)})})},e.onFocus=function(){var n=this;xt.batch(function(){n.queries.forEach(function(r){r.onFocus()})})},e.onOnline=function(){var n=this;xt.batch(function(){n.queries.forEach(function(r){r.onOnline()})})},t}(Ye),Ro=function(){function i(e){this.options=G({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||Yr(),this.meta=e.meta}var t=i.prototype;return t.setState=function(s){this.dispatch({type:"setState",state:s})},t.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},t.removeObserver=function(s){this.observers=this.observers.filter(function(n){return n!==s})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(Ft).catch(Ft)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var s=this,n,r=this.state.status==="loading",o=Promise.resolve();return r||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(l){l!==s.state.context&&s.dispatch({type:"loading",context:l,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(l){n=l,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(n,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(n,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(n,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:n}),n}).catch(function(l){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(l,s.state.variables,s.state.context,s),As().error(l),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(l,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,l,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:l}),l})})},t.executeMutation=function(){var s=this,n;return this.retryer=new Ur({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(s){var n=this;this.state=Oo(this.state,s),xt.batch(function(){n.observers.forEach(function(r){r.onMutationUpdate(s)}),n.mutationCache.notify(n)})},i}();function Yr(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Oo(i,t){switch(t.type){case"failed":return G({},i,{failureCount:i.failureCount+1});case"pause":return G({},i,{isPaused:!0});case"continue":return G({},i,{isPaused:!1});case"loading":return G({},i,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return G({},i,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return G({},i,{data:void 0,error:t.error,failureCount:i.failureCount+1,isPaused:!1,status:"error"});case"setState":return G({},i,t.state);default:return i}}var To=function(i){qe(t,i);function t(s){var n;return n=i.call(this)||this,n.config=s||{},n.mutations=[],n.mutationId=0,n}var e=t.prototype;return e.build=function(n,r,o){var l=new Ro({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(r),state:o,defaultOptions:r.mutationKey?n.getMutationDefaults(r.mutationKey):void 0,meta:r.meta});return this.add(l),l},e.add=function(n){this.mutations.push(n),this.notify(n)},e.remove=function(n){this.mutations=this.mutations.filter(function(r){return r!==n}),n.cancel(),this.notify(n)},e.clear=function(){var n=this;xt.batch(function(){n.mutations.forEach(function(r){n.remove(r)})})},e.getAll=function(){return this.mutations},e.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(r){return on(n,r)})},e.findAll=function(n){return this.mutations.filter(function(r){return on(n,r)})},e.notify=function(n){var r=this;xt.batch(function(){r.listeners.forEach(function(o){o(n)})})},e.onFocus=function(){this.resumePausedMutations()},e.onOnline=function(){this.resumePausedMutations()},e.resumePausedMutations=function(){var n=this.mutations.filter(function(r){return r.state.isPaused});return xt.batch(function(){return n.reduce(function(r,o){return r.then(function(){return o.continue().catch(Ft)})},Promise.resolve())})},t}(Ye);function Fo(){return{onFetch:function(t){t.fetchFn=function(){var e,s,n,r,o,l,h=(e=t.fetchOptions)==null||(s=e.meta)==null?void 0:s.refetchPage,c=(n=t.fetchOptions)==null||(r=n.meta)==null?void 0:r.fetchMore,u=c==null?void 0:c.pageParam,d=(c==null?void 0:c.direction)==="forward",f=(c==null?void 0:c.direction)==="backward",p=((o=t.state.data)==null?void 0:o.pages)||[],m=((l=t.state.data)==null?void 0:l.pageParams)||[],b=$r(),g=b==null?void 0:b.signal,S=m,j=!1,N=t.options.queryFn||function(){return Promise.reject("Missing queryFn")},M=function(nt,ft,z,Y){return S=Y?[ft].concat(S):[].concat(S,[ft]),Y?[z].concat(nt):[].concat(nt,[z])},A=function(nt,ft,z,Y){if(j)return Promise.reject("Cancelled");if(typeof z>"u"&&!ft&&nt.length)return Promise.resolve(nt);var v={queryKey:t.queryKey,signal:g,pageParam:z,meta:t.meta},O=N(v),U=Promise.resolve(O).then(function(lt){return M(nt,z,lt,Y)});if(Ds(O)){var D=U;D.cancel=O.cancel}return U},B;if(!p.length)B=A([]);else if(d){var F=typeof u<"u",it=F?u:cn(t.options,p);B=A(p,F,it)}else if(f){var q=typeof u<"u",tt=q?u:Lo(t.options,p);B=A(p,q,tt,!0)}else(function(){S=[];var ot=typeof t.options.getNextPageParam>"u",nt=h&&p[0]?h(p[0],0,p):!0;B=nt?A([],ot,m[0]):Promise.resolve(M([],m[0],p[0]));for(var ft=function(v){B=B.then(function(O){var U=h&&p[v]?h(p[v],v,p):!0;if(U){var D=ot?m[v]:cn(t.options,O);return A(O,ot,D)}return Promise.resolve(M(O,m[v],p[v]))})},z=1;z<p.length;z++)ft(z)})();var gt=B.then(function(ot){return{pages:ot,pageParams:S}}),st=gt;return st.cancel=function(){j=!0,b==null||b.abort(),Ds(B)&&B.cancel()},gt}}}}function cn(i,t){return i.getNextPageParam==null?void 0:i.getNextPageParam(t[t.length-1],t)}function Lo(i,t){return i.getPreviousPageParam==null?void 0:i.getPreviousPageParam(t[0],t)}var Do=function(){function i(e){e===void 0&&(e={}),this.queryCache=e.queryCache||new Eo,this.mutationCache=e.mutationCache||new To,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=i.prototype;return t.mount=function(){var s=this;this.unsubscribeFocus=Ge.subscribe(function(){Ge.isFocused()&&js.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=js.subscribe(function(){Ge.isFocused()&&js.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},t.unmount=function(){var s,n;(s=this.unsubscribeFocus)==null||s.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},t.isFetching=function(s,n){var r=me(s,n),o=r[0];return o.fetching=!0,this.queryCache.findAll(o).length},t.isMutating=function(s){return this.mutationCache.findAll(G({},s,{fetching:!0})).length},t.getQueryData=function(s,n){var r;return(r=this.queryCache.find(s,n))==null?void 0:r.state.data},t.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(n){var r=n.queryKey,o=n.state,l=o.data;return[r,l]})},t.setQueryData=function(s,n,r){var o=_s(s),l=this.defaultQueryOptions(o);return this.queryCache.build(this,l).setData(n,r)},t.setQueriesData=function(s,n,r){var o=this;return xt.batch(function(){return o.getQueryCache().findAll(s).map(function(l){var h=l.queryKey;return[h,o.setQueryData(h,n,r)]})})},t.getQueryState=function(s,n){var r;return(r=this.queryCache.find(s,n))==null?void 0:r.state},t.removeQueries=function(s,n){var r=me(s,n),o=r[0],l=this.queryCache;xt.batch(function(){l.findAll(o).forEach(function(h){l.remove(h)})})},t.resetQueries=function(s,n,r){var o=this,l=me(s,n,r),h=l[0],c=l[1],u=this.queryCache,d=G({},h,{active:!0});return xt.batch(function(){return u.findAll(h).forEach(function(f){f.reset()}),o.refetchQueries(d,c)})},t.cancelQueries=function(s,n,r){var o=this,l=me(s,n,r),h=l[0],c=l[1],u=c===void 0?{}:c;typeof u.revert>"u"&&(u.revert=!0);var d=xt.batch(function(){return o.queryCache.findAll(h).map(function(f){return f.cancel(u)})});return Promise.all(d).then(Ft).catch(Ft)},t.invalidateQueries=function(s,n,r){var o,l,h,c=this,u=me(s,n,r),d=u[0],f=u[1],p=G({},d,{active:(o=(l=d.refetchActive)!=null?l:d.active)!=null?o:!0,inactive:(h=d.refetchInactive)!=null?h:!1});return xt.batch(function(){return c.queryCache.findAll(d).forEach(function(m){m.invalidate()}),c.refetchQueries(p,f)})},t.refetchQueries=function(s,n,r){var o=this,l=me(s,n,r),h=l[0],c=l[1],u=xt.batch(function(){return o.queryCache.findAll(h).map(function(f){return f.fetch(void 0,G({},c,{meta:{refetchPage:h==null?void 0:h.refetchPage}}))})}),d=Promise.all(u).then(Ft);return c!=null&&c.throwOnError||(d=d.catch(Ft)),d},t.fetchQuery=function(s,n,r){var o=_s(s,n,r),l=this.defaultQueryOptions(o);typeof l.retry>"u"&&(l.retry=!1);var h=this.queryCache.build(this,l);return h.isStaleByTime(l.staleTime)?h.fetch(l):Promise.resolve(h.state.data)},t.prefetchQuery=function(s,n,r){return this.fetchQuery(s,n,r).then(Ft).catch(Ft)},t.fetchInfiniteQuery=function(s,n,r){var o=_s(s,n,r);return o.behavior=Fo(),this.fetchQuery(o)},t.prefetchInfiniteQuery=function(s,n,r){return this.fetchInfiniteQuery(s,n,r).then(Ft).catch(Ft)},t.cancelMutations=function(){var s=this,n=xt.batch(function(){return s.mutationCache.getAll().map(function(r){return r.cancel()})});return Promise.all(n).then(Ft).catch(Ft)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(s){this.defaultOptions=s},t.setQueryDefaults=function(s,n){var r=this.queryDefaults.find(function(o){return ve(s)===ve(o.queryKey)});r?r.defaultOptions=n:this.queryDefaults.push({queryKey:s,defaultOptions:n})},t.getQueryDefaults=function(s){var n;return s?(n=this.queryDefaults.find(function(r){return Fs(s,r.queryKey)}))==null?void 0:n.defaultOptions:void 0},t.setMutationDefaults=function(s,n){var r=this.mutationDefaults.find(function(o){return ve(s)===ve(o.mutationKey)});r?r.defaultOptions=n:this.mutationDefaults.push({mutationKey:s,defaultOptions:n})},t.getMutationDefaults=function(s){var n;return s?(n=this.mutationDefaults.find(function(r){return Fs(s,r.mutationKey)}))==null?void 0:n.defaultOptions:void 0},t.defaultQueryOptions=function(s){if(s!=null&&s._defaulted)return s;var n=G({},this.defaultOptions.queries,this.getQueryDefaults(s==null?void 0:s.queryKey),s,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=$i(n.queryKey,n)),n},t.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},t.defaultMutationOptions=function(s){return s!=null&&s._defaulted?s:G({},this.defaultOptions.mutations,this.getMutationDefaults(s==null?void 0:s.mutationKey),s,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},i}(),Ao=function(i){qe(t,i);function t(s,n){var r;return r=i.call(this)||this,r.client=s,r.options=n,r.trackedProps=[],r.selectError=null,r.bindMethods(),r.setOptions(n),r}var e=t.prototype;return e.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},e.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),un(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},e.onUnsubscribe=function(){this.listeners.length||this.destroy()},e.shouldFetchOnReconnect=function(){return Pi(this.currentQuery,this.options,this.options.refetchOnReconnect)},e.shouldFetchOnWindowFocus=function(){return Pi(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},e.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},e.setOptions=function(n,r){var o=this.options,l=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(n),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=o.queryKey),this.updateQuery();var h=this.hasListeners();h&&dn(this.currentQuery,l,this.options,o)&&this.executeFetch(),this.updateResult(r),h&&(this.currentQuery!==l||this.options.enabled!==o.enabled||this.options.staleTime!==o.staleTime)&&this.updateStaleTimeout();var c=this.computeRefetchInterval();h&&(this.currentQuery!==l||this.options.enabled!==o.enabled||c!==this.currentRefetchInterval)&&this.updateRefetchInterval(c)},e.getOptimisticResult=function(n){var r=this.client.defaultQueryObserverOptions(n),o=this.client.getQueryCache().build(this.client,r);return this.createResult(o,r)},e.getCurrentResult=function(){return this.currentResult},e.trackResult=function(n,r){var o=this,l={},h=function(u){o.trackedProps.includes(u)||o.trackedProps.push(u)};return Object.keys(n).forEach(function(c){Object.defineProperty(l,c,{configurable:!1,enumerable:!0,get:function(){return h(c),n[c]}})}),(r.useErrorBoundary||r.suspense)&&h("error"),l},e.getNextResult=function(n){var r=this;return new Promise(function(o,l){var h=r.subscribe(function(c){c.isFetching||(h(),c.isError&&(n!=null&&n.throwOnError)?l(c.error):o(c))})})},e.getCurrentQuery=function(){return this.currentQuery},e.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},e.refetch=function(n){return this.fetch(G({},n,{meta:{refetchPage:n==null?void 0:n.refetchPage}}))},e.fetchOptimistic=function(n){var r=this,o=this.client.defaultQueryObserverOptions(n),l=this.client.getQueryCache().build(this.client,o);return l.fetch().then(function(){return r.createResult(l,o)})},e.fetch=function(n){var r=this;return this.executeFetch(n).then(function(){return r.updateResult(),r.currentResult})},e.executeFetch=function(n){this.updateQuery();var r=this.currentQuery.fetch(this.options,n);return n!=null&&n.throwOnError||(r=r.catch(Ft)),r},e.updateStaleTimeout=function(){var n=this;if(this.clearStaleTimeout(),!(Os||this.currentResult.isStale||!Ci(this.options.staleTime))){var r=zr(this.currentResult.dataUpdatedAt,this.options.staleTime),o=r+1;this.staleTimeoutId=setTimeout(function(){n.currentResult.isStale||n.updateResult()},o)}},e.computeRefetchInterval=function(){var n;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(n=this.options.refetchInterval)!=null?n:!1},e.updateRefetchInterval=function(n){var r=this;this.clearRefetchInterval(),this.currentRefetchInterval=n,!(Os||this.options.enabled===!1||!Ci(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(r.options.refetchIntervalInBackground||Ge.isFocused())&&r.executeFetch()},this.currentRefetchInterval))},e.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},e.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},e.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},e.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},e.createResult=function(n,r){var o=this.currentQuery,l=this.options,h=this.currentResult,c=this.currentResultState,u=this.currentResultOptions,d=n!==o,f=d?n.state:this.currentQueryInitialState,p=d?this.currentResult:this.previousQueryResult,m=n.state,b=m.dataUpdatedAt,g=m.error,S=m.errorUpdatedAt,j=m.isFetching,N=m.status,M=!1,A=!1,B;if(r.optimisticResults){var F=this.hasListeners(),it=!F&&un(n,r),q=F&&dn(n,o,r,l);(it||q)&&(j=!0,b||(N="loading"))}if(r.keepPreviousData&&!m.dataUpdateCount&&(p!=null&&p.isSuccess)&&N!=="error")B=p.data,b=p.dataUpdatedAt,N=p.status,M=!0;else if(r.select&&typeof m.data<"u")if(h&&m.data===(c==null?void 0:c.data)&&r.select===this.selectFn)B=this.selectResult;else try{this.selectFn=r.select,B=r.select(m.data),r.structuralSharing!==!1&&(B=Ls(h==null?void 0:h.data,B)),this.selectResult=B,this.selectError=null}catch(st){As().error(st),this.selectError=st}else B=m.data;if(typeof r.placeholderData<"u"&&typeof B>"u"&&(N==="loading"||N==="idle")){var tt;if(h!=null&&h.isPlaceholderData&&r.placeholderData===(u==null?void 0:u.placeholderData))tt=h.data;else if(tt=typeof r.placeholderData=="function"?r.placeholderData():r.placeholderData,r.select&&typeof tt<"u")try{tt=r.select(tt),r.structuralSharing!==!1&&(tt=Ls(h==null?void 0:h.data,tt)),this.selectError=null}catch(st){As().error(st),this.selectError=st}typeof tt<"u"&&(N="success",B=tt,A=!0)}this.selectError&&(g=this.selectError,B=this.selectResult,S=Date.now(),N="error");var gt={status:N,isLoading:N==="loading",isSuccess:N==="success",isError:N==="error",isIdle:N==="idle",data:B,dataUpdatedAt:b,error:g,errorUpdatedAt:S,failureCount:m.fetchFailureCount,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>f.dataUpdateCount||m.errorUpdateCount>f.errorUpdateCount,isFetching:j,isRefetching:j&&N!=="loading",isLoadingError:N==="error"&&m.dataUpdatedAt===0,isPlaceholderData:A,isPreviousData:M,isRefetchError:N==="error"&&m.dataUpdatedAt!==0,isStale:Vi(n,r),refetch:this.refetch,remove:this.remove};return gt},e.shouldNotifyListeners=function(n,r){if(!r)return!0;var o=this.options,l=o.notifyOnChangeProps,h=o.notifyOnChangePropsExclusions;if(!l&&!h||l==="tracked"&&!this.trackedProps.length)return!0;var c=l==="tracked"?this.trackedProps:l;return Object.keys(n).some(function(u){var d=u,f=n[d]!==r[d],p=c==null?void 0:c.some(function(b){return b===u}),m=h==null?void 0:h.some(function(b){return b===u});return f&&!m&&(!c||p)})},e.updateResult=function(n){var r=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!No(this.currentResult,r)){var o={cache:!0};(n==null?void 0:n.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,r)&&(o.listeners=!0),this.notify(G({},o,n))}},e.updateQuery=function(){var n=this.client.getQueryCache().build(this.client,this.options);if(n!==this.currentQuery){var r=this.currentQuery;this.currentQuery=n,this.currentQueryInitialState=n.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(r==null||r.removeObserver(this),n.addObserver(this))}},e.onQueryUpdate=function(n){var r={};n.type==="success"?r.onSuccess=!0:n.type==="error"&&!Cs(n.error)&&(r.onError=!0),this.updateResult(r),this.hasListeners()&&this.updateTimers()},e.notify=function(n){var r=this;xt.batch(function(){n.onSuccess?(r.options.onSuccess==null||r.options.onSuccess(r.currentResult.data),r.options.onSettled==null||r.options.onSettled(r.currentResult.data,null)):n.onError&&(r.options.onError==null||r.options.onError(r.currentResult.error),r.options.onSettled==null||r.options.onSettled(void 0,r.currentResult.error)),n.listeners&&r.listeners.forEach(function(o){o(r.currentResult)}),n.cache&&r.client.getQueryCache().notify({query:r.currentQuery,type:"observerResultsUpdated"})})},t}(Ye);function Io(i,t){return t.enabled!==!1&&!i.state.dataUpdatedAt&&!(i.state.status==="error"&&t.retryOnMount===!1)}function un(i,t){return Io(i,t)||i.state.dataUpdatedAt>0&&Pi(i,t,t.refetchOnMount)}function Pi(i,t,e){if(t.enabled!==!1){var s=typeof e=="function"?e(i):e;return s==="always"||s!==!1&&Vi(i,t)}return!1}function dn(i,t,e,s){return e.enabled!==!1&&(i!==t||s.enabled===!1)&&(!e.suspense||i.state.status!=="error")&&Vi(i,e)}function Vi(i,t){return i.isStaleByTime(t.staleTime)}var zo=function(i){qe(t,i);function t(s,n){var r;return r=i.call(this)||this,r.client=s,r.setOptions(n),r.bindMethods(),r.updateResult(),r}var e=t.prototype;return e.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},e.setOptions=function(n){this.options=this.client.defaultMutationOptions(n)},e.onUnsubscribe=function(){if(!this.listeners.length){var n;(n=this.currentMutation)==null||n.removeObserver(this)}},e.onMutationUpdate=function(n){this.updateResult();var r={listeners:!0};n.type==="success"?r.onSuccess=!0:n.type==="error"&&(r.onError=!0),this.notify(r)},e.getCurrentResult=function(){return this.currentResult},e.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},e.mutate=function(n,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,G({},this.options,{variables:typeof n<"u"?n:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},e.updateResult=function(){var n=this.currentMutation?this.currentMutation.state:Yr(),r=G({},n,{isLoading:n.status==="loading",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=r},e.notify=function(n){var r=this;xt.batch(function(){r.mutateOptions&&(n.onSuccess?(r.mutateOptions.onSuccess==null||r.mutateOptions.onSuccess(r.currentResult.data,r.currentResult.variables,r.currentResult.context),r.mutateOptions.onSettled==null||r.mutateOptions.onSettled(r.currentResult.data,null,r.currentResult.variables,r.currentResult.context)):n.onError&&(r.mutateOptions.onError==null||r.mutateOptions.onError(r.currentResult.error,r.currentResult.variables,r.currentResult.context),r.mutateOptions.onSettled==null||r.mutateOptions.onSettled(void 0,r.currentResult.error,r.currentResult.variables,r.currentResult.context))),n.listeners&&r.listeners.forEach(function(o){o(r.currentResult)})})},t}(Ye),Bo=eo.unstable_batchedUpdates;xt.setBatchNotifyFunction(Bo);var $o=console;Po($o);var fn=Ct.createContext(void 0),Qr=Ct.createContext(!1);function Wr(i){return i&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=fn),window.ReactQueryClientContext):fn}var Jt=function(){var t=Ct.useContext(Wr(Ct.useContext(Qr)));if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Vo=function(t){var e=t.client,s=t.contextSharing,n=s===void 0?!1:s,r=t.children;Ct.useEffect(function(){return e.mount(),function(){e.unmount()}},[e]);var o=Wr(n);return Ct.createElement(Qr.Provider,{value:n},Ct.createElement(o.Provider,{value:e},r))};function Uo(){var i=!1;return{clearReset:function(){i=!1},reset:function(){i=!0},isReset:function(){return i}}}var qo=Ct.createContext(Uo()),Yo=function(){return Ct.useContext(qo)};function Hr(i,t,e){return typeof t=="function"?t.apply(void 0,e):typeof t=="boolean"?t:!!i}function wt(i,t,e){var s=Ct.useRef(!1),n=Ct.useState(0),r=n[1],o=vo(i,t,e),l=Jt(),h=Ct.useRef();h.current?h.current.setOptions(o):h.current=new zo(l,o);var c=h.current.getCurrentResult();Ct.useEffect(function(){s.current=!0;var d=h.current.subscribe(xt.batchCalls(function(){s.current&&r(function(f){return f+1})}));return function(){s.current=!1,d()}},[]);var u=Ct.useCallback(function(d,f){h.current.mutate(d,f).catch(Ft)},[]);if(c.error&&Hr(void 0,h.current.options.useErrorBoundary,[c.error]))throw c.error;return G({},c,{mutate:u,mutateAsync:c.mutate})}function Qo(i,t){var e=Ct.useRef(!1),s=Ct.useState(0),n=s[1],r=Jt(),o=Yo(),l=r.defaultQueryObserverOptions(i);l.optimisticResults=!0,l.onError&&(l.onError=xt.batchCalls(l.onError)),l.onSuccess&&(l.onSuccess=xt.batchCalls(l.onSuccess)),l.onSettled&&(l.onSettled=xt.batchCalls(l.onSettled)),l.suspense&&(typeof l.staleTime!="number"&&(l.staleTime=1e3),l.cacheTime===0&&(l.cacheTime=1)),(l.suspense||l.useErrorBoundary)&&(o.isReset()||(l.retryOnMount=!1));var h=Ct.useState(function(){return new t(r,l)}),c=h[0],u=c.getOptimisticResult(l);if(Ct.useEffect(function(){e.current=!0,o.clearReset();var d=c.subscribe(xt.batchCalls(function(){e.current&&n(function(f){return f+1})}));return c.updateResult(),function(){e.current=!1,d()}},[o,c]),Ct.useEffect(function(){c.setOptions(l,{listeners:!1})},[l,c]),l.suspense&&u.isLoading)throw c.fetchOptimistic(l).then(function(d){var f=d.data;l.onSuccess==null||l.onSuccess(f),l.onSettled==null||l.onSettled(f,null)}).catch(function(d){o.clearReset(),l.onError==null||l.onError(d),l.onSettled==null||l.onSettled(void 0,d)});if(u.isError&&!o.isReset()&&!u.isFetching&&Hr(l.suspense,l.useErrorBoundary,[u.error,c.getCurrentQuery()]))throw u.error;return l.notifyOnChangeProps==="tracked"&&(u=c.trackResult(u,l)),u}function Rt(i,t,e){var s=_s(i,t,e);return Qo(s,Ao)}function Jr(i,t){return function(){return i.apply(t,arguments)}}const{toString:Wo}=Object.prototype,{getPrototypeOf:Ui}=Object,{iterator:Ys,toStringTag:Kr}=Symbol,Qs=(i=>t=>{const e=Wo.call(t);return i[e]||(i[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),ee=i=>(i=i.toLowerCase(),t=>Qs(t)===i),Ws=i=>t=>typeof t===i,{isArray:Qe}=Array,Be=Ws("undefined");function ls(i){return i!==null&&!Be(i)&&i.constructor!==null&&!Be(i.constructor)&&Ut(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const Gr=ee("ArrayBuffer");function Ho(i){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(i):t=i&&i.buffer&&Gr(i.buffer),t}const Jo=Ws("string"),Ut=Ws("function"),Zr=Ws("number"),hs=i=>i!==null&&typeof i=="object",Ko=i=>i===!0||i===!1,Ms=i=>{if(Qs(i)!=="object")return!1;const t=Ui(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Kr in i)&&!(Ys in i)},Go=i=>{if(!hs(i)||ls(i))return!1;try{return Object.keys(i).length===0&&Object.getPrototypeOf(i)===Object.prototype}catch{return!1}},Zo=ee("Date"),Xo=ee("File"),tl=ee("Blob"),el=ee("FileList"),sl=i=>hs(i)&&Ut(i.pipe),il=i=>{let t;return i&&(typeof FormData=="function"&&i instanceof FormData||Ut(i.append)&&((t=Qs(i))==="formdata"||t==="object"&&Ut(i.toString)&&i.toString()==="[object FormData]"))},nl=ee("URLSearchParams"),[rl,al,ol,ll]=["ReadableStream","Request","Response","Headers"].map(ee),hl=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cs(i,t,{allOwnKeys:e=!1}={}){if(i===null||typeof i>"u")return;let s,n;if(typeof i!="object"&&(i=[i]),Qe(i))for(s=0,n=i.length;s<n;s++)t.call(null,i[s],s,i);else{if(ls(i))return;const r=e?Object.getOwnPropertyNames(i):Object.keys(i),o=r.length;let l;for(s=0;s<o;s++)l=r[s],t.call(null,i[l],l,i)}}function Xr(i,t){if(ls(i))return null;t=t.toLowerCase();const e=Object.keys(i);let s=e.length,n;for(;s-- >0;)if(n=e[s],t===n.toLowerCase())return n;return null}const ye=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ta=i=>!Be(i)&&i!==ye;function ki(){const{caseless:i,skipUndefined:t}=ta(this)&&this||{},e={},s=(n,r)=>{const o=i&&Xr(e,r)||r;Ms(e[o])&&Ms(n)?e[o]=ki(e[o],n):Ms(n)?e[o]=ki({},n):Qe(n)?e[o]=n.slice():(!t||!Be(n))&&(e[o]=n)};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&cs(arguments[n],s);return e}const cl=(i,t,e,{allOwnKeys:s}={})=>(cs(t,(n,r)=>{e&&Ut(n)?i[r]=Jr(n,e):i[r]=n},{allOwnKeys:s}),i),ul=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),dl=(i,t,e,s)=>{i.prototype=Object.create(t.prototype,s),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:t.prototype}),e&&Object.assign(i.prototype,e)},fl=(i,t,e,s)=>{let n,r,o;const l={};if(t=t||{},i==null)return t;do{for(n=Object.getOwnPropertyNames(i),r=n.length;r-- >0;)o=n[r],(!s||s(o,i,t))&&!l[o]&&(t[o]=i[o],l[o]=!0);i=e!==!1&&Ui(i)}while(i&&(!e||e(i,t))&&i!==Object.prototype);return t},ml=(i,t,e)=>{i=String(i),(e===void 0||e>i.length)&&(e=i.length),e-=t.length;const s=i.indexOf(t,e);return s!==-1&&s===e},pl=i=>{if(!i)return null;if(Qe(i))return i;let t=i.length;if(!Zr(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=i[t];return e},gl=(i=>t=>i&&t instanceof i)(typeof Uint8Array<"u"&&Ui(Uint8Array)),xl=(i,t)=>{const s=(i&&i[Ys]).call(i);let n;for(;(n=s.next())&&!n.done;){const r=n.value;t.call(i,r[0],r[1])}},bl=(i,t)=>{let e;const s=[];for(;(e=i.exec(t))!==null;)s.push(e);return s},vl=ee("HTMLFormElement"),yl=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,s,n){return s.toUpperCase()+n}),mn=(({hasOwnProperty:i})=>(t,e)=>i.call(t,e))(Object.prototype),wl=ee("RegExp"),ea=(i,t)=>{const e=Object.getOwnPropertyDescriptors(i),s={};cs(e,(n,r)=>{let o;(o=t(n,r,i))!==!1&&(s[r]=o||n)}),Object.defineProperties(i,s)},Nl=i=>{ea(i,(t,e)=>{if(Ut(i)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const s=i[e];if(Ut(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},Sl=(i,t)=>{const e={},s=n=>{n.forEach(r=>{e[r]=!0})};return Qe(i)?s(i):s(String(i).split(t)),e},_l=()=>{},jl=(i,t)=>i!=null&&Number.isFinite(i=+i)?i:t;function Cl(i){return!!(i&&Ut(i.append)&&i[Kr]==="FormData"&&i[Ys])}const Ml=i=>{const t=new Array(10),e=(s,n)=>{if(hs(s)){if(t.indexOf(s)>=0)return;if(ls(s))return s;if(!("toJSON"in s)){t[n]=s;const r=Qe(s)?[]:{};return cs(s,(o,l)=>{const h=e(o,n+1);!Be(h)&&(r[l]=h)}),t[n]=void 0,r}}return s};return e(i,0)},Pl=ee("AsyncFunction"),kl=i=>i&&(hs(i)||Ut(i))&&Ut(i.then)&&Ut(i.catch),sa=((i,t)=>i?setImmediate:t?((e,s)=>(ye.addEventListener("message",({source:n,data:r})=>{n===ye&&r===e&&s.length&&s.shift()()},!1),n=>{s.push(n),ye.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",Ut(ye.postMessage)),El=typeof queueMicrotask<"u"?queueMicrotask.bind(ye):typeof process<"u"&&process.nextTick||sa,Rl=i=>i!=null&&Ut(i[Ys]),w={isArray:Qe,isArrayBuffer:Gr,isBuffer:ls,isFormData:il,isArrayBufferView:Ho,isString:Jo,isNumber:Zr,isBoolean:Ko,isObject:hs,isPlainObject:Ms,isEmptyObject:Go,isReadableStream:rl,isRequest:al,isResponse:ol,isHeaders:ll,isUndefined:Be,isDate:Zo,isFile:Xo,isBlob:tl,isRegExp:wl,isFunction:Ut,isStream:sl,isURLSearchParams:nl,isTypedArray:gl,isFileList:el,forEach:cs,merge:ki,extend:cl,trim:hl,stripBOM:ul,inherits:dl,toFlatObject:fl,kindOf:Qs,kindOfTest:ee,endsWith:ml,toArray:pl,forEachEntry:xl,matchAll:bl,isHTMLForm:vl,hasOwnProperty:mn,hasOwnProp:mn,reduceDescriptors:ea,freezeMethods:Nl,toObjectSet:Sl,toCamelCase:yl,noop:_l,toFiniteNumber:jl,findKey:Xr,global:ye,isContextDefined:ta,isSpecCompliantForm:Cl,toJSONObject:Ml,isAsyncFn:Pl,isThenable:kl,setImmediate:sa,asap:El,isIterable:Rl};function H(i,t,e,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",t&&(this.code=t),e&&(this.config=e),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}w.inherits(H,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:w.toJSONObject(this.config),code:this.code,status:this.status}}});const ia=H.prototype,na={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{na[i]={value:i}});Object.defineProperties(H,na);Object.defineProperty(ia,"isAxiosError",{value:!0});H.from=(i,t,e,s,n,r)=>{const o=Object.create(ia);w.toFlatObject(i,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const l=i&&i.message?i.message:"Error",h=t==null&&i?i.code:t;return H.call(o,l,h,e,s,n),i&&o.cause==null&&Object.defineProperty(o,"cause",{value:i,configurable:!0}),o.name=i&&i.name||"Error",r&&Object.assign(o,r),o};const Ol=null;function Ei(i){return w.isPlainObject(i)||w.isArray(i)}function ra(i){return w.endsWith(i,"[]")?i.slice(0,-2):i}function pn(i,t,e){return i?i.concat(t).map(function(n,r){return n=ra(n),!e&&r?"["+n+"]":n}).join(e?".":""):t}function Tl(i){return w.isArray(i)&&!i.some(Ei)}const Fl=w.toFlatObject(w,{},null,function(t){return/^is[A-Z]/.test(t)});function Hs(i,t,e){if(!w.isObject(i))throw new TypeError("target must be an object");t=t||new FormData,e=w.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,g){return!w.isUndefined(g[b])});const s=e.metaTokens,n=e.visitor||u,r=e.dots,o=e.indexes,h=(e.Blob||typeof Blob<"u"&&Blob)&&w.isSpecCompliantForm(t);if(!w.isFunction(n))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(w.isDate(m))return m.toISOString();if(w.isBoolean(m))return m.toString();if(!h&&w.isBlob(m))throw new H("Blob is not supported. Use a Buffer instead.");return w.isArrayBuffer(m)||w.isTypedArray(m)?h&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,b,g){let S=m;if(m&&!g&&typeof m=="object"){if(w.endsWith(b,"{}"))b=s?b:b.slice(0,-2),m=JSON.stringify(m);else if(w.isArray(m)&&Tl(m)||(w.isFileList(m)||w.endsWith(b,"[]"))&&(S=w.toArray(m)))return b=ra(b),S.forEach(function(N,M){!(w.isUndefined(N)||N===null)&&t.append(o===!0?pn([b],M,r):o===null?b:b+"[]",c(N))}),!1}return Ei(m)?!0:(t.append(pn(g,b,r),c(m)),!1)}const d=[],f=Object.assign(Fl,{defaultVisitor:u,convertValue:c,isVisitable:Ei});function p(m,b){if(!w.isUndefined(m)){if(d.indexOf(m)!==-1)throw Error("Circular reference detected in "+b.join("."));d.push(m),w.forEach(m,function(S,j){(!(w.isUndefined(S)||S===null)&&n.call(t,S,w.isString(j)?j.trim():j,b,f))===!0&&p(S,b?b.concat(j):[j])}),d.pop()}}if(!w.isObject(i))throw new TypeError("data must be an object");return p(i),t}function gn(i){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function qi(i,t){this._pairs=[],i&&Hs(i,this,t)}const aa=qi.prototype;aa.append=function(t,e){this._pairs.push([t,e])};aa.toString=function(t){const e=t?function(s){return t.call(this,s,gn)}:gn;return this._pairs.map(function(n){return e(n[0])+"="+e(n[1])},"").join("&")};function Ll(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function oa(i,t,e){if(!t)return i;const s=e&&e.encode||Ll;w.isFunction(e)&&(e={serialize:e});const n=e&&e.serialize;let r;if(n?r=n(t,e):r=w.isURLSearchParams(t)?t.toString():new qi(t,e).toString(s),r){const o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+r}return i}class xn{constructor(){this.handlers=[]}use(t,e,s){return this.handlers.push({fulfilled:t,rejected:e,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){w.forEach(this.handlers,function(s){s!==null&&t(s)})}}const la={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Dl=typeof URLSearchParams<"u"?URLSearchParams:qi,Al=typeof FormData<"u"?FormData:null,Il=typeof Blob<"u"?Blob:null,zl={isBrowser:!0,classes:{URLSearchParams:Dl,FormData:Al,Blob:Il},protocols:["http","https","file","blob","url","data"]},Yi=typeof window<"u"&&typeof document<"u",Ri=typeof navigator=="object"&&navigator||void 0,Bl=Yi&&(!Ri||["ReactNative","NativeScript","NS"].indexOf(Ri.product)<0),$l=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Vl=Yi&&window.location.href||"http://localhost",Ul=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yi,hasStandardBrowserEnv:Bl,hasStandardBrowserWebWorkerEnv:$l,navigator:Ri,origin:Vl},Symbol.toStringTag,{value:"Module"})),Dt={...Ul,...zl};function ql(i,t){return Hs(i,new Dt.classes.URLSearchParams,{visitor:function(e,s,n,r){return Dt.isNode&&w.isBuffer(e)?(this.append(s,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...t})}function Yl(i){return w.matchAll(/\w+|\[(\w*)]/g,i).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ql(i){const t={},e=Object.keys(i);let s;const n=e.length;let r;for(s=0;s<n;s++)r=e[s],t[r]=i[r];return t}function ha(i){function t(e,s,n,r){let o=e[r++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=r>=e.length;return o=!o&&w.isArray(n)?n.length:o,h?(w.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!l):((!n[o]||!w.isObject(n[o]))&&(n[o]=[]),t(e,s,n[o],r)&&w.isArray(n[o])&&(n[o]=Ql(n[o])),!l)}if(w.isFormData(i)&&w.isFunction(i.entries)){const e={};return w.forEachEntry(i,(s,n)=>{t(Yl(s),n,e,0)}),e}return null}function Wl(i,t,e){if(w.isString(i))try{return(t||JSON.parse)(i),w.trim(i)}catch(s){if(s.name!=="SyntaxError")throw s}return(e||JSON.stringify)(i)}const us={transitional:la,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const s=e.getContentType()||"",n=s.indexOf("application/json")>-1,r=w.isObject(t);if(r&&w.isHTMLForm(t)&&(t=new FormData(t)),w.isFormData(t))return n?JSON.stringify(ha(t)):t;if(w.isArrayBuffer(t)||w.isBuffer(t)||w.isStream(t)||w.isFile(t)||w.isBlob(t)||w.isReadableStream(t))return t;if(w.isArrayBufferView(t))return t.buffer;if(w.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(r){if(s.indexOf("application/x-www-form-urlencoded")>-1)return ql(t,this.formSerializer).toString();if((l=w.isFileList(t))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Hs(l?{"files[]":t}:t,h&&new h,this.formSerializer)}}return r||n?(e.setContentType("application/json",!1),Wl(t)):t}],transformResponse:[function(t){const e=this.transitional||us.transitional,s=e&&e.forcedJSONParsing,n=this.responseType==="json";if(w.isResponse(t)||w.isReadableStream(t))return t;if(t&&w.isString(t)&&(s&&!this.responseType||n)){const o=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?H.from(l,H.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Dt.classes.FormData,Blob:Dt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};w.forEach(["delete","get","head","post","put","patch"],i=>{us.headers[i]={}});const Hl=w.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Jl=i=>{const t={};let e,s,n;return i&&i.split(`
`).forEach(function(o){n=o.indexOf(":"),e=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!e||t[e]&&Hl[e])&&(e==="set-cookie"?t[e]?t[e].push(s):t[e]=[s]:t[e]=t[e]?t[e]+", "+s:s)}),t},bn=Symbol("internals");function He(i){return i&&String(i).trim().toLowerCase()}function Ps(i){return i===!1||i==null?i:w.isArray(i)?i.map(Ps):String(i)}function Kl(i){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=e.exec(i);)t[s[1]]=s[2];return t}const Gl=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function ni(i,t,e,s,n){if(w.isFunction(s))return s.call(this,t,e);if(n&&(t=e),!!w.isString(t)){if(w.isString(s))return t.indexOf(s)!==-1;if(w.isRegExp(s))return s.test(t)}}function Zl(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,s)=>e.toUpperCase()+s)}function Xl(i,t){const e=w.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(i,s+e,{value:function(n,r,o){return this[s].call(this,t,n,r,o)},configurable:!0})})}let qt=class{constructor(t){t&&this.set(t)}set(t,e,s){const n=this;function r(l,h,c){const u=He(h);if(!u)throw new Error("header name must be a non-empty string");const d=w.findKey(n,u);(!d||n[d]===void 0||c===!0||c===void 0&&n[d]!==!1)&&(n[d||h]=Ps(l))}const o=(l,h)=>w.forEach(l,(c,u)=>r(c,u,h));if(w.isPlainObject(t)||t instanceof this.constructor)o(t,e);else if(w.isString(t)&&(t=t.trim())&&!Gl(t))o(Jl(t),e);else if(w.isObject(t)&&w.isIterable(t)){let l={},h,c;for(const u of t){if(!w.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[c=u[0]]=(h=l[c])?w.isArray(h)?[...h,u[1]]:[h,u[1]]:u[1]}o(l,e)}else t!=null&&r(e,t,s);return this}get(t,e){if(t=He(t),t){const s=w.findKey(this,t);if(s){const n=this[s];if(!e)return n;if(e===!0)return Kl(n);if(w.isFunction(e))return e.call(this,n,s);if(w.isRegExp(e))return e.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=He(t),t){const s=w.findKey(this,t);return!!(s&&this[s]!==void 0&&(!e||ni(this,this[s],s,e)))}return!1}delete(t,e){const s=this;let n=!1;function r(o){if(o=He(o),o){const l=w.findKey(s,o);l&&(!e||ni(s,s[l],l,e))&&(delete s[l],n=!0)}}return w.isArray(t)?t.forEach(r):r(t),n}clear(t){const e=Object.keys(this);let s=e.length,n=!1;for(;s--;){const r=e[s];(!t||ni(this,this[r],r,t,!0))&&(delete this[r],n=!0)}return n}normalize(t){const e=this,s={};return w.forEach(this,(n,r)=>{const o=w.findKey(s,r);if(o){e[o]=Ps(n),delete e[r];return}const l=t?Zl(r):String(r).trim();l!==r&&delete e[r],e[l]=Ps(n),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return w.forEach(this,(s,n)=>{s!=null&&s!==!1&&(e[n]=t&&w.isArray(s)?s.join(", "):s)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const s=new this(t);return e.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[bn]=this[bn]={accessors:{}}).accessors,n=this.prototype;function r(o){const l=He(o);s[l]||(Xl(n,o),s[l]=!0)}return w.isArray(t)?t.forEach(r):r(t),this}};qt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);w.reduceDescriptors(qt.prototype,({value:i},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>i,set(s){this[e]=s}}});w.freezeMethods(qt);function ri(i,t){const e=this||us,s=t||e,n=qt.from(s.headers);let r=s.data;return w.forEach(i,function(l){r=l.call(e,r,n.normalize(),t?t.status:void 0)}),n.normalize(),r}function ca(i){return!!(i&&i.__CANCEL__)}function We(i,t,e){H.call(this,i??"canceled",H.ERR_CANCELED,t,e),this.name="CanceledError"}w.inherits(We,H,{__CANCEL__:!0});function ua(i,t,e){const s=e.config.validateStatus;!e.status||!s||s(e.status)?i(e):t(new H("Request failed with status code "+e.status,[H.ERR_BAD_REQUEST,H.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function th(i){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return t&&t[1]||""}function eh(i,t){i=i||10;const e=new Array(i),s=new Array(i);let n=0,r=0,o;return t=t!==void 0?t:1e3,function(h){const c=Date.now(),u=s[r];o||(o=c),e[n]=h,s[n]=c;let d=r,f=0;for(;d!==n;)f+=e[d++],d=d%i;if(n=(n+1)%i,n===r&&(r=(r+1)%i),c-o<t)return;const p=u&&c-u;return p?Math.round(f*1e3/p):void 0}}function sh(i,t){let e=0,s=1e3/t,n,r;const o=(c,u=Date.now())=>{e=u,n=null,r&&(clearTimeout(r),r=null),i(...c)};return[(...c)=>{const u=Date.now(),d=u-e;d>=s?o(c,u):(n=c,r||(r=setTimeout(()=>{r=null,o(n)},s-d)))},()=>n&&o(n)]}const Is=(i,t,e=3)=>{let s=0;const n=eh(50,250);return sh(r=>{const o=r.loaded,l=r.lengthComputable?r.total:void 0,h=o-s,c=n(h),u=o<=l;s=o;const d={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:c||void 0,estimated:c&&l&&u?(l-o)/c:void 0,event:r,lengthComputable:l!=null,[t?"download":"upload"]:!0};i(d)},e)},vn=(i,t)=>{const e=i!=null;return[s=>t[0]({lengthComputable:e,total:i,loaded:s}),t[1]]},yn=i=>(...t)=>w.asap(()=>i(...t)),ih=Dt.hasStandardBrowserEnv?((i,t)=>e=>(e=new URL(e,Dt.origin),i.protocol===e.protocol&&i.host===e.host&&(t||i.port===e.port)))(new URL(Dt.origin),Dt.navigator&&/(msie|trident)/i.test(Dt.navigator.userAgent)):()=>!0,nh=Dt.hasStandardBrowserEnv?{write(i,t,e,s,n,r,o){if(typeof document>"u")return;const l=[`${i}=${encodeURIComponent(t)}`];w.isNumber(e)&&l.push(`expires=${new Date(e).toUTCString()}`),w.isString(s)&&l.push(`path=${s}`),w.isString(n)&&l.push(`domain=${n}`),r===!0&&l.push("secure"),w.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(i){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+i+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(i){this.write(i,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function rh(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function ah(i,t){return t?i.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):i}function da(i,t,e){let s=!rh(t);return i&&(s||e==!1)?ah(i,t):t}const wn=i=>i instanceof qt?{...i}:i;function Se(i,t){t=t||{};const e={};function s(c,u,d,f){return w.isPlainObject(c)&&w.isPlainObject(u)?w.merge.call({caseless:f},c,u):w.isPlainObject(u)?w.merge({},u):w.isArray(u)?u.slice():u}function n(c,u,d,f){if(w.isUndefined(u)){if(!w.isUndefined(c))return s(void 0,c,d,f)}else return s(c,u,d,f)}function r(c,u){if(!w.isUndefined(u))return s(void 0,u)}function o(c,u){if(w.isUndefined(u)){if(!w.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function l(c,u,d){if(d in t)return s(c,u);if(d in i)return s(void 0,c)}const h={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(c,u,d)=>n(wn(c),wn(u),d,!0)};return w.forEach(Object.keys({...i,...t}),function(u){const d=h[u]||n,f=d(i[u],t[u],u);w.isUndefined(f)&&d!==l||(e[u]=f)}),e}const fa=i=>{const t=Se({},i);let{data:e,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:r,headers:o,auth:l}=t;if(t.headers=o=qt.from(o),t.url=oa(da(t.baseURL,t.url,t.allowAbsoluteUrls),i.params,i.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),w.isFormData(e)){if(Dt.hasStandardBrowserEnv||Dt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(w.isFunction(e.getHeaders)){const h=e.getHeaders(),c=["content-type","content-length"];Object.entries(h).forEach(([u,d])=>{c.includes(u.toLowerCase())&&o.set(u,d)})}}if(Dt.hasStandardBrowserEnv&&(s&&w.isFunction(s)&&(s=s(t)),s||s!==!1&&ih(t.url))){const h=n&&r&&nh.read(r);h&&o.set(n,h)}return t},oh=typeof XMLHttpRequest<"u",lh=oh&&function(i){return new Promise(function(e,s){const n=fa(i);let r=n.data;const o=qt.from(n.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:c}=n,u,d,f,p,m;function b(){p&&p(),m&&m(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function S(){if(!g)return;const N=qt.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),A={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:N,config:i,request:g};ua(function(F){e(F),b()},function(F){s(F),b()},A),g=null}"onloadend"in g?g.onloadend=S:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(S)},g.onabort=function(){g&&(s(new H("Request aborted",H.ECONNABORTED,i,g)),g=null)},g.onerror=function(M){const A=M&&M.message?M.message:"Network Error",B=new H(A,H.ERR_NETWORK,i,g);B.event=M||null,s(B),g=null},g.ontimeout=function(){let M=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||la;n.timeoutErrorMessage&&(M=n.timeoutErrorMessage),s(new H(M,A.clarifyTimeoutError?H.ETIMEDOUT:H.ECONNABORTED,i,g)),g=null},r===void 0&&o.setContentType(null),"setRequestHeader"in g&&w.forEach(o.toJSON(),function(M,A){g.setRequestHeader(A,M)}),w.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),l&&l!=="json"&&(g.responseType=n.responseType),c&&([f,m]=Is(c,!0),g.addEventListener("progress",f)),h&&g.upload&&([d,p]=Is(h),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",p)),(n.cancelToken||n.signal)&&(u=N=>{g&&(s(!N||N.type?new We(null,i,g):N),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const j=th(n.url);if(j&&Dt.protocols.indexOf(j)===-1){s(new H("Unsupported protocol "+j+":",H.ERR_BAD_REQUEST,i));return}g.send(r||null)})},hh=(i,t)=>{const{length:e}=i=i?i.filter(Boolean):[];if(t||e){let s=new AbortController,n;const r=function(c){if(!n){n=!0,l();const u=c instanceof Error?c:this.reason;s.abort(u instanceof H?u:new We(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,r(new H(`timeout ${t} of ms exceeded`,H.ETIMEDOUT))},t);const l=()=>{i&&(o&&clearTimeout(o),o=null,i.forEach(c=>{c.unsubscribe?c.unsubscribe(r):c.removeEventListener("abort",r)}),i=null)};i.forEach(c=>c.addEventListener("abort",r));const{signal:h}=s;return h.unsubscribe=()=>w.asap(l),h}},ch=function*(i,t){let e=i.byteLength;if(e<t){yield i;return}let s=0,n;for(;s<e;)n=s+t,yield i.slice(s,n),s=n},uh=async function*(i,t){for await(const e of dh(i))yield*ch(e,t)},dh=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const t=i.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},Nn=(i,t,e,s)=>{const n=uh(i,t);let r=0,o,l=h=>{o||(o=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:c,value:u}=await n.next();if(c){l(),h.close();return}let d=u.byteLength;if(e){let f=r+=d;e(f)}h.enqueue(new Uint8Array(u))}catch(c){throw l(c),c}},cancel(h){return l(h),n.return()}},{highWaterMark:2})},Sn=64*1024,{isFunction:ms}=w,fh=(({Request:i,Response:t})=>({Request:i,Response:t}))(w.global),{ReadableStream:_n,TextEncoder:jn}=w.global,Cn=(i,...t)=>{try{return!!i(...t)}catch{return!1}},mh=i=>{i=w.merge.call({skipUndefined:!0},fh,i);const{fetch:t,Request:e,Response:s}=i,n=t?ms(t):typeof fetch=="function",r=ms(e),o=ms(s);if(!n)return!1;const l=n&&ms(_n),h=n&&(typeof jn=="function"?(m=>b=>m.encode(b))(new jn):async m=>new Uint8Array(await new e(m).arrayBuffer())),c=r&&l&&Cn(()=>{let m=!1;const b=new e(Dt.origin,{body:new _n,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!b}),u=o&&l&&Cn(()=>w.isReadableStream(new s("").body)),d={stream:u&&(m=>m.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!d[m]&&(d[m]=(b,g)=>{let S=b&&b[m];if(S)return S.call(b);throw new H(`Response type '${m}' is not supported`,H.ERR_NOT_SUPPORT,g)})});const f=async m=>{if(m==null)return 0;if(w.isBlob(m))return m.size;if(w.isSpecCompliantForm(m))return(await new e(Dt.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(w.isArrayBufferView(m)||w.isArrayBuffer(m))return m.byteLength;if(w.isURLSearchParams(m)&&(m=m+""),w.isString(m))return(await h(m)).byteLength},p=async(m,b)=>{const g=w.toFiniteNumber(m.getContentLength());return g??f(b)};return async m=>{let{url:b,method:g,data:S,signal:j,cancelToken:N,timeout:M,onDownloadProgress:A,onUploadProgress:B,responseType:F,headers:it,withCredentials:q="same-origin",fetchOptions:tt}=fa(m),gt=t||fetch;F=F?(F+"").toLowerCase():"text";let st=hh([j,N&&N.toAbortSignal()],M),ot=null;const nt=st&&st.unsubscribe&&(()=>{st.unsubscribe()});let ft;try{if(B&&c&&g!=="get"&&g!=="head"&&(ft=await p(it,S))!==0){let D=new e(b,{method:"POST",body:S,duplex:"half"}),lt;if(w.isFormData(S)&&(lt=D.headers.get("content-type"))&&it.setContentType(lt),D.body){const[Pt,yt]=vn(ft,Is(yn(B)));S=Nn(D.body,Sn,Pt,yt)}}w.isString(q)||(q=q?"include":"omit");const z=r&&"credentials"in e.prototype,Y={...tt,signal:st,method:g.toUpperCase(),headers:it.normalize().toJSON(),body:S,duplex:"half",credentials:z?q:void 0};ot=r&&new e(b,Y);let v=await(r?gt(ot,tt):gt(b,Y));const O=u&&(F==="stream"||F==="response");if(u&&(A||O&&nt)){const D={};["status","statusText","headers"].forEach(At=>{D[At]=v[At]});const lt=w.toFiniteNumber(v.headers.get("content-length")),[Pt,yt]=A&&vn(lt,Is(yn(A),!0))||[];v=new s(Nn(v.body,Sn,Pt,()=>{yt&&yt(),nt&&nt()}),D)}F=F||"text";let U=await d[w.findKey(d,F)||"text"](v,m);return!O&&nt&&nt(),await new Promise((D,lt)=>{ua(D,lt,{data:U,headers:qt.from(v.headers),status:v.status,statusText:v.statusText,config:m,request:ot})})}catch(z){throw nt&&nt(),z&&z.name==="TypeError"&&/Load failed|fetch/i.test(z.message)?Object.assign(new H("Network Error",H.ERR_NETWORK,m,ot),{cause:z.cause||z}):H.from(z,z&&z.code,m,ot)}}},ph=new Map,ma=i=>{let t=i&&i.env||{};const{fetch:e,Request:s,Response:n}=t,r=[s,n,e];let o=r.length,l=o,h,c,u=ph;for(;l--;)h=r[l],c=u.get(h),c===void 0&&u.set(h,c=l?new Map:mh(t)),u=c;return c};ma();const Qi={http:Ol,xhr:lh,fetch:{get:ma}};w.forEach(Qi,(i,t)=>{if(i){try{Object.defineProperty(i,"name",{value:t})}catch{}Object.defineProperty(i,"adapterName",{value:t})}});const Mn=i=>`- ${i}`,gh=i=>w.isFunction(i)||i===null||i===!1;function xh(i,t){i=w.isArray(i)?i:[i];const{length:e}=i;let s,n;const r={};for(let o=0;o<e;o++){s=i[o];let l;if(n=s,!gh(s)&&(n=Qi[(l=String(s)).toLowerCase()],n===void 0))throw new H(`Unknown adapter '${l}'`);if(n&&(w.isFunction(n)||(n=n.get(t))))break;r[l||"#"+o]=n}if(!n){const o=Object.entries(r).map(([h,c])=>`adapter ${h} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=e?o.length>1?`since :
`+o.map(Mn).join(`
`):" "+Mn(o[0]):"as no adapter specified";throw new H("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n}const pa={getAdapter:xh,adapters:Qi};function ai(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new We(null,i)}function Pn(i){return ai(i),i.headers=qt.from(i.headers),i.data=ri.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),pa.getAdapter(i.adapter||us.adapter,i)(i).then(function(s){return ai(i),s.data=ri.call(i,i.transformResponse,s),s.headers=qt.from(s.headers),s},function(s){return ca(s)||(ai(i),s&&s.response&&(s.response.data=ri.call(i,i.transformResponse,s.response),s.response.headers=qt.from(s.response.headers))),Promise.reject(s)})}const ga="1.13.2",Js={};["object","boolean","number","function","string","symbol"].forEach((i,t)=>{Js[i]=function(s){return typeof s===i||"a"+(t<1?"n ":" ")+i}});const kn={};Js.transitional=function(t,e,s){function n(r,o){return"[Axios v"+ga+"] Transitional option '"+r+"'"+o+(s?". "+s:"")}return(r,o,l)=>{if(t===!1)throw new H(n(o," has been removed"+(e?" in "+e:"")),H.ERR_DEPRECATED);return e&&!kn[o]&&(kn[o]=!0,console.warn(n(o," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(r,o,l):!0}};Js.spelling=function(t){return(e,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function bh(i,t,e){if(typeof i!="object")throw new H("options must be an object",H.ERR_BAD_OPTION_VALUE);const s=Object.keys(i);let n=s.length;for(;n-- >0;){const r=s[n],o=t[r];if(o){const l=i[r],h=l===void 0||o(l,r,i);if(h!==!0)throw new H("option "+r+" must be "+h,H.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new H("Unknown option "+r,H.ERR_BAD_OPTION)}}const ks={assertOptions:bh,validators:Js},ne=ks.validators;let we=class{constructor(t){this.defaults=t||{},this.interceptors={request:new xn,response:new xn}}async request(t,e){try{return await this._request(t,e)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const r=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?r&&!String(s.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+r):s.stack=r}catch{}}throw s}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Se(this.defaults,e);const{transitional:s,paramsSerializer:n,headers:r}=e;s!==void 0&&ks.assertOptions(s,{silentJSONParsing:ne.transitional(ne.boolean),forcedJSONParsing:ne.transitional(ne.boolean),clarifyTimeoutError:ne.transitional(ne.boolean)},!1),n!=null&&(w.isFunction(n)?e.paramsSerializer={serialize:n}:ks.assertOptions(n,{encode:ne.function,serialize:ne.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),ks.assertOptions(e,{baseUrl:ne.spelling("baseURL"),withXsrfToken:ne.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=r&&w.merge(r.common,r[e.method]);r&&w.forEach(["delete","get","head","post","put","patch","common"],m=>{delete r[m]}),e.headers=qt.concat(o,r);const l=[];let h=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(e)===!1||(h=h&&b.synchronous,l.unshift(b.fulfilled,b.rejected))});const c=[];this.interceptors.response.forEach(function(b){c.push(b.fulfilled,b.rejected)});let u,d=0,f;if(!h){const m=[Pn.bind(this),void 0];for(m.unshift(...l),m.push(...c),f=m.length,u=Promise.resolve(e);d<f;)u=u.then(m[d++],m[d++]);return u}f=l.length;let p=e;for(;d<f;){const m=l[d++],b=l[d++];try{p=m(p)}catch(g){b.call(this,g);break}}try{u=Pn.call(this,p)}catch(m){return Promise.reject(m)}for(d=0,f=c.length;d<f;)u=u.then(c[d++],c[d++]);return u}getUri(t){t=Se(this.defaults,t);const e=da(t.baseURL,t.url,t.allowAbsoluteUrls);return oa(e,t.params,t.paramsSerializer)}};w.forEach(["delete","get","head","options"],function(t){we.prototype[t]=function(e,s){return this.request(Se(s||{},{method:t,url:e,data:(s||{}).data}))}});w.forEach(["post","put","patch"],function(t){function e(s){return function(r,o,l){return this.request(Se(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}we.prototype[t]=e(),we.prototype[t+"Form"]=e(!0)});let vh=class xa{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(r){e=r});const s=this;this.promise.then(n=>{if(!s._listeners)return;let r=s._listeners.length;for(;r-- >0;)s._listeners[r](n);s._listeners=null}),this.promise.then=n=>{let r;const o=new Promise(l=>{s.subscribe(l),r=l}).then(n);return o.cancel=function(){s.unsubscribe(r)},o},t(function(r,o,l){s.reason||(s.reason=new We(r,o,l),e(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=s=>{t.abort(s)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new xa(function(n){t=n}),cancel:t}}};function yh(i){return function(e){return i.apply(null,e)}}function wh(i){return w.isObject(i)&&i.isAxiosError===!0}const Oi={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Oi).forEach(([i,t])=>{Oi[t]=i});function ba(i){const t=new we(i),e=Jr(we.prototype.request,t);return w.extend(e,we.prototype,t,{allOwnKeys:!0}),w.extend(e,t,null,{allOwnKeys:!0}),e.create=function(n){return ba(Se(i,n))},e}const St=ba(us);St.Axios=we;St.CanceledError=We;St.CancelToken=vh;St.isCancel=ca;St.VERSION=ga;St.toFormData=Hs;St.AxiosError=H;St.Cancel=St.CanceledError;St.all=function(t){return Promise.all(t)};St.spread=yh;St.isAxiosError=wh;St.mergeConfig=Se;St.AxiosHeaders=qt;St.formToJSON=i=>ha(w.isHTMLForm(i)?new FormData(i):i);St.getAdapter=pa.getAdapter;St.HttpStatusCode=Oi;St.default=St;const{Axios:af,AxiosError:of,CanceledError:lf,isCancel:hf,CancelToken:cf,VERSION:uf,all:df,Cancel:ff,isAxiosError:mf,spread:pf,toFormData:gf,AxiosHeaders:xf,HttpStatusCode:bf,formToJSON:vf,getAdapter:yf,mergeConfig:wf}=St,K=St.create({baseURL:"",headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});console.log(" API Configuration [Build: 2025-11-10T20:00 - SIMPLIFIED]:",{baseURL:"(empty = relative to current origin)",currentOrigin:window.location.origin,hostname:window.location.hostname,note:"All API requests will be relative to current page origin"});K.interceptors.request.use(i=>{const t=localStorage.getItem("auth_token");return t&&(i.headers.Authorization=`Bearer ${t}`),i});const Wi={getAccounts:async()=>(await K.get("/api/accounts")).data,getAccountInfo:async()=>(await K.get("/api/account/info")).data,switchAccount:async i=>(await K.post("/api/account/switch",{account_id:i})).data},Xt={getPositions:async()=>(await K.get(`/api/positions?_t=${Date.now()}`)).data,closePosition:async(i,t)=>{await K.post(`/api/positions/${i}/close`,{quantity:t})},modifyStopLoss:async(i,t)=>{await K.post(`/api/positions/${i}/modify-stop`,{stop_price:t})},modifyTakeProfit:async(i,t)=>{await K.post(`/api/positions/${i}/modify-tp`,{take_profit:t})},flattenAll:async()=>{await K.post("/api/positions/flatten")},enableTrailingStop:async(i,t)=>(await K.post(`/api/positions/${i}/trailing-stop`,{enabled:!0,trail_amount:t})).data,disableTrailingStop:async i=>(await K.post(`/api/positions/${i}/trailing-stop`,{enabled:!1})).data,enableBreakeven:async i=>(await K.post(`/api/positions/${i}/breakeven`,{enabled:!0})).data,disableBreakeven:async i=>(await K.post(`/api/positions/${i}/breakeven`,{enabled:!1})).data},De={getOrders:async()=>(await K.get(`/api/orders?_t=${Date.now()}`)).data,cancelOrder:async i=>{await K.post(`/api/orders/${i}/cancel`)},cancelAll:async i=>{await K.post("/api/orders/cancel-all",i?{account_id:i}:{})},modifyOrder:async(i,t)=>(await K.post(`/api/orders/${i}/modify`,t)).data,placeOrder:async i=>{const t={...i};return t.symbol&&(t.symbol=t.symbol.trim().toUpperCase()),t.order_type&&(t.order_type=t.order_type.toLowerCase()),(await K.post("/api/orders/place",t)).data}},de={getStrategies:async()=>(await K.get("/api/strategies")).data,getStrategyStatus:async()=>(await K.get("/api/strategies/status")).data,startStrategy:async(i,t,e)=>{const s={symbols:t??[]};return e&&(s.accountId=e),(await K.post(`/api/strategies/${i}/start`,s)).data},stopStrategy:async(i,t)=>{const e={};return t&&(e.accountId=t),(await K.post(`/api/strategies/${i}/stop`,e)).data},getStrategyStats:async(i,t)=>{const e=t?`?account_id=${t}`:"";return(await K.get(`/api/strategies/${i}/stats${e}`)).data},getStrategyLogs:async(i,t)=>{const e=t?`?limit=${t}`:"";return(await K.get(`/api/strategies/${i}/logs${e}`)).data},verifyStrategy:async i=>(await K.get(`/api/strategies/${i}/verify`)).data,testStrategy:async(i,t)=>{const e={};return t&&(e.account_id=t),(await K.post(`/api/strategies/${i}/test`,e)).data},updateStrategyConfig:async(i,t)=>(await K.put(`/api/strategies/${i}/config`,t)).data},Nh={getMetrics:async()=>{const i=await K.get("/api/metrics");return i.data.performance||i.data}},Sh={getRisk:async i=>{const t=i?`?account_id=${encodeURIComponent(i)}`:"";return(await K.get(`/api/risk${t}`)).data}},_h={getTrades:async(i={})=>{const t=new URLSearchParams;i.accountId&&t.append("account_id",i.accountId),i.start&&t.append("start",i.start),i.end&&t.append("end",i.end),i.symbol&&t.append("symbol",i.symbol),i.type&&t.append("type",i.type),i.limit&&t.append("limit",String(i.limit)),i.cursor&&t.append("cursor",i.cursor),t.append("refresh","1"),t.append("_t",Date.now().toString());const e=t.toString();return(await K.get(`/api/trades${e?`?${e}`:""}`)).data}},va={getPerformanceSummary:async()=>(await K.get("/api/performance")).data,getPerformanceHistory:async(i={})=>{const t=new URLSearchParams;i.accountId&&t.append("account_id",i.accountId),i.interval&&t.append("interval",i.interval),i.start&&t.append("start",i.start),i.end&&t.append("end",i.end);const e=t.toString();return(await K.get(`/api/performance/history${e?`?${e}`:""}`)).data},getHistoricalData:async i=>{const t=new URLSearchParams;return t.append("symbol",i.symbol),i.timeframe&&t.append("timeframe",i.timeframe),i.limit&&t.append("limit",String(i.limit)),i.end&&t.append("end",i.end),(await K.get(`/api/history?${t.toString()}`)).data}},ss={getSettings:async(i="global")=>{const t=i&&i!=="global"?`?account_id=${i}`:"";return(await K.get(`/api/settings${t}`)).data},saveSettings:async i=>{const t={...i};return(await K.post("/api/settings",t)).data}},jh={getNotifications:async i=>{const t=i?`?account_id=${i}`:"";return(await K.get(`/api/notifications${t}`)).data}},Ch={testOvernightBreakout:async(i,t,e)=>(await K.post("/api/test/overnight-breakout",{symbol:i||"MNQ",quantity:t||1,account_name:e||"PRAC"})).data},ya=_.createContext(void 0);function Mh({children:i}){const[t,e]=_.useState(null),{data:s=[],isLoading:n}=Rt("accounts",Wi.getAccounts,{refetchInterval:6e4,staleTime:3e4}),{data:r}=Rt(["settings","global"],()=>ss.getSettings("global"),{staleTime:6e4,refetchOnWindowFocus:!1});return _.useEffect(()=>{var o;if(s.length>0&&!t){const l=(o=r==null?void 0:r.settings)==null?void 0:o.defaultAccount,h=l?s.find(c=>String(c.id)===String(l)||String(c.account_id)===String(l)||String(c.accountId)===String(l)):null;e(h||s[0])}},[s,t,r]),a.jsx(ya.Provider,{value:{accounts:s,selectedAccount:t,setSelectedAccount:e,isLoading:n},children:i})}function se(){const i=_.useContext(ya);if(i===void 0)throw new Error("useAccount must be used within an AccountProvider");return i}const Ph=()=>{const i=window.location.hostname;return i==="localhost"||i==="127.0.0.1"?"ws://localhost:8080/ws":`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`},wa=Ph();console.log(" WebSocket Configuration [Build: 2025-11-10T19:45 - FIXED]:",{url:wa,hostname:window.location.hostname,protocol:window.location.protocol,isLocalhost:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"});class kh{constructor(){oe(this,"socket",null);oe(this,"listeners",new Map);oe(this,"reconnectAttempts",0);oe(this,"maxReconnectAttempts",8);oe(this,"reconnectDelay",1e3);oe(this,"heartbeatIntervalId",null);oe(this,"HEARTBEAT_INTERVAL",3e4);oe(this,"manualClose",!1)}connect(){if(!(this.socket&&(this.socket.readyState===WebSocket.OPEN||this.socket.readyState===WebSocket.CONNECTING))){this.notify("socket_connecting",{timestamp:new Date().toISOString()});try{this.manualClose=!1,this.socket=new WebSocket(wa),this.socket.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.notify("socket_connected",{timestamp:new Date().toISOString()}),this.startHeartbeat()},this.socket.onclose=t=>{console.log("WebSocket disconnected",t.reason||""),this.clearHeartbeat(),this.notify("socket_disconnected",{code:t.code,reason:t.reason,wasClean:t.wasClean,timestamp:new Date().toISOString()}),this.manualClose||this.attemptReconnect()},this.socket.onmessage=t=>{try{const e=JSON.parse(t.data);this.handleMessage(e)}catch(e){console.error("Error parsing WebSocket message:",e)}},this.socket.onerror=t=>{console.error("WebSocket error:",t),this.notify("socket_error",{error:t})}}catch(t){console.error("Failed to create WebSocket:",t),this.notify("socket_error",{error:t}),this.attemptReconnect()}}}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached"),this.notify("socket_failed",{attempts:this.reconnectAttempts,timestamp:new Date().toISOString()});return}this.reconnectAttempts++;const t=this.reconnectDelay*this.reconnectAttempts;console.log(`Reconnecting in ${t}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),this.notify("socket_reconnecting",{attempt:this.reconnectAttempts,delay:t,timestamp:new Date().toISOString()}),window.setTimeout(()=>{this.connect()},t)}disconnect(){this.manualClose=!0,this.clearHeartbeat(),this.socket&&(this.socket.close(),this.socket=null)}forceReconnect(){this.manualClose=!1,this.reconnectAttempts=0,this.clearHeartbeat(),this.socket&&(this.socket.close(),this.socket=null),this.connect()}on(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}off(t,e){var s;(s=this.listeners.get(t))==null||s.delete(e)}emit(t,e){var s;((s=this.socket)==null?void 0:s.readyState)===WebSocket.OPEN&&this.socket.send(JSON.stringify({action:t,payload:e}))}handleMessage(t){const e=this.listeners.get(t.type);e&&e.forEach(s=>s(t.data))}notify(t,e){const s=this.listeners.get(t);s&&s.forEach(n=>n(e))}startHeartbeat(){this.clearHeartbeat(),this.heartbeatIntervalId=window.setInterval(()=>{var t;((t=this.socket)==null?void 0:t.readyState)===WebSocket.OPEN&&this.socket.send(JSON.stringify({action:"ping",payload:{timestamp:Date.now()}}))},this.HEARTBEAT_INTERVAL)}clearHeartbeat(){this.heartbeatIntervalId!==null&&(window.clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null)}isConnected(){var t;return((t=this.socket)==null?void 0:t.readyState)===WebSocket.OPEN||!1}}const J=new kh,Na=_.createContext(void 0);function Eh({children:i}){const[t,e]=_.useState("connecting"),[s,n]=_.useState(0),[r,o]=_.useState(null),[l,h]=_.useState(null),[c,u]=_.useState(null);_.useEffect(()=>{const p=()=>{e("connecting"),u(null)},m=N=>{e("connected"),n(0),o((N==null?void 0:N.timestamp)??new Date().toISOString()),u(null)},b=N=>{e("disconnected"),h((N==null?void 0:N.timestamp)??new Date().toISOString())},g=N=>{e("reconnecting"),N!=null&&N.attempt?n(N.attempt):n(M=>M+1)},S=N=>{var A;e("error");const M=(N==null?void 0:N.error)instanceof Event?N.error.type:((A=N==null?void 0:N.error)==null?void 0:A.message)??"Unknown error";u(M)},j=N=>{e("error"),N!=null&&N.attempts&&n(N.attempts)};return J.on("socket_connecting",p),J.on("socket_connected",m),J.on("socket_disconnected",b),J.on("socket_reconnecting",g),J.on("socket_error",S),J.on("socket_failed",j),J.connect(),()=>{J.off("socket_connecting",p),J.off("socket_connected",m),J.off("socket_disconnected",b),J.off("socket_reconnecting",g),J.off("socket_error",S),J.off("socket_failed",j)}},[]);const d=_.useCallback(()=>{e("connecting"),u(null),n(0),J.forceReconnect()},[]),f=_.useMemo(()=>({status:t,reconnectAttempts:s,lastConnectedAt:r,lastDisconnectedAt:l,lastError:c,reconnect:d,isConnected:J.isConnected()}),[t,s,r,l,c,d]);return a.jsx(Na.Provider,{value:f,children:i})}function Rh(){const i=_.useContext(Na);if(!i)throw new Error("useWebSocket must be used within a WebSocketProvider");return i}const Sa=()=>{const i=Jt();_.useEffect(()=>{const t=()=>{i.invalidateQueries("positions"),i.invalidateQueries("orders")},e=()=>{i.invalidateQueries("positions")},s=()=>{i.invalidateQueries("orders")};return J.on("marketUpdate",t),J.on("position_update",e),J.on("order_update",s),()=>{J.off("marketUpdate",t),J.off("position_update",e),J.off("order_update",s)}},[i])};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),at=(i,t)=>{const e=_.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:l="",children:h,...c},u)=>_.createElement("svg",{ref:u,...Oh,width:n,height:n,stroke:s,strokeWidth:o?Number(r)*24/Number(n):r,className:["lucide",`lucide-${Th(i)}`,l].join(" "),...c},[...t.map(([d,f])=>_.createElement(d,f)),...Array.isArray(h)?h:[h]]));return e.displayName=`${i}`,e};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=at("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=at("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=at("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=at("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=at("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=at("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=at("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=at("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=at("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=at("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=at("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=at("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=at("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=at("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=at("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=at("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=at("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=at("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=at("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=at("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=at("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=at("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vh=at("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=at("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=at("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=at("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=at("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=at("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=at("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=at("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Qh({account:i,isSelected:t,onSelect:e}){const s=i.dailyPnL??i.daily_pnl??0,n=s>=0?"text-green-400":"text-red-400",r=s>=0?Ks:Hi;return a.jsxs("div",{className:`p-6 rounded-lg border-2 transition-all cursor-pointer ${t?"bg-slate-800 border-primary-500 shadow-lg shadow-primary-500/20":"bg-slate-800/50 border-slate-700 hover:border-slate-600"}`,onClick:e,children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:i.name}),a.jsx("p",{className:"text-sm text-slate-400",children:i.account_type})]}),a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${i.status==="active"?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400"}`,children:i.status})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Dh,{className:"w-5 h-5 text-slate-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-slate-400",children:"Balance"}),a.jsxs("p",{className:"text-2xl font-bold",children:[i.currency," ",i.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),s!==0&&a.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[a.jsx(r,{className:"w-4 h-4"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm",children:"P&L"}),a.jsxs("p",{className:"text-lg font-semibold",children:[s>=0?"+":"",i.currency," ",Math.abs(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]})}function Ji({accounts:i,selectedAccount:t,onAccountChange:e}){var u;const[s,n]=_.useState(!1),r=Jt(),o=d=>d.id||d.accountId||d.account_id||d.name||"unknown",l=d=>d.name||d.accountId||d.account_id||o(d),h=wt(d=>Wi.switchAccount(d),{onSuccess:d=>{if(d.success&&d.account){const f=d.account.id||d.account.accountId||d.account.account_id,p=i.find(g=>o(g)===f),m={id:d.account.id||d.account.accountId||d.account.account_id||o(d.account),name:(p==null?void 0:p.name)||d.account.name||d.account.accountId||d.account.account_id||o(d.account),status:d.account.status||"active",balance:Number(d.account.balance??0),currency:d.account.currency||"USD",account_type:d.account.account_type||"unknown",accountId:d.account.accountId,account_id:d.account.account_id,equity:d.account.equity??d.account.balance??0,dailyPnL:d.account.dailyPnL??d.account.daily_pnl??0,daily_pnl:d.account.dailyPnL??d.account.daily_pnl??0};console.log("[AccountSelector] Account switched",{normalized:m,originalAccount:p==null?void 0:p.name,accountId:f}),e(m),r.setQueryData("accountInfo",m),r.setQueryData("accounts",g=>(g==null?void 0:g.map(S=>o(S)===m.id?{...S,balance:m.balance,status:m.status}:S))||[]),["accounts","accountInfo","positions","orders","metrics","trades","performance","performanceHistory","historicalData"].forEach(g=>r.invalidateQueries({predicate:S=>S.queryKey[0]===g})),n(!1)}},onError:d=>{console.error("Failed to switch account:",d)}}),c=async d=>{const f=t?o(t):null,p=o(d);if(p===f){n(!1);return}h.mutate(p)};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>n(!s),className:"w-full bg-slate-700 hover:bg-slate-600 rounded-lg px-4 py-3 flex items-center justify-between transition-colors border border-slate-600",disabled:h.isLoading,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),a.jsx("div",{className:"text-left",children:t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium",children:l(t)}),a.jsxs("div",{className:"text-xs text-slate-400",children:["$",((u=t.balance)==null?void 0:u.toLocaleString())||"N/A"]})]}):a.jsx("div",{className:"text-slate-400",children:"Select Account"})})]}),a.jsx(Gt,{className:`w-5 h-5 transition-transform ${s?"rotate-180":""}`})]}),s&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),a.jsx("div",{className:"absolute top-full mt-2 w-full bg-slate-700 border border-slate-600 rounded-lg shadow-xl z-50 max-h-96 overflow-y-auto",children:i.length===0?a.jsx("div",{className:"px-4 py-3 text-slate-400 text-sm",children:"No accounts available"}):i.map(d=>{var g;const f=o(d),p=t?o(t):null,m=f===p,b=h.isLoading&&h.variables===f;return a.jsxs("button",{onClick:()=>c(d),disabled:h.isLoading,className:`w-full px-4 py-3 flex items-center justify-between hover:bg-slate-600 transition-colors ${m?"bg-slate-600":""} ${h.isLoading?"opacity-50":""}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${d.status==="active"?"bg-green-500":"bg-slate-500"}`}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium",children:l(d)}),a.jsxs("div",{className:"text-xs text-slate-400",children:["$",((g=d.balance)==null?void 0:g.toLocaleString())||"N/A",d.status&&a.jsxs("span",{className:"ml-2 capitalize",children:[" ",d.status]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[b&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-500"}),m&&!b&&a.jsx(En,{className:"w-5 h-5 text-primary-400"})]})]},f)})})]}),h.isError&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-400 text-sm",children:[a.jsx(_e,{className:"w-4 h-4"}),a.jsx("span",{children:"Failed to switch account"})]}),h.isSuccess&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-green-400 text-sm",children:[a.jsx(En,{className:"w-4 h-4"}),a.jsx("span",{children:"Account switched successfully"})]})]})}function ge(i,t){const{selectedAccount:e}=se(),s=Jt(),n=e==null?void 0:e.id,{data:r}=Rt(["settings","global",n],()=>ss.getSettings(n||"global"),{staleTime:6e4,refetchOnWindowFocus:!1}),[o,l]=_.useState(()=>{var d;const u=((d=r==null?void 0:r.settings)==null?void 0:d.widgetStates)||{};return u[i]!==void 0?u[i]:t});_.useEffect(()=>{var u;if((u=r==null?void 0:r.settings)!=null&&u.widgetStates){const d=r.settings.widgetStates;d[i]!==void 0&&l(d[i])}},[r,i]);const h=wt(async u=>{const d=(r==null?void 0:r.settings)||{},f=d.widgetStates||{},p={...d,widgetStates:{...f,[i]:u}};await ss.saveSettings({...p,account_id:n})},{onSuccess:()=>{s.invalidateQueries(["settings"])}}),c=_.useCallback(u=>{l(d=>{const f=typeof u=="function"?u(d):u;return setTimeout(()=>{h.mutate(f)},500),f})},[h]);return[o,c]}function Wh({metrics:i}){const[t,e]=ge("performanceMetrics",!0);return a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>e(s=>!s),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3 text-left",children:[a.jsx(zs,{className:"w-5 h-5 text-blue-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Performance Metrics"}),a.jsx("p",{className:"text-xs text-slate-400",children:"System, API & Cache stats"})]})]}),t?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),t&&a.jsx("div",{className:"px-4 pb-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(zs,{className:"w-4 h-4"}),"System"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Memory"}),a.jsxs("p",{className:"font-semibold",children:[i.system.memory_mb," MB"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"CPU"}),a.jsxs("p",{className:"font-semibold",children:[i.system.cpu_percent,"%"]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-slate-400",children:"Uptime"}),a.jsx("p",{className:"font-semibold",children:i.system.uptime})]})]})]}),a.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-700",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(Li,{className:"w-4 h-4"}),"API Calls"]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Total"}),a.jsx("span",{className:"font-semibold",children:i.api.total_calls})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Errors"}),a.jsx("span",{className:`font-semibold ${i.api.total_errors>0?"text-red-400":"text-green-400"}`,children:i.api.total_errors})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Error Rate"}),a.jsxs("span",{className:`font-semibold ${i.api.error_rate>1?"text-red-400":"text-green-400"}`,children:[i.api.error_rate.toFixed(2),"%"]})]})]})]}),Object.keys(i.cache).length>0&&a.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-700",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(Lh,{className:"w-4 h-4"}),"Cache"]}),a.jsx("div",{className:"space-y-2",children:Object.entries(i.cache).map(([s,n])=>a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex justify-between mb-1",children:[a.jsx("span",{className:"text-slate-400 text-xs",children:s}),a.jsx("span",{className:"font-semibold",children:n.hit_rate})]}),a.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1.5",children:a.jsx("div",{className:"bg-primary-500 h-1.5 rounded-full transition-all",style:{width:n.hit_rate}})})]},s))})]})]})})]})}function Hh(){const{selectedAccount:i}=se(),t=i==null?void 0:i.id,[e,s]=ge("positionsOverview",!0),{data:n=[],isLoading:r}=Rt(["positions",t],Xt.getPositions,{enabled:!!t,staleTime:6e4,refetchOnWindowFocus:!1}),o=wt(({positionId:h,quantity:c})=>Xt.closePosition(h,c),{onSuccess:()=>{}}),l=(h,c)=>{h&&confirm("Close entire position?")&&o.mutate({positionId:h,quantity:c})};return r?a.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:a.jsx("p",{className:"text-slate-400",children:"Loading positions..."})}):n.length===0?a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Open Positions"}),a.jsx("p",{className:"text-slate-400",children:"No open positions"})]}):a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>s(h=>!h),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsx("div",{className:"flex items-center gap-3 text-left",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Open Positions"}),a.jsx("p",{className:"text-xs text-slate-400",children:n.length>0?`${n.length} position${n.length!==1?"s":""}`:"No positions"})]})}),e?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),e&&a.jsx("div",{className:"px-4 pb-4",children:a.jsx("div",{className:"space-y-3",children:n.map(h=>{const c=h.side==="LONG",u=Number(h.unrealized_pnl??0),d=Number(h.realized_pnl??0),f=Number(h.entry_price??0),p=Number(h.current_price??f),m=u>=0?Ks:Hi,b=u>=0?"text-green-400":"text-red-400";return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${c?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:h.side}),a.jsx("span",{className:"font-semibold",children:h.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(h.quantity??0)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:`flex items-center gap-1 ${b}`,children:[a.jsx(m,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-semibold",children:["$",u.toFixed(2)]})]}),a.jsx("button",{onClick:()=>l(h.id),disabled:o.isLoading,className:"p-1.5 hover:bg-red-500/20 text-red-400 rounded transition-colors disabled:opacity-50",title:"Close position",children:a.jsx(Bs,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Entry"}),a.jsxs("p",{className:"font-semibold",children:["$",f.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current"}),a.jsxs("p",{className:"font-semibold",children:["$",p.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Realized P&L"}),a.jsxs("p",{className:`font-semibold ${d>=0?"text-green-400":"text-red-400"}`,children:["$",d.toFixed(2)]})]})]})]},h.id||`${h.symbol}-${h.entry_price}`)})})})]})}const Jh=[{label:"Trade",value:"trade"},{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"}];function Kh(){const{selectedAccount:i}=se(),[t,e]=_.useState("day"),{data:s,isLoading:n}=Rt(["performanceHistory",i==null?void 0:i.id,t],async()=>{console.log(" PerformanceChart: Fetching performance history for account:",i==null?void 0:i.id,"interval:",t);try{const h=await va.getPerformanceHistory({accountId:i==null?void 0:i.id,interval:t});return console.log(" PerformanceChart: Received data:",h),h.points&&h.points.length>0&&(console.log(` PerformanceChart [${t}]: First 5 data points:`),h.points.slice(0,5).forEach((c,u)=>{console.log(`  Point ${u+1}:`,{timestamp:c.timestamp,period_pnl:c.period_pnl,cumulative_pnl:c.cumulative_pnl,trade_count:c.trade_count})}),console.log(` PerformanceChart [${t}]: Last 5 data points:`),h.points.slice(-5).forEach((c,u)=>{console.log(`  Point ${h.points.length-4+u}:`,{timestamp:c.timestamp,period_pnl:c.period_pnl,cumulative_pnl:c.cumulative_pnl,trade_count:c.trade_count})})),h}catch(h){throw console.error(" PerformanceChart: Error fetching data:",h),h}},{enabled:!!i,staleTime:6e4,onError:h=>{console.error(" PerformanceChart: Query error:",h)}}),r=_.useMemo(()=>{var m;if(!(s!=null&&s.summary))return null;const h=(m=s.points)==null?void 0:m[s.points.length-1],c=(h==null?void 0:h.cumulative_pnl)??s.summary.total_pnl??0,u=(i==null?void 0:i.balance)??(i==null?void 0:i.equity),f=(u!=null&&!Number.isNaN(Number(u))?Number(u):void 0)??s.summary.end_balance??(s.summary.start_balance??0)+c,p=s.summary.start_balance??f-c;return{...s.summary,start_balance:p,end_balance:f}},[s,i]),o=_.useMemo(()=>{if(!(s!=null&&s.points))return[];const h=(r==null?void 0:r.start_balance)??0,c=new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric",hour:t==="trade"||t==="hour"?"2-digit":void 0,minute:t==="trade"||t==="hour"?"2-digit":void 0});return s.points.map(u=>({label:c.format(new Date(u.timestamp)),cumulative:u.cumulative_pnl,period:u.period_pnl,balance:h+u.cumulative_pnl,trades:u.trade_count}))},[s,t,r]),l=()=>{const h=i==null?void 0:i.id,c=new URLSearchParams;h&&c.append("account_id",h),c.append("interval",t);const u=`/api/performance/export${c.toString()?`?${c.toString()}`:""}`;window.open(u,"_blank")};return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Performance"}),a.jsxs("button",{onClick:l,className:"px-3 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2 text-sm",disabled:!i||!s,children:[a.jsx(Ca,{className:"w-4 h-4"}),"Export CSV"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Jh.map(h=>a.jsx("button",{onClick:()=>e(h.value),className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors ${t===h.value?"bg-primary-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:h.label},h.value))})]}),n?a.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400 text-sm",children:"Loading performance history..."}):o.length===0?a.jsx("div",{className:"h-64 flex items-center justify-center text-slate-500 text-sm",children:"No historical trades available for this period."}):a.jsx(ro,{width:"100%",height:320,children:a.jsxs(ao,{data:o,children:[a.jsx(oo,{strokeDasharray:"3 3",stroke:"#374151"}),a.jsx(lo,{dataKey:"label",stroke:"#9CA3AF",minTickGap:16}),a.jsx(nn,{stroke:"#9CA3AF",yAxisId:"left"}),a.jsx(nn,{stroke:"#9CA3AF",yAxisId:"right",orientation:"right"}),a.jsx(ho,{contentStyle:{backgroundColor:"#1E293B",border:"1px solid #334155",borderRadius:"8px"}}),a.jsx(co,{}),a.jsx(ii,{type:"monotone",dataKey:"cumulative",stroke:"#10B981",strokeWidth:2,yAxisId:"left",name:"Cumulative P&L",dot:!1}),a.jsx(ii,{type:"monotone",dataKey:"balance",stroke:"#3B82F6",strokeWidth:2,yAxisId:"right",name:"Balance",dot:!1}),a.jsx(ii,{type:"monotone",dataKey:"period",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"4 4",yAxisId:"left",name:"Period P&L",dot:!1})]})}),r&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm bg-slate-900/60 rounded-lg p-4 border border-slate-700/60",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Total P&L"}),a.jsxs("p",{className:`font-semibold ${r.total_pnl>=0?"text-green-400":"text-red-400"}`,children:[r.total_pnl>=0?"+":"","$",Math.abs(r.total_pnl).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Win Rate"}),a.jsxs("p",{className:"font-semibold",children:[r.win_rate.toFixed(2),"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Max Drawdown"}),a.jsxs("p",{className:"font-semibold",children:["-$",Math.abs(r.max_drawdown).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Trades"}),a.jsx("p",{className:"font-semibold",children:r.trade_count})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current Balance"}),a.jsxs("p",{className:"font-semibold",children:["$",Number(r.end_balance??0).toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}const oi=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}),Gh=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});function Zh(){const{selectedAccount:i}=se(),[t,e]=_.useState(20),[s,n]=ge("recentTrades",!0),{data:r,isLoading:o}=Rt(["trades",i==null?void 0:i.id,t],()=>_h.getTrades({accountId:i==null?void 0:i.id,limit:t,type:"filled"}),{enabled:!!i,staleTime:3e4}),l=(r==null?void 0:r.items)??[],h=_.useMemo(()=>r!=null&&r.summary?r.summary:null,[r]),c=()=>{const u=i==null?void 0:i.id,d=new URLSearchParams;u&&d.append("account_id",u);const f=`/api/trades/export${d.toString()?`?${d.toString()}`:""}`;window.open(f,"_blank")};return a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>n(u=>!u),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsx("div",{className:"flex items-center gap-3 text-left",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Recent Trades"}),a.jsx("p",{className:"text-xs text-slate-400",children:l.length>0?`${l.length} trades`:"No trades"})]})}),a.jsx("div",{className:"flex items-center gap-2",children:s?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})})]}),s&&a.jsxs("div",{className:"px-4 pb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("button",{onClick:c,className:"px-3 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2 text-sm",disabled:!i||l.length===0,children:[a.jsx(Ca,{className:"w-4 h-4"}),"Export CSV"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"text-xs text-slate-400 flex items-center gap-2",children:["Rows",a.jsx("select",{value:t,onChange:u=>e(Number(u.target.value)),className:"bg-slate-900 border border-slate-700 text-slate-200 text-xs px-2 py-1 rounded focus:outline-none focus:ring-1 focus:ring-primary-500",children:[20,50,100].map(u=>a.jsx("option",{value:u,children:u},u))})]}),h&&a.jsxs("div",{className:"flex flex-col items-end text-xs text-slate-400",children:[a.jsxs("div",{children:["Gross PnL (shown trades):"," ",a.jsxs("span",{className:h.gross_pnl>=0?"text-green-400 font-semibold":"text-red-400 font-semibold",children:[h.gross_pnl>=0?"+":"",oi.format(Math.abs(h.gross_pnl))]})]}),h.total_in_period&&h.displayed_count&&h.total_in_period>h.displayed_count&&a.jsxs("div",{className:"text-slate-500 mt-1",children:["Showing ",h.displayed_count," of ",h.total_in_period," total trades"]})]})]})]}),o?a.jsx("div",{className:"py-10 text-center text-slate-400 text-sm",children:"Loading trades..."}):l.length===0?a.jsx("div",{className:"py-10 text-center text-slate-500 text-sm",children:"No trades in this period."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"max-h-[48rem] overflow-y-auto pr-1",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"sticky top-0 bg-slate-800",children:a.jsxs("tr",{className:"text-slate-400 text-xs uppercase tracking-wide",children:[a.jsx("th",{className:"pb-3 text-left",children:"Time"}),a.jsx("th",{className:"pb-3 text-left",children:"Symbol"}),a.jsx("th",{className:"pb-3 text-left",children:"Side"}),a.jsx("th",{className:"pb-3 text-right",children:"Qty"}),a.jsx("th",{className:"pb-3 text-right",children:"Price"}),a.jsx("th",{className:"pb-3 text-right",children:"Net P&L"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-700/60",children:l.map(u=>{const d=u.net_pnl>=0?"text-green-400":"text-red-400";return a.jsxs("tr",{className:"hover:bg-slate-700/40 transition-colors",children:[a.jsx("td",{className:"py-2 text-slate-300",children:Gh.format(new Date(u.timestamp))}),a.jsx("td",{className:"py-2 font-semibold text-slate-100",children:u.symbol}),a.jsx("td",{className:`py-2 uppercase ${u.side==="BUY"?"text-green-300":"text-red-300"}`,children:u.side}),a.jsx("td",{className:"py-2 text-right text-slate-200",children:u.quantity}),a.jsx("td",{className:"py-2 text-right text-slate-200",children:u.price?oi.format(u.price):""}),a.jsxs("td",{className:`py-2 text-right font-semibold ${d}`,children:[u.net_pnl>=0?"+":"",oi.format(Math.abs(u.net_pnl))]})]},u.id)})})]})})})]})]})}const Xh=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2}),On=new Intl.NumberFormat(void 0,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:1}),re=i=>i==null||Number.isNaN(i)?"":Xh.format(i),Tn=i=>{if(!i)return"";try{return new Date(i).toLocaleString()}catch{return i}},Fn=(i,t)=>i||t>=1?"bg-red-500":t>=.8?"bg-amber-500":"bg-emerald-500",tc=i=>i?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30":"bg-red-500/20 text-red-200 border border-red-500/30",ec={info:"bg-slate-700 text-slate-200 border border-slate-600",warning:"bg-amber-500/20 text-amber-300 border border-amber-500/40",error:"bg-red-500/20 text-red-200 border border-red-500/40",success:"bg-emerald-500/20 text-emerald-200 border border-emerald-500/40"};function sc(){const{selectedAccount:i}=se(),t=i==null?void 0:i.id,e=Jt(),[s,n]=ge("riskDrawer",!0),{data:r,isLoading:o,error:l,refetch:h,isFetching:c}=Rt(["risk",t],()=>Sh.getRisk(t),{enabled:!!t,staleTime:3e4,refetchInterval:6e4,keepPreviousData:!0}),u=!!l,d=l instanceof Error?l.message:"Failed to load risk metrics.";_.useEffect(()=>{const b=g=>{g&&(t&&g.account_id&&String(g.account_id)!==String(t)||e.setQueryData(["risk",t],g))};return J.on("risk_update",b),()=>{J.off("risk_update",b)}},[t,e]);const f=_.useMemo(()=>{if(!r)return null;const b=r.dll.pct??(r.dll.limit?r.dll.used/r.dll.limit:0);return{pct:Math.min(1,Math.max(0,b||0)),limit:r.dll.limit,used:r.dll.used,remaining:r.dll.remaining,violated:r.dll.violated}},[r]),p=_.useMemo(()=>{if(!r)return null;const b=r.mll.pct??(r.mll.limit?r.mll.used/r.mll.limit:0);return{pct:Math.min(1,Math.max(0,b||0)),limit:r.mll.limit,used:r.mll.used,remaining:r.mll.remaining,violated:r.mll.violated}},[r]),m=(r==null?void 0:r.events)??[];return a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>n(b=>!b),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3 text-left",children:[r!=null&&r.compliance?a.jsx(Uh,{className:"w-5 h-5 text-emerald-400"}):a.jsx(Vh,{className:"w-5 h-5 text-red-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Risk Monitor"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[r!=null&&r.account_name?`${r.account_name}  `:"",r?Tn(r.timestamp):"Awaiting data"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx(le,{className:"w-4 h-4 animate-spin text-slate-400"}),s?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]})]}),s&&a.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[o&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[a.jsx(le,{className:"w-4 h-4 animate-spin"}),"Loading risk metrics..."]}),u&&a.jsxs("div",{className:"flex items-center justify-between gap-3 text-sm text-red-300 bg-red-500/10 border border-red-500/30 rounded-lg px-3 py-2",children:[a.jsx("span",{children:d}),a.jsx("button",{onClick:()=>h(),className:"text-xs font-semibold text-red-200 underline",children:"Retry"})]}),!o&&!u&&r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${tc(r.compliance)}`,children:r.compliance?"Compliant":"Non-Compliant"}),r.violations.length>0&&a.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-300",children:[a.jsx(_a,{className:"w-4 h-4"}),r.violations[0]]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Current Balance"}),a.jsx("p",{className:"font-semibold text-slate-100",children:re(r.balance)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Total PnL"}),a.jsx("p",{className:`font-semibold ${r.total_pnl>=0?"text-emerald-400":"text-red-400"}`,children:re(r.total_pnl)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Start Balance"}),a.jsx("p",{className:"font-semibold text-slate-100",children:re(r.start_balance)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Trailing Loss"}),a.jsx("p",{className:`font-semibold ${r.trailing_loss>0?"text-amber-300":"text-slate-200"}`,children:re(r.trailing_loss)})]})]}),f&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[a.jsx("span",{children:"Daily Loss Limit"}),a.jsxs("span",{children:[re(f.used)," / ",re(f.limit)]})]}),a.jsx("div",{className:"h-2 rounded bg-slate-700 overflow-hidden",children:a.jsx("div",{className:`h-full ${Fn(f.violated,f.pct)}`,style:{width:`${f.pct*100}%`}})}),a.jsx("p",{className:"text-xs text-slate-500",children:f.limit===null?"No daily loss limit configured":`Remaining: ${re(f.remaining)} (${On.format(1-f.pct)})`})]}),p&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[a.jsx("span",{children:"Maximum Loss Limit"}),a.jsxs("span",{children:[re(p.used)," / ",re(p.limit)]})]}),a.jsx("div",{className:"h-2 rounded bg-slate-700 overflow-hidden",children:a.jsx("div",{className:`h-full ${Fn(p.violated,p.pct)}`,style:{width:`${p.pct*100}%`}})}),a.jsx("p",{className:"text-xs text-slate-500",children:p.limit===null?"No maximum loss limit configured":`Remaining: ${re(p.remaining)} (${On.format(1-p.pct)})`})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 uppercase",children:[a.jsx(Ae,{className:"w-4 h-4 text-slate-300"}),"Recent Risk Events"]}),m.length===0?a.jsx("div",{className:"text-xs text-slate-500 bg-slate-900/60 border border-slate-700/60 rounded-lg px-3 py-2",children:"No recent risk events"}):a.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:m.map(b=>a.jsxs("div",{className:`px-3 py-2 rounded-lg text-xs ${ec[b.level]}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-semibold",children:b.message}),a.jsx("span",{className:"text-slate-300/80",children:Tn(b.timestamp)})]}),b.meta&&a.jsx("pre",{className:"text-xs text-slate-300/70 whitespace-pre-wrap",children:JSON.stringify(b.meta,null,2)})]},b.id))})]})]})]})]})}const ic=i=>{if(!i)return"";try{const t=new Date(i),s=new Date().getTime()-t.getTime(),n=Math.floor(s/6e4);return n<1?"Just now":n<60?`${n}m ago`:n<1440?`${Math.floor(n/60)}h ago`:t.toLocaleString()}catch{return i}},nc=i=>{switch(i){case"success":return a.jsx(Ae,{className:"w-4 h-4 text-emerald-400"});case"warning":return a.jsx(_a,{className:"w-4 h-4 text-amber-400"});case"error":return a.jsx(_e,{className:"w-4 h-4 text-red-400"});default:return a.jsx(Ma,{className:"w-4 h-4 text-blue-400"})}},rc=i=>{switch(i){case"success":return"bg-emerald-500/10 border-emerald-500/30 text-emerald-200";case"warning":return"bg-amber-500/10 border-amber-500/30 text-amber-200";case"error":return"bg-red-500/10 border-red-500/30 text-red-200";default:return"bg-blue-500/10 border-blue-500/30 text-blue-200"}};function ac(){const{selectedAccount:i}=se(),t=i==null?void 0:i.id,e=Jt(),[s,n]=_.useState(!0),[r,o]=_.useState(0),{data:l,isLoading:h,error:c}=Rt(["notifications",t],()=>jh.getNotifications(t),{enabled:!!t,staleTime:1e4,refetchInterval:3e4,keepPreviousData:!0});_.useEffect(()=>{const f=p=>{!p||!p.notification||t&&p.account_id&&String(p.account_id)!==String(t)||(e.invalidateQueries(["notifications",t]),s||o(m=>m+1))};return J.on("notification",f),()=>{J.off("notification",f)}},[t,e,s]),_.useEffect(()=>{s&&o(0)},[s]);const u=(l==null?void 0:l.notifications)||[],d=u.length>0;return a.jsxs("div",{className:"fixed right-4 top-20 z-40 w-80",children:[a.jsxs("button",{onClick:()=>n(!s),className:`w-full flex items-center justify-between px-4 py-2 rounded-t-lg border transition-colors ${s?"bg-slate-800 border-slate-600 text-slate-200":"bg-slate-700 hover:bg-slate-600 border-slate-500 text-slate-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Fh,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Notifications"}),r>0&&a.jsx("span",{className:"px-1.5 py-0.5 text-xs font-bold bg-red-500 text-white rounded-full min-w-[1.25rem] text-center",children:r})]}),s?a.jsx(te,{className:"w-4 h-4"}):a.jsx(Gt,{className:"w-4 h-4"})]}),s&&a.jsx("div",{className:"bg-slate-800 border-x border-b border-slate-600 rounded-b-lg shadow-xl max-h-[32rem] flex flex-col",children:h?a.jsx("div",{className:"p-4 text-center text-slate-400 text-sm",children:"Loading notifications..."}):c?a.jsx("div",{className:"p-4 text-center text-red-400 text-sm",children:"Failed to load notifications"}):d?a.jsx("div",{className:"overflow-y-auto flex-1",children:u.map(f=>a.jsx("div",{className:`p-3 border-b border-slate-700/50 ${rc(f.level)}`,children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:"mt-0.5",children:nc(f.level)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium",children:f.message}),f.meta&&a.jsxs("div",{className:"mt-1 text-xs text-slate-400",children:[f.meta.symbol&&a.jsxs("span",{className:"mr-2",children:["Symbol: ",f.meta.symbol]}),f.meta.side&&a.jsxs("span",{className:"mr-2",children:["Side: ",f.meta.side]}),f.meta.quantity&&a.jsxs("span",{children:["Qty: ",f.meta.quantity]})]}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:ic(f.timestamp)})]})]})},f.id))}):a.jsx("div",{className:"p-4 text-center text-slate-400 text-sm",children:"No notifications"})})]})}function oc(){const i=Jt(),{accounts:t,selectedAccount:e,setSelectedAccount:s}=se(),{status:n,reconnectAttempts:r,lastError:o,reconnect:l}=Rh();Sa();const h=e==null?void 0:e.id,{data:c}=Rt(["accountInfo",h],Wi.getAccountInfo,{enabled:!!h,staleTime:6e4,refetchOnWindowFocus:!1}),{data:u}=Rt(["metrics"],Nh.getMetrics,{refetchInterval:n==="connected"?!1:6e4,staleTime:3e4,refetchOnWindowFocus:!1}),d=(u==null?void 0:u.performance)||u;_.useEffect(()=>{let m=!0;const b=N=>{if(!m||!N)return;const M={id:N.account_id||N.accountId||N.id,name:N.account_name||N.name,status:N.status||"active",balance:Number(N.balance??0),currency:N.currency||"USD",account_type:N.account_type||"unknown",equity:Number(N.equity??N.balance??0),dailyPnL:Number(N.dailyPnL??N.daily_pnl??0),daily_pnl:Number(N.dailyPnL??N.daily_pnl??0)};M.id&&(i.setQueryData(["accountInfo",M.id],M),i.setQueryData(["accounts"],A=>A==null?void 0:A.map(B=>(B.id||B.accountId||B.account_id)===M.id?{...B,...M}:B)))},g=N=>{if(!m||!N)return;const M=N.performance||N;i.setQueryData(["metrics"],M)},S=N=>{!m||!N||h&&i.setQueryData(["positions",h],N)},j=N=>{!m||!N||Array.isArray(N)&&i.setQueryData(["accounts"],N)};return J.on("account_update",b),J.on("metrics_update",g),J.on("position_update",S),J.on("accounts_update",j),()=>{m=!1,J.off("account_update",b),J.off("metrics_update",g),J.off("position_update",S),J.off("accounts_update",j)}},[i,h]);const f=_.useMemo(()=>{switch(n){case"connected":return{label:"Connected",container:"bg-green-500/20 text-green-300",dot:"bg-green-400"};case"reconnecting":return{label:`Reconnecting (${r})`,container:"bg-amber-500/20 text-amber-200",dot:"bg-amber-300"};case"error":return{label:"Connection Error",container:"bg-red-500/20 text-red-300",dot:"bg-red-400"};default:return{label:"Disconnected",container:"bg-red-500/20 text-red-300",dot:"bg-red-400"}}},[n,r]),p=n==="error"||n==="disconnected";return a.jsxs("div",{className:"space-y-6",children:[a.jsx(ac,{}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),a.jsx("p",{className:"text-slate-400 mt-1",children:"Real-time trading overview"})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg ${f.container}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${f.dot}`}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium",children:f.label}),o&&a.jsx("span",{className:"text-xs text-red-200 truncate max-w-[200px]",children:o})]}),p&&a.jsx("button",{onClick:l,className:"ml-2 text-xs font-semibold text-primary-300 underline",children:"Retry"})]})})]}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ji,{accounts:t,selectedAccount:e,onAccountChange:s})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(_i,{to:"/strategies",className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors text-sm font-medium",children:[a.jsx(zs,{className:"w-4 h-4"}),"Manage Strategies",a.jsx(Rn,{className:"w-3 h-3"})]}),a.jsxs(_i,{to:"/positions",className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-sm font-medium",children:["View All Positions & Orders",a.jsx(Rn,{className:"w-3 h-3"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c&&a.jsx(Qh,{account:c,isSelected:!0}),a.jsx(Kh,{}),a.jsx(Hh,{})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(sc,{}),d&&a.jsx(Wh,{metrics:d}),a.jsx(Zh,{})]})]})]})}const lc="MNQ";function hc({onOrderPlaced:i}){const t=Jt(),{selectedAccount:e}=se(),[s,n]=_.useState(lc),[r,o]=_.useState("BUY"),[l,h]=_.useState("market"),[c,u]=_.useState("1"),[d,f]=_.useState(""),[p,m]=_.useState(""),[b,g]=_.useState(!1),[S,j]=_.useState(""),[N,M]=_.useState(""),[A,B]=_.useState(""),[F,it]=_.useState(""),[q,tt]=_.useState(!1),[gt,st]=_.useState(!1),[ot,nt]=_.useState("DAY"),[ft,z]=_.useState(null),[Y,v]=_.useState(null),O=e==null?void 0:e.id,U=wt(De.placeOrder,{onSuccess:()=>{v("Order submitted successfully"),z(null),t.invalidateQueries(["orders",O]),t.invalidateQueries(["positions",O]),i&&i()},onError:P=>{var et,rt;console.error("Failed to submit order",P);const kt=((rt=(et=P==null?void 0:P.response)==null?void 0:et.data)==null?void 0:rt.error)||(P==null?void 0:P.message)||"Failed to submit order";z(kt),v(null)}}),D=wt(P=>De.cancelAll(P),{onSuccess:()=>{t.invalidateQueries(["orders",O]),v("Cancelled all open orders"),z(null)},onError:P=>{var et,rt;const kt=((rt=(et=P==null?void 0:P.response)==null?void 0:et.data)==null?void 0:rt.error)||(P==null?void 0:P.message)||"Failed to cancel orders";z(kt),v(null)}}),lt=wt(Xt.flattenAll,{onSuccess:()=>{t.invalidateQueries(["positions",O]),t.invalidateQueries(["orders",O]),v("Flatten command sent"),z(null)},onError:P=>{var et,rt;const kt=((rt=(et=P==null?void 0:P.response)==null?void 0:et.data)==null?void 0:rt.error)||(P==null?void 0:P.message)||"Failed to flatten positions";z(kt),v(null)}}),Pt=()=>{f(""),m(""),j(""),M(""),B(""),it(""),g(!1),tt(!1),st(!1),nt("DAY")},yt=P=>{if(P.preventDefault(),!O){z("Select an account before placing orders"),v(null);return}if(!s.trim()){z("Symbol is required"),v(null);return}const kt=Number(c);if(!Number.isFinite(kt)||kt<=0){z("Quantity must be greater than 0"),v(null);return}const et={symbol:s,side:r,quantity:Math.floor(kt),order_type:l,account_id:O,time_in_force:ot,reduce_only:gt};if(l==="limit"){const rt=Number(d);if(!Number.isFinite(rt)||rt<=0){z("Limit price required for limit orders"),v(null);return}et.limit_price=rt}if(l==="stop"){const rt=Number(p);if(!Number.isFinite(rt)||rt<=0){z("Stop price required for stop orders"),v(null);return}et.stop_price=rt}if(b)if(l==="stop"){const rt=A?Number(A):void 0,Et=F?Number(F):void 0;if(!rt||!Et){z("Stop loss and take profit prices are required for stop-entry brackets"),v(null);return}et.stop_loss_price=rt,et.take_profit_price=Et,et.enable_bracket=!0,et.enable_breakeven=q}else{const rt=S?Number(S):void 0,Et=N?Number(N):void 0;if(!rt&&!Et){z("Provide stop-loss and/or take-profit ticks for bracket orders"),v(null);return}rt&&(et.stop_loss_ticks=Math.floor(rt)),Et&&(et.take_profit_ticks=Math.floor(Et)),et.enable_bracket=!0}U.mutate(et,{onSuccess:()=>{Pt()}})},At=U.isLoading,zt=!O,[ie,Bt]=ge("orderTicket",!0);return a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>Bt(P=>!P),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsx("div",{className:"flex items-center gap-3 text-left",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Quick Order Ticket"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Place discretionary trades directly from the dashboard"})]})}),ie?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),ie&&a.jsxs("div",{className:"px-4 pb-4",children:[ft&&a.jsxs("div",{className:"mb-4 flex items-center gap-2 rounded border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-300",children:[a.jsx(_e,{className:"h-4 w-4"}),a.jsx("span",{children:ft})]}),Y&&a.jsxs("div",{className:"mb-4 flex items-center gap-2 rounded border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-200",children:[a.jsx(Ae,{className:"h-4 w-4"}),a.jsx("span",{children:Y})]}),a.jsxs("form",{className:"space-y-5",onSubmit:yt,children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Symbol"}),a.jsx("input",{type:"text",value:s,onChange:P=>n(P.target.value.toUpperCase()),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"MNQ"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Quantity"}),a.jsx("input",{type:"number",min:1,value:c,onChange:P=>u(P.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Side"}),a.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>o("BUY"),className:`rounded px-3 py-2 text-sm font-semibold transition-colors ${r==="BUY"?"bg-emerald-500/30 text-emerald-200 ring-1 ring-emerald-400/60":"bg-slate-900 text-slate-300 hover:bg-slate-700/60"}`,children:"Buy"}),a.jsx("button",{type:"button",onClick:()=>o("SELL"),className:`rounded px-3 py-2 text-sm font-semibold transition-colors ${r==="SELL"?"bg-red-500/30 text-red-200 ring-1 ring-red-400/60":"bg-slate-900 text-slate-300 hover:bg-slate-700/60"}`,children:"Sell"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Order Type"}),a.jsxs("select",{value:l,onChange:P=>h(P.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",children:[a.jsx("option",{value:"market",children:"Market"}),a.jsx("option",{value:"limit",children:"Limit"}),a.jsx("option",{value:"stop",children:"Stop Entry"})]})]})]}),l==="limit"&&a.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Limit Price"}),a.jsx("input",{type:"number",value:d,onChange:P=>f(P.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Enter price"})]})}),l==="stop"&&a.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Price"}),a.jsx("input",{type:"number",value:p,onChange:P=>m(P.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Entry stop price"})]})}),a.jsxs("div",{className:"rounded border border-slate-700/60 bg-slate-900/40 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:b,onChange:P=>g(P.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Attach Bracket"]}),a.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Optional"})]}),b&&l!=="stop"&&a.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Loss (ticks)"}),a.jsx("input",{type:"number",value:S,onChange:P=>j(P.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"e.g. 40"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Take Profit (ticks)"}),a.jsx("input",{type:"number",value:N,onChange:P=>M(P.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"e.g. 80"})]})]}),b&&l==="stop"&&a.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Loss Price"}),a.jsx("input",{type:"number",value:A,onChange:P=>B(P.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Stop loss price"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Take Profit Price"}),a.jsx("input",{type:"number",value:F,onChange:P=>it(P.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Take profit price"})]}),a.jsx("div",{className:"flex items-center",children:a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:q,onChange:P=>tt(P.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Enable Breakeven"]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Time in Force"}),a.jsxs("select",{value:ot,onChange:P=>nt(P.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",children:[a.jsx("option",{value:"DAY",children:"DAY"}),a.jsx("option",{value:"GTC",children:"GTC"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:gt,onChange:P=>st(P.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Reduce-Only"]})})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:At||zt,className:"inline-flex items-center gap-2 rounded bg-primary-500 px-4 py-2 text-sm font-semibold text-slate-950 transition-colors hover:bg-primary-400 disabled:cursor-not-allowed disabled:bg-slate-600 disabled:text-slate-300",children:[At&&a.jsx(le,{className:"h-4 w-4 animate-spin"}),"Place Order"]}),a.jsxs("button",{type:"button",onClick:()=>D.mutate(O),disabled:D.isLoading||zt,className:"inline-flex items-center gap-2 rounded border border-slate-600 px-4 py-2 text-sm font-semibold text-slate-200 transition-colors hover:bg-slate-700 disabled:cursor-not-allowed disabled:text-slate-400",children:[D.isLoading&&a.jsx(le,{className:"h-4 w-4 animate-spin"}),"Cancel All Orders"]}),a.jsxs("button",{type:"button",onClick:()=>lt.mutate(),disabled:lt.isLoading||zt,className:"inline-flex items-center gap-2 rounded border border-red-600/60 px-4 py-2 text-sm font-semibold text-red-300 transition-colors hover:bg-red-500/10 disabled:cursor-not-allowed disabled:text-red-500/60",children:[lt.isLoading&&a.jsx(le,{className:"h-4 w-4 animate-spin"}),"Flatten Positions"]})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Tip: Brackets on market/limit orders use tick offsets. Stop entries require explicit pricing for the attached OCO legs."})]})]})]})}function dt(i){var t=i.width,e=i.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Ne(i,t){return i.width===t.width&&i.height===t.height}var cc=function(){function i(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return i.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(i.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),i.prototype.subscribe=function(t){var e=this,s={next:t};return this._observers.push(s),{unsubscribe:function(){e._observers=e._observers.filter(function(n){return n!==s})}}},i.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},i.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},i.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},i.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},i}();function uc(i){return new cc(i)}var dc=function(){function i(t,e,s){var n;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=dt({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(n=s==null?void 0:s.allowResizeObserver)!==null&&n!==void 0?n:!0,this._chooseAndInitObserver()}return i.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(i.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bitmapSize",{get:function(){return dt({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),i.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=dt(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},i.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},i.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(i.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),i.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},i.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},i.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},i.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Ne(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},i.prototype._emitBitmapSizeChanged=function(t,e){var s=this;this._bitmapSizeChangedListeners.forEach(function(n){return n.call(s,t,e)})},i.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,s=dt(this._transformBitmapSize(t,this._canvasElementClientSize)),n=Ne(this.bitmapSize,s)?null:s;e===null&&n===null||e!==null&&n!==null&&Ne(e,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(e,n))},i.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var s=this;this._suggestedBitmapSizeChangedListeners.forEach(function(n){return n.call(s,t,e)})},i.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}mc().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},i.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Ln(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=uc(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},i.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var s=Ln(this._canvasElement);if(s!==null){var n=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:s.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?pc(r[0],n):dt({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},i.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var s=e.find(function(o){return o.target===t._canvasElement});if(!(!s||!s.devicePixelContentBoxSize||!s.devicePixelContentBoxSize[0])){var n=s.devicePixelContentBoxSize[0],r=dt({width:n.inlineSize,height:n.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},i}();function fc(i,t){return new dc(i,t.transform,t.options)}function Ln(i){return i.ownerDocument.defaultView}function mc(){return new Promise(function(i){var t=new ResizeObserver(function(e){i(e.every(function(s){return"devicePixelContentBoxSize"in s})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function pc(i,t){return dt({width:Math.round(i.left*t+i.width*t)-Math.round(i.left*t),height:Math.round(i.top*t+i.height*t)-Math.round(i.top*t)})}var gc=function(){function i(t,e,s){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,s.width===0||s.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=s,this._context=t}return i.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},i.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(i.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),i}();function je(i,t){var e=i.canvasElementClientSize;if(e.width===0||e.height===0)return null;var s=i.bitmapSize;if(s.width===0||s.height===0)return null;var n=i.canvasElement.getContext("2d",t);return n===null?null:new gc(n,e,s)}/*!
 * @license
 * TradingView Lightweight Charts v5.0.9
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Pa={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Dn,Kt;function Ce(i,t){const e={0:[],1:[i.lineWidth,i.lineWidth],2:[2*i.lineWidth,2*i.lineWidth],3:[6*i.lineWidth,6*i.lineWidth],4:[i.lineWidth,4*i.lineWidth]}[t];i.setLineDash(e)}function ka(i,t,e,s){i.beginPath();const n=i.lineWidth%2?.5:0;i.moveTo(e,t+n),i.lineTo(s,t+n),i.stroke()}function Lt(i,t){if(!i)throw new Error("Assertion failed"+(t?": "+t:""))}function Yt(i){if(i===void 0)throw new Error("Value is undefined");return i}function C(i){if(i===null)throw new Error("Value is null");return i}function pe(i){return C(Yt(i))}(function(i){i[i.Simple=0]="Simple",i[i.WithSteps=1]="WithSteps",i[i.Curved=2]="Curved"})(Dn||(Dn={})),function(i){i[i.Solid=0]="Solid",i[i.Dotted=1]="Dotted",i[i.Dashed=2]="Dashed",i[i.LargeDashed=3]="LargeDashed",i[i.SparseDotted=4]="SparseDotted"}(Kt||(Kt={}));class Nt{constructor(){this.t=[]}i(t,e,s){const n={h:t,l:e,o:s===!0};this.t.push(n)}_(t){const e=this.t.findIndex(s=>t===s.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,s){const n=[...this.t];this.t=this.t.filter(r=>!r.o),n.forEach(r=>r.h(t,e,s))}v(){return this.t.length>0}m(){this.t=[]}}function Ht(i,...t){for(const e of t)for(const s in e)e[s]!==void 0&&Object.prototype.hasOwnProperty.call(e,s)&&!["__proto__","constructor","prototype"].includes(s)&&(typeof e[s]!="object"||i[s]===void 0||Array.isArray(e[s])?i[s]=e[s]:Ht(i[s],e[s]));return i}function Me(i){return typeof i=="number"&&isFinite(i)}function is(i){return typeof i=="number"&&i%1==0}function ds(i){return typeof i=="string"}function ps(i){return typeof i=="boolean"}function he(i){const t=i;if(!t||typeof t!="object")return t;let e,s,n;for(s in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(s)&&(n=t[s],e[s]=n&&typeof n=="object"?he(n):n);return e}function xc(i){return i!==null}function ns(i){return i===null?void 0:i}const Ea="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function rs(i,t,e){return t===void 0&&(t=Ea),`${e=e!==void 0?`${e} `:""}${i}px ${t}`}class bc{constructor(t){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",V:0,B:0,I:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.F(),s=this.W();return t.P===e&&t.T===s||(t.P=e,t.T=s,t.k=rs(e,s),t.A=2.5/12*e,t.V=t.A,t.B=e/12*t.C,t.I=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function li(i){return i<0?0:i>255?255:Math.round(i)||0}function An(i){return .199*i[0]+.687*i[1]+.114*i[2]}class vc{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const s=this.K(t),n=s[3];return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${e*n})`}X(t){const e=this.K(t);return{Z:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:An(e)>160?"black":"white"}}J(t){return An(this.K(t))}tt(t,e,s){const[n,r,o,l]=this.K(t),[h,c,u,d]=this.K(e),f=[li(n+s*(h-n)),li(r+s*(c-r)),li(o+s*(u-o)),(p=l+s*(d-l),p<=0||p>1?Math.min(Math.max(p,0),1):Math.round(1e4*p)/1e4)];var p;return`rgba(${f[0]}, ${f[1]}, ${f[2]}, ${f[3]})`}K(t){const e=this.q.get(t);if(e)return e;const s=function(o){const l=document.createElement("div");l.style.display="none",document.body.appendChild(l),l.style.color=o;const h=window.getComputedStyle(l).color;return document.body.removeChild(l),h}(t),n=s.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!n){if(this.Y.length)for(const o of this.Y){const l=o(t);if(l)return this.q.set(t,l),l}throw new Error(`Failed to parse color: ${t}`)}const r=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return this.q.set(t,r),r}}class yc{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,s){this.it.forEach(n=>{n.nt(t,e,s)})}}class xe{nt(t,e,s){t.useBitmapCoordinateSpace(n=>this.et(n,e,s))}}class wc extends xe{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.rt===null||this.rt.lt===null)return;const n=this.rt.lt,r=this.rt,o=Math.max(1,Math.floor(e))%2/2,l=h=>{t.beginPath();for(let c=n.to-1;c>=n.from;--c){const u=r.ot[c],d=Math.round(u._t*e)+o,f=u.ut*s,p=h*s+o;t.moveTo(d,f),t.arc(d,f,p,0,2*Math.PI)}t.fill()};r.ct>0&&(t.fillStyle=r.dt,l(r.ft+r.ct)),t.fillStyle=r.vt,l(r.ft)}}function Nc(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const Sc={from:0,to:1};class _c{constructor(t,e,s){this.Mt=new yc,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.Pt=s,this.Mt.st(this.bt)}yt(t){this.kt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}kt(){const t=this.Pt.Dt();t.length!==this.bt.length&&(this.St=t.map(Nc),this.bt=this.St.map(e=>{const s=new wc;return s.ht(e),s}),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.Pt.Bt(),s=this.Ct.It(),n=this.O.Et();this.kt(),e.forEach((r,o)=>{const l=this.St[o],h=r.At(s),c=r.zt();!t&&h!==null&&r.Vt()&&c!==null?(l.vt=h.Lt,l.ft=h.ft,l.ct=h.Ot,l.ot[0].gt=h.gt,l.ot[0].ut=r.Ft().Nt(h.gt,c.Wt),l.dt=h.Ht??this.O.Ut(l.ot[0].ut/r.Ft().$t()),l.ot[0].wt=s,l.ot[0]._t=n.qt(s),l.lt=Sc):l.lt=null})}}class jc extends xe{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.Yt===null)return;const r=this.Yt.jt.Vt,o=this.Yt.Kt.Vt;if(!r&&!o)return;const l=Math.round(this.Yt._t*s),h=Math.round(this.Yt.ut*n);t.lineCap="butt",r&&l>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*s),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,Ce(t,this.Yt.jt.Xt),function(c,u,d,f){c.beginPath();const p=c.lineWidth%2?.5:0;c.moveTo(u+p,d),c.lineTo(u+p,f),c.stroke()}(t,l,0,e.height)),o&&h>=0&&(t.lineWidth=Math.floor(this.Yt.Kt.ct*n),t.strokeStyle=this.Yt.Kt.R,t.fillStyle=this.Yt.Kt.R,Ce(t,this.Yt.Kt.Xt),ka(t,h,0,e.width))}}class Cc{constructor(t,e){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new jc(this.Zt),this.Jt=t,this.Pt=e}yt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.Pt.Qt().N().crosshair,s=this.Zt;if(e.mode===2)return s.Kt.Vt=!1,void(s.jt.Vt=!1);s.Kt.Vt=t&&this.Jt.ti(this.Pt),s.jt.Vt=t&&this.Jt.ii(),s.Kt.ct=e.horzLine.width,s.Kt.Xt=e.horzLine.style,s.Kt.R=e.horzLine.color,s.jt.ct=e.vertLine.width,s.jt.Xt=e.vertLine.style,s.jt.R=e.vertLine.color,s._t=this.Jt.si(),s.ut=this.Jt.ni()}}function Mc(i,t,e,s,n,r){i.fillRect(t+r,e,s-2*r,r),i.fillRect(t+r,e+n-r,s-2*r,r),i.fillRect(t,e,r,n),i.fillRect(t+s-r,e,r,n)}function Gs(i,t,e,s,n,r){i.save(),i.globalCompositeOperation="copy",i.fillStyle=r,i.fillRect(t,e,s,n),i.restore()}function In(i,t,e,s,n,r){i.beginPath(),i.roundRect?i.roundRect(t,e,s,n,r):(i.lineTo(t+s-r[1],e),r[1]!==0&&i.arcTo(t+s,e,t+s,e+r[1],r[1]),i.lineTo(t+s,e+n-r[2]),r[2]!==0&&i.arcTo(t+s,e+n,t+s-r[2],e+n,r[2]),i.lineTo(t+r[3],e+n),r[3]!==0&&i.arcTo(t,e+n,t,e+n-r[3],r[3]),i.lineTo(t,e+r[0]),r[0]!==0&&i.arcTo(t,e,t+r[0],e,r[0]))}function zn(i,t,e,s,n,r,o=0,l=[0,0,0,0],h=""){if(i.save(),!o||!h||h===r)return In(i,t,e,s,n,l),i.fillStyle=r,i.fill(),void i.restore();const c=o/2;var u;In(i,t+c,e+c,s-o,n-o,(u=-c,l.map(d=>d===0?d:d+u))),r!=="transparent"&&(i.fillStyle=r,i.fill()),h!=="transparent"&&(i.lineWidth=o,i.strokeStyle=h,i.closePath(),i.stroke()),i.restore()}function Ra(i,t,e,s,n,r,o){i.save(),i.globalCompositeOperation="copy";const l=i.createLinearGradient(0,0,0,n);l.addColorStop(0,r),l.addColorStop(1,o),i.fillStyle=l,i.fillRect(t,e,s,n),i.restore()}class Bn{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.P+t.A+t.V:0}nt(t,e,s,n){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const r=this.Yt.R,o=this.ei.Z,l=t.useBitmapCoordinateSpace(h=>{const c=h.context;c.font=e.k;const u=this.hi(h,e,s,n),d=u.ai;return u.li?zn(c,d.oi,d._i,d.ui,d.ci,o,d.di,[d.ft,0,0,d.ft],o):zn(c,d.fi,d._i,d.ui,d.ci,o,d.di,[0,d.ft,d.ft,0],o),this.Yt.pi&&(c.fillStyle=r,c.fillRect(d.fi,d.mi,d.wi-d.fi,d.gi)),this.Yt.Mi&&(c.fillStyle=e.D,c.fillRect(u.li?d.bi-d.di:0,d._i,d.di,d.Si-d._i)),u});t.useMediaCoordinateSpace(({context:h})=>{const c=l.xi;h.font=e.k,h.textAlign=l.li?"right":"left",h.textBaseline="middle",h.fillStyle=r,h.fillText(this.Yt.ri,c.Ci,(c._i+c.Si)/2+c.Pi)})}hi(t,e,s,n){const{context:r,bitmapSize:o,mediaSize:l,horizontalPixelRatio:h,verticalPixelRatio:c}=t,u=this.Yt.pi||!this.Yt.yi?e.C:0,d=this.Yt.ki?e.S:0,f=e.A+this.ei.Ti,p=e.V+this.ei.Ri,m=e.B,b=e.I,g=this.Yt.ri,S=e.P,j=s.Di(r,g),N=Math.ceil(s.Vi(r,g)),M=S+f+p,A=e.S+m+b+N+u,B=Math.max(1,Math.floor(c));let F=Math.round(M*c);F%2!=B%2&&(F+=1);const it=d>0?Math.max(1,Math.floor(d*h)):0,q=Math.round(A*h),tt=Math.round(u*h),gt=this.ei.Bi??this.ei.Ii,st=Math.round(gt*c)-Math.floor(.5*c),ot=Math.floor(st+B/2-F/2),nt=ot+F,ft=n==="right",z=ft?l.width-d:d,Y=ft?o.width-it:it;let v,O,U;return ft?(v=Y-q,O=Y-tt,U=z-u-m-d):(v=Y+q,O=Y+tt,U=z+u+m),{li:ft,ai:{_i:ot,mi:st,Si:nt,ui:q,ci:F,ft:2*h,di:it,oi:v,fi:Y,wi:O,gi:B,bi:o.width},xi:{_i:ot/c,Si:nt/c,Ci:U,Pi:j}}}}class Zs{constructor(t){this.Ei={Ii:0,Z:"#000",Ri:0,Ti:0},this.Ai={ri:"",Vt:!1,pi:!0,yi:!1,Ht:"",R:"#FFF",Mi:!1,ki:!1},this.zi={ri:"",Vt:!1,pi:!1,yi:!0,Ht:"",R:"#FFF",Mi:!0,ki:!0},this.xt=!0,this.Li=new(t||Bn)(this.Ai,this.Ei),this.Oi=new(t||Bn)(this.zi,this.Ei)}ri(){return this.Ni(),this.Ai.ri}Ii(){return this.Ni(),this.Ei.Ii}yt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Fi(){return this.Ei.Bi||0}Wi(t){this.Ei.Bi=t}Hi(){return this.Ni(),this.Ai.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ai.Vt}Tt(t){return this.Ni(),this.Ai.pi=this.Ai.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Oi}Ni(){this.xt&&(this.Ai.pi=!0,this.zi.pi=!1,this.qi(this.Ai,this.zi,this.Ei))}}class Pc extends Zs{constructor(t,e,s){super(),this.Jt=t,this.Yi=e,this.ji=s}qi(t,e,s){if(t.Vt=!1,this.Jt.N().mode===2)return;const n=this.Jt.N().horzLine;if(!n.labelVisible)return;const r=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||r===null)return;const o=this.Yi.Xi().X(n.labelBackgroundColor);s.Z=o.Z,t.R=o.G;const l=2/12*this.Yi.P();s.Ti=l,s.Ri=l;const h=this.ji(this.Yi);s.Ii=h.Ii,t.ri=this.Yi.Zi(h.gt,r),t.Vt=!0}}const kc=/[1-9]/g;class Oa{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const s=t.useMediaCoordinateSpace(({context:f})=>(f.font=e.k,Math.round(e.Gi.Vi(f,C(this.Yt).ri,kc))));if(s<=0)return;const n=e.Ji,r=s+2*n,o=r/2,l=this.Yt.Qi;let h=this.Yt.Ii,c=Math.floor(h-o)+.5;c<0?(h+=Math.abs(0-c),c=Math.floor(h-o)+.5):c+r>l&&(h-=Math.abs(l-(c+r)),c=Math.floor(h-o)+.5);const u=c+r,d=Math.ceil(0+e.S+e.C+e.A+e.P+e.V);t.useBitmapCoordinateSpace(({context:f,horizontalPixelRatio:p,verticalPixelRatio:m})=>{const b=C(this.Yt);f.fillStyle=b.Z;const g=Math.round(c*p),S=Math.round(0*m),j=Math.round(u*p),N=Math.round(d*m),M=Math.round(2*p);if(f.beginPath(),f.moveTo(g,S),f.lineTo(g,N-M),f.arcTo(g,N,g+M,N,M),f.lineTo(j-M,N),f.arcTo(j,N,j,N-M,M),f.lineTo(j,S),f.fill(),b.pi){const A=Math.round(b.Ii*p),B=S,F=Math.round((B+e.C)*m);f.fillStyle=b.R;const it=Math.max(1,Math.floor(p)),q=Math.floor(.5*p);f.fillRect(A-q,B,it,F-B)}}),t.useMediaCoordinateSpace(({context:f})=>{const p=C(this.Yt),m=0+e.S+e.C+e.A+e.P/2;f.font=e.k,f.textAlign="left",f.textBaseline="middle",f.fillStyle=p.R;const b=e.Gi.Di(f,"Apr0");f.translate(c+n,m+b),f.fillText(p.ri,0,0)})}}class Ec{constructor(t,e,s){this.xt=!0,this.Gt=new Oa,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Ii:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=s}yt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const t=this.Zt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const s=this.ts.Et();if(s.Ki())return;t.Qi=s.Qi();const n=this.ji();if(n===null)return;t.Ii=n.Ii;const r=s.ss(this.Ct.It());t.ri=s.ns(C(r)),t.Vt=!0;const o=this.ts.Xi().X(e.labelBackgroundColor);t.Z=o.Z,t.R=o.G,t.pi=s.N().ticksVisible}}class Ta{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Ft(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var $n;(function(i){i[i.Normal=0]="Normal",i[i.Magnet=1]="Magnet",i[i.Hidden=2]="Hidden",i[i.MagnetOHLC=3]="MagnetOHLC"})($n||($n={}));class Rc extends Ta{constructor(t,e){super(),this.Pt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=t,this.Ps=e,this.ys=((n,r)=>o=>{const l=r(),h=n();if(o===C(this.Pt).ks())return{gt:h,Ii:l};{const c=C(o.zt());return{gt:o.Ts(l,c),Ii:l}}})(()=>this.ds,()=>this.Ss);const s=((n,r)=>()=>{const o=this.ts.Et().Rs(n()),l=r();return o&&Number.isFinite(l)?{wt:o,Ii:l}:null})(()=>this.fs,()=>this.si());this.Ds=new Ec(this,t,s)}N(){return this.Ps}Vs(t,e){this.xs=t,this.Cs=e}Bs(){this.xs=NaN,this.Cs=NaN}Is(){return this.xs}Es(){return this.Cs}As(t,e,s){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,s)}It(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.Pt=null,this.Bs(),this.Ns()}Fs(t){let e=this.gs.get(t);e||(e=new Cc(this,t),this.gs.set(t,e));let s=this.Ms.get(t);return s||(s=new _c(this.ts,this,t),this.Ms.set(t,s)),[e,s]}ti(t){return t===this.Pt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ws(t,e){this.ps&&this.Pt===t||this.vs.clear();const s=[];return this.Pt===t&&s.push(this.Hs(this.vs,e,this.ys)),s}cs(){return this.ps?[this.Ds]:[]}Us(){return this.Pt}Ns(){this.ts.$s().forEach(t=>{var e,s;(e=this.gs.get(t))==null||e.yt(),(s=this.Ms.get(t))==null||s.yt()}),this.vs.forEach(t=>t.yt()),this.Ds.yt()}qs(t){return t&&!t.ks().Ki()?t.ks():null}zs(t,e,s){this.Ys(t,e,s)&&this.Ns()}Ys(t,e,s){const n=this.bs,r=this.Ss,o=this.ds,l=this.fs,h=this.Pt,c=this.qs(s);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.Et().qt(t),this.Pt=s;const u=c!==null?c.zt():null;return c!==null&&u!==null?(this.ds=e,this.Ss=c.Nt(e,u)):(this.ds=NaN,this.Ss=NaN),n!==this.bs||r!==this.Ss||l!==this.fs||o!==this.ds||h!==this.Pt}Os(){const t=this.ts.js().map(s=>s.Xs().Ks()).filter(xc),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,s){let n=t.get(e);return n===void 0&&(n=new Pc(this,e,s),t.set(e,n)),n}}function Xs(i){return i==="left"||i==="right"}class Tt{constructor(t){this.Zs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const s=function(n,r){return n===void 0?r:{tn:Math.max(n.tn,r.tn),sn:n.sn||r.sn}}(this.Zs.get(t),e);this.Zs.set(t,s)}nn(){return this.Js}en(t){const e=this.Zs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Wt:t}]}_n(t){this.un(),this.Gs.push({an:5,Wt:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Wt:t})}fn(t){this.hn(),this.Gs.push({an:3,Wt:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Zs.forEach((e,s)=>{this.Qs(s,e)})}static wn(){return new Tt(2)}static gn(){return new Tt(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Wt);break;case 2:this.dn(t.Wt);break;case 3:this.fn(t.Wt);break;case 4:this.cn();break;case 5:this._n(t.Wt);break;case 6:this.un()}}un(){const t=this.Gs.findIndex(e=>e.an===5);t!==-1&&this.Gs.splice(t,1)}}class Fa{formatTickmarks(t){return t.map(e=>this.format(e))}}const Vn=".";function ce(i,t){if(!Me(i))return"n/a";if(!is(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?i.toString():("0000000000000000"+i.toString()).slice(-t)}class ti extends Fa{constructor(t,e){if(super(),e||(e=1),Me(t)&&is(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"":"";return t=Math.abs(t),e+this.Sn(t)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.xn++}}Sn(t){const e=this.Yi/this.Mn;let s=Math.floor(t),n="";const r=this.xn!==void 0?this.xn:NaN;if(e>1){let o=+(Math.round(t*e)-s*e).toFixed(this.xn);o>=e&&(o-=e,s+=1),n=Vn+ce(+o.toFixed(this.xn)*this.Mn,r)}else s=Math.round(s*e)/e,r>0&&(n=Vn+ce(0,r));return s.toFixed(0)+n}}class La extends ti{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class Oc extends Fa{constructor(t){super(),this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.Pn(t):t<999995?e+this.Pn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Pn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Pn(t/1e9)+"B")}Pn(t){let e;const s=Math.pow(10,this.Cn);return e=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(n,r)=>r)}}const Tc=/[2-9]/g;class as{constructor(t=50){this.yn=0,this.kn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}Bn(){this.yn=0,this.Dn.clear(),this.kn=1,this.Tn=1,this.Rn={}}Vi(t,e,s){return this.In(t,e,s).width}Di(t,e,s){const n=this.In(t,e,s);return((n.actualBoundingBoxAscent||0)-(n.actualBoundingBoxDescent||0))/2}In(t,e,s){const n=s||Tc,r=String(e).replace(n,"0");if(this.Dn.has(r))return Yt(this.Dn.get(r)).En;if(this.yn===this.Vn){const l=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(l),this.Tn++,this.yn--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Dn.set(r,{En:o,An:this.kn}),this.Rn[this.kn]=r,this.yn++,this.kn++),o}}class Fc{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,s){this.zn=t,this.M=e,this.Ln=s}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class Da{constructor(t,e,s){this.Fn=t,this.On=new as(50),this.Wn=e,this.O=s,this.F=-1,this.Gt=new Fc(this.On)}Tt(){const t=this.O.Hn(this.Wn);if(t===null)return null;const e=t.Un(this.Wn)?t.$n():this.Wn.Ft();if(e===null)return null;const s=t.qn(e);if(s==="overlay")return null;const n=this.O.Yn();return n.P!==this.F&&(this.F=n.P,this.On.Bn()),this.Gt.Nn(this.Fn.$i(),n,s),this.Gt}}class Lc extends xe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var o;if(!((o=this.Yt)!=null&&o.Vt))return null;const{ut:s,ct:n,Kn:r}=this.Yt;return e>=s-n-7&&e<=s+n+7?{Xn:this.Yt,Kn:r}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.Yt===null||this.Yt.Vt===!1)return;const r=Math.round(this.Yt.ut*n);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*s),Ce(t,this.Yt.Xt),ka(t,r,0,e.width))}}class Ki{constructor(t){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new Lc,this.xt=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Zn)}yt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class Dc extends Ki{constructor(t){super(t)}te(){this.Zn.Vt=!1;const t=this.Jn.Ft(),e=t.ie().ie;if(e!==2&&e!==3)return;const s=this.Jn.N();if(!s.baseLineVisible||!this.Jn.Vt())return;const n=this.Jn.zt();n!==null&&(this.Zn.Vt=!0,this.Zn.ut=t.Nt(n.Wt,n.Wt),this.Zn.R=s.baseLineColor,this.Zn.ct=s.baseLineWidth,this.Zn.Xt=s.baseLineStyle)}}class Ac extends xe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){const n=this.Yt;if(n===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,l=Math.round(n.ne.x*e)+o,h=n.ne.y*s;t.fillStyle=n.ee,t.beginPath();const c=Math.max(2,1.5*n.re)*e;t.arc(l,h,c,0,2*Math.PI,!1),t.fill(),t.fillStyle=n.he,t.beginPath(),t.arc(l,h,n.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=n.ae,t.beginPath(),t.arc(l,h,n.ft*e+r/2,0,2*Math.PI,!1),t.stroke()}}const Ic=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class zc{constructor(t){this.Gt=new Ac,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.yt()}be(){if(this.yt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}yt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().Et(),e=t.Pe(),s=this.ge.zt();if(e===null||s===null)return;const n=this.ge.ye(!0);if(n.ke||!e.Te(n.Re))return;const r={x:t.qt(n.Re),y:this.ge.Ft().Nt(n.gt,s.Wt)},o=n.R,l=this.ge.N().lineWidth,h=this.De(this.Ve(),o);this.Gt.ht({ee:o,re:l,he:h.he,ae:h.ae,ft:h.ft,ne:r})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Be(t,e,s,n){const r=s+(n-s)*e;return this.ge.Qt().Xi().j(t,r)}De(t,e){const s=t%2600/2600;let n;for(const c of Ic)if(s>=c.le&&s<=c.oe){n=c;break}Lt(n!==void 0,"Last price animation internal logic error");const r=(s-n.le)/(n.oe-n.le);return{he:this.Be(e,r,n.ce,n.de),ae:this.Be(e,r,n.fe,n.pe),ft:(o=r,l=n._e,h=n.ue,l+(h-l)*o)};var o,l,h}}class Bc extends Ki{constructor(t){super(t)}te(){const t=this.Zn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const s=this.Jn.ye(e.priceLineSource===0);s.ke||(t.Vt=!0,t.ut=s.Ii,t.R=this.Jn.Ie(s.R),t.ct=e.priceLineWidth,t.Xt=e.priceLineStyle)}}class $c extends Zs{constructor(t){super(),this.Jt=t}qi(t,e,s){t.Vt=!1,e.Vt=!1;const n=this.Jt;if(!n.Vt())return;const r=n.N(),o=r.lastValueVisible,l=n.Ee()!=="",h=r.seriesLastValueMode===0,c=n.ye(!1);if(c.ke)return;o&&(t.ri=this.Ae(c,o,h),t.Vt=t.ri.length!==0),(l||h)&&(e.ri=this.ze(c,o,l,h),e.Vt=e.ri.length>0);const u=n.Ie(c.R),d=this.Jt.Qt().Xi().X(u);s.Z=d.Z,s.Ii=c.Ii,e.Ht=n.Qt().Ut(c.Ii/n.Ft().$t()),t.Ht=u,t.R=d.G,e.R=d.G}ze(t,e,s,n){let r="";const o=this.Jt.Ee();return s&&o.length!==0&&(r+=`${o} `),e&&n&&(r+=this.Jt.Ft().Le()?t.Oe:t.Ne),r.trim()}Ae(t,e,s){return e?s?this.Jt.Ft().Le()?t.Ne:t.Oe:t.ri:""}}function Un(i,t,e,s){const n=Number.isFinite(t),r=Number.isFinite(e);return n&&r?i(t,e):n||r?n?t:e:s}class It{constructor(t,e){this.Fe=t,this.We=e}He(t){return t!==null&&this.Fe===t.Fe&&this.We===t.We}Ue(){return new It(this.Fe,this.We)}$e(){return this.Fe}qe(){return this.We}Ye(){return this.We-this.Fe}Ki(){return this.We===this.Fe||Number.isNaN(this.We)||Number.isNaN(this.Fe)}vn(t){return t===null?this:new It(Un(Math.min,this.$e(),t.$e(),-1/0),Un(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!Me(t)||this.We-this.Fe===0)return;const e=.5*(this.We+this.Fe);let s=this.We-e,n=this.Fe-e;s*=t,n*=t,this.We=e+s,this.Fe=e+n}Ke(t){Me(t)&&(this.We+=t,this.Fe+=t)}Xe(){return{minValue:this.Fe,maxValue:this.We}}static Ze(t){return t===null?null:new It(t.minValue,t.maxValue)}}class $s{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(t){return t===null?null:new $s(It.Ze(t.priceRange),t.margins)}}class Vc extends Ki{constructor(t,e){super(t),this.ir=e}te(){const t=this.Zn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const s=this.ir.sr();s!==null&&(t.Vt=!0,t.ut=s,t.R=e.color,t.ct=e.lineWidth,t.Xt=e.lineStyle,t.Kn=this.ir.N().id)}}class Uc extends Zs{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,s){t.Vt=!1,e.Vt=!1;const n=this.ir.N(),r=n.axisLabelVisible,o=n.title!=="",l=this.ge;if(!r||!l.Vt())return;const h=this.ir.sr();if(h===null)return;o&&(e.ri=n.title,e.Vt=!0),e.Ht=l.Qt().Ut(h/l.Ft().$t()),t.ri=this.nr(n.price),t.Vt=!0;const c=this.ge.Qt().Xi().X(n.axisLabelColor||n.color);s.Z=c.Z;const u=n.axisLabelTextColor||c.G;t.R=u,e.R=u,s.Ii=h}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Ft().Zi(t,e.Wt)}}class qc{constructor(t,e){this.ge=t,this.Ps=e,this.er=new Vc(t,this),this.Fn=new Uc(t,this),this.rr=new Da(this.Fn,t,t.Qt())}hr(t){Ht(this.Ps,t),this.yt(),this.ge.Qt().ar()}N(){return this.Ps}lr(){return this.er}_r(){return this.rr}ur(){return this.Fn}yt(){this.er.yt(),this.Fn.yt()}sr(){const t=this.ge,e=t.Ft();if(t.Qt().Et().Ki()||e.Ki())return null;const s=t.zt();return s===null?null:e.Nt(this.Ps.price,s.Wt)}}class Yc extends Ta{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const Qc={Bar:(i,t,e,s)=>{const n=t.upColor,r=t.downColor,o=C(i(e,s)),l=pe(o.Wt[0])<=pe(o.Wt[3]);return{cr:o.R??(l?n:r)}},Candlestick:(i,t,e,s)=>{const n=t.upColor,r=t.downColor,o=t.borderUpColor,l=t.borderDownColor,h=t.wickUpColor,c=t.wickDownColor,u=C(i(e,s)),d=pe(u.Wt[0])<=pe(u.Wt[3]);return{cr:u.R??(d?n:r),dr:u.Ht??(d?o:l),pr:u.vr??(d?h:c)}},Custom:(i,t,e,s)=>({cr:C(i(e,s)).R??t.color}),Area:(i,t,e,s)=>{const n=C(i(e,s));return{cr:n.vt??t.lineColor,vt:n.vt??t.lineColor,mr:n.mr??t.topColor,wr:n.wr??t.bottomColor}},Baseline:(i,t,e,s)=>{const n=C(i(e,s));return{cr:n.Wt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:n.gr??t.topLineColor,Mr:n.Mr??t.bottomLineColor,br:n.br??t.topFillColor1,Sr:n.Sr??t.topFillColor2,Cr:n.Cr??t.bottomFillColor1,Pr:n.Pr??t.bottomFillColor2}},Line:(i,t,e,s)=>{const n=C(i(e,s));return{cr:n.R??t.color,vt:n.R??t.color}},Histogram:(i,t,e,s)=>({cr:C(i(e,s)).R??t.color})};class Wc{constructor(t){this.yr=(e,s)=>s!==void 0?s.Wt:this.ge.Xs().kr(e),this.ge=t,this.Tr=Qc[t.Rr()]}Dr(t,e){return this.Tr(this.yr,this.ge.N(),t,e)}}function Aa(i,t,e,s,n=0,r=t.length){let o=r-n;for(;0<o;){const l=o>>1,h=n+l;s(t[h],e)===i?(n=h+1,o-=l+1):o=l}return n}const $e=Aa.bind(null,!0),Ia=Aa.bind(null,!1);var qn;(function(i){i[i.NearestLeft=-1]="NearestLeft",i[i.None=0]="None",i[i.NearestRight=1]="NearestRight"})(qn||(qn={}));const fe=30;class Hc{constructor(){this.Vr=[],this.Br=new Map,this.Ir=new Map,this.Er=[]}Ar(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}kr(t){return this.Fr(t)}Fr(t,e=0){const s=this.Nr(t,e);return s===null?null:{...this.Wr(s),Re:this.Or(s)}}Hr(){return this.Vr}Ur(t,e,s){if(this.Ki())return null;let n=null;for(const r of s)n=gs(n,this.$r(t,e,r));return n}ht(t){this.Ir.clear(),this.Br.clear(),this.Vr=t,this.Er=t.map(e=>e.Re)}qr(){return this.Er}Or(t){return this.Vr[t].Re}Wr(t){return this.Vr[t]}Nr(t,e){const s=this.Yr(t);if(s===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Kr(t);default:throw new TypeError("Unknown search mode")}return s}jr(t){let e=this.Xr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Kr(t){const e=this.Zr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Xr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Xr(t){return $e(this.Vr,t,(e,s)=>e.Re<s)}Zr(t){return Ia(this.Vr,t,(e,s)=>e.Re>s)}Gr(t,e,s){let n=null;for(let r=t;r<e;r++){const o=this.Vr[r].Wt[s];Number.isNaN(o)||(n===null?n={Jr:o,Qr:o}:(o<n.Jr&&(n.Jr=o),o>n.Qr&&(n.Qr=o)))}return n}$r(t,e,s){if(this.Ki())return null;let n=null;const r=C(this.Lr()),o=C(this.Ks()),l=Math.max(t,r),h=Math.min(e,o),c=Math.ceil(l/fe)*fe,u=Math.max(c,Math.floor(h/fe)*fe);{const f=this.Xr(l),p=this.Zr(Math.min(h,c,e));n=gs(n,this.Gr(f,p,s))}let d=this.Br.get(s);d===void 0&&(d=new Map,this.Br.set(s,d));for(let f=Math.max(c+1,l);f<u;f+=fe){const p=Math.floor(f/fe);let m=d.get(p);if(m===void 0){const b=this.Xr(p*fe),g=this.Zr((p+1)*fe-1);m=this.Gr(b,g,s),d.set(p,m)}n=gs(n,m)}{const f=this.Xr(u),p=this.Zr(h);n=gs(n,this.Gr(f,p,s))}return n}}function gs(i,t){return i===null?t:t===null?i:{Jr:Math.min(i.Jr,t.Jr),Qr:Math.max(i.Qr,t.Qr)}}const Vs={setLineStyle:Ce};class Jc{constructor(t){this.th=t}nt(t,e,s){this.th.draw(t,Vs)}ih(t,e,s){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t,Vs)}}class Kc{constructor(t){this.Dn=null,this.sh=t}Tt(){var s;const t=this.sh.renderer();if(t===null)return null;if(((s=this.Dn)==null?void 0:s.nh)===t)return this.Dn.eh;const e=new Jc(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class za{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Fs(){var s,n,r;const t=((n=(s=this.ah).paneViews)==null?void 0:n.call(s))??[];if(((r=this.hh)==null?void 0:r.nh)===t)return this.hh.eh;const e=t.map(o=>new Kc(o));return this.hh={nh:t,eh:e},e}jn(t,e){var s,n;return((n=(s=this.ah).hitTest)==null?void 0:n.call(s,t,e))??null}}let Gc=class extends za{us(){return[]}};class Zc{constructor(t){this.th=t}nt(t,e,s){this.th.draw(t,Vs)}ih(t,e,s){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t,Vs)}}class Yn{constructor(t){this.Dn=null,this.sh=t}Tt(){var s;const t=this.sh.renderer();if(t===null)return null;if(((s=this.Dn)==null?void 0:s.nh)===t)return this.Dn.eh;const e=new Zc(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function Ba(i){var t,e,s;return{ri:i.text(),Ii:i.coordinate(),Bi:(t=i.fixedCoordinate)==null?void 0:t.call(i),R:i.textColor(),Z:i.backColor(),Vt:((e=i.visible)==null?void 0:e.call(i))??!0,pi:((s=i.tickVisible)==null?void 0:s.call(i))??!0}}class Xc{constructor(t,e){this.Gt=new Oa,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Ba(this._h)}),this.Gt}}class tu extends Zs{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,s){const n=Ba(this._h);s.Z=n.Z,t.R=n.R;const r=2/12*this.Yi.P();s.Ti=r,s.Ri=r,s.Ii=n.Ii,s.Bi=n.Bi,t.ri=n.ri,t.Vt=n.Vt,t.pi=n.pi}}class eu extends za{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var n,r,o;const t=((r=(n=this.ah).timeAxisViews)==null?void 0:r.call(n))??[];if(((o=this.dh)==null?void 0:o.nh)===t)return this.dh.eh;const e=this.ge.Qt().Et(),s=t.map(l=>new Xc(l,e));return this.dh={nh:t,eh:s},s}Ws(){var n,r,o;const t=((r=(n=this.ah).priceAxisViews)==null?void 0:r.call(n))??[];if(((o=this.fh)==null?void 0:o.nh)===t)return this.fh.eh;const e=this.ge.Ft(),s=t.map(l=>new tu(l,e));return this.fh={nh:t,eh:s},s}wh(){var s,n,r;const t=((n=(s=this.ah).priceAxisPaneViews)==null?void 0:n.call(s))??[];if(((r=this.ph)==null?void 0:r.nh)===t)return this.ph.eh;const e=t.map(o=>new Yn(o));return this.ph={nh:t,eh:e},e}gh(){var s,n,r;const t=((n=(s=this.ah).timeAxisPaneViews)==null?void 0:n.call(s))??[];if(((r=this.mh)==null?void 0:r.nh)===t)return this.mh.eh;const e=t.map(o=>new Yn(o));return this.mh={nh:t,eh:e},e}Mh(t,e){var s,n;return((n=(s=this.ah).autoscaleInfo)==null?void 0:n.call(s,t,e))??null}}function hi(i,t,e,s){i.forEach(n=>{t(n).forEach(r=>{r.rh()===e&&s.push(r)})})}function ci(i){return i.Fs()}function su(i){return i.wh()}function iu(i){return i.gh()}const nu=["Area","Line","Baseline"];class ei extends Yc{constructor(t,e,s,n,r){super(t),this.Yt=new Hc,this.er=new Bc(this),this.bh=[],this.Sh=new Dc(this),this.xh=null,this.Ch=null,this.Ph=null,this.yh=[],this.Ps=s,this.kh=e;const o=new $c(this);this.vs=[o],this.rr=new Da(o,this,t),nu.includes(this.kh)&&(this.xh=new zc(this)),this.Th(),this.sh=n(this,this.Qt(),r)}m(){this.Ph!==null&&clearTimeout(this.Ph)}Ie(t){return this.Ps.priceLineColor||t}ye(t){const e={ke:!0},s=this.Ft();if(this.Qt().Et().Ki()||s.Ki()||this.Yt.Ki())return e;const n=this.Qt().Et().Pe(),r=this.zt();if(n===null||r===null)return e;let o,l;if(t){const d=this.Yt.Ar();if(d===null)return e;o=d,l=d.Re}else{const d=this.Yt.Fr(n.bi(),-1);if(d===null||(o=this.Yt.kr(d.Re),o===null))return e;l=d.Re}const h=o.Wt[3],c=this.Rh().Dr(l,{Wt:o}),u=s.Nt(h,r.Wt);return{ke:!1,gt:h,ri:s.Zi(h,r.Wt),Oe:s.Dh(h),Ne:s.Vh(h,r.Wt),R:c.cr,Ii:u,Re:l}}Rh(){return this.Ch!==null||(this.Ch=new Wc(this)),this.Ch}N(){return this.Ps}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.Ps.priceScaleId&&this.Qt().Bh(this,e),Ht(this.Ps,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Ih()),this.Qt().Eh(this),this.Qt().Ah(),this.sh.yt("options")}ht(t,e){this.Yt.ht(t),this.sh.yt("data"),this.xh!==null&&(e&&e.zh?this.xh.be():t.length===0&&this.xh.Me());const s=this.Qt().Hn(this);this.Qt().Lh(s),this.Qt().Eh(this),this.Qt().Ah(),this.Qt().ar()}Oh(t){const e=new qc(this,t);return this.bh.push(e),this.Qt().Eh(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Eh(this)}Fh(){return this.bh}Rr(){return this.kh}zt(){const t=this.Wh();return t===null?null:{Wt:t.Wt[3],Hh:t.wt}}Wh(){const t=this.Qt().Et().Pe();if(t===null)return null;const e=t.Uh();return this.Yt.Fr(e,1)}Xs(){return this.Yt}$h(t){const e=this.Yt.kr(t);return e===null?null:this.kh==="Bar"||this.kh==="Candlestick"||this.kh==="Custom"?{qh:e.Wt[0],Yh:e.Wt[1],jh:e.Wt[2],Kh:e.Wt[3]}:e.Wt[3]}Xh(t){const e=[];hi(this.yh,ci,"top",e);const s=this.xh;return s!==null&&s.Vt()&&(this.Ph===null&&s.xe()&&(this.Ph=setTimeout(()=>{this.Ph=null,this.Qt().Zh()},0)),s.Se(),e.unshift(s)),e}Fs(){const t=[];this.Gh()||t.push(this.Sh),t.push(this.sh,this.er);const e=this.bh.map(s=>s.lr());return t.push(...e),hi(this.yh,ci,"normal",t),t}Jh(){return this.Qh(ci,"bottom")}ta(t){return this.Qh(su,t)}ia(t){return this.Qh(iu,t)}sa(t,e){return this.yh.map(s=>s.jn(t,e)).filter(s=>s!==null)}us(){return[this.rr,...this.bh.map(t=>t._r())]}Ws(t,e){if(e!==this.es&&!this.Gh())return[];const s=[...this.vs];for(const n of this.bh)s.push(n.ur());return this.yh.forEach(n=>{s.push(...n.Ws())}),s}cs(){const t=[];return this.yh.forEach(e=>{t.push(...e.cs())}),t}Mh(t,e){if(this.Ps.autoscaleInfoProvider!==void 0){const s=this.Ps.autoscaleInfoProvider(()=>{const n=this.na(t,e);return n===null?null:n.Xe()});return $s.Ze(s)}return this.na(t,e)}nh(){const t=this.Ps.priceFormat;return t.base??1/t.minMove}ea(){return this.ra}Ns(){var t;this.sh.yt();for(const e of this.vs)e.yt();for(const e of this.bh)e.yt();this.er.yt(),this.Sh.yt(),(t=this.xh)==null||t.yt(),this.yh.forEach(e=>e.Ns())}Ft(){return C(super.Ft())}At(t){if(!((this.kh==="Line"||this.kh==="Area"||this.kh==="Baseline")&&this.Ps.crosshairMarkerVisible))return null;const e=this.Yt.kr(t);return e===null?null:{gt:e.Wt[3],ft:this.ha(),Ht:this.aa(),Ot:this.la(),Lt:this.oa(t)}}Ee(){return this.Ps.title}Vt(){return this.Ps.visible}_a(t){this.yh.push(new eu(t,this))}ua(t){this.yh=this.yh.filter(e=>e.oh()!==t)}ca(){if(this.kh==="Custom")return t=>this.sh.da(t)}fa(){if(this.kh==="Custom")return t=>this.sh.pa(t)}va(){return this.Yt.qr()}Gh(){return!Xs(this.Ft().ma())}na(t,e){if(!is(t)||!is(e)||this.Yt.Ki())return null;const s=this.kh==="Line"||this.kh==="Area"||this.kh==="Baseline"||this.kh==="Histogram"?[3]:[2,1],n=this.Yt.Ur(t,e,s);let r=n!==null?new It(n.Jr,n.Qr):null,o=null;if(this.Rr()==="Histogram"){const l=this.Ps.base,h=new It(l,l);r=r!==null?r.vn(h):h}return this.yh.forEach(l=>{const h=l.Mh(t,e);if(h!=null&&h.priceRange){const c=new It(h.priceRange.minValue,h.priceRange.maxValue);r=r!==null?r.vn(c):c}h!=null&&h.margins&&(o=h.margins)}),new $s(r,o)}ha(){switch(this.kh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}aa(){switch(this.kh){case"Line":case"Area":case"Baseline":{const t=this.Ps.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}la(){switch(this.kh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}oa(t){switch(this.kh){case"Line":case"Area":case"Baseline":{const e=this.Ps.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.Ps.priceFormat.type){case"custom":{const t=this.Ps.priceFormat.formatter;this.ra={format:t,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(e=>e.map(t))};break}case"volume":this.ra=new Oc(this.Ps.priceFormat.precision);break;case"percent":this.ra=new La(this.Ps.priceFormat.precision);break;default:{const t=Math.pow(10,this.Ps.priceFormat.precision);this.ra=new ti(t,this.Ps.priceFormat.minMove*t)}}this.es!==null&&this.es.wa()}Qh(t,e){const s=[];return hi(this.yh,t,e,s),s}}const ru=[3],au=[0,1,2,3];class ou{constructor(t){this.Ps=t}ga(t,e,s){let n=t;if(this.Ps.mode===0)return n;const r=s.ks(),o=r.zt();if(o===null)return n;const l=r.Nt(t,o),h=s.Ma().filter(u=>u instanceof ei).reduce((u,d)=>{if(s.Un(d)||!d.Vt())return u;const f=d.Ft(),p=d.Xs();if(f.Ki()||!p.Te(e))return u;const m=p.kr(e);if(m===null)return u;const b=pe(d.zt()),g=this.Ps.mode===3?au:ru;return u.concat(g.map(S=>f.Nt(m.Wt[S],b.Wt)))},[]);if(h.length===0)return n;h.sort((u,d)=>Math.abs(u-l)-Math.abs(d-l));const c=h[0];return n=r.Ts(c,o),n}}function Ze(i,t,e){return Math.min(Math.max(i,t),e)}function xs(i,t,e){return t-i<=e}function Gi(i){const t=Math.ceil(i);return t%2==0?t-1:t}class lu extends xe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.Yt===null)return;const r=Math.max(1,Math.floor(s));t.lineWidth=r,function(o,l){o.save(),o.lineWidth%2&&o.translate(.5,.5),l(),o.restore()}(t,()=>{const o=C(this.Yt);if(o.ba){t.strokeStyle=o.Sa,Ce(t,o.xa),t.beginPath();for(const l of o.Ca){const h=Math.round(l.Pa*s);t.moveTo(h,-r),t.lineTo(h,e.height+r)}t.stroke()}if(o.ya){t.strokeStyle=o.ka,Ce(t,o.Ta),t.beginPath();for(const l of o.Ra){const h=Math.round(l.Pa*n);t.moveTo(-r,h),t.lineTo(e.width+r,h)}t.stroke()}})}}class hu{constructor(t){this.Gt=new lu,this.xt=!0,this.Pt=t}yt(){this.xt=!0}Tt(){if(this.xt){const t=this.Pt.Qt().N().grid,e={ya:t.horzLines.visible,ba:t.vertLines.visible,ka:t.horzLines.color,Sa:t.vertLines.color,Ta:t.horzLines.style,xa:t.vertLines.style,Ra:this.Pt.ks().Da(),Ca:(this.Pt.Qt().Et().Da()||[]).map(s=>({Pa:s.coord}))};this.Gt.ht(e),this.xt=!1}return this.Gt}}class cu{constructor(t){this.sh=new hu(t)}lr(){return this.sh}}const ui={Va:4,Ba:1e-4};function Fe(i,t){const e=100*(i-t)/t;return t<0?-e:e}function uu(i,t){const e=Fe(i.$e(),t),s=Fe(i.qe(),t);return new It(e,s)}function Xe(i,t){const e=100*(i-t)/t+100;return t<0?-e:e}function du(i,t){const e=Xe(i.$e(),t),s=Xe(i.qe(),t);return new It(e,s)}function Us(i,t){const e=Math.abs(i);if(e<1e-15)return 0;const s=Math.log10(e+t.Ba)+t.Va;return i<0?-s:s}function ts(i,t){const e=Math.abs(i);if(e<1e-15)return 0;const s=Math.pow(10,e-t.Va)-t.Ba;return i<0?-s:s}function Je(i,t){if(i===null)return null;const e=Us(i.$e(),t),s=Us(i.qe(),t);return new It(e,s)}function Le(i,t){if(i===null)return null;const e=ts(i.$e(),t),s=ts(i.qe(),t);return new It(e,s)}function di(i){if(i===null)return ui;const t=Math.abs(i.qe()-i.$e());if(t>=1||t<1e-15)return ui;const e=Math.ceil(Math.abs(Math.log10(t))),s=ui.Va+e;return{Va:s,Ba:1/Math.pow(10,s)}}class fi{constructor(t,e){if(this.Ia=t,this.Ea=e,function(s){if(s<0)return!1;if(s>1e18)return!0;for(let n=s;n>1;n/=10)if(n%10!=0)return!1;return!0}(this.Ia))this.Aa=[2,2.5,2];else{this.Aa=[];for(let s=this.Ia;s!==1;){if(s%2==0)this.Aa.push(2),s/=2;else{if(s%5!=0)throw new Error("unexpected base");this.Aa.push(2,2.5),s/=5}if(this.Aa.length>100)throw new Error("something wrong with base")}}}za(t,e,s){const n=this.Ia===0?0:1/this.Ia;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,l=this.Ea[0];for(;;){const d=xs(r,n,1e-14)&&r>n+1e-14,f=xs(r,s*l,1e-14),p=xs(r,1,1e-14);if(!(d&&f&&p))break;r/=l,l=this.Ea[++o%this.Ea.length]}if(r<=n+1e-14&&(r=n),r=Math.max(1,r),this.Aa.length>0&&(h=r,c=1,u=1e-14,Math.abs(h-c)<u))for(o=0,l=this.Aa[0];xs(r,s*l,1e-14)&&r>n+1e-14;)r/=l,l=this.Aa[++o%this.Aa.length];var h,c,u;return r}}class Qn{constructor(t,e,s,n){this.La=[],this.Yi=t,this.Ia=e,this.Oa=s,this.Na=n}za(t,e){if(t<e)throw new Error("high < low");const s=this.Yi.$t(),n=(t-e)*this.Fa()/s,r=new fi(this.Ia,[2,2.5,2]),o=new fi(this.Ia,[2,2,2.5]),l=new fi(this.Ia,[2.5,2,2]),h=[];return h.push(r.za(t,e,n),o.za(t,e,n),l.za(t,e,n)),function(c){if(c.length<1)throw Error("array is empty");let u=c[0];for(let d=1;d<c.length;++d)c[d]<u&&(u=c[d]);return u}(h)}Wa(){const t=this.Yi,e=t.zt();if(e===null)return void(this.La=[]);const s=t.$t(),n=this.Oa(s-1,e),r=this.Oa(0,e),o=this.Yi.N().entireTextOnly?this.Ha()/2:0,l=o,h=s-1-o,c=Math.max(n,r),u=Math.min(n,r);if(c===u)return void(this.La=[]);const d=this.za(c,u);if(this.Ua(e,d,c,u,l,h),t.$a()&&this.qa(d,u,c)){const m=this.Yi.Ya();this.ja(e,d,l,h,m,2*m)}const f=this.La.map(m=>m.Ka),p=this.Yi.Xa(f);for(let m=0;m<this.La.length;m++)this.La[m].Za=p[m]}Da(){return this.La}Ha(){return this.Yi.P()}Fa(){return Math.ceil(2.5*this.Ha())}Ua(t,e,s,n,r,o){const l=this.La,h=this.Yi;let c=s%e;c+=c<0?e:0;const u=s>=n?1:-1;let d=null,f=0;for(let p=s-c;p>n;p-=e){const m=this.Na(p,t,!0);d!==null&&Math.abs(m-d)<this.Fa()||m<r||m>o||(f<l.length?(l[f].Pa=m,l[f].Za=h.Ga(p),l[f].Ka=p):l.push({Pa:m,Za:h.Ga(p),Ka:p}),f++,d=m,h.Ja()&&(e=this.za(p*u,n)))}l.length=f}ja(t,e,s,n,r,o){const l=this.La,h=this.Qa(t,s,r,o),c=this.Qa(t,n,-o,-r),u=this.Na(0,t,!0)-this.Na(e,t,!0);l.length>0&&l[0].Pa-h.Pa<u/2&&l.shift(),l.length>0&&c.Pa-l[l.length-1].Pa<u/2&&l.pop(),l.unshift(h),l.push(c)}Qa(t,e,s,n){const r=(s+n)/2,o=this.Oa(e+s,t),l=this.Oa(e+n,t),h=Math.min(o,l),c=Math.max(o,l),u=Math.max(.1,this.za(c,h)),d=this.Oa(e+r,t),f=d-d%u,p=this.Na(f,t,!0);return{Za:this.Yi.Ga(f),Pa:p,Ka:f}}qa(t,e,s){let n=pe(this.Yi.Qe());return this.Yi.Ja()&&(n=Le(n,this.Yi.tl())),n.$e()-e<t&&s-n.qe()<t}}function $a(i){return i.slice().sort((t,e)=>C(t.hs())-C(e.hs()))}var Wn;(function(i){i[i.Normal=0]="Normal",i[i.Logarithmic=1]="Logarithmic",i[i.Percentage=2]="Percentage",i[i.IndexedTo100=3]="IndexedTo100"})(Wn||(Wn={}));const Hn=new La,Jn=new ti(100,1);class fu{constructor(t,e,s,n,r){this.il=0,this.sl=null,this.Ge=null,this.nl=null,this.el={rl:!1,hl:null},this.al=!1,this.ll=0,this.ol=0,this._l=new Nt,this.ul=new Nt,this.cl=[],this.dl=null,this.fl=null,this.pl=null,this.vl=null,this.ml=null,this.ra=Jn,this.wl=di(null),this.gl=t,this.Ps=e,this.Ml=s,this.bl=n,this.Sl=r,this.xl=new Qn(this,100,this.Cl.bind(this),this.Pl.bind(this))}ma(){return this.gl}N(){return this.Ps}hr(t){if(Ht(this.Ps,t),this.wa(),t.mode!==void 0&&this.yl({ie:t.mode}),t.scaleMargins!==void 0){const e=Yt(t.scaleMargins.top),s=Yt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(s<0||s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(e+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+s}`);this.kl(),this.pl=null}}Tl(){return this.Ps.autoScale}Rl(){return this.al}Ja(){return this.Ps.mode===1}Le(){return this.Ps.mode===2}Dl(){return this.Ps.mode===3}tl(){return this.wl}ie(){return{sn:this.Ps.autoScale,Vl:this.Ps.invertScale,ie:this.Ps.mode}}yl(t){const e=this.ie();let s=null;t.sn!==void 0&&(this.Ps.autoScale=t.sn),t.ie!==void 0&&(this.Ps.mode=t.ie,t.ie!==2&&t.ie!==3||(this.Ps.autoScale=!0),this.el.rl=!1),e.ie===1&&t.ie!==e.ie&&(function(r,o){if(r===null)return!1;const l=ts(r.$e(),o),h=ts(r.qe(),o);return isFinite(l)&&isFinite(h)}(this.Ge,this.wl)?(s=Le(this.Ge,this.wl),s!==null&&this.Bl(s)):this.Ps.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(s=Je(this.Ge,this.wl),s!==null&&this.Bl(s));const n=e.ie!==this.Ps.mode;n&&(e.ie===2||this.Le())&&this.wa(),n&&(e.ie===3||this.Dl())&&this.wa(),t.Vl!==void 0&&e.Vl!==t.Vl&&(this.Ps.invertScale=t.Vl,this.Il()),this.ul.p(e,this.ie())}El(){return this.ul}P(){return this.Ml.fontSize}$t(){return this.il}Al(t){this.il!==t&&(this.il=t,this.kl(),this.pl=null)}zl(){if(this.sl)return this.sl;const t=this.$t()-this.Ll()-this.Ol();return this.sl=t,t}Qe(){return this.Nl(),this.Ge}Bl(t,e){const s=this.Ge;(e||s===null&&t!==null||s!==null&&!s.He(t))&&(this.pl=null,this.Ge=t)}Fl(t){this.Bl(t),this.Wl(t!==null)}Ki(){return this.Nl(),this.il===0||!this.Ge||this.Ge.Ki()}Hl(t){return this.Vl()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=Fe(t,e):this.Dl()&&(t=Xe(t,e)),this.Pl(t,e)}Ul(t,e,s){this.Nl();const n=this.Ol(),r=C(this.Qe()),o=r.$e(),l=r.qe(),h=this.zl()-1,c=this.Vl(),u=h/(l-o),d=s===void 0?0:s.from,f=s===void 0?t.length:s.to,p=this.$l();for(let m=d;m<f;m++){const b=t[m],g=b.gt;if(isNaN(g))continue;let S=g;p!==null&&(S=p(b.gt,e));const j=n+u*(S-o),N=c?j:this.il-1-j;b.ut=N}}ql(t,e,s){this.Nl();const n=this.Ol(),r=C(this.Qe()),o=r.$e(),l=r.qe(),h=this.zl()-1,c=this.Vl(),u=h/(l-o),d=s===void 0?0:s.from,f=s===void 0?t.length:s.to,p=this.$l();for(let m=d;m<f;m++){const b=t[m];let g=b.qh,S=b.Yh,j=b.jh,N=b.Kh;p!==null&&(g=p(b.qh,e),S=p(b.Yh,e),j=p(b.jh,e),N=p(b.Kh,e));let M=n+u*(g-o),A=c?M:this.il-1-M;b.Yl=A,M=n+u*(S-o),A=c?M:this.il-1-M,b.jl=A,M=n+u*(j-o),A=c?M:this.il-1-M,b.Kl=A,M=n+u*(N-o),A=c?M:this.il-1-M,b.Xl=A}}Ts(t,e){const s=this.Cl(t,e);return this.Zl(s,e)}Zl(t,e){let s=t;return this.Le()?s=function(n,r){return r<0&&(n=-n),n/100*r+r}(s,e):this.Dl()&&(s=function(n,r){return n-=100,r<0&&(n=-n),n/100*r+r}(s,e)),s}Ma(){return this.cl}Dt(){return this.fl||(this.fl=$a(this.cl)),this.fl}Gl(t){this.cl.indexOf(t)===-1&&(this.cl.push(t),this.wa(),this.Jl())}Ql(t){const e=this.cl.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.cl.splice(e,1),this.cl.length===0&&(this.yl({sn:!0}),this.Bl(null)),this.wa(),this.Jl()}zt(){let t=null;for(const e of this.cl){const s=e.zt();s!==null&&(t===null||s.Hh<t.Hh)&&(t=s)}return t===null?null:t.Wt}Vl(){return this.Ps.invertScale}Da(){const t=this.zt()===null;if(this.pl!==null&&(t||this.pl.io===t))return this.pl.Da;this.xl.Wa();const e=this.xl.Da();return this.pl={Da:e,io:t},this._l.p(),e}so(){return this._l}no(t){this.Le()||this.Dl()||this.vl===null&&this.nl===null&&(this.Ki()||(this.vl=this.il-t,this.nl=C(this.Qe()).Ue()))}eo(t){if(this.Le()||this.Dl()||this.vl===null)return;this.yl({sn:!1}),(t=this.il-t)<0&&(t=0);let e=(this.vl+.2*(this.il-1))/(t+.2*(this.il-1));const s=C(this.nl).Ue();e=Math.max(e,.1),s.je(e),this.Bl(s)}ro(){this.Le()||this.Dl()||(this.vl=null,this.nl=null)}ho(t){this.Tl()||this.ml===null&&this.nl===null&&(this.Ki()||(this.ml=t,this.nl=C(this.Qe()).Ue()))}ao(t){if(this.Tl()||this.ml===null)return;const e=C(this.Qe()).Ye()/(this.zl()-1);let s=t-this.ml;this.Vl()&&(s*=-1);const n=s*e,r=C(this.nl).Ue();r.Ke(n),this.Bl(r,!0),this.pl=null}lo(){this.Tl()||this.ml!==null&&(this.ml=null,this.nl=null)}ea(){return this.ra||this.wa(),this.ra}Zi(t,e){switch(this.Ps.mode){case 2:return this.oo(Fe(t,e));case 3:return this.ea().format(Xe(t,e));default:return this.nr(t)}}Ga(t){switch(this.Ps.mode){case 2:return this.oo(t);case 3:return this.ea().format(t);default:return this.nr(t)}}Xa(t){switch(this.Ps.mode){case 2:return this._o(t);case 3:return this.ea().formatTickmarks(t);default:return this.uo(t)}}Dh(t){return this.nr(t,C(this.dl).ea())}Vh(t,e){return t=Fe(t,e),this.oo(t,Hn)}co(){return this.cl}do(t){this.el={hl:t,rl:!1}}Ns(){this.cl.forEach(t=>t.Ns())}$a(){return this.Ps.ensureEdgeTickMarksVisible&&this.Tl()}Ya(){return this.P()/2}wa(){this.pl=null;let t=1/0;this.dl=null;for(const s of this.cl)s.hs()<t&&(t=s.hs(),this.dl=s);let e=100;this.dl!==null&&(e=Math.round(this.dl.nh())),this.ra=Jn,this.Le()?(this.ra=Hn,e=100):this.Dl()?(this.ra=new ti(100,1),e=100):this.dl!==null&&(this.ra=this.dl.ea()),this.xl=new Qn(this,e,this.Cl.bind(this),this.Pl.bind(this)),this.xl.Wa()}Jl(){this.fl=null}fo(){return this.dl===null||this.Le()||this.Dl()?1:1/this.dl.nh()}Xi(){return this.Sl}Wl(t){this.al=t}Ll(){return this.Vl()?this.Ps.scaleMargins.bottom*this.$t()+this.ol:this.Ps.scaleMargins.top*this.$t()+this.ll}Ol(){return this.Vl()?this.Ps.scaleMargins.top*this.$t()+this.ll:this.Ps.scaleMargins.bottom*this.$t()+this.ol}Nl(){this.el.rl||(this.el.rl=!0,this.po())}kl(){this.sl=null}Pl(t,e){if(this.Nl(),this.Ki())return 0;t=this.Ja()&&t?Us(t,this.wl):t;const s=C(this.Qe()),n=this.Ol()+(this.zl()-1)*(t-s.$e())/s.Ye();return this.Hl(n)}Cl(t,e){if(this.Nl(),this.Ki())return 0;const s=this.Hl(t),n=C(this.Qe()),r=n.$e()+n.Ye()*((s-this.Ol())/(this.zl()-1));return this.Ja()?ts(r,this.wl):r}Il(){this.pl=null,this.xl.Wa()}po(){if(this.Rl()&&!this.Tl())return;const t=this.el.hl;if(t===null)return;let e=null;const s=this.co();let n=0,r=0;for(const h of s){if(!h.Vt())continue;const c=h.zt();if(c===null)continue;const u=h.Mh(t.Uh(),t.bi());let d=u&&u.Qe();if(d!==null){switch(this.Ps.mode){case 1:d=Je(d,this.wl);break;case 2:d=uu(d,c.Wt);break;case 3:d=du(d,c.Wt)}if(e=e===null?d:e.vn(C(d)),u!==null){const f=u.tr();f!==null&&(n=Math.max(n,f.above),r=Math.max(r,f.below))}}}if(this.$a()&&(n=Math.max(n,this.Ya()),r=Math.max(r,this.Ya())),n===this.ll&&r===this.ol||(this.ll=n,this.ol=r,this.pl=null,this.kl()),e!==null){if(e.$e()===e.qe()){const h=5*this.fo();this.Ja()&&(e=Le(e,this.wl)),e=new It(e.$e()-h,e.qe()+h),this.Ja()&&(e=Je(e,this.wl))}if(this.Ja()){const h=Le(e,this.wl),c=di(h);if(o=c,l=this.wl,o.Va!==l.Va||o.Ba!==l.Ba){const u=this.nl!==null?Le(this.nl,this.wl):null;this.wl=c,e=Je(h,c),u!==null&&(this.nl=Je(u,c))}}this.Bl(e)}else this.Ge===null&&(this.Bl(new It(-.5,.5)),this.wl=di(null));var o,l}$l(){return this.Le()?Fe:this.Dl()?Xe:this.Ja()?t=>Us(t,this.wl):null}vo(t,e,s){return e===void 0?(s===void 0&&(s=this.ea()),s.format(t)):e(t)}mo(t,e,s){return e===void 0?(s===void 0&&(s=this.ea()),s.formatTickmarks(t)):e(t)}nr(t,e){return this.vo(t,this.bl.priceFormatter,e)}uo(t,e){const s=this.bl.priceFormatter;return this.mo(t,this.bl.tickmarksPriceFormatter??(s?n=>n.map(s):void 0),e)}oo(t,e){return this.vo(t,this.bl.percentageFormatter,e)}_o(t,e){const s=this.bl.percentageFormatter;return this.mo(t,this.bl.tickmarksPercentageFormatter??(s?n=>n.map(s):void 0),e)}}function Kn(i){return i instanceof ei}class Gn{constructor(t,e){this.cl=[],this.wo=new Map,this.il=0,this.Mo=0,this.bo=1,this.fl=null,this.So=!1,this.xo=new Nt,this.yh=[],this.uh=t,this.ts=e,this.Co=new cu(this);const s=e.N();this.Po=this.yo("left",s.leftPriceScale),this.ko=this.yo("right",s.rightPriceScale),this.Po.El().i(this.To.bind(this,this.Po),this),this.ko.El().i(this.To.bind(this,this.ko),this),this.Ro(s)}Ro(t){if(t.leftPriceScale&&this.Po.hr(t.leftPriceScale),t.rightPriceScale&&this.ko.hr(t.rightPriceScale),t.localization&&(this.Po.wa(),this.ko.wa()),t.overlayPriceScales){const e=Array.from(this.wo.values());for(const s of e){const n=C(s[0].Ft());n.hr(t.overlayPriceScales),t.localization&&n.wa()}}}Do(t){switch(t){case"left":return this.Po;case"right":return this.ko}return this.wo.has(t)?Yt(this.wo.get(t))[0].Ft():null}m(){this.Qt().Vo().u(this),this.Po.El().u(this),this.ko.El().u(this),this.cl.forEach(t=>{t.m&&t.m()}),this.yh=this.yh.filter(t=>{const e=t.oh();return e.detached&&e.detached(),!1}),this.xo.p()}Bo(){return this.bo}Io(t){this.bo=t}Qt(){return this.ts}Qi(){return this.Mo}$t(){return this.il}Eo(t){this.Mo=t,this.Ao()}Al(t){this.il=t,this.Po.Al(t),this.ko.Al(t),this.cl.forEach(e=>{if(this.Un(e)){const s=e.Ft();s!==null&&s.Al(t)}}),this.Ao()}zo(t){this.So=t}Lo(){return this.So}Oo(){return this.cl.filter(Kn)}Ma(){return this.cl}Un(t){const e=t.Ft();return e===null||this.Po!==e&&this.ko!==e}Gl(t,e,s){this.No(t,e,s?t.hs():this.cl.length)}Ql(t,e){const s=this.cl.indexOf(t);Lt(s!==-1,"removeDataSource: invalid data source"),this.cl.splice(s,1),e||this.cl.forEach((o,l)=>o.ls(l));const n=C(t.Ft()).ma();if(this.wo.has(n)){const o=Yt(this.wo.get(n)),l=o.indexOf(t);l!==-1&&(o.splice(l,1),o.length===0&&this.wo.delete(n))}const r=t.Ft();r&&r.Ma().indexOf(t)>=0&&(r.Ql(t),this.Fo(r)),this.fl=null}qn(t){return t===this.Po?"left":t===this.ko?"right":"overlay"}Wo(){return this.Po}Ho(){return this.ko}Uo(t,e){t.no(e)}$o(t,e){t.eo(e),this.Ao()}qo(t){t.ro()}Yo(t,e){t.ho(e)}jo(t,e){t.ao(e),this.Ao()}Ko(t){t.lo()}Ao(){this.cl.forEach(t=>{t.Ns()})}ks(){let t=null;return this.ts.N().rightPriceScale.visible&&this.ko.Ma().length!==0?t=this.ko:this.ts.N().leftPriceScale.visible&&this.Po.Ma().length!==0?t=this.Po:this.cl.length!==0&&(t=this.cl[0].Ft()),t===null&&(t=this.ko),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.ko:this.ts.N().leftPriceScale.visible&&(t=this.Po),t}Fo(t){t!==null&&t.Tl()&&this.Xo(t)}Zo(t){const e=this.uh.Pe();t.yl({sn:!0}),e!==null&&t.do(e),this.Ao()}Go(){this.Xo(this.Po),this.Xo(this.ko)}Jo(){this.Fo(this.Po),this.Fo(this.ko),this.cl.forEach(t=>{this.Un(t)&&this.Fo(t.Ft())}),this.Ao(),this.ts.ar()}Dt(){return this.fl===null&&(this.fl=$a(this.cl)),this.fl}Qo(t,e){e=Ze(e,0,this.cl.length-1);const s=this.cl.indexOf(t);Lt(s!==-1,"setSeriesOrder: invalid data source"),this.cl.splice(s,1),this.cl.splice(e,0,t),this.cl.forEach((n,r)=>n.ls(r)),this.fl=null;for(const n of[this.Po,this.ko])n.Jl(),n.wa();this.ts.ar()}Bt(){return this.Dt().filter(Kn)}t_(){return this.xo}i_(){return this.Co}_a(t){this.yh.push(new Gc(t))}ua(t){this.yh=this.yh.filter(e=>e.oh()!==t),t.detached&&t.detached(),this.ts.ar()}s_(){return this.yh}sa(t,e){return this.yh.map(s=>s.jn(t,e)).filter(s=>s!==null)}Xo(t){const e=t.co();if(e&&e.length>0&&!this.uh.Ki()){const s=this.uh.Pe();s!==null&&t.do(s)}t.Ns()}No(t,e,s){let n=this.Do(e);if(n===null&&(n=this.yo(e,this.ts.N().overlayPriceScales)),this.cl.splice(s,0,t),!Xs(e)){const r=this.wo.get(e)||[];r.push(t),this.wo.set(e,r)}t.ls(s),n.Gl(t),t._s(n),this.Fo(n),this.fl=null}To(t,e,s){e.ie!==s.ie&&this.Xo(t)}yo(t,e){const s={visible:!0,autoScale:!0,...he(e)},n=new fu(t,s,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return n.Al(this.$t()),n}}function bs(i){return{n_:i.n_,e_:{Kn:i.r_.externalId},h_:i.r_.cursorStyle}}function mu(i,t,e,s){for(const n of i){const r=n.Tt(s);if(r!==null&&r.jn){const o=r.jn(t,e);if(o!==null)return{a_:n,e_:o}}}return null}function pu(i){return i.Fs!==void 0}function Va(i,t,e){const s=[i,...i.Dt()],n=function(r,o,l){var f;let h,c;for(const p of r){const m=((f=p.sa)==null?void 0:f.call(p,o,l))??[];for(const b of m)u=b.zOrder,d=h==null?void 0:h.zOrder,(!d||u==="top"&&d!=="top"||u==="normal"&&d==="bottom")&&(h=b,c=p)}var u,d;return h&&c?{r_:h,n_:c}:null}(s,t,e);if((n==null?void 0:n.r_.zOrder)==="top")return bs(n);for(const r of s){if(n&&n.n_===r&&n.r_.zOrder!=="bottom"&&!n.r_.isBackground)return bs(n);if(pu(r)){const o=mu(r.Fs(i),t,e,i);if(o!==null)return{n_:r,a_:o.a_,e_:o.e_}}if(n&&n.n_===r&&n.r_.zOrder!=="bottom"&&n.r_.isBackground)return bs(n)}return n!=null&&n.r_?bs(n):null}class gu{constructor(t,e,s=50){this.yn=0,this.kn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.l_=t,this.o_=e,this.Vn=s}__(t){const e=t.time,s=this.o_.cacheKey(e),n=this.Dn.get(s);if(n!==void 0)return n.u_;if(this.yn===this.Vn){const o=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(Yt(o)),this.Tn++,this.yn--}const r=this.l_(t);return this.Dn.set(s,{u_:r,An:this.kn}),this.Rn.set(this.kn,s),this.yn++,this.kn++,r}}class Ie{constructor(t,e){Lt(t<=e,"right should be >= left"),this.c_=t,this.d_=e}Uh(){return this.c_}bi(){return this.d_}f_(){return this.d_-this.c_+1}Te(t){return this.c_<=t&&t<=this.d_}He(t){return this.c_===t.Uh()&&this.d_===t.bi()}}function Zn(i,t){return i===null||t===null?i===t:i.He(t)}class xu{constructor(){this.p_=new Map,this.Dn=null,this.v_=!1}m_(t){this.v_=t,this.Dn=null}w_(t,e){this.g_(e),this.Dn=null;for(let s=e;s<t.length;++s){const n=t[s];let r=this.p_.get(n.timeWeight);r===void 0&&(r=[],this.p_.set(n.timeWeight,r)),r.push({index:s,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}M_(t,e,s,n,r){const o=Math.ceil(e/t);return this.Dn!==null&&this.Dn.b_===o&&r===this.Dn.S_&&s===this.Dn.x_||(this.Dn={S_:r,x_:s,Da:this.C_(o,s,n),b_:o}),this.Dn.Da}g_(t){if(t===0)return void this.p_.clear();const e=[];this.p_.forEach((s,n)=>{t<=s[0].index?e.push(n):s.splice($e(s,t,r=>r.index<t),1/0)});for(const s of e)this.p_.delete(s)}C_(t,e,s){let n=[];const r=o=>!e||s.has(o.index);for(const o of Array.from(this.p_.keys()).sort((l,h)=>h-l)){if(!this.p_.get(o))continue;const l=n;n=[];const h=l.length;let c=0;const u=Yt(this.p_.get(o)),d=u.length;let f=1/0,p=-1/0;for(let m=0;m<d;m++){const b=u[m],g=b.index;for(;c<h;){const S=l[c],j=S.index;if(!(j<g&&r(S))){f=j;break}c++,n.push(S),p=j,f=1/0}if(f-g>=t&&g-p>=t&&r(b))n.push(b),p=g;else if(this.v_)return l}for(;c<h;c++)r(l[c])&&n.push(l[c])}return n}}class ze{constructor(t){this.P_=t}y_(){return this.P_===null?null:new Ie(Math.floor(this.P_.Uh()),Math.ceil(this.P_.bi()))}k_(){return this.P_}static T_(){return new ze(null)}}function bu(i,t){return i.weight>t.weight?i:t}class vu{constructor(t,e,s,n){this.Mo=0,this.R_=null,this.D_=[],this.ml=null,this.vl=null,this.V_=new xu,this.B_=new Map,this.I_=ze.T_(),this.E_=!0,this.A_=new Nt,this.z_=new Nt,this.L_=new Nt,this.O_=null,this.N_=null,this.F_=new Map,this.W_=-1,this.H_=[],this.Ps=e,this.bl=s,this.U_=e.rightOffset,this.q_=e.barSpacing,this.ts=t,this.Y_(e),this.o_=n,this.j_(),this.V_.m_(e.uniformDistribution),this.K_()}N(){return this.Ps}X_(t){Ht(this.bl,t),this.Z_(),this.j_()}hr(t,e){Ht(this.Ps,t),this.Ps.fixLeftEdge&&this.G_(),this.Ps.fixRightEdge&&this.J_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),this.Y_(t),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.q_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.K_(),this.Z_(),this.j_(),this.L_.p()}Rs(t){var e;return((e=this.D_[t])==null?void 0:e.time)??null}ss(t){return this.D_[t]??null}Q_(t,e){if(this.D_.length<1)return null;if(this.o_.key(t)>this.o_.key(this.D_[this.D_.length-1].time))return e?this.D_.length-1:null;const s=$e(this.D_,this.o_.key(t),(n,r)=>this.o_.key(n.time)<r);return this.o_.key(t)<this.o_.key(this.D_[s].time)?e?s:null:s}Ki(){return this.Mo===0||this.D_.length===0||this.R_===null}tu(){return this.D_.length>0}Pe(){return this.iu(),this.I_.y_()}su(){return this.iu(),this.I_.k_()}nu(){const t=this.Pe();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.eu(e)}eu(t){const e=Math.round(t.from),s=Math.round(t.to),n=C(this.ru()),r=C(this.hu());return{from:C(this.ss(Math.max(n,e))),to:C(this.ss(Math.min(r,s)))}}au(t){return{from:C(this.Q_(t.from,!0)),to:C(this.Q_(t.to,!0))}}Qi(){return this.Mo}Eo(t){if(!isFinite(t)||t<=0||this.Mo===t)return;const e=this.su(),s=this.Mo;if(this.Mo=t,this.E_=!0,this.Ps.lockVisibleTimeRangeOnResize&&s!==0){const n=this.q_*t/s;this.q_=n}if(this.Ps.fixLeftEdge&&e!==null&&e.Uh()<=0){const n=s-t;this.U_-=Math.round(n/this.q_)+1,this.E_=!0}this.lu(),this.ou()}qt(t){if(this.Ki()||!is(t))return 0;const e=this._u()+this.U_-t;return this.Mo-(e+.5)*this.q_-1}uu(t,e){const s=this._u(),n=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=n;o<r;o++){const l=t[o].wt,h=s+this.U_-l,c=this.Mo-(h+.5)*this.q_-1;t[o]._t=c}}cu(t,e){const s=Math.ceil(this.du(t));return e&&this.Ps.ignoreWhitespaceIndices&&!this.fu(s)?this.pu(s):s}fn(t){this.E_=!0,this.U_=t,this.ou(),this.ts.vu(),this.ts.ar()}mu(){return this.q_}dn(t){const e=this.q_;if(this.wu(t),this.Ps.rightOffsetPixels!==void 0&&e!==0){const s=this.U_*e/this.q_;this.U_=s}this.ou(),this.ts.vu(),this.ts.ar()}gu(){return this.U_}Da(){if(this.Ki())return null;if(this.N_!==null)return this.N_;const t=this.q_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),s=Math.round(e/t),n=C(this.Pe()),r=Math.max(n.Uh(),n.Uh()-s),o=Math.max(n.bi(),n.bi()-s),l=this.V_.M_(t,e,this.Ps.ignoreWhitespaceIndices,this.F_,this.W_),h=this.ru()+s,c=this.hu()-s,u=this.Mu(),d=this.Ps.fixLeftEdge||u,f=this.Ps.fixRightEdge||u;let p=0;for(const m of l){if(!(r<=m.index&&m.index<=o))continue;let b;p<this.H_.length?(b=this.H_[p],b.coord=this.qt(m.index),b.label=this.bu(m),b.weight=m.weight):(b={needAlignCoordinate:!1,coord:this.qt(m.index),label:this.bu(m),weight:m.weight},this.H_.push(b)),this.q_>e/2&&!u?b.needAlignCoordinate=!1:b.needAlignCoordinate=d&&m.index<=h||f&&m.index>=c,p++}return this.H_.length=p,this.N_=this.H_,this.H_}Su(){let t;this.E_=!0,this.dn(this.Ps.barSpacing),t=this.Ps.rightOffsetPixels!==void 0?this.Ps.rightOffsetPixels/this.mu():this.Ps.rightOffset,this.fn(t)}xu(t){this.E_=!0,this.R_=t,this.ou(),this.G_()}Cu(t,e){const s=this.du(t),n=this.mu(),r=n+e*(n/10);this.dn(r),this.Ps.rightBarStaysOnScroll||this.fn(this.gu()+(s-this.du(t)))}no(t){this.ml&&this.lo(),this.vl===null&&this.O_===null&&(this.Ki()||(this.vl=t,this.Pu()))}eo(t){if(this.O_===null)return;const e=Ze(this.Mo-t,0,this.Mo),s=Ze(this.Mo-C(this.vl),0,this.Mo);e!==0&&s!==0&&this.dn(this.O_.mu*e/s)}ro(){this.vl!==null&&(this.vl=null,this.yu())}ho(t){this.ml===null&&this.O_===null&&(this.Ki()||(this.ml=t,this.Pu()))}ao(t){if(this.ml===null)return;const e=(this.ml-t)/this.mu();this.U_=C(this.O_).gu+e,this.E_=!0,this.ou()}lo(){this.ml!==null&&(this.ml=null,this.yu())}ku(){this.Tu(this.Ps.rightOffset)}Tu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.U_,n=performance.now();this.ts._n({Ru:r=>(r-n)/e>=1,Du:r=>{const o=(r-n)/e;return o>=1?t:s+(t-s)*o}})}yt(t,e){this.E_=!0,this.D_=t,this.V_.w_(t,e),this.ou()}Vu(){return this.A_}Bu(){return this.z_}Iu(){return this.L_}_u(){return this.R_||0}Eu(t,e){const s=t.f_(),n=e&&this.Ps.rightOffsetPixels||0;this.wu((this.Mo-n)/s),this.U_=t.bi()-this._u(),e&&(this.U_=n?n/this.mu():this.Ps.rightOffset),this.ou(),this.E_=!0,this.ts.vu(),this.ts.ar()}Au(){const t=this.ru(),e=this.hu();t!==null&&e!==null&&this.Eu(new Ie(t,e),!0)}zu(t){const e=new Ie(t.from,t.to);this.Eu(e)}ns(t){return this.bl.timeFormatter!==void 0?this.bl.timeFormatter(t.originalTime):this.o_.formatHorzItem(t.time)}K_(){if(!this.Ps.ignoreWhitespaceIndices)return;this.F_.clear();const t=this.ts.js();for(const e of t)for(const s of e.va())this.F_.set(s,!0);this.W_++}Mu(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}ru(){return this.D_.length===0?null:0}hu(){return this.D_.length===0?null:this.D_.length-1}Lu(t){return(this.Mo-1-t)/this.q_}du(t){const e=this.Lu(t),s=this._u()+this.U_-e;return Math.round(1e6*s)/1e6}wu(t){const e=this.q_;this.q_=t,this.lu(),e!==this.q_&&(this.E_=!0,this.Ou())}iu(){if(!this.E_)return;if(this.E_=!1,this.Ki())return void this.Nu(ze.T_());const t=this._u(),e=this.Mo/this.q_,s=this.U_+t,n=new Ie(s-e+1,s);this.Nu(new ze(n))}lu(){const t=Ze(this.q_,this.Fu(),this.Wu());this.q_!==t&&(this.q_=t,this.E_=!0)}Wu(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.Mo}Fu(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&this.D_.length!==0?this.Mo/this.D_.length:this.Ps.minBarSpacing}ou(){const t=this.Hu();t!==null&&this.U_<t&&(this.U_=t,this.E_=!0);const e=this.Uu();this.U_>e&&(this.U_=e,this.E_=!0)}Hu(){const t=this.ru(),e=this.R_;return t===null||e===null?null:t-e-1+(this.Ps.fixLeftEdge?this.Mo/this.q_:Math.min(2,this.D_.length))}Uu(){return this.Ps.fixRightEdge?0:this.Mo/this.q_-Math.min(2,this.D_.length)}Pu(){this.O_={mu:this.mu(),gu:this.gu()}}yu(){this.O_=null}bu(t){let e=this.B_.get(t.weight);return e===void 0&&(e=new gu(s=>this.$u(s),this.o_),this.B_.set(t.weight,e)),e.__(t)}$u(t){return this.o_.formatTickmark(t,this.bl)}Nu(t){const e=this.I_;this.I_=t,Zn(e.y_(),this.I_.y_())||this.A_.p(),Zn(e.k_(),this.I_.k_())||this.z_.p(),this.Ou()}Ou(){this.N_=null}Z_(){this.Ou(),this.B_.clear()}j_(){this.o_.updateFormatter(this.bl)}G_(){if(!this.Ps.fixLeftEdge)return;const t=this.ru();if(t===null)return;const e=this.Pe();if(e===null)return;const s=e.Uh()-t;if(s<0){const n=this.U_-s-1;this.fn(n)}this.lu()}J_(){this.ou(),this.lu()}fu(t){return!this.Ps.ignoreWhitespaceIndices||this.F_.get(t)||!1}pu(t){const e=function*(n){const r=Math.round(n),o=r<n;let l=1;for(;;)o?(yield r+l,yield r-l):(yield r-l,yield r+l),l++}(t),s=this.hu();for(;s;){const n=e.next().value;if(this.F_.get(n))return n;if(n<0||n>s)break}return t}Y_(t){if(t.rightOffsetPixels!==void 0){const e=t.rightOffsetPixels/(t.barSpacing||this.q_);this.ts.fn(e)}}}var Xn,tr,er,Di,sr;(function(i){i[i.OnTouchEnd=0]="OnTouchEnd",i[i.OnNextTap=1]="OnNextTap"})(Xn||(Xn={}));class yu{constructor(t,e,s){this.qu=[],this.Yu=[],this.Mo=0,this.ju=null,this.Ku=new Nt,this.Xu=new Nt,this.Zu=null,this.Gu=t,this.Ps=e,this.o_=s,this.Sl=new vc(this.Ps.layout.colorParsers),this.Ju=new bc(this),this.uh=new vu(this,e.timeScale,this.Ps.localization,s),this.Ct=new Rc(this,e.crosshair),this.Qu=new ou(e.crosshair),e.addDefaultPane&&(this.tc(0),this.qu[0].Io(2)),this.sc=this.nc(0),this.ec=this.nc(1)}Ih(){this.rc(Tt.gn())}ar(){this.rc(Tt.wn())}Zh(){this.rc(new Tt(1))}Eh(t){const e=this.hc(t);this.rc(e)}ac(){return this.ju}lc(t){var s,n,r,o;if(((s=this.ju)==null?void 0:s.n_)===(t==null?void 0:t.n_)&&((r=(n=this.ju)==null?void 0:n.e_)==null?void 0:r.Kn)===((o=t==null?void 0:t.e_)==null?void 0:o.Kn))return;const e=this.ju;this.ju=t,e!==null&&this.Eh(e.n_),t!==null&&t.n_!==(e==null?void 0:e.n_)&&this.Eh(t.n_)}N(){return this.Ps}hr(t){Ht(this.Ps,t),this.qu.forEach(e=>e.Ro(t)),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.X_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Ku.p(),this.sc=this.nc(0),this.ec=this.nc(1),this.Ih()}oc(t,e,s=0){const n=this.qu[s];if(n===void 0)return;if(t==="left")return Ht(this.Ps,{leftPriceScale:e}),n.Ro({leftPriceScale:e}),this.Ku.p(),void this.Ih();if(t==="right")return Ht(this.Ps,{rightPriceScale:e}),n.Ro({rightPriceScale:e}),this.Ku.p(),void this.Ih();const r=this._c(t,s);r!==null&&(r.Ft.hr(e),this.Ku.p())}_c(t,e){const s=this.qu[e];if(s===void 0)return null;const n=s.Do(t);return n!==null?{Us:s,Ft:n}:null}Et(){return this.uh}$s(){return this.qu}uc(){return this.Ct}cc(){return this.Xu}dc(t,e){t.Al(e),this.vu()}Eo(t){this.Mo=t,this.uh.Eo(this.Mo),this.qu.forEach(e=>e.Eo(t)),this.vu()}fc(t){this.qu.length!==1&&(Lt(t>=0&&t<this.qu.length,"Invalid pane index"),this.qu.splice(t,1),this.Ih())}vc(t,e){if(this.qu.length<2)return;Lt(t>=0&&t<this.qu.length,"Invalid pane index");const s=this.qu[t],n=this.qu.reduce((d,f)=>d+f.Bo(),0),r=this.qu.reduce((d,f)=>d+f.$t(),0),o=r-30*(this.qu.length-1);e=Math.min(o,Math.max(30,e));const l=n/r,h=s.$t();s.Io(e*l);let c=e-h,u=this.qu.length-1;for(const d of this.qu)if(d!==s){const f=Math.min(o,Math.max(30,d.$t()-c/u));c-=d.$t()-f,u-=1;const p=f*l;d.Io(p)}this.Ih()}mc(t,e){Lt(t>=0&&t<this.qu.length&&e>=0&&e<this.qu.length,"Invalid pane index");const s=this.qu[t],n=this.qu[e];this.qu[t]=n,this.qu[e]=s,this.Ih()}wc(t,e){if(Lt(t>=0&&t<this.qu.length&&e>=0&&e<this.qu.length,"Invalid pane index"),t===e)return;const[s]=this.qu.splice(t,1);this.qu.splice(e,0,s),this.Ih()}Uo(t,e,s){t.Uo(e,s)}$o(t,e,s){t.$o(e,s),this.Ah(),this.rc(this.gc(t,2))}qo(t,e){t.qo(e),this.rc(this.gc(t,2))}Yo(t,e,s){e.Tl()||t.Yo(e,s)}jo(t,e,s){e.Tl()||(t.jo(e,s),this.Ah(),this.rc(this.gc(t,2)))}Ko(t,e){e.Tl()||(t.Ko(e),this.rc(this.gc(t,2)))}Zo(t,e){t.Zo(e),this.rc(this.gc(t,2))}Mc(t){this.uh.no(t)}bc(t,e){const s=this.Et();if(s.Ki()||e===0)return;const n=s.Qi();t=Math.max(1,Math.min(t,n)),s.Cu(t,e),this.vu()}Sc(t){this.xc(0),this.Cc(t),this.Pc()}yc(t){this.uh.eo(t),this.vu()}kc(){this.uh.ro(),this.ar()}xc(t){this.uh.ho(t)}Cc(t){this.uh.ao(t),this.vu()}Pc(){this.uh.lo(),this.ar()}js(){return this.Yu}Tc(t,e,s,n,r){this.Ct.Vs(t,e);let o=NaN,l=this.uh.cu(t,!0);const h=this.uh.Pe();h!==null&&(l=Math.min(Math.max(h.Uh(),l),h.bi()));const c=n.ks(),u=c.zt();if(u!==null&&(o=c.Ts(e,u)),o=this.Qu.ga(o,l,n),this.Ct.As(l,o,n),this.Zh(),!r){const d=Va(n,t,e);this.lc(d&&{n_:d.n_,e_:d.e_,h_:d.h_||null}),this.Xu.p(this.Ct.It(),{x:t,y:e},s)}}Rc(t,e,s){const n=s.ks(),r=n.zt(),o=n.Nt(t,C(r)),l=this.uh.Q_(e,!0),h=this.uh.qt(C(l));this.Tc(h,o,null,s,!0)}Dc(t){this.uc().Ls(),this.Zh(),t||this.Xu.p(null,null,null)}Ah(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Is(),s=this.Ct.Es();this.Tc(e,s,null,t)}this.Ct.Ns()}Vc(t,e,s){const n=this.uh.Rs(0);e!==void 0&&s!==void 0&&this.uh.yt(e,s);const r=this.uh.Rs(0),o=this.uh._u(),l=this.uh.Pe();if(l!==null&&n!==null&&r!==null){const h=l.Te(o),c=this.o_.key(n)>this.o_.key(r),u=t!==null&&t>o&&!c,d=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,f=h&&(s!==void 0||d)&&this.uh.N().shiftVisibleRangeOnNewBar;if(u&&!f){const p=t-o;this.uh.fn(this.uh.gu()-p)}}this.uh.xu(t)}Lh(t){t!==null&&t.Jo()}Hn(t){if(function(s){return s instanceof Gn}(t))return t;const e=this.qu.find(s=>s.Dt().includes(t));return e===void 0?null:e}vu(){this.qu.forEach(t=>t.Jo()),this.Ah()}m(){this.qu.forEach(t=>t.m()),this.qu.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Bc(){return this.Ju}Yn(){return this.Ju.N()}Vo(){return this.Ku}Ic(t,e){const s=this.tc(e);this.Ec(t,s),this.Yu.push(t),this.Yu.length===1?this.Ih():this.ar()}Ac(t){const e=this.Hn(t),s=this.Yu.indexOf(t);Lt(s!==-1,"Series not found");const n=C(e);this.Yu.splice(s,1),n.Ql(t),t.m&&t.m(),this.uh.K_(),this.zc(n)}Bh(t,e){const s=C(this.Hn(t));s.Ql(t,!0),s.Gl(t,e,!0)}Au(){const t=Tt.wn();t.rn(),this.rc(t)}Lc(t){const e=Tt.wn();e.ln(t),this.rc(e)}cn(){const t=Tt.wn();t.cn(),this.rc(t)}dn(t){const e=Tt.wn();e.dn(t),this.rc(e)}fn(t){const e=Tt.wn();e.fn(t),this.rc(e)}_n(t){const e=Tt.wn();e._n(t),this.rc(e)}hn(){const t=Tt.wn();t.hn(),this.rc(t)}Oc(){return this.Ps.rightPriceScale.visible?"right":"left"}Nc(t,e){if(Lt(e>=0,"Index should be greater or equal to 0"),e===this.Fc(t))return;const s=C(this.Hn(t));s.Ql(t);const n=this.tc(e);this.Ec(t,n),s.Ma().length===0&&this.zc(s),this.Ih()}Wc(){return this.ec}$(){return this.sc}Ut(t){const e=this.ec,s=this.sc;if(e===s)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Zu===null||this.Zu.mr!==s||this.Zu.wr!==e)this.Zu={mr:s,wr:e,Hc:new Map};else{const r=this.Zu.Hc.get(t);if(r!==void 0)return r}const n=this.Sl.tt(s,e,t/100);return this.Zu.Hc.set(t,n),n}Uc(t){return this.qu.indexOf(t)}Xi(){return this.Sl}$c(){return this.qc()}qc(t){const e=new Gn(this.uh,this);this.qu.push(e);const s=t??this.qu.length-1,n=Tt.gn();return n.Qs(s,{tn:0,sn:!0}),this.rc(n),e}tc(t){return Lt(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.qu.length,t))<this.qu.length?this.qu[t]:this.qc(t)}Fc(t){return this.qu.findIndex(e=>e.Oo().includes(t))}gc(t,e){const s=new Tt(e);if(t!==null){const n=this.qu.indexOf(t);s.Qs(n,{tn:e})}return s}hc(t,e){return e===void 0&&(e=2),this.gc(this.Hn(t),e)}rc(t){this.Gu&&this.Gu(t),this.qu.forEach(e=>e.i_().lr().yt())}Ec(t,e){const s=t.N().priceScaleId,n=s!==void 0?s:this.Oc();e.Gl(t,n),Xs(n)||t.hr(t.N())}nc(t){const e=this.Ps.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}zc(t){!t.Lo()&&t.Ma().length===0&&this.qu.length>1&&this.qu.splice(this.Uc(t),1)}}function Ua(i){if(i>=1)return 0;let t=0;for(;t<8;t++){const e=Math.round(i);if(Math.abs(e-i)<1e-8)return t;i*=10}return t}function Ai(i){return!Me(i)&&!ds(i)}function qa(i){return Me(i)}(function(i){i[i.Disabled=0]="Disabled",i[i.Continuous=1]="Continuous",i[i.OnDataUpdate=2]="OnDataUpdate"})(tr||(tr={})),function(i){i[i.LastBar=0]="LastBar",i[i.LastVisible=1]="LastVisible"}(er||(er={})),function(i){i.Solid="solid",i.VerticalGradient="gradient"}(Di||(Di={})),function(i){i[i.Year=0]="Year",i[i.Month=1]="Month",i[i.DayOfMonth=2]="DayOfMonth",i[i.Time=3]="Time",i[i.TimeWithSeconds=4]="TimeWithSeconds"}(sr||(sr={}));const ir=i=>i.getUTCFullYear();function wu(i,t,e){return t.replace(/yyyy/g,(s=>ce(ir(s),4))(i)).replace(/yy/g,(s=>ce(ir(s)%100,2))(i)).replace(/MMMM/g,((s,n)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(n,{month:"long"}))(i,e)).replace(/MMM/g,((s,n)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(n,{month:"short"}))(i,e)).replace(/MM/g,(s=>ce((n=>n.getUTCMonth()+1)(s),2))(i)).replace(/dd/g,(s=>ce((n=>n.getUTCDate())(s),2))(i))}class Ya{constructor(t="yyyy-MM-dd",e="default"){this.Yc=t,this.jc=e}__(t){return wu(t,this.Yc,this.jc)}}class Nu{constructor(t){this.Kc=t||"%h:%m:%s"}__(t){return this.Kc.replace("%h",ce(t.getUTCHours(),2)).replace("%m",ce(t.getUTCMinutes(),2)).replace("%s",ce(t.getUTCSeconds(),2))}}const Su={Xc:"yyyy-MM-dd",Zc:"%h:%m:%s",Gc:" ",Jc:"default"};class _u{constructor(t={}){const e={...Su,...t};this.Qc=new Ya(e.Xc,e.Jc),this.td=new Nu(e.Zc),this.sd=e.Gc}__(t){return`${this.Qc.__(t)}${this.sd}${this.td.__(t)}`}}function vs(i){return 60*i*60*1e3}function mi(i){return 60*i*1e3}const ys=[{nd:(nr=1,1e3*nr),ed:10},{nd:mi(1),ed:20},{nd:mi(5),ed:21},{nd:mi(30),ed:22},{nd:vs(1),ed:30},{nd:vs(3),ed:31},{nd:vs(6),ed:32},{nd:vs(12),ed:33}];var nr;function rr(i,t){if(i.getUTCFullYear()!==t.getUTCFullYear())return 70;if(i.getUTCMonth()!==t.getUTCMonth())return 60;if(i.getUTCDate()!==t.getUTCDate())return 50;for(let e=ys.length-1;e>=0;--e)if(Math.floor(t.getTime()/ys[e].nd)!==Math.floor(i.getTime()/ys[e].nd))return ys[e].ed;return 0}function pi(i){let t=i;if(ds(i)&&(t=Zi(i)),!Ai(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{rd:Math.round(e.getTime()/1e3),hd:t}}function ar(i){if(!qa(i))throw new Error("time must be of type isUTCTimestamp");return{rd:i}}function Zi(i){const t=new Date(i);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${i}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function or(i){ds(i.time)&&(i.time=Zi(i.time))}class lr{options(){return this.Ps}setOptions(t){this.Ps=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(or)}(t):or(t)}createConverterToInternalObj(t){return C(function(e){return e.length===0?null:Ai(e[0].time)||ds(e[0].time)?pi:ar}(t))}key(t){return typeof t=="object"&&"rd"in t?t.rd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.hd===void 0?new Date(1e3*e.rd).getTime():new Date(Date.UTC(e.hd.year,e.hd.month-1,e.hd.day)).getTime()}convertHorzItemToInternal(t){return qa(e=t)?ar(e):Ai(e)?pi(e):pi(Zi(e));var e}updateFormatter(t){if(!this.Ps)return;const e=t.dateFormat;this.Ps.timeScale.timeVisible?this.ad=new _u({Xc:e,Zc:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Gc:"   ",Jc:t.locale}):this.ad=new Ya(e,t.locale)}formatHorzItem(t){const e=t;return this.ad.__(new Date(1e3*e.rd))}formatTickmark(t,e){const s=function(r,o,l){switch(r){case 0:case 10:return o?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),n=this.Ps.timeScale;if(n.tickMarkFormatter!==void 0){const r=n.tickMarkFormatter(t.originalTime,s,e.locale);if(r!==null)return r}return function(r,o,l){const h={};switch(o){case 0:h.year="numeric";break;case 1:h.month="short";break;case 2:h.day="numeric";break;case 3:h.hour12=!1,h.hour="2-digit",h.minute="2-digit";break;case 4:h.hour12=!1,h.hour="2-digit",h.minute="2-digit",h.second="2-digit"}const c=r.hd===void 0?new Date(1e3*r.rd):new Date(Date.UTC(r.hd.year,r.hd.month-1,r.hd.day));return new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()).toLocaleString(l,h)}(t.time,s,e.locale)}maxTickMarkWeight(t){let e=t.reduce(bu,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(s,n=0){if(s.length===0)return;let r=n===0?null:s[n-1].time.rd,o=r!==null?new Date(1e3*r):null,l=0;for(let h=n;h<s.length;++h){const c=s[h],u=new Date(1e3*c.time.rd);o!==null&&(c.timeWeight=rr(u,o)),l+=c.time.rd-(r||c.time.rd),r=c.time.rd,o=u}if(n===0&&s.length>1){const h=Math.ceil(l/(s.length-1)),c=new Date(1e3*(s[0].time.rd-h));s[0].timeWeight=rr(new Date(1e3*s[0].time.rd),c)}})(t,e)}static ld(t){return Ht({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const Ve=typeof window<"u";function hr(){return!!Ve&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function gi(){return!!Ve&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Ii(i){return i+i%2}function ju(i){Ve&&window.chrome!==void 0&&i.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class si{constructor(t,e,s){this.od=0,this._d=null,this.ud={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.dd=0,this.fd=null,this.pd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.vd=null,this.md=!1,this.wd=null,this.gd=null,this.Md=!1,this.bd=!1,this.Sd=!1,this.xd=null,this.Cd=null,this.Pd=null,this.yd=null,this.kd=null,this.Td=null,this.Rd=null,this.Dd=0,this.Vd=!1,this.Bd=!1,this.Id=!1,this.Ed=0,this.Ad=null,this.zd=!gi(),this.Ld=n=>{this.Od(n)},this.Nd=n=>{if(this.Fd(n)){const r=this.Wd(n);if(++this.dd,this.fd&&this.dd>1){const{Hd:o}=this.Ud(ae(n),this.pd);o<30&&!this.Sd&&this.$d(r,this.Yd.qd),this.jd()}}else{const r=this.Wd(n);if(++this.od,this._d&&this.od>1){const{Hd:o}=this.Ud(ae(n),this.ud);o<5&&!this.bd&&this.Kd(r,this.Yd.Xd),this.Zd()}}},this.Gd=t,this.Yd=e,this.Ps=s,this.Jd()}m(){this.xd!==null&&(this.xd(),this.xd=null),this.Cd!==null&&(this.Cd(),this.Cd=null),this.yd!==null&&(this.yd(),this.yd=null),this.kd!==null&&(this.kd(),this.kd=null),this.Td!==null&&(this.Td(),this.Td=null),this.Pd!==null&&(this.Pd(),this.Pd=null),this.Qd(),this.Zd()}tf(t){this.yd&&this.yd();const e=this.if.bind(this);if(this.yd=()=>{this.Gd.removeEventListener("mousemove",e)},this.Gd.addEventListener("mousemove",e),this.Fd(t))return;const s=this.Wd(t);this.Kd(s,this.Yd.sf),this.zd=!0}Zd(){this._d!==null&&clearTimeout(this._d),this.od=0,this._d=null,this.ud={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}jd(){this.fd!==null&&clearTimeout(this.fd),this.dd=0,this.fd=null,this.pd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}if(t){if(this.Id||this.gd!==null||this.Fd(t))return;const e=this.Wd(t);this.Kd(e,this.Yd.nf),this.zd=!0}ef(t){const e=xi(t.changedTouches,C(this.Ad));if(e===null||(this.Ed=ws(t),this.Rd!==null)||this.Bd)return;this.Vd=!0;const s=this.Ud(ae(e),C(this.gd)),{rf:n,hf:r,Hd:o}=s;if(this.Md||!(o<5)){if(!this.Md){const l=.5*n,h=r>=l&&!this.Ps.af(),c=l>r&&!this.Ps.lf();h||c||(this.Bd=!0),this.Md=!0,this.Sd=!0,this.Qd(),this.jd()}if(!this.Bd){const l=this.Wd(t,e);this.$d(l,this.Yd._f),Te(t)}}}uf(t){if(t.button!==0)return;const e=this.Ud(ae(t),C(this.wd)),{Hd:s}=e;if(s>=5&&(this.bd=!0,this.Zd()),this.bd){const n=this.Wd(t);this.Kd(n,this.Yd.cf)}}Ud(t,e){const s=Math.abs(e._t-t._t),n=Math.abs(e.ut-t.ut);return{rf:s,hf:n,Hd:s+n}}df(t){let e=xi(t.changedTouches,C(this.Ad));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.Ad=null,this.Ed=ws(t),this.Qd(),this.gd=null,this.Td&&(this.Td(),this.Td=null);const s=this.Wd(t,e);if(this.$d(s,this.Yd.ff),++this.dd,this.fd&&this.dd>1){const{Hd:n}=this.Ud(ae(e),this.pd);n<30&&!this.Sd&&this.$d(s,this.Yd.qd),this.jd()}else this.Sd||(this.$d(s,this.Yd.pf),this.Yd.pf&&Te(t));this.dd===0&&Te(t),t.touches.length===0&&this.md&&(this.md=!1,Te(t))}Od(t){if(t.button!==0)return;const e=this.Wd(t);if(this.wd=null,this.Id=!1,this.kd&&(this.kd(),this.kd=null),hr()&&this.Gd.ownerDocument.documentElement.removeEventListener("mouseleave",this.Ld),!this.Fd(t))if(this.Kd(e,this.Yd.vf),++this.od,this._d&&this.od>1){const{Hd:s}=this.Ud(ae(t),this.ud);s<5&&!this.bd&&this.Kd(e,this.Yd.Xd),this.Zd()}else this.bd||this.Kd(e,this.Yd.mf)}Qd(){this.vd!==null&&(clearTimeout(this.vd),this.vd=null)}wf(t){if(this.Ad!==null)return;const e=t.changedTouches[0];this.Ad=e.identifier,this.Ed=ws(t);const s=this.Gd.ownerDocument.documentElement;this.Sd=!1,this.Md=!1,this.Bd=!1,this.gd=ae(e),this.Td&&(this.Td(),this.Td=null);{const r=this.ef.bind(this),o=this.df.bind(this);this.Td=()=>{s.removeEventListener("touchmove",r),s.removeEventListener("touchend",o)},s.addEventListener("touchmove",r,{passive:!1}),s.addEventListener("touchend",o,{passive:!1}),this.Qd(),this.vd=setTimeout(this.gf.bind(this,t),240)}const n=this.Wd(t,e);this.$d(n,this.Yd.Mf),this.fd||(this.dd=0,this.fd=setTimeout(this.jd.bind(this),500),this.pd=ae(e))}bf(t){if(t.button!==0)return;const e=this.Gd.ownerDocument.documentElement;hr()&&e.addEventListener("mouseleave",this.Ld),this.bd=!1,this.wd=ae(t),this.kd&&(this.kd(),this.kd=null);{const n=this.uf.bind(this),r=this.Od.bind(this);this.kd=()=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}if(this.Id=!0,this.Fd(t))return;const s=this.Wd(t);this.Kd(s,this.Yd.Sf),this._d||(this.od=0,this._d=setTimeout(this.Zd.bind(this),500),this.ud=ae(t))}Jd(){this.Gd.addEventListener("mouseenter",this.tf.bind(this)),this.Gd.addEventListener("touchcancel",this.Qd.bind(this));{const t=this.Gd.ownerDocument,e=s=>{this.Yd.xf&&(s.composed&&this.Gd.contains(s.composedPath()[0])||s.target&&this.Gd.contains(s.target)||this.Yd.xf())};this.Cd=()=>{t.removeEventListener("touchstart",e)},this.xd=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}gi()&&(this.Pd=()=>{this.Gd.removeEventListener("dblclick",this.Nd)},this.Gd.addEventListener("dblclick",this.Nd)),this.Gd.addEventListener("mouseleave",this.Cf.bind(this)),this.Gd.addEventListener("touchstart",this.wf.bind(this),{passive:!0}),ju(this.Gd),this.Gd.addEventListener("mousedown",this.bf.bind(this)),this.Pf(),this.Gd.addEventListener("touchmove",()=>{},{passive:!1})}Pf(){this.Yd.yf===void 0&&this.Yd.kf===void 0&&this.Yd.Tf===void 0||(this.Gd.addEventListener("touchstart",t=>this.Rf(t.touches),{passive:!0}),this.Gd.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.Rd!==null&&this.Yd.kf!==void 0){const e=cr(t.touches[0],t.touches[1])/this.Dd;this.Yd.kf(this.Rd,e),Te(t)}},{passive:!1}),this.Gd.addEventListener("touchend",t=>{this.Rf(t.touches)}))}Rf(t){t.length===1&&(this.Vd=!1),t.length!==2||this.Vd||this.md?this.Df():this.Vf(t)}Vf(t){const e=this.Gd.getBoundingClientRect()||{left:0,top:0};this.Rd={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Dd=cr(t[0],t[1]),this.Yd.yf!==void 0&&this.Yd.yf(),this.Qd()}Df(){this.Rd!==null&&(this.Rd=null,this.Yd.Tf!==void 0&&this.Yd.Tf())}Cf(t){if(this.yd&&this.yd(),this.Fd(t)||!this.zd)return;const e=this.Wd(t);this.Kd(e,this.Yd.Bf),this.zd=!gi()}gf(t){const e=xi(t.touches,C(this.Ad));if(e===null)return;const s=this.Wd(t,e);this.$d(s,this.Yd.If),this.Sd=!0,this.md=!0}Fd(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:ws(t)<this.Ed+500}$d(t,e){e&&e.call(this.Yd,t)}Kd(t,e){e&&e.call(this.Yd,t)}Wd(t,e){const s=e||t,n=this.Gd.getBoundingClientRect()||{left:0,top:0};return{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,screenX:s.screenX,screenY:s.screenY,localX:s.clientX-n.left,localY:s.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Ef:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Af:t.type,zf:s.target,a_:t.view,Lf:()=>{t.type!=="touchstart"&&Te(t)}}}}function cr(i,t){const e=i.clientX-t.clientX,s=i.clientY-t.clientY;return Math.sqrt(e*e+s*s)}function Te(i){i.cancelable&&i.preventDefault()}function ae(i){return{_t:i.pageX,ut:i.pageY}}function ws(i){return i.timeStamp||performance.now()}function xi(i,t){for(let e=0;e<i.length;++e)if(i[e].identifier===t)return i[e];return null}class Cu{constructor(t,e,s){this.Of=null,this.Nf=null,this.Ff=!0,this.Wf=null,this.Hf=t,this.Uf=t.$f()[e],this.qf=t.$f()[s],this.Yf=document.createElement("tr"),this.Yf.style.height="1px",this.jf=document.createElement("td"),this.jf.style.position="relative",this.jf.style.padding="0",this.jf.style.margin="0",this.jf.setAttribute("colspan","3"),this.Kf(),this.Yf.appendChild(this.jf),this.Ff=this.Hf.N().layout.panes.enableResize,this.Ff?this.Xf():(this.Of=null,this.Nf=null)}m(){this.Nf!==null&&this.Nf.m()}Zf(){return this.Yf}Gf(){return dt({width:this.Uf.Gf().width,height:1})}Jf(){return dt({width:this.Uf.Jf().width,height:1*window.devicePixelRatio})}Qf(t,e,s){const n=this.Jf();t.fillStyle=this.Hf.N().layout.panes.separatorColor,t.fillRect(e,s,n.width,n.height)}yt(){this.Kf(),this.Hf.N().layout.panes.enableResize!==this.Ff&&(this.Ff=this.Hf.N().layout.panes.enableResize,this.Ff?this.Xf():(this.Of!==null&&(this.jf.removeChild(this.Of.tp),this.jf.removeChild(this.Of.ip),this.Of=null),this.Nf!==null&&(this.Nf.m(),this.Nf=null)))}Xf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.jf.appendChild(t);const s=document.createElement("div"),n=s.style;n.position="absolute",n.zIndex="50",n.top="-4px",n.height="9px",n.width="100%",n.backgroundColor="",n.cursor="row-resize",this.jf.appendChild(s);const r={sf:this.sp.bind(this),Bf:this.np.bind(this),Sf:this.ep.bind(this),Mf:this.ep.bind(this),cf:this.rp.bind(this),_f:this.rp.bind(this),vf:this.hp.bind(this),ff:this.hp.bind(this)};this.Nf=new si(s,r,{af:()=>!1,lf:()=>!0}),this.Of={ip:s,tp:t}}Kf(){this.jf.style.background=this.Hf.N().layout.panes.separatorColor}sp(t){this.Of!==null&&(this.Of.ip.style.backgroundColor=this.Hf.N().layout.panes.separatorHoverColor)}np(t){this.Of!==null&&this.Wf===null&&(this.Of.ip.style.backgroundColor="")}ep(t){if(this.Of===null)return;const e=this.Uf.ap().Bo()+this.qf.ap().Bo(),s=e/(this.Uf.Gf().height+this.qf.Gf().height),n=30*s;e<=2*n||(this.Wf={lp:t.pageY,op:this.Uf.ap().Bo(),_p:e-n,up:e,cp:s,dp:n},this.Of.tp.style.display="block")}rp(t){const e=this.Wf;if(e===null)return;const s=(t.pageY-e.lp)*e.cp,n=Ze(e.op+s,e.dp,e._p);this.Uf.ap().Io(n),this.qf.ap().Io(e.up-n),this.Hf.Qt().Ih()}hp(t){this.Wf!==null&&this.Of!==null&&(this.Wf=null,this.Of.tp.style.display="none")}}function bi(i,t){return i.fp-t.fp}function vi(i,t,e){const s=(i.fp-t.fp)/(i.wt-t.wt);return Math.sign(s)*Math.min(Math.abs(s),e)}class Mu{constructor(t,e,s,n){this.pp=null,this.vp=null,this.mp=null,this.wp=null,this.gp=null,this.Mp=0,this.bp=0,this.Sp=t,this.xp=e,this.Cp=s,this.Mn=n}Pp(t,e){if(this.pp!==null){if(this.pp.wt===e)return void(this.pp.fp=t);if(Math.abs(this.pp.fp-t)<this.Mn)return}this.wp=this.mp,this.mp=this.vp,this.vp=this.pp,this.pp={wt:e,fp:t}}le(t,e){if(this.pp===null||this.vp===null||e-this.pp.wt>50)return;let s=0;const n=vi(this.pp,this.vp,this.xp),r=bi(this.pp,this.vp),o=[n],l=[r];if(s+=r,this.mp!==null){const c=vi(this.vp,this.mp,this.xp);if(Math.sign(c)===Math.sign(n)){const u=bi(this.vp,this.mp);if(o.push(c),l.push(u),s+=u,this.wp!==null){const d=vi(this.mp,this.wp,this.xp);if(Math.sign(d)===Math.sign(n)){const f=bi(this.mp,this.wp);o.push(d),l.push(f),s+=f}}}}let h=0;for(let c=0;c<o.length;++c)h+=l[c]/s*o[c];Math.abs(h)<this.Sp||(this.gp={fp:t,wt:e},this.bp=h,this.Mp=function(c,u){const d=Math.log(u);return Math.log(1*d/-c)/d}(Math.abs(h),this.Cp))}Du(t){const e=C(this.gp),s=t-e.wt;return e.fp+this.bp*(Math.pow(this.Cp,s)-1)/Math.log(this.Cp)}Ru(t){return this.gp===null||this.yp(t)===this.Mp}yp(t){const e=t-C(this.gp).wt;return Math.min(e,this.Mp)}}class Pu{constructor(t,e){this.kp=void 0,this.Tp=void 0,this.Rp=void 0,this.ps=!1,this.Dp=t,this.Vp=e,this.Bp()}yt(){this.Bp()}Ip(){this.kp&&this.Dp.removeChild(this.kp),this.Tp&&this.Dp.removeChild(this.Tp),this.kp=void 0,this.Tp=void 0}Ep(){return this.ps!==this.Ap()||this.Rp!==this.zp()}zp(){return this.Vp.Qt().Xi().J(this.Vp.N().layout.textColor)>160?"dark":"light"}Ap(){return this.Vp.N().layout.attributionLogo}Lp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Bp(){this.Ep()&&(this.Ip(),this.ps=this.Ap(),this.ps&&(this.Rp=this.zp(),this.Tp=document.createElement("style"),this.Tp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.kp=document.createElement("a"),this.kp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.Lp()}`,this.kp.title="Charting by TradingView",this.kp.id="tv-attr-logo",this.kp.target="_blank",this.kp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.kp.toggleAttribute("data-dark",this.Rp==="dark"),this.Dp.appendChild(this.Tp),this.Dp.appendChild(this.kp)))}}function Pe(i,t){const e=C(i.ownerDocument).createElement("canvas");i.appendChild(e);const s=fc(e,{options:{allowResizeObserver:!0},transform:(n,r)=>({width:Math.max(n.width,r.width),height:Math.max(n.height,r.height)})});return s.resizeCanvasElement(t),s}function ke(i){var t;i.width=1,i.height=1,(t=i.getContext("2d"))==null||t.clearRect(0,0,1,1)}function zi(i,t,e,s){i.ih&&i.ih(t,e,s)}function Es(i,t,e,s){i.nt(t,e,s)}function Bi(i,t,e,s){const n=i(e,s);for(const r of n){const o=r.Tt(s);o!==null&&t(o)}}function yi(i,t){return e=>{var s,n;return function(r){return r.Ft!==void 0}(e)?(((s=e.Ft())==null?void 0:s.ma())??"")!==t?[]:((n=e.ta)==null?void 0:n.call(e,i))??[]:[]}}function ur(i,t,e,s){if(!i.length)return;let n=0;const r=i[0].$t(s,!0);let o=t===1?e/2-(i[0].Fi()-r/2):i[0].Fi()-r/2-e/2;o=Math.max(0,o);for(let l=1;l<i.length;l++){const h=i[l],c=i[l-1],u=c.$t(s,!1),d=h.Fi(),f=c.Fi();if(t===1?d>f-u:d<f+u){const p=f-u*t;h.Wi(p);const m=p-t*u/2;if((t===1?m<0:m>e)&&o>0){const b=t===1?-1-m:m-e,g=Math.min(b,o);for(let S=n;S<i.length;S++)i[S].Wi(i[S].Fi()+t*g);o-=g}}else n=l,o=t===1?f-u-d:d-(f+u)}}class dr{constructor(t,e,s,n){this.Yi=null,this.Op=null,this.Np=!1,this.Fp=new as(200),this.Wp=null,this.Hp=0,this.Up=!1,this.$p=()=>{this.Up||this.Pt.qp().Qt().ar()},this.Yp=()=>{this.Up||this.Pt.qp().Qt().ar()},this.Pt=t,this.Ps=e,this.Ml=e.layout,this.Ju=s,this.jp=n==="left",this.Kp=yi("normal",n),this.Xp=yi("top",n),this.Zp=yi("bottom",n),this.jf=document.createElement("div"),this.jf.style.height="100%",this.jf.style.overflow="hidden",this.jf.style.width="25px",this.jf.style.left="0",this.jf.style.position="relative",this.Gp=Pe(this.jf,dt({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.$p);const r=this.Gp.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Jp=Pe(this.jf,dt({width:16,height:16})),this.Jp.subscribeSuggestedBitmapSizeChanged(this.Yp);const o=this.Jp.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const l={Sf:this.ep.bind(this),Mf:this.ep.bind(this),cf:this.rp.bind(this),_f:this.rp.bind(this),xf:this.Qp.bind(this),vf:this.hp.bind(this),ff:this.hp.bind(this),Xd:this.tv.bind(this),qd:this.tv.bind(this),sf:this.iv.bind(this),Bf:this.np.bind(this)};this.Nf=new si(this.Jp.canvasElement,l,{af:()=>!this.Ps.handleScroll.vertTouchDrag,lf:()=>!0})}m(){this.Nf.m(),this.Jp.unsubscribeSuggestedBitmapSizeChanged(this.Yp),ke(this.Jp.canvasElement),this.Jp.dispose(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.$p),ke(this.Gp.canvasElement),this.Gp.dispose(),this.Yi!==null&&this.Yi.so().u(this),this.Yi=null}Zf(){return this.jf}P(){return this.Ml.fontSize}sv(){const t=this.Ju.N();return this.Wp!==t.k&&(this.Fp.Bn(),this.Wp=t.k),t}nv(){if(this.Yi===null)return 0;let t=0;const e=this.sv(),s=C(this.Gp.canvasElement.getContext("2d",{colorSpace:this.Pt.qp().N().layout.colorSpace}));s.save();const n=this.Yi.Da();s.font=this.ev(),n.length>0&&(t=Math.max(this.Fp.Vi(s,n[0].Za),this.Fp.Vi(s,n[n.length-1].Za)));const r=this.rv();for(let c=r.length;c--;){const u=this.Fp.Vi(s,r[c].ri());u>t&&(t=u)}const o=this.Yi.zt();if(o!==null&&this.Op!==null&&(l=this.Ps.crosshair).mode!==2&&l.horzLine.visible&&l.horzLine.labelVisible){const c=this.Yi.Ts(1,o),u=this.Yi.Ts(this.Op.height-2,o);t=Math.max(t,this.Fp.Vi(s,this.Yi.Zi(Math.floor(Math.min(c,u))+.11111111111111,o)),this.Fp.Vi(s,this.Yi.Zi(Math.ceil(Math.max(c,u))-.11111111111111,o)))}var l;s.restore();const h=t||34;return Ii(Math.ceil(e.S+e.C+e.B+e.I+5+h))}hv(t){this.Op!==null&&Ne(this.Op,t)||(this.Op=t,this.Up=!0,this.Gp.resizeCanvasElement(t),this.Jp.resizeCanvasElement(t),this.Up=!1,this.jf.style.width=`${t.width}px`,this.jf.style.height=`${t.height}px`)}av(){return C(this.Op).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.so().u(this),this.Yi=t,t.so().i(this._l.bind(this),this))}Ft(){return this.Yi}Bn(){const t=this.Pt.ap();this.Pt.qp().Qt().Zo(t,C(this.Ft()))}lv(t){if(this.Op===null)return;const e={colorSpace:this.Pt.qp().N().layout.colorSpace};if(t!==1){this.ov(),this.Gp.applySuggestedBitmapSize();const n=je(this.Gp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this._v(r),this.uv(r)}),this.Pt.cv(n,this.Zp),this.dv(n),this.Pt.cv(n,this.Kp),this.fv(n))}this.Jp.applySuggestedBitmapSize();const s=je(this.Jp,e);s!==null&&(s.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.pv(s),this.Pt.cv(s,this.Xp))}Jf(){return this.Gp.bitmapSize}Qf(t,e,s,n){const r=this.Jf();if(r.width>0&&r.height>0&&(t.drawImage(this.Gp.canvasElement,e,s),n)){const o=this.Jp.canvasElement;t.drawImage(o,e,s)}}yt(){var t;(t=this.Yi)==null||t.Da()}ep(t){if(this.Yi===null||this.Yi.Ki()||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.qp().Qt(),s=this.Pt.ap();this.Np=!0,e.Uo(s,this.Yi,t.localY)}rp(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.qp().Qt(),s=this.Pt.ap(),n=this.Yi;e.$o(s,n,t.localY)}Qp(){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.qp().Qt(),e=this.Pt.ap(),s=this.Yi;this.Np&&(this.Np=!1,t.qo(e,s))}hp(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.qp().Qt(),s=this.Pt.ap();this.Np=!1,e.qo(s,this.Yi)}tv(t){this.Ps.handleScale.axisDoubleClickReset.price&&this.Bn()}iv(t){this.Yi!==null&&(!this.Pt.qp().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Dl()||this.vv(1))}np(t){this.vv(0)}rv(){const t=[],e=this.Yi===null?void 0:this.Yi;return(s=>{for(let n=0;n<s.length;++n){const r=s[n].Ws(this.Pt.ap(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.Pt.ap().Dt()),t}_v({context:t,bitmapSize:e}){const{width:s,height:n}=e,r=this.Pt.ap().Qt(),o=r.$(),l=r.Wc();o===l?Gs(t,0,0,s,n,o):Ra(t,0,0,s,n,o,l)}uv({context:t,bitmapSize:e,horizontalPixelRatio:s}){if(this.Op===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const n=Math.max(1,Math.floor(this.sv().S*s));let r;r=this.jp?e.width-n:0,t.fillRect(r,0,n,e.height)}dv(t){if(this.Op===null||this.Yi===null)return;const e=this.Yi.Da(),s=this.Yi.N(),n=this.sv(),r=this.jp?this.Op.width-n.C:0;s.borderVisible&&s.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:l,verticalPixelRatio:h})=>{o.fillStyle=s.borderColor;const c=Math.max(1,Math.floor(h)),u=Math.floor(.5*h),d=Math.round(n.C*l);o.beginPath();for(const f of e)o.rect(Math.floor(r*l),Math.round(f.Pa*h)-u,d,c);o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{o.font=this.ev(),o.fillStyle=s.textColor??this.Ml.textColor,o.textAlign=this.jp?"right":"left",o.textBaseline="middle";const l=this.jp?Math.round(r-n.B):Math.round(r+n.C+n.B),h=e.map(c=>this.Fp.Di(o,c.Za));for(let c=e.length;c--;){const u=e[c];o.fillText(u.Za,l,u.Pa+h[c])}})}ov(){if(this.Op===null||this.Yi===null)return;let t=this.Op.height/2;const e=[],s=this.Yi.Dt().slice(),n=this.Pt.ap(),r=this.sv();this.Yi===n.$n()&&this.Pt.ap().Dt().forEach(h=>{n.Un(h)&&s.push(h)});const o=this.Yi.Ma()[0],l=this.Yi;s.forEach(h=>{const c=h.Ws(n,l);c.forEach(u=>{u.Wi(null),u.Hi()&&e.push(u)}),o===h&&c.length>0&&(t=c[0].Ii())}),e.forEach(h=>h.Wi(h.Ii())),this.Yi.N().alignLabels&&this.mv(e,r,t)}mv(t,e,s){if(this.Op===null)return;const n=t.filter(o=>o.Ii()<=s),r=t.filter(o=>o.Ii()>s);n.sort((o,l)=>l.Ii()-o.Ii()),n.length&&r.length&&r.push(n[0]),r.sort((o,l)=>o.Ii()-l.Ii());for(const o of t){const l=Math.floor(o.$t(e)/2),h=o.Ii();h>-l&&h<l&&o.Wi(l),h>this.Op.height-l&&h<this.Op.height+l&&o.Wi(this.Op.height-l)}ur(n,1,this.Op.height,e),ur(r,-1,this.Op.height,e)}fv(t){if(this.Op===null)return;const e=this.rv(),s=this.sv(),n=this.jp?"right":"left";e.forEach(r=>{r.Ui()&&r.Tt(C(this.Yi)).nt(t,s,this.Fp,n)})}pv(t){if(this.Op===null||this.Yi===null)return;const e=this.Pt.qp().Qt(),s=[],n=this.Pt.ap(),r=e.uc().Ws(n,this.Yi);r.length&&s.push(r);const o=this.sv(),l=this.jp?"right":"left";s.forEach(h=>{h.forEach(c=>{c.Tt(C(this.Yi)).nt(t,o,this.Fp,l)})})}vv(t){this.jf.style.cursor=t===1?"ns-resize":"default"}_l(){const t=this.nv();this.Hp<t&&this.Pt.qp().Qt().Ih(),this.Hp=t}ev(){return rs(this.Ml.fontSize,this.Ml.fontFamily)}}function ku(i,t){var e;return((e=i.Jh)==null?void 0:e.call(i,t))??[]}function fr(i,t){var e;return((e=i.Fs)==null?void 0:e.call(i,t))??[]}function mr(i,t){var e;return((e=i.us)==null?void 0:e.call(i,t))??[]}function Eu(i,t){var e;return((e=i.Xh)==null?void 0:e.call(i,t))??[]}class Xi{constructor(t,e){this.Op=dt({width:0,height:0}),this.wv=null,this.gv=null,this.Mv=null,this.bv=null,this.Sv=!1,this.xv=new Nt,this.Cv=new Nt,this.Pv=0,this.yv=!1,this.kv=null,this.Tv=!1,this.Rv=null,this.Dv=null,this.Up=!1,this.$p=()=>{this.Up||this.Vv===null||this.ts().ar()},this.Yp=()=>{this.Up||this.Vv===null||this.ts().ar()},this.Vp=t,this.Vv=e,this.Vv.t_().i(this.Bv.bind(this),this,!0),this.Iv=document.createElement("td"),this.Iv.style.padding="0",this.Iv.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.Ev=document.createElement("td"),this.Ev.style.padding="0",this.Av=document.createElement("td"),this.Av.style.padding="0",this.Iv.appendChild(s),this.Gp=Pe(s,dt({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.$p);const n=this.Gp.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Jp=Pe(s,dt({width:16,height:16})),this.Jp.subscribeSuggestedBitmapSizeChanged(this.Yp);const r=this.Jp.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Yf=document.createElement("tr"),this.Yf.appendChild(this.Ev),this.Yf.appendChild(this.Iv),this.Yf.appendChild(this.Av),this.zv(),this.Nf=new si(this.Jp.canvasElement,this,{af:()=>this.kv===null&&!this.Vp.N().handleScroll.vertTouchDrag,lf:()=>this.kv===null&&!this.Vp.N().handleScroll.horzTouchDrag})}m(){this.wv!==null&&this.wv.m(),this.gv!==null&&this.gv.m(),this.Mv=null,this.Jp.unsubscribeSuggestedBitmapSizeChanged(this.Yp),ke(this.Jp.canvasElement),this.Jp.dispose(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.$p),ke(this.Gp.canvasElement),this.Gp.dispose(),this.Vv!==null&&(this.Vv.t_().u(this),this.Vv.m()),this.Nf.m()}ap(){return C(this.Vv)}Lv(t){var e;this.Vv!==null&&this.Vv.t_().u(this),this.Vv=t,this.Vv!==null&&this.Vv.t_().i(Xi.prototype.Bv.bind(this),this,!0),this.zv(),this.Vp.$f().indexOf(this)===this.Vp.$f().length-1?(this.Mv=this.Mv??new Pu(this.Iv,this.Vp),this.Mv.yt()):((e=this.Mv)==null||e.Ip(),this.Mv=null)}qp(){return this.Vp}Zf(){return this.Yf}zv(){if(this.Vv!==null&&(this.Ov(),this.ts().js().length!==0)){if(this.wv!==null){const t=this.Vv.Wo();this.wv._s(C(t))}if(this.gv!==null){const t=this.Vv.Ho();this.gv._s(C(t))}}}Nv(){this.wv!==null&&this.wv.yt(),this.gv!==null&&this.gv.yt()}Bo(){return this.Vv!==null?this.Vv.Bo():0}Io(t){this.Vv&&this.Vv.Io(t)}sf(t){if(!this.Vv)return;this.Fv();const e=t.localX,s=t.localY;this.Wv(e,s,t)}Sf(t){this.Fv(),this.Hv(),this.Wv(t.localX,t.localY,t)}nf(t){if(!this.Vv)return;this.Fv();const e=t.localX,s=t.localY;this.Wv(e,s,t)}mf(t){this.Vv!==null&&(this.Fv(),this.Uv(t))}Xd(t){this.Vv!==null&&this.$v(this.Cv,t)}qd(t){this.Xd(t)}cf(t){this.Fv(),this.qv(t),this.Wv(t.localX,t.localY,t)}vf(t){this.Vv!==null&&(this.Fv(),this.yv=!1,this.Yv(t))}pf(t){this.Vv!==null&&this.Uv(t)}If(t){if(this.yv=!0,this.kv===null){const e={x:t.localX,y:t.localY};this.jv(e,e,t)}}Bf(t){this.Vv!==null&&(this.Fv(),this.Vv.Qt().lc(null),this.Kv())}Xv(){return this.xv}Zv(){return this.Cv}yf(){this.Pv=1,this.ts().hn()}kf(t,e){if(!this.Vp.N().handleScale.pinch)return;const s=5*(e-this.Pv);this.Pv=e,this.ts().bc(t._t,s)}Mf(t){this.yv=!1,this.Tv=this.kv!==null,this.Hv();const e=this.ts().uc();this.kv!==null&&e.Vt()&&(this.Rv={x:e.si(),y:e.ni()},this.kv={x:t.localX,y:t.localY})}_f(t){if(this.Vv===null)return;const e=t.localX,s=t.localY;if(this.kv===null)this.qv(t);else{this.Tv=!1;const n=C(this.Rv),r=n.x+(e-this.kv.x),o=n.y+(s-this.kv.y);this.Wv(r,o,t)}}ff(t){this.qp().N().trackingMode.exitMode===0&&(this.Tv=!0),this.Gv(),this.Yv(t)}jn(t,e){const s=this.Vv;return s===null?null:Va(s,t,e)}Jv(t,e){C(e==="left"?this.wv:this.gv).hv(dt({width:t,height:this.Op.height}))}Gf(){return this.Op}hv(t){Ne(this.Op,t)||(this.Op=t,this.Up=!0,this.Gp.resizeCanvasElement(t),this.Jp.resizeCanvasElement(t),this.Up=!1,this.Iv.style.width=t.width+"px",this.Iv.style.height=t.height+"px")}Qv(){const t=C(this.Vv);t.Fo(t.Wo()),t.Fo(t.Ho());for(const e of t.Ma())if(t.Un(e)){const s=e.Ft();s!==null&&t.Fo(s),e.Ns()}for(const e of t.s_())e.Ns()}Jf(){return this.Gp.bitmapSize}Qf(t,e,s,n){const r=this.Jf();if(r.width>0&&r.height>0&&(t.drawImage(this.Gp.canvasElement,e,s),n)){const o=this.Jp.canvasElement;t!==null&&t.drawImage(o,e,s)}}lv(t){if(t===0||this.Vv===null)return;t>1&&this.Qv(),this.wv!==null&&this.wv.lv(t),this.gv!==null&&this.gv.lv(t);const e={colorSpace:this.Vp.N().layout.colorSpace};if(t!==1){this.Gp.applySuggestedBitmapSize();const n=je(this.Gp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this._v(r)}),this.Vv&&(this.tm(n,ku),this.im(n),this.tm(n,fr),this.tm(n,mr)))}this.Jp.applySuggestedBitmapSize();const s=je(this.Jp,e);s!==null&&(s.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.sm(s),this.tm(s,Eu),this.tm(s,mr))}nm(){return this.wv}rm(){return this.gv}cv(t,e){this.tm(t,e)}Bv(){this.Vv!==null&&this.Vv.t_().u(this),this.Vv=null}Uv(t){this.$v(this.xv,t)}$v(t,e){const s=e.localX,n=e.localY;t.v()&&t.p(this.ts().Et().cu(s),{x:s,y:n},e)}_v({context:t,bitmapSize:e}){const{width:s,height:n}=e,r=this.ts(),o=r.$(),l=r.Wc();o===l?Gs(t,0,0,s,n,l):Ra(t,0,0,s,n,o,l)}im(t){const e=C(this.Vv),s=e.i_().lr().Tt(e);s!==null&&s.nt(t,!1)}sm(t){this.hm(t,fr,Es,this.ts().uc())}tm(t,e){const s=C(this.Vv),n=s.Dt(),r=s.s_();for(const o of r)this.hm(t,e,zi,o);for(const o of n)this.hm(t,e,zi,o);for(const o of r)this.hm(t,e,Es,o);for(const o of n)this.hm(t,e,Es,o)}hm(t,e,s,n){const r=C(this.Vv),o=r.Qt().ac(),l=o!==null&&o.n_===n,h=o!==null&&l&&o.e_!==void 0?o.e_.Xn:void 0;Bi(e,c=>s(c,t,l,h),n,r)}Ov(){if(this.Vv===null)return;const t=this.Vp,e=this.Vv.Wo().N().visible,s=this.Vv.Ho().N().visible;e||this.wv===null||(this.Ev.removeChild(this.wv.Zf()),this.wv.m(),this.wv=null),s||this.gv===null||(this.Av.removeChild(this.gv.Zf()),this.gv.m(),this.gv=null);const n=t.Qt().Bc();e&&this.wv===null&&(this.wv=new dr(this,t.N(),n,"left"),this.Ev.appendChild(this.wv.Zf())),s&&this.gv===null&&(this.gv=new dr(this,t.N(),n,"right"),this.Av.appendChild(this.gv.Zf()))}am(t){return t.Ef&&this.yv||this.kv!==null}lm(t){return Math.max(0,Math.min(t,this.Op.width-1))}om(t){return Math.max(0,Math.min(t,this.Op.height-1))}Wv(t,e,s){this.ts().Tc(this.lm(t),this.om(e),s,C(this.Vv))}Kv(){this.ts().Dc()}Gv(){this.Tv&&(this.kv=null,this.Kv())}jv(t,e,s){this.kv=t,this.Tv=!1,this.Wv(e.x,e.y,s);const n=this.ts().uc();this.Rv={x:n.si(),y:n.ni()}}ts(){return this.Vp.Qt()}Yv(t){if(!this.Sv)return;const e=this.ts(),s=this.ap();if(e.Ko(s,s.ks()),this.bv=null,this.Sv=!1,e.Pc(),this.Dv!==null){const n=performance.now(),r=e.Et();this.Dv.le(r.gu(),n),this.Dv.Ru(n)||e._n(this.Dv)}}Fv(){this.kv=null}Hv(){if(this.Vv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)C(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Vv.ks().Ki()&&this.ts().Et().Ki()}}qv(t){if(this.Vv===null)return;const e=this.ts(),s=e.Et();if(s.Ki())return;const n=this.Vp.N(),r=n.handleScroll,o=n.kineticScroll;if((!r.pressedMouseMove||t.Ef)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Ef))return;const l=this.Vv.ks(),h=performance.now();if(this.bv!==null||this.am(t)||(this.bv={x:t.clientX,y:t.clientY,rd:h,_m:t.localX,um:t.localY}),this.bv!==null&&!this.Sv&&(this.bv.x!==t.clientX||this.bv.y!==t.clientY)){if(t.Ef&&o.touch||!t.Ef&&o.mouse){const c=s.mu();this.Dv=new Mu(.2/c,7/c,.997,15/c),this.Dv.Pp(s.gu(),this.bv.rd)}else this.Dv=null;l.Ki()||e.Yo(this.Vv,l,t.localY),e.xc(t.localX),this.Sv=!0}this.Sv&&(l.Ki()||e.jo(this.Vv,l,t.localY),e.Cc(t.localX),this.Dv!==null&&this.Dv.Pp(s.gu(),h))}}class pr{constructor(t,e,s,n,r){this.xt=!0,this.Op=dt({width:0,height:0}),this.$p=()=>this.lv(3),this.jp=t==="left",this.Ju=s.Bc,this.Ps=e,this.dm=n,this.fm=r,this.jf=document.createElement("div"),this.jf.style.width="25px",this.jf.style.height="100%",this.jf.style.overflow="hidden",this.Gp=Pe(this.jf,dt({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.$p)}m(){this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.$p),ke(this.Gp.canvasElement),this.Gp.dispose()}Zf(){return this.jf}Gf(){return this.Op}hv(t){Ne(this.Op,t)||(this.Op=t,this.Gp.resizeCanvasElement(t),this.jf.style.width=`${t.width}px`,this.jf.style.height=`${t.height}px`,this.xt=!0)}lv(t){if(t<3&&!this.xt||this.Op.width===0||this.Op.height===0)return;this.xt=!1,this.Gp.applySuggestedBitmapSize();const e=je(this.Gp,{colorSpace:this.Ps.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace(s=>{this._v(s),this.uv(s)})}Jf(){return this.Gp.bitmapSize}Qf(t,e,s){const n=this.Jf();n.width>0&&n.height>0&&t.drawImage(this.Gp.canvasElement,e,s)}uv({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(!this.dm())return;t.fillStyle=this.Ps.timeScale.borderColor;const r=Math.floor(this.Ju.N().S*s),o=Math.floor(this.Ju.N().S*n),l=this.jp?e.width-r:0;t.fillRect(l,0,r,o)}_v({context:t,bitmapSize:e}){Gs(t,0,0,e.width,e.height,this.fm())}}function tn(i){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,i))??[]}}const Ru=tn("normal"),Ou=tn("top"),Tu=tn("bottom");class Fu{constructor(t,e){this.pm=null,this.vm=null,this.M=null,this.wm=!1,this.Op=dt({width:0,height:0}),this.gm=new Nt,this.Fp=new as(5),this.Up=!1,this.$p=()=>{this.Up||this.Vp.Qt().ar()},this.Yp=()=>{this.Up||this.Vp.Qt().ar()},this.Vp=t,this.o_=e,this.Ps=t.N().layout,this.kp=document.createElement("tr"),this.Mm=document.createElement("td"),this.Mm.style.padding="0",this.bm=document.createElement("td"),this.bm.style.padding="0",this.jf=document.createElement("td"),this.jf.style.height="25px",this.jf.style.padding="0",this.Sm=document.createElement("div"),this.Sm.style.width="100%",this.Sm.style.height="100%",this.Sm.style.position="relative",this.Sm.style.overflow="hidden",this.jf.appendChild(this.Sm),this.Gp=Pe(this.Sm,dt({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.$p);const s=this.Gp.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Jp=Pe(this.Sm,dt({width:16,height:16})),this.Jp.subscribeSuggestedBitmapSizeChanged(this.Yp);const n=this.Jp.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.kp.appendChild(this.Mm),this.kp.appendChild(this.jf),this.kp.appendChild(this.bm),this.xm(),this.Vp.Qt().Vo().i(this.xm.bind(this),this),this.Nf=new si(this.Jp.canvasElement,this,{af:()=>!0,lf:()=>!this.Vp.N().handleScroll.horzTouchDrag})}m(){this.Nf.m(),this.pm!==null&&this.pm.m(),this.vm!==null&&this.vm.m(),this.Jp.unsubscribeSuggestedBitmapSizeChanged(this.Yp),ke(this.Jp.canvasElement),this.Jp.dispose(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.$p),ke(this.Gp.canvasElement),this.Gp.dispose()}Zf(){return this.kp}Cm(){return this.pm}Pm(){return this.vm}Sf(t){if(this.wm)return;this.wm=!0;const e=this.Vp.Qt();!e.Et().Ki()&&this.Vp.N().handleScale.axisPressedMouseMove.time&&e.Mc(t.localX)}Mf(t){this.Sf(t)}xf(){const t=this.Vp.Qt();!t.Et().Ki()&&this.wm&&(this.wm=!1,this.Vp.N().handleScale.axisPressedMouseMove.time&&t.kc())}cf(t){const e=this.Vp.Qt();!e.Et().Ki()&&this.Vp.N().handleScale.axisPressedMouseMove.time&&e.yc(t.localX)}_f(t){this.cf(t)}vf(){this.wm=!1;const t=this.Vp.Qt();t.Et().Ki()&&!this.Vp.N().handleScale.axisPressedMouseMove.time||t.kc()}ff(){this.vf()}Xd(){this.Vp.N().handleScale.axisDoubleClickReset.time&&this.Vp.Qt().cn()}qd(){this.Xd()}sf(){this.Vp.Qt().N().handleScale.axisPressedMouseMove.time&&this.vv(1)}Bf(){this.vv(0)}Gf(){return this.Op}ym(){return this.gm}km(t,e,s){Ne(this.Op,t)||(this.Op=t,this.Up=!0,this.Gp.resizeCanvasElement(t),this.Jp.resizeCanvasElement(t),this.Up=!1,this.jf.style.width=`${t.width}px`,this.jf.style.height=`${t.height}px`,this.gm.p(t)),this.pm!==null&&this.pm.hv(dt({width:e,height:t.height})),this.vm!==null&&this.vm.hv(dt({width:s,height:t.height}))}Tm(){const t=this.Rm();return Math.ceil(t.S+t.C+t.P+t.A+t.V+t.Dm)}yt(){this.Vp.Qt().Et().Da()}Jf(){return this.Gp.bitmapSize}Qf(t,e,s,n){const r=this.Jf();if(r.width>0&&r.height>0&&(t.drawImage(this.Gp.canvasElement,e,s),n)){const o=this.Jp.canvasElement;t.drawImage(o,e,s)}}lv(t){if(t===0)return;const e={colorSpace:this.Ps.colorSpace};if(t!==1){this.Gp.applySuggestedBitmapSize();const n=je(this.Gp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this._v(r),this.uv(r),this.Vm(n,Tu)}),this.dv(n),this.Vm(n,Ru)),this.pm!==null&&this.pm.lv(t),this.vm!==null&&this.vm.lv(t)}this.Jp.applySuggestedBitmapSize();const s=je(this.Jp,e);s!==null&&(s.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.Bm([...this.Vp.Qt().js(),this.Vp.Qt().uc()],s),this.Vm(s,Ou))}Vm(t,e){const s=this.Vp.Qt().js();for(const n of s)Bi(e,r=>zi(r,t,!1,void 0),n,void 0);for(const n of s)Bi(e,r=>Es(r,t,!1,void 0),n,void 0)}_v({context:t,bitmapSize:e}){Gs(t,0,0,e.width,e.height,this.Vp.Qt().Wc())}uv({context:t,bitmapSize:e,verticalPixelRatio:s}){if(this.Vp.N().timeScale.borderVisible){t.fillStyle=this.Im();const n=Math.max(1,Math.floor(this.Rm().S*s));t.fillRect(0,0,e.width,n)}}dv(t){const e=this.Vp.Qt().Et(),s=e.Da();if(!s||s.length===0)return;const n=this.o_.maxTickMarkWeight(s),r=this.Rm(),o=e.N();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:h,verticalPixelRatio:c})=>{l.strokeStyle=this.Im(),l.fillStyle=this.Im();const u=Math.max(1,Math.floor(h)),d=Math.floor(.5*h);l.beginPath();const f=Math.round(r.C*c);for(let p=s.length;p--;){const m=Math.round(s[p].coord*h);l.rect(m-d,0,u,f)}l.fill()}),t.useMediaCoordinateSpace(({context:l})=>{const h=r.S+r.C+r.A+r.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.H(),l.font=this.ev();for(const c of s)if(c.weight<n){const u=c.needAlignCoordinate?this.Em(l,c.coord,c.label):c.coord;l.fillText(c.label,u,h)}this.Vp.N().timeScale.allowBoldLabels&&(l.font=this.Am());for(const c of s)if(c.weight>=n){const u=c.needAlignCoordinate?this.Em(l,c.coord,c.label):c.coord;l.fillText(c.label,u,h)}})}Em(t,e,s){const n=this.Fp.Vi(t,s),r=n/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+n>this.Op.width&&(e-=Math.abs(this.Op.width-(o+n))),e}Bm(t,e){const s=this.Rm();for(const n of t)for(const r of n.cs())r.Tt().nt(e,s)}Im(){return this.Vp.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}ev(){return rs(this.F(),this.Ps.fontFamily)}Am(){return rs(this.F(),this.Ps.fontFamily,"bold")}Rm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,P:NaN,k:"",Gi:new as,Dm:0});const t=this.M,e=this.ev();if(t.k!==e){const s=this.F();t.P=s,t.k=e,t.A=3*s/12,t.V=3*s/12,t.Ji=9*s/12,t.L=0,t.Dm=4*s/12,t.Gi.Bn()}return this.M}vv(t){this.jf.style.cursor=t===1?"ew-resize":"default"}xm(){const t=this.Vp.Qt(),e=t.N();e.leftPriceScale.visible||this.pm===null||(this.Mm.removeChild(this.pm.Zf()),this.pm.m(),this.pm=null),e.rightPriceScale.visible||this.vm===null||(this.bm.removeChild(this.vm.Zf()),this.vm.m(),this.vm=null);const s={Bc:this.Vp.Qt().Bc()},n=()=>e.leftPriceScale.borderVisible&&t.Et().N().borderVisible,r=()=>t.Wc();e.leftPriceScale.visible&&this.pm===null&&(this.pm=new pr("left",e,s,n,r),this.Mm.appendChild(this.pm.Zf())),e.rightPriceScale.visible&&this.vm===null&&(this.vm=new pr("right",e,s,n,r),this.bm.appendChild(this.vm.Zf()))}}var Dr;const Lu=!!Ve&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(i=>i.brand.includes("Chromium"))&&!!Ve&&((Dr=navigator==null?void 0:navigator.userAgentData)!=null&&Dr.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Du{constructor(t,e,s){var n;this.zm=[],this.Lm=[],this.Om=0,this.il=0,this.Mo=0,this.Nm=0,this.Fm=0,this.Wm=null,this.Hm=!1,this.xv=new Nt,this.Cv=new Nt,this.Xu=new Nt,this.Um=null,this.$m=null,this.Dp=t,this.Ps=e,this.o_=s,this.kp=document.createElement("div"),this.kp.classList.add("tv-lightweight-charts"),this.kp.style.overflow="hidden",this.kp.style.direction="ltr",this.kp.style.width="100%",this.kp.style.height="100%",(n=this.kp).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.qm=document.createElement("table"),this.qm.setAttribute("cellspacing","0"),this.kp.appendChild(this.qm),this.Ym=this.jm.bind(this),wi(this.Ps)&&this.Km(!0),this.ts=new yu(this.Gu.bind(this),this.Ps,s),this.Qt().cc().i(this.Xm.bind(this),this),this.Zm=new Fu(this,this.o_),this.qm.appendChild(this.Zm.Zf());const r=e.autoSize&&this.Gm();let o=this.Ps.width,l=this.Ps.height;if(r||o===0||l===0){const h=t.getBoundingClientRect();o=o||h.width,l=l||h.height}this.Jm(o,l),this.Qm(),t.appendChild(this.kp),this.tw(),this.ts.Et().Iu().i(this.ts.Ih.bind(this.ts),this),this.ts.Vo().i(this.ts.Ih.bind(this.ts),this)}Qt(){return this.ts}N(){return this.Ps}$f(){return this.zm}iw(){return this.Zm}m(){this.Km(!1),this.Om!==0&&window.cancelAnimationFrame(this.Om),this.ts.cc().u(this),this.ts.Et().Iu().u(this),this.ts.Vo().u(this),this.ts.m();for(const t of this.zm)this.qm.removeChild(t.Zf()),t.Xv().u(this),t.Zv().u(this),t.m();this.zm=[];for(const t of this.Lm)this.sw(t);this.Lm=[],C(this.Zm).m(),this.kp.parentElement!==null&&this.kp.parentElement.removeChild(this.kp),this.Xu.m(),this.xv.m(),this.Cv.m(),this.nw()}Jm(t,e,s=!1){if(this.il===e&&this.Mo===t)return;const n=function(l){const h=Math.floor(l.width),c=Math.floor(l.height);return dt({width:h-h%2,height:c-c%2})}(dt({width:t,height:e}));this.il=n.height,this.Mo=n.width;const r=this.il+"px",o=this.Mo+"px";C(this.kp).style.height=r,C(this.kp).style.width=o,this.qm.style.height=r,this.qm.style.width=o,s?this.ew(Tt.gn(),performance.now()):this.ts.Ih()}lv(t){t===void 0&&(t=Tt.gn());for(let e=0;e<this.zm.length;e++)this.zm[e].lv(t.en(e).tn);this.Ps.timeScale.visible&&this.Zm.lv(t.nn())}hr(t){var n;const e=wi(this.Ps);this.ts.hr(t);const s=wi(this.Ps);s!==e&&this.Km(s),(n=t.layout)!=null&&n.panes&&this.rw(),this.tw(),this.hw(t)}Xv(){return this.xv}Zv(){return this.Cv}cc(){return this.Xu}aw(t=!1){this.Wm!==null&&(this.ew(this.Wm,performance.now()),this.Wm=null);const e=this.lw(null),s=document.createElement("canvas");s.width=e.width,s.height=e.height;const n=C(s.getContext("2d"));return this.lw(n,t),s}ow(t){return t==="left"&&!this._w()||t==="right"&&!this.uw()||this.zm.length===0?0:C(t==="left"?this.zm[0].nm():this.zm[0].rm()).av()}cw(){return this.Ps.autoSize&&this.Um!==null}ip(){return this.kp}dw(t){this.$m=t,this.$m?this.ip().style.setProperty("cursor",t):this.ip().style.removeProperty("cursor")}fw(){return this.$m}pw(t){return Yt(this.zm[t]).Gf()}rw(){this.Lm.forEach(t=>{t.yt()})}hw(t){(t.autoSize!==void 0||!this.Um||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Um&&this.Gm(),t.autoSize===!1&&this.Um!==null&&this.nw(),t.autoSize||t.width===void 0&&t.height===void 0||this.Jm(t.width||this.Mo,t.height||this.il))}lw(t,e){let s=0,n=0;const r=this.zm[0],o=(h,c)=>{let u=0;for(let d=0;d<this.zm.length;d++){const f=this.zm[d],p=C(h==="left"?f.nm():f.rm()),m=p.Jf();if(t!==null&&p.Qf(t,c,u,e),u+=m.height,d<this.zm.length-1){const b=this.Lm[d],g=b.Jf();t!==null&&b.Qf(t,c,u),u+=g.height}}};this._w()&&(o("left",0),s+=C(r.nm()).Jf().width);for(let h=0;h<this.zm.length;h++){const c=this.zm[h],u=c.Jf();if(t!==null&&c.Qf(t,s,n,e),n+=u.height,h<this.zm.length-1){const d=this.Lm[h],f=d.Jf();t!==null&&d.Qf(t,s,n),n+=f.height}}s+=r.Jf().width,this.uw()&&(o("right",s),s+=C(r.rm()).Jf().width);const l=(h,c,u)=>{C(h==="left"?this.Zm.Cm():this.Zm.Pm()).Qf(C(t),c,u)};if(this.Ps.timeScale.visible){const h=this.Zm.Jf();if(t!==null){let c=0;this._w()&&(l("left",c,n),c=C(r.nm()).Jf().width),this.Zm.Qf(t,c,n,e),c+=h.width,this.uw()&&l("right",c,n)}n+=h.height}return dt({width:s,height:n})}mw(){let t=0,e=0,s=0;for(const g of this.zm)this._w()&&(e=Math.max(e,C(g.nm()).nv(),this.Ps.leftPriceScale.minimumWidth)),this.uw()&&(s=Math.max(s,C(g.rm()).nv(),this.Ps.rightPriceScale.minimumWidth)),t+=g.Bo();e=Ii(e),s=Ii(s);const n=this.Mo,r=this.il,o=Math.max(n-e-s,0),l=1*this.Lm.length,h=this.Ps.timeScale.visible;let c=h?Math.max(this.Zm.Tm(),this.Ps.timeScale.minimumHeight):0;var u;c=(u=c)+u%2;const d=l+c,f=r<d?0:r-d,p=f/t;let m=0;const b=window.devicePixelRatio||1;for(let g=0;g<this.zm.length;++g){const S=this.zm[g];S.Lv(this.ts.$s()[g]);let j=0,N=0;N=g===this.zm.length-1?Math.ceil((f-m)*b)/b:Math.round(S.Bo()*p*b)/b,j=Math.max(N,2),m+=j,S.hv(dt({width:o,height:j})),this._w()&&S.Jv(e,"left"),this.uw()&&S.Jv(s,"right"),S.ap()&&this.ts.dc(S.ap(),j)}this.Zm.km(dt({width:h?o:0,height:c}),h?e:0,h?s:0),this.ts.Eo(o),this.Nm!==e&&(this.Nm=e),this.Fm!==s&&(this.Fm=s)}Km(t){t?this.kp.addEventListener("wheel",this.Ym,{passive:!1}):this.kp.removeEventListener("wheel",this.Ym)}ww(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Lu?1/window.devicePixelRatio:1}jm(t){if(!(t.deltaX!==0&&this.Ps.handleScroll.mouseWheel||t.deltaY!==0&&this.Ps.handleScale.mouseWheel))return;const e=this.ww(t),s=e*t.deltaX/100,n=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),n!==0&&this.Ps.handleScale.mouseWheel){const r=Math.sign(n)*Math.min(1,Math.abs(n)),o=t.clientX-this.kp.getBoundingClientRect().left;this.Qt().bc(o,r)}s!==0&&this.Ps.handleScroll.mouseWheel&&this.Qt().Sc(-80*s)}ew(t,e){var n;const s=t.nn();s===3&&this.gw(),s!==3&&s!==2||(this.Mw(t),this.bw(t,e),this.Zm.yt(),this.zm.forEach(r=>{r.Nv()}),((n=this.Wm)==null?void 0:n.nn())===3&&(this.Wm.vn(t),this.gw(),this.Mw(this.Wm),this.bw(this.Wm,e),t=this.Wm,this.Wm=null)),this.lv(t)}bw(t,e){for(const s of t.pn())this.mn(s,e)}Mw(t){const e=this.ts.$s();for(let s=0;s<e.length;s++)t.en(s).sn&&e[s].Go()}mn(t,e){const s=this.ts.Et();switch(t.an){case 0:s.Au();break;case 1:s.zu(t.Wt);break;case 2:s.dn(t.Wt);break;case 3:s.fn(t.Wt);break;case 4:s.Su();break;case 5:t.Wt.Ru(e)||s.fn(t.Wt.Du(e))}}Gu(t){this.Wm!==null?this.Wm.vn(t):this.Wm=t,this.Hm||(this.Hm=!0,this.Om=window.requestAnimationFrame(e=>{if(this.Hm=!1,this.Om=0,this.Wm!==null){const s=this.Wm;this.Wm=null,this.ew(s,e);for(const n of s.pn())if(n.an===5&&!n.Wt.Ru(e)){this.Qt()._n(n.Wt);break}}}))}gw(){this.Qm()}sw(t){this.qm.removeChild(t.Zf()),t.m()}Qm(){const t=this.ts.$s(),e=t.length,s=this.zm.length;for(let n=e;n<s;n++){const r=Yt(this.zm.pop());this.qm.removeChild(r.Zf()),r.Xv().u(this),r.Zv().u(this),r.m();const o=this.Lm.pop();o!==void 0&&this.sw(o)}for(let n=s;n<e;n++){const r=new Xi(this,t[n]);if(r.Xv().i(this.Sw.bind(this,r),this),r.Zv().i(this.xw.bind(this,r),this),this.zm.push(r),n>0){const o=new Cu(this,n-1,n);this.Lm.push(o),this.qm.insertBefore(o.Zf(),this.Zm.Zf())}this.qm.insertBefore(r.Zf(),this.Zm.Zf())}for(let n=0;n<e;n++){const r=t[n],o=this.zm[n];o.ap()!==r?o.Lv(r):o.zv()}this.tw(),this.mw()}Cw(t,e,s,n){var d;const r=new Map;t!==null&&this.ts.js().forEach(f=>{const p=f.Xs().Fr(t);p!==null&&r.set(f,p)});let o;if(t!==null){const f=(d=this.ts.Et().ss(t))==null?void 0:d.originalTime;f!==void 0&&(o=f)}const l=this.Qt().ac(),h=l!==null&&l.n_ instanceof ei?l.n_:void 0,c=l!==null&&l.e_!==void 0?l.e_.Kn:void 0,u=this.Pw(n);return{yw:o,Re:t??void 0,kw:e??void 0,Tw:u!==-1?u:void 0,Rw:h,Dw:r,Vw:c,Bw:s??void 0}}Pw(t){let e=-1;if(t)e=this.zm.indexOf(t);else{const s=this.Qt().uc().Us();s!==null&&(e=this.Qt().$s().indexOf(s))}return e}Sw(t,e,s,n){this.xv.p(()=>this.Cw(e,s,n,t))}xw(t,e,s,n){this.Cv.p(()=>this.Cw(e,s,n,t))}Xm(t,e,s){var n;this.dw(((n=this.Qt().ac())==null?void 0:n.h_)??null),this.Xu.p(()=>this.Cw(t,e,s))}tw(){const t=this.Ps.timeScale.visible?"":"none";this.Zm.Zf().style.display=t}_w(){return this.zm[0].ap().Wo().N().visible}uw(){return this.zm[0].ap().Ho().N().visible}Gm(){return"ResizeObserver"in window&&(this.Um=new ResizeObserver(t=>{const e=t[t.length-1];e&&this.Jm(e.contentRect.width,e.contentRect.height)}),this.Um.observe(this.Dp,{box:"border-box"}),!0)}nw(){this.Um!==null&&this.Um.disconnect(),this.Um=null}}function wi(i){return!!(i.handleScroll.mouseWheel||i.handleScale.mouseWheel)}function Au(i){return i.open===void 0&&i.value===void 0}function Iu(i){return function(t){return t.open!==void 0}(i)||function(t){return t.value!==void 0}(i)}function gr(i,t,e,s){const n=e.value,r={Re:t,wt:i,Wt:[n,n,n,n],yw:s};return e.color!==void 0&&(r.R=e.color),r}function zu(i,t,e,s){const n=e.value,r={Re:t,wt:i,Wt:[n,n,n,n],yw:s};return e.lineColor!==void 0&&(r.vt=e.lineColor),e.topColor!==void 0&&(r.mr=e.topColor),e.bottomColor!==void 0&&(r.wr=e.bottomColor),r}function Bu(i,t,e,s){const n=e.value,r={Re:t,wt:i,Wt:[n,n,n,n],yw:s};return e.topLineColor!==void 0&&(r.gr=e.topLineColor),e.bottomLineColor!==void 0&&(r.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(r.br=e.topFillColor1),e.topFillColor2!==void 0&&(r.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.Pr=e.bottomFillColor2),r}function $u(i,t,e,s){const n={Re:t,wt:i,Wt:[e.open,e.high,e.low,e.close],yw:s};return e.color!==void 0&&(n.R=e.color),n}function Vu(i,t,e,s){const n={Re:t,wt:i,Wt:[e.open,e.high,e.low,e.close],yw:s};return e.color!==void 0&&(n.R=e.color),e.borderColor!==void 0&&(n.Ht=e.borderColor),e.wickColor!==void 0&&(n.vr=e.wickColor),n}function Uu(i,t,e,s,n){const r=Yt(n)(e),o=Math.max(...r),l=Math.min(...r),h=r[r.length-1],c=[h,o,l,h],{time:u,color:d,...f}=e;return{Re:t,wt:i,Wt:c,yw:s,se:f,R:d}}function Ke(i){return i.Wt!==void 0}function xr(i,t){return t.customValues!==void 0&&(i.Iw=t.customValues),i}function be(i){return(t,e,s,n,r,o)=>function(l,h){return h?h(l):Au(l)}(s,o)?xr({wt:t,Re:e,yw:n},s):xr(i(t,e,s,n,r),s)}function br(i){return{Candlestick:be(Vu),Bar:be($u),Area:be(zu),Baseline:be(Bu),Histogram:be(gr),Line:be(gr),Custom:be(Uu)}[i]}function vr(i){return{Re:0,Ew:new Map,Hh:i}}function yr(i,t){if(i!==void 0&&i.length!==0)return{Aw:t.key(i[0].wt),zw:t.key(i[i.length-1].wt)}}function wr(i){let t;return i.forEach(e=>{t===void 0&&(t=e.yw)}),Yt(t)}class qu{constructor(t){this.Lw=new Map,this.Ow=new Map,this.Nw=new Map,this.Fw=[],this.o_=t}m(){this.Lw.clear(),this.Ow.clear(),this.Nw.clear(),this.Fw=[]}Ww(t,e){let s=this.Lw.size!==0,n=!1;const r=this.Ow.get(t);if(r!==void 0)if(this.Ow.size===1)s=!1,n=!0,this.Lw.clear();else for(const h of this.Fw)h.pointData.Ew.delete(t)&&(n=!0);let o=[];if(e.length!==0){const h=e.map(p=>p.time),c=this.o_.createConverterToInternalObj(e),u=br(t.Rr()),d=t.ca(),f=t.fa();o=e.map((p,m)=>{const b=c(p.time),g=this.o_.key(b);let S=this.Lw.get(g);S===void 0&&(S=vr(b),this.Lw.set(g,S),n=!0);const j=u(b,S.Re,p,h[m],d,f);return S.Ew.set(t,j),j})}s&&this.Hw(),this.Uw(t,o);let l=-1;if(n){const h=[];this.Lw.forEach(c=>{h.push({timeWeight:0,time:c.Hh,pointData:c,originalTime:wr(c.Ew)})}),h.sort((c,u)=>this.o_.key(c.time)-this.o_.key(u.time)),l=this.$w(h)}return this.qw(t,l,function(h,c,u){const d=yr(h,u),f=yr(c,u);if(d!==void 0&&f!==void 0)return{Yw:!1,zh:d.zw>=f.zw&&d.Aw>=f.Aw}}(this.Ow.get(t),r,this.o_))}Ac(t){return this.Ww(t,[])}jw(t,e,s){const n=e;(function(g){g.yw===void 0&&(g.yw=g.time)})(n),this.o_.preprocessData(e);const r=this.o_.createConverterToInternalObj([e])(e.time),o=this.Nw.get(t);if(!s&&o!==void 0&&this.o_.key(r)<this.o_.key(o))throw new Error(`Cannot update oldest data, last time=${o}, new time=${r}`);let l=this.Lw.get(this.o_.key(r));if(s&&l===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const h=l===void 0;l===void 0&&(l=vr(r),this.Lw.set(this.o_.key(r),l));const c=br(t.Rr()),u=t.ca(),d=t.fa(),f=c(r,l.Re,e,n.yw,u,d);l.Ew.set(t,f),s?this.Kw(t,f,l.Re):this.Xw(t,f);const p={zh:Ke(f),Yw:s};if(!h)return this.qw(t,-1,p);const m={timeWeight:0,time:l.Hh,pointData:l,originalTime:wr(l.Ew)},b=$e(this.Fw,this.o_.key(m.time),(g,S)=>this.o_.key(g.time)<S);this.Fw.splice(b,0,m);for(let g=b;g<this.Fw.length;++g)Ns(this.Fw[g].pointData,g);return this.o_.fillWeightsForPoints(this.Fw,b),this.qw(t,b,p)}Zw(t,e){const s=this.Ow.get(t);if(s===void 0||e<=0)return[[],this.Gw()];e=Math.min(e,s.length);const n=s.splice(-e).reverse();s.length===0?this.Nw.delete(t):this.Nw.set(t,s[s.length-1].wt);for(const r of n){const o=this.Lw.get(this.o_.key(r.wt));if(o&&(o.Ew.delete(t),o.Ew.size===0)){this.Lw.delete(this.o_.key(o.Hh)),this.Fw.splice(o.Re,1);for(let l=o.Re;l<this.Fw.length;++l)Ns(this.Fw[l].pointData,l)}}return[n,this.qw(t,this.Fw.length-1,{Yw:!1,zh:!1})]}Xw(t,e){let s=this.Ow.get(t);s===void 0&&(s=[],this.Ow.set(t,s));const n=s.length!==0?s[s.length-1]:null;n===null||this.o_.key(e.wt)>this.o_.key(n.wt)?Ke(e)&&s.push(e):Ke(e)?s[s.length-1]=e:s.splice(-1,1),this.Nw.set(t,e.wt)}Kw(t,e,s){const n=this.Ow.get(t);if(n===void 0)return;const r=$e(n,s,(o,l)=>o.Re<l);Ke(e)?n[r]=e:n.splice(r,1)}Uw(t,e){e.length!==0?(this.Ow.set(t,e.filter(Ke)),this.Nw.set(t,e[e.length-1].wt)):(this.Ow.delete(t),this.Nw.delete(t))}Hw(){for(const t of this.Fw)t.pointData.Ew.size===0&&this.Lw.delete(this.o_.key(t.time))}$w(t){let e=-1;for(let s=0;s<this.Fw.length&&s<t.length;++s){const n=this.Fw[s],r=t[s];if(this.o_.key(n.time)!==this.o_.key(r.time)){e=s;break}r.timeWeight=n.timeWeight,Ns(r.pointData,s)}if(e===-1&&this.Fw.length!==t.length&&(e=Math.min(this.Fw.length,t.length)),e===-1)return-1;for(let s=e;s<t.length;++s)Ns(t[s].pointData,s);return this.o_.fillWeightsForPoints(t,e),this.Fw=t,e}Jw(){if(this.Ow.size===0)return null;let t=0;return this.Ow.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))}),t}qw(t,e,s){const n=this.Gw();if(e!==-1)this.Ow.forEach((r,o)=>{n.Oo.set(o,{se:r,Qw:o===t?s:void 0})}),this.Ow.has(t)||n.Oo.set(t,{se:[],Qw:s}),n.Et.tg=this.Fw,n.Et.ig=e;else{const r=this.Ow.get(t);n.Oo.set(t,{se:r||[],Qw:s})}return n}Gw(){return{Oo:new Map,Et:{_u:this.Jw()}}}}function Ns(i,t){i.Re=t,i.Ew.forEach(e=>{e.Re=t})}function Yu(i,t){return i.wt<t}function Qu(i,t){return t<i.wt}function Qa(i,t,e){const s=t.Uh(),n=t.bi(),r=$e(i,s,Yu),o=Ia(i,n,Qu);if(!e)return{from:r,to:o};let l=r,h=o;return r>0&&r<i.length&&i[r].wt>=s&&(l=r-1),o>0&&o<i.length&&i[o-1].wt<=n&&(h=o+1),{from:l,to:h}}class en{constructor(t,e,s){this.sg=!0,this.ng=!0,this.eg=!0,this.rg=[],this.hg=null,this.Jn=t,this.Qn=e,this.ag=s}yt(t){this.sg=!0,t==="data"&&(this.ng=!0),t==="options"&&(this.eg=!0)}Tt(){return this.Jn.Vt()?(this.lg(),this.hg===null?null:this.og):null}_g(){this.rg=this.rg.map(t=>({...t,...this.Jn.Rh().Dr(t.wt)}))}ug(){this.hg=null}lg(){this.ng&&(this.cg(),this.ng=!1),this.eg&&(this._g(),this.eg=!1),this.sg&&(this.dg(),this.sg=!1)}dg(){const t=this.Jn.Ft(),e=this.Qn.Et();if(this.ug(),e.Ki()||t.Ki())return;const s=e.Pe();if(s===null||this.Jn.Xs().zr()===0)return;const n=this.Jn.zt();n!==null&&(this.hg=Qa(this.rg,s,this.ag),this.fg(t,e,n.Wt),this.pg())}}class Wu{constructor(t,e){this.vg=t,this.Yi=e}nt(t,e,s){this.vg.draw(t,this.Yi,e,s)}}class Hu extends en{constructor(t,e,s){super(t,e,!1),this.sh=s,this.og=new Wu(this.sh.renderer(),n=>{const r=t.zt();return r===null?null:t.Ft().Nt(n,r.Wt)})}da(t){return this.sh.priceValueBuilder(t)}pa(t){return this.sh.isWhitespace(t)}cg(){const t=this.Jn.Rh();this.rg=this.Jn.Xs().Hr().map(e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),mg:e.se}))}fg(t,e){e.uu(this.rg,ns(this.hg))}pg(){this.sh.update({bars:this.rg.map(Ju),barSpacing:this.Qn.Et().mu(),visibleRange:this.hg},this.Jn.N())}}function Ju(i){return{x:i._t,time:i.wt,originalData:i.mg,barColor:i.cr}}const Ku={color:"#2196f3"},Gu=(i,t,e)=>{const s=pe(e);return new Hu(i,t,s)};function sn(i){const t={value:i.Wt[3],time:i.yw};return i.Iw!==void 0&&(t.customValues=i.Iw),t}function Nr(i){const t=sn(i);return i.R!==void 0&&(t.color=i.R),t}function Zu(i){const t=sn(i);return i.vt!==void 0&&(t.lineColor=i.vt),i.mr!==void 0&&(t.topColor=i.mr),i.wr!==void 0&&(t.bottomColor=i.wr),t}function Xu(i){const t=sn(i);return i.gr!==void 0&&(t.topLineColor=i.gr),i.Mr!==void 0&&(t.bottomLineColor=i.Mr),i.br!==void 0&&(t.topFillColor1=i.br),i.Sr!==void 0&&(t.topFillColor2=i.Sr),i.Cr!==void 0&&(t.bottomFillColor1=i.Cr),i.Pr!==void 0&&(t.bottomFillColor2=i.Pr),t}function Wa(i){const t={open:i.Wt[0],high:i.Wt[1],low:i.Wt[2],close:i.Wt[3],time:i.yw};return i.Iw!==void 0&&(t.customValues=i.Iw),t}function td(i){const t=Wa(i);return i.R!==void 0&&(t.color=i.R),t}function ed(i){const t=Wa(i),{R:e,Ht:s,vr:n}=i;return e!==void 0&&(t.color=e),s!==void 0&&(t.borderColor=s),n!==void 0&&(t.wickColor=n),t}function Rs(i){return{Area:Zu,Line:Nr,Baseline:Xu,Histogram:Nr,Bar:td,Candlestick:ed,Custom:sd}[i]}function sd(i){const t=i.yw;return{...i.se,time:t}}const id={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},nd={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},rd={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:Ea,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},Ni={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},ad={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Sr(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:rd,crosshair:id,grid:nd,overlayPriceScales:{...Ni},leftPriceScale:{...Ni,visible:!1},rightPriceScale:{...Ni,visible:!0},timeScale:ad,localization:{locale:Ve?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class Ha{constructor(t,e,s){this.Hf=t,this.wg=e,this.gg=s??0}applyOptions(t){this.Hf.Qt().oc(this.wg,t,this.gg)}options(){return this.Yi().N()}width(){return Xs(this.wg)?this.Hf.ow(this.wg):0}setVisibleRange(t){this.setAutoScale(!1),this.Yi().Fl(new It(t.from,t.to))}getVisibleRange(){let t,e,s=this.Yi().Qe();if(s===null)return null;if(this.Yi().Ja()){const n=this.Yi().fo(),r=Ua(n);s=Le(s,this.Yi().tl()),t=Number((Math.round(s.$e()/n)*n).toFixed(r)),e=Number((Math.round(s.qe()/n)*n).toFixed(r))}else t=s.$e(),e=s.qe();return{from:t,to:e}}setAutoScale(t){this.applyOptions({autoScale:t})}Yi(){return C(this.Hf.Qt()._c(this.wg,this.gg)).Ft}}class od{constructor(t,e,s,n){this.Hf=t,this.Pt=s,this.Mg=e,this.bg=n}getHeight(){return this.Pt.$t()}setHeight(t){const e=this.Hf.Qt(),s=e.Uc(this.Pt);e.vc(s,t)}getStretchFactor(){return this.Pt.Bo()}setStretchFactor(t){this.Pt.Io(t),this.Hf.Qt().Ih()}paneIndex(){return this.Hf.Qt().Uc(this.Pt)}moveTo(t){const e=this.paneIndex();e!==t&&(Lt(t>=0&&t<this.Hf.$f().length,"Invalid pane index"),this.Hf.Qt().wc(e,t))}getSeries(){return this.Pt.Oo().map(t=>this.Mg(t))??[]}getHTMLElement(){const t=this.Hf.$f();return t&&t.length!==0&&t[this.paneIndex()]?t[this.paneIndex()].Zf():null}attachPrimitive(t){this.Pt._a(t),t.attached&&t.attached({chart:this.bg,requestUpdate:()=>this.Pt.Qt().Ih()})}detachPrimitive(t){this.Pt.ua(t)}priceScale(t){if(this.Pt.Do(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new Ha(this.Hf,t,this.paneIndex())}setPreserveEmptyPane(t){this.Pt.zo(t)}preserveEmptyPane(){return this.Pt.Lo()}addCustomSeries(t,e={},s=0){return this.bg.addCustomSeries(t,e,s)}addSeries(t,e={}){return this.bg.addSeries(t,e,this.paneIndex())}}const ld={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class _r{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}Sg(){return this.ir}}class hd{constructor(t,e,s,n,r,o){this.xg=new Nt,this.Jn=t,this.Cg=e,this.Pg=s,this.o_=r,this.bg=n,this.yg=o}m(){this.xg.m()}priceFormatter(){return this.Jn.ea()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Nt(t,e.Wt)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Ts(t,e.Wt)}barsInLogicalRange(t){if(t===null)return null;const e=new ze(new Ie(t.from,t.to)).y_(),s=this.Jn.Xs();if(s.Ki())return null;const n=s.Fr(e.Uh(),1),r=s.Fr(e.bi(),-1),o=C(s.Lr()),l=C(s.Ks());if(n!==null&&r!==null&&n.Re>r.Re)return{barsBefore:t.from-o,barsAfter:l-t.to};const h={barsBefore:n===null||n.Re===o?t.from-o:n.Re-o,barsAfter:r===null||r.Re===l?l-t.to:l-r.Re};return n!==null&&r!==null&&(h.from=n.yw,h.to=r.yw),h}setData(t){this.o_,this.Jn.Rr(),this.Cg.kg(this.Jn,t),this.Tg("full")}update(t,e=!1){this.Jn.Rr(),this.Cg.Rg(this.Jn,t,e),this.Tg("update")}pop(t=1){const e=this.Cg.Dg(this.Jn,t);e.length!==0&&this.Tg("update");const s=Rs(this.seriesType());return e.map(n=>s(n))}dataByIndex(t,e){const s=this.Jn.Xs().Fr(t,e);return s===null?null:Rs(this.seriesType())(s)}data(){const t=Rs(this.seriesType());return this.Jn.Xs().Hr().map(e=>t(e))}subscribeDataChanged(t){this.xg.i(t)}unsubscribeDataChanged(t){this.xg._(t)}applyOptions(t){this.Jn.hr(t)}options(){return he(this.Jn.N())}priceScale(){return this.Pg.priceScale(this.Jn.Ft().ma(),this.getPane().paneIndex())}createPriceLine(t){const e=Ht(he(ld),t),s=this.Jn.Oh(e);return new _r(s)}removePriceLine(t){this.Jn.Nh(t.Sg())}priceLines(){return this.Jn.Fh().map(t=>new _r(t))}seriesType(){return this.Jn.Rr()}lastValueData(t){const e=this.Jn.ye(t);return e.ke?{noData:!0}:{noData:!1,price:e.gt,color:e.R}}attachPrimitive(t){this.Jn._a(t),t.attached&&t.attached({chart:this.bg,series:this,requestUpdate:()=>this.Jn.Qt().Ih(),horzScaleBehavior:this.o_})}detachPrimitive(t){this.Jn.ua(t),t.detached&&t.detached(),this.Jn.Qt().Ih()}getPane(){const t=this.Jn,e=C(this.Jn.Qt().Hn(t));return this.yg(e)}moveToPane(t){this.Jn.Qt().Nc(this.Jn,t)}seriesOrder(){const t=this.Jn.Qt().Hn(this.Jn);return t===null?-1:t.Oo().indexOf(this.Jn)}setSeriesOrder(t){const e=this.Jn.Qt().Hn(this.Jn);e!==null&&e.Qo(this.Jn,t)}Tg(t){this.xg.v()&&this.xg.p(t)}}class cd{constructor(t,e,s){this.Vg=new Nt,this.z_=new Nt,this.gm=new Nt,this.ts=t,this.uh=t.Et(),this.Zm=e,this.uh.Vu().i(this.Bg.bind(this)),this.uh.Bu().i(this.Ig.bind(this)),this.Zm.ym().i(this.Eg.bind(this)),this.o_=s}m(){this.uh.Vu().u(this),this.uh.Bu().u(this),this.Zm.ym().u(this),this.Vg.m(),this.z_.m(),this.gm.m()}scrollPosition(){return this.uh.gu()}scrollToPosition(t,e){e?this.uh.Tu(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.ku()}getVisibleRange(){const t=this.uh.nu();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.o_.convertHorzItemToInternal(t.from),to:this.o_.convertHorzItemToInternal(t.to)},s=this.uh.au(e);this.ts.Lc(s)}getVisibleLogicalRange(){const t=this.uh.su();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){Lt(t.from<=t.to,"The from index cannot be after the to index."),this.ts.Lc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.Au()}logicalToCoordinate(t){const e=this.ts.Et();return e.Ki()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Ki()?null:this.uh.cu(t)}timeToIndex(t,e){const s=this.o_.convertHorzItemToInternal(t);return this.uh.Q_(s,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.Et(),s=e.cu(t),n=e.ss(s);return n===null?null:n.originalTime}width(){return this.Zm.Gf().width}height(){return this.Zm.Gf().height}subscribeVisibleTimeRangeChange(t){this.Vg.i(t)}unsubscribeVisibleTimeRangeChange(t){this.Vg._(t)}subscribeVisibleLogicalRangeChange(t){this.z_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.z_._(t)}subscribeSizeChange(t){this.gm.i(t)}unsubscribeSizeChange(t){this.gm._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...he(this.uh.N()),barSpacing:this.uh.mu()}}Bg(){this.Vg.v()&&this.Vg.p(this.getVisibleRange())}Ig(){this.z_.v()&&this.z_.p(this.getVisibleLogicalRange())}Eg(t){this.gm.p(t.width,t.height)}}function jr(i){return function(t){if(ps(t.handleScale)){const s=t.handleScale;t.handleScale={axisDoubleClickReset:{time:s,price:s},axisPressedMouseMove:{time:s,price:s},mouseWheel:s,pinch:s}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:s,axisDoubleClickReset:n}=t.handleScale;ps(s)&&(t.handleScale.axisPressedMouseMove={time:s,price:s}),ps(n)&&(t.handleScale.axisDoubleClickReset={time:n,price:n})}const e=t.handleScroll;ps(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(i),i}class ud{constructor(t,e,s){this.Ag=new Map,this.zg=new Map,this.Lg=new Nt,this.Og=new Nt,this.Ng=new Nt,this.qu=new WeakMap,this.Fg=new qu(e);const n=s===void 0?he(Sr()):Ht(he(Sr()),jr(s));this.Wg=e,this.Hf=new Du(t,n,e),this.Hf.Xv().i(o=>{this.Lg.v()&&this.Lg.p(this.Hg(o()))},this),this.Hf.Zv().i(o=>{this.Og.v()&&this.Og.p(this.Hg(o()))},this),this.Hf.cc().i(o=>{this.Ng.v()&&this.Ng.p(this.Hg(o()))},this);const r=this.Hf.Qt();this.Ug=new cd(r,this.Hf.iw(),this.Wg)}remove(){this.Hf.Xv().u(this),this.Hf.Zv().u(this),this.Hf.cc().u(this),this.Ug.m(),this.Hf.m(),this.Ag.clear(),this.zg.clear(),this.Lg.m(),this.Og.m(),this.Ng.m(),this.Fg.m()}resize(t,e,s){this.autoSizeActive()||this.Hf.Jm(t,e,s)}addCustomSeries(t,e={},s=0){const n=(r=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...Ku,...r.defaultOptions()},$g:Gu,qg:r}))(pe(t));return this.Yg(n,e,s)}addSeries(t,e={},s=0){return this.Yg(t,e,s)}removeSeries(t){const e=Yt(this.Ag.get(t)),s=this.Fg.Ac(e);this.Hf.Qt().Ac(e),this.jg(s),this.Ag.delete(t),this.zg.delete(e)}kg(t,e){this.jg(this.Fg.Ww(t,e))}Rg(t,e,s){this.jg(this.Fg.jw(t,e,s))}Dg(t,e){const[s,n]=this.Fg.Zw(t,e);return s.length!==0&&this.jg(n),s}subscribeClick(t){this.Lg.i(t)}unsubscribeClick(t){this.Lg._(t)}subscribeCrosshairMove(t){this.Ng.i(t)}unsubscribeCrosshairMove(t){this.Ng._(t)}subscribeDblClick(t){this.Og.i(t)}unsubscribeDblClick(t){this.Og._(t)}priceScale(t,e=0){return new Ha(this.Hf,t,e)}timeScale(){return this.Ug}applyOptions(t){this.Hf.hr(jr(t))}options(){return this.Hf.N()}takeScreenshot(t=!1,e=!1){let s,n;try{e||(s=this.Hf.Qt().N().crosshair.mode,this.Hf.hr({crosshair:{mode:2}})),n=this.Hf.aw(t)}finally{e||s===void 0||this.Hf.Qt().hr({crosshair:{mode:s}})}return n}addPane(t=!1){const e=this.Hf.Qt().$c();return e.zo(t),this.Kg(e)}removePane(t){this.Hf.Qt().fc(t)}swapPanes(t,e){this.Hf.Qt().mc(t,e)}autoSizeActive(){return this.Hf.cw()}chartElement(){return this.Hf.ip()}panes(){return this.Hf.Qt().$s().map(t=>this.Kg(t))}paneSize(t=0){const e=this.Hf.pw(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,s){const n=this.Ag.get(s);if(n===void 0)return;const r=this.Hf.Qt().Hn(n);r!==null&&this.Hf.Qt().Rc(t,e,r)}clearCrosshairPosition(){this.Hf.Qt().Dc(!0)}horzBehaviour(){return this.Wg}Yg(t,e={},s=0){Lt(t.$g!==void 0),function(h){if(h===void 0||h.type==="custom")return;const c=h;c.minMove!==void 0&&c.precision===void 0&&(c.precision=Ua(c.minMove))}(e.priceFormat),t.type==="Candlestick"&&function(h){h.borderColor!==void 0&&(h.borderUpColor=h.borderColor,h.borderDownColor=h.borderColor),h.wickColor!==void 0&&(h.wickUpColor=h.wickColor,h.wickDownColor=h.wickColor)}(e);const n=Ht(he(Pa),he(t.defaultOptions),e),r=t.$g,o=new ei(this.Hf.Qt(),t.type,n,r,t.qg);this.Hf.Qt().Ic(o,s);const l=new hd(o,this,this,this,this.Wg,h=>this.Kg(h));return this.Ag.set(l,o),this.zg.set(o,l),l}jg(t){const e=this.Hf.Qt();e.Vc(t.Et._u,t.Et.tg,t.Et.ig),t.Oo.forEach((s,n)=>n.ht(s.se,s.Qw)),e.Et().K_(),e.vu()}Xg(t){return Yt(this.zg.get(t))}Hg(t){const e=new Map;t.Dw.forEach((n,r)=>{const o=r.Rr(),l=Rs(o)(n);if(o!=="Custom")Lt(Iu(l));else{const h=r.fa();Lt(!h||h(l)===!1)}e.set(this.Xg(r),l)});const s=t.Rw!==void 0&&this.zg.has(t.Rw)?this.Xg(t.Rw):void 0;return{time:t.yw,logical:t.Re,point:t.kw,paneIndex:t.Tw,hoveredSeries:s,hoveredObjectId:t.Vw,seriesData:e,sourceEvent:t.Bw}}Kg(t){let e=this.qu.get(t);return e||(e=new od(this.Hf,s=>this.Xg(s),t,this),this.qu.set(t,e)),e}}function dd(i){if(ds(i)){const t=document.getElementById(i);return Lt(t!==null,`Cannot find element in DOM with id=${i}`),t}return i}function fd(i,t,e){const s=dd(i),n=new ud(s,t,e);return t.setOptions(n.options()),n}function md(i,t){return fd(i,new lr,lr.ld(t))}class Ja extends en{constructor(t,e){super(t,e,!0)}fg(t,e,s){e.uu(this.rg,ns(this.hg)),t.Ul(this.rg,s,ns(this.hg))}Zg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}cg(){const t=this.Jn.Rh();this.rg=this.Jn.Xs().Hr().map(e=>{const s=e.Wt[3];return this.Gg(e.Re,s,t)})}}function pd(i,t,e,s,n,r,o){if(t.length===0||s.from>=t.length||s.to<=0)return;const{context:l,horizontalPixelRatio:h,verticalPixelRatio:c}=i,u=t[s.from];let d=r(i,u),f=u;if(s.to-s.from<2){const p=n/2;l.beginPath();const m={_t:u._t-p,ut:u.ut},b={_t:u._t+p,ut:u.ut};l.moveTo(m._t*h,m.ut*c),l.lineTo(b._t*h,b.ut*c),o(i,d,m,b)}else{const p=(b,g)=>{o(i,d,f,g),l.beginPath(),d=b,f=g};let m=f;l.beginPath(),l.moveTo(u._t*h,u.ut*c);for(let b=s.from+1;b<s.to;++b){m=t[b];const g=r(i,m);switch(e){case 0:l.lineTo(m._t*h,m.ut*c);break;case 1:l.lineTo(m._t*h,t[b-1].ut*c),g!==d&&(p(g,m),l.lineTo(m._t*h,t[b-1].ut*c)),l.lineTo(m._t*h,m.ut*c);break;case 2:{const[S,j]=gd(t,b-1,b);l.bezierCurveTo(S._t*h,S.ut*c,j._t*h,j.ut*c,m._t*h,m.ut*c);break}}e!==1&&g!==d&&(p(g,m),l.moveTo(m._t*h,m.ut*c))}(f!==m||f===m&&e===1)&&o(i,d,f,m)}}const Cr=6;function Si(i,t){return{_t:i._t-t._t,ut:i.ut-t.ut}}function Mr(i,t){return{_t:i._t/t,ut:i.ut/t}}function gd(i,t,e){const s=Math.max(0,t-1),n=Math.min(i.length-1,e+1);var r,o;return[(r=i[t],o=Mr(Si(i[e],i[s]),Cr),{_t:r._t+o._t,ut:r.ut+o.ut}),Si(i[e],Mr(Si(i[n],i[t]),Cr))]}function xd(i,t){const e=i.context;e.strokeStyle=t,e.stroke()}class bd extends xe{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:s,Jg:n,Qg:r,ct:o,Xt:l,tM:h}=this.rt;if(s===null)return;const c=t.context;c.lineCap="butt",c.lineWidth=o*t.verticalPixelRatio,Ce(c,l),c.lineJoin="round";const u=this.iM.bind(this);r!==void 0&&pd(t,e,r,s,n,u,xd),h&&function(d,f,p,m,b){if(m.to-m.from<=0)return;const{horizontalPixelRatio:g,verticalPixelRatio:S,context:j}=d;let N=null;const M=Math.max(1,Math.floor(g))%2/2,A=p*S+M;for(let B=m.to-1;B>=m.from;--B){const F=f[B];if(F){const it=b(d,F);it!==N&&(j.beginPath(),N!==null&&j.fill(),j.fillStyle=it,N=it);const q=Math.round(F._t*g)+M,tt=F.ut*S;j.moveTo(q,tt),j.arc(q,tt,A,0,2*Math.PI)}}j.fill()}(t,e,h,s,u)}}class vd extends bd{iM(t,e){return e.vt}}class yd extends Ja{constructor(){super(...arguments),this.og=new vd}Gg(t,e,s){return{...this.Zg(t,e),...s.Dr(t)}}pg(){const t=this.Jn.N(),e={ot:this.rg,Xt:t.lineStyle,Qg:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,tM:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.hg,Jg:this.Qn.Et().mu()};this.og.ht(e)}}const wd={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},$g:(i,t)=>new yd(i,t)};class Nd extends en{constructor(t,e){super(t,e,!1)}fg(t,e,s){e.uu(this.rg,ns(this.hg)),t.ql(this.rg,s,ns(this.hg))}VM(t,e,s){return{wt:t,qh:e.Wt[0],Yh:e.Wt[1],jh:e.Wt[2],Kh:e.Wt[3],_t:NaN,Yl:NaN,jl:NaN,Kl:NaN,Xl:NaN}}cg(){const t=this.Jn.Rh();this.rg=this.Jn.Xs().Hr().map(e=>this.Gg(e.Re,e,t))}}class Sd extends xe{constructor(){super(...arguments),this.Yt=null,this.yM=0}ht(t){this.Yt=t}et(t){if(this.Yt===null||this.Yt.Xs.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:e}=t;this.yM=function(r,o){if(r>=2.5&&r<=4)return Math.floor(3*o);const l=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),h=Math.floor(r*l*o),c=Math.floor(r*o),u=Math.min(h,c);return Math.max(Math.floor(o),u)}(this.Yt.mu,e),this.yM>=2&&Math.floor(e)%2!=this.yM%2&&this.yM--;const s=this.Yt.Xs;this.Yt.BM&&this.IM(t,s,this.Yt.lt),this.Yt.Mi&&this.uv(t,s,this.Yt.lt);const n=this.EM(e);(!this.Yt.Mi||this.yM>2*n)&&this.AM(t,s,this.Yt.lt)}IM(t,e,s){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="",h=Math.min(Math.floor(r),Math.floor(this.Yt.mu*r));h=Math.max(Math.floor(r),Math.min(h,this.yM));const c=Math.floor(.5*h);let u=null;for(let d=s.from;d<s.to;d++){const f=e[d];f.pr!==l&&(n.fillStyle=f.pr,l=f.pr);const p=Math.round(Math.min(f.Yl,f.Xl)*o),m=Math.round(Math.max(f.Yl,f.Xl)*o),b=Math.round(f.jl*o),g=Math.round(f.Kl*o);let S=Math.round(r*f._t)-c;const j=S+h-1;u!==null&&(S=Math.max(u+1,S),S=Math.min(S,j));const N=j-S+1;n.fillRect(S,b,N,p-b),n.fillRect(S,m+1,N,g-m),u=j}}EM(t){let e=Math.floor(1*t);this.yM<=2*e&&(e=Math.floor(.5*(this.yM-1)));const s=Math.max(Math.floor(t),e);return this.yM<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}uv(t,e,s){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.EM(r);let c=null;for(let u=s.from;u<s.to;u++){const d=e[u];d.dr!==l&&(n.fillStyle=d.dr,l=d.dr);let f=Math.round(d._t*r)-Math.floor(.5*this.yM);const p=f+this.yM-1,m=Math.round(Math.min(d.Yl,d.Xl)*o),b=Math.round(Math.max(d.Yl,d.Xl)*o);if(c!==null&&(f=Math.max(c+1,f),f=Math.min(f,p)),this.Yt.mu*r>2*h)Mc(n,f,m,p-f+1,b-m+1,h);else{const g=p-f+1;n.fillRect(f,m,g,b-m+1)}c=p}}AM(t,e,s){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.EM(r);for(let c=s.from;c<s.to;c++){const u=e[c];let d=Math.round(Math.min(u.Yl,u.Xl)*o),f=Math.round(Math.max(u.Yl,u.Xl)*o),p=Math.round(u._t*r)-Math.floor(.5*this.yM),m=p+this.yM-1;if(u.cr!==l){const b=u.cr;n.fillStyle=b,l=b}this.Yt.Mi&&(p+=h,d+=h,m-=h,f-=h),d>f||n.fillRect(p,d,m-p+1,f-d+1)}}}class _d extends Nd{constructor(){super(...arguments),this.og=new Sd}Gg(t,e,s){return{...this.VM(t,e,s),...s.Dr(t)}}pg(){const t=this.Jn.N();this.og.ht({Xs:this.rg,mu:this.Qn.Et().mu(),BM:t.wickVisible,Mi:t.borderVisible,lt:this.hg})}}const jd={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},$g:(i,t)=>new _d(i,t)};class Cd extends xe{constructor(){super(...arguments),this.Yt=null,this.zM=[]}ht(t){this.Yt=t,this.zM=[]}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return;this.zM.length||this.LM(e);const n=Math.max(1,Math.floor(s)),r=Math.round(this.Yt.OM*s)-Math.floor(n/2),o=r+n;for(let l=this.Yt.lt.from;l<this.Yt.lt.to;l++){const h=this.Yt.ot[l],c=this.zM[l-this.Yt.lt.from],u=Math.round(h.ut*s);let d,f;t.fillStyle=h.cr,u<=r?(d=u,f=o):(d=r,f=u-Math.floor(n/2)+n),t.fillRect(c.Uh,d,c.bi-c.Uh+1,f-d)}}LM(t){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return void(this.zM=[]);const e=Math.ceil(this.Yt.mu*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.Yt.mu*t)-e;this.zM=new Array(this.Yt.lt.to-this.Yt.lt.from);for(let r=this.Yt.lt.from;r<this.Yt.lt.to;r++){const o=this.Yt.ot[r],l=Math.round(o._t*t);let h,c;if(s%2){const u=(s-1)/2;h=l-u,c=l+u}else{const u=s/2;h=l-u,c=l+u-1}this.zM[r-this.Yt.lt.from]={Uh:h,bi:c,NM:l,ne:o._t*t,wt:o.wt}}for(let r=this.Yt.lt.from+1;r<this.Yt.lt.to;r++){const o=this.zM[r-this.Yt.lt.from],l=this.zM[r-this.Yt.lt.from-1];o.wt===l.wt+1&&o.Uh-l.bi!==e+1&&(l.NM>l.ne?l.bi=o.Uh-e-1:o.Uh=l.bi+e+1)}let n=Math.ceil(this.Yt.mu*t);for(let r=this.Yt.lt.from;r<this.Yt.lt.to;r++){const o=this.zM[r-this.Yt.lt.from];o.bi<o.Uh&&(o.bi=o.Uh);const l=o.bi-o.Uh+1;n=Math.min(l,n)}if(e>0&&n<4)for(let r=this.Yt.lt.from;r<this.Yt.lt.to;r++){const o=this.zM[r-this.Yt.lt.from];o.bi-o.Uh+1>n&&(o.NM>o.ne?o.bi-=1:o.Uh+=1)}}}class Md extends Ja{constructor(){super(...arguments),this.og=new Cd}Gg(t,e,s){return{...this.Zg(t,e),...s.Dr(t)}}pg(){const t={ot:this.rg,mu:this.Qn.Et().mu(),lt:this.hg,OM:this.Jn.Ft().Nt(this.Jn.N().base,C(this.Jn.zt()).Wt)};this.og.ht(t)}}const Pd={type:"Histogram",isBuiltIn:!0,defaultOptions:{color:"#26a69a",base:0},$g:(i,t)=>new Md(i,t)};class kd{constructor(t,e){this.Jn=t,this.ah=e,this.WM()}detach(){this.Jn.detachPrimitive(this.ah)}getSeries(){return this.Jn}applyOptions(t){this.ah&&this.ah.hr&&this.ah.hr(t)}WM(){this.Jn.attachPrimitive(this.ah)}}const Ed={autoScale:!0,zOrder:"normal"};function es(i,t){return Gi(Math.min(Math.max(i,12),30)*t)}function Ue(i,t){switch(i){case"arrowDown":case"arrowUp":return es(t,1);case"circle":return es(t,.8);case"square":return es(t,.7)}}function Ka(i){return function(t){const e=Math.ceil(t);return e%2!=0?e-1:e}(es(i,1))}function Ga(i){return Math.max(es(i,.1),3)}function Pr(i,t,e){return t?i:e?Math.ceil(i/2):0}function kr(i,t,e,s){const n=(Ue("arrowUp",s)-1)/2*e._b,r=(Gi(s/2)-1)/2*e._b;t.beginPath(),i?(t.moveTo(e._t-n,e.ut),t.lineTo(e._t,e.ut-n),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+r,e.ut),t.lineTo(e._t+r,e.ut+n),t.lineTo(e._t-r,e.ut+n),t.lineTo(e._t-r,e.ut)):(t.moveTo(e._t-n,e.ut),t.lineTo(e._t,e.ut+n),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+r,e.ut),t.lineTo(e._t+r,e.ut-n),t.lineTo(e._t-r,e.ut-n),t.lineTo(e._t-r,e.ut)),t.fill()}function Er(i,t,e,s,n,r){const o=(Ue("arrowUp",s)-1)/2,l=(Gi(s/2)-1)/2;return n>=t-l-2&&n<=t+l+2&&r>=(i?e:e-o)-2&&r<=(i?e+o:e)+2?!0:(()=>{if(n<t-o-3||n>t+o+3||r<(i?e-o-3:e)||r>(i?e:e+o+3))return!1;const h=Math.abs(n-t);return Math.abs(r-e)+3>=h/2})()}class Rd{constructor(){this.Yt=null,this.On=new as,this.F=-1,this.W="",this.Wp="",this.ub="normal"}ht(t){this.Yt=t}Nn(t,e,s){this.F===t&&this.W===e||(this.F=t,this.W=e,this.Wp=rs(t,e),this.On.Bn()),this.ub=s}jn(t,e){if(this.Yt===null||this.Yt.lt===null)return null;for(let s=this.Yt.lt.from;s<this.Yt.lt.to;s++){const n=this.Yt.ot[s];if(n&&Td(n,t,e))return{zOrder:"normal",externalId:n.Kn??""}}return null}draw(t){this.ub!=="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}drawBackground(t){this.ub==="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.Yt!==null&&this.Yt.lt!==null){t.textBaseline="middle",t.font=this.Wp;for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const r=this.Yt.ot[n];r.ri!==void 0&&(r.ri.Qi=this.On.Vi(t,r.ri.cb),r.ri.$t=this.F,r.ri._t=r._t-r.ri.Qi/2),Od(r,t,e,s)}}}}function Od(i,t,e,s){t.fillStyle=i.R,i.ri!==void 0&&function(n,r,o,l,h,c){n.save(),n.scale(h,c),n.fillText(r,o,l),n.restore()}(t,i.ri.cb,i.ri._t,i.ri.ut,e,s),function(n,r,o){if(n.zr!==0){switch(n.fb){case"arrowDown":return void kr(!1,r,o,n.zr);case"arrowUp":return void kr(!0,r,o,n.zr);case"circle":return void function(l,h,c){const u=(Ue("circle",c)-1)/2;l.beginPath(),l.arc(h._t,h.ut,u*h._b,0,2*Math.PI,!1),l.fill()}(r,o,n.zr);case"square":return void function(l,h,c){const u=Ue("square",c),d=(u-1)*h._b/2,f=h._t-d,p=h.ut-d;l.fillRect(f,p,u*h._b,u*h._b)}(r,o,n.zr)}n.fb}}(i,t,function(n,r,o){const l=Math.max(1,Math.floor(r))%2/2;return{_t:Math.round(n._t*r)+l,ut:n.ut*o,_b:r}}(i,e,s))}function Td(i,t,e){return!(i.ri===void 0||!function(s,n,r,o,l,h){const c=o/2;return l>=s&&l<=s+r&&h>=n-c&&h<=n+c}(i.ri._t,i.ri.ut,i.ri.Qi,i.ri.$t,t,e))||function(s,n,r){if(s.zr===0)return!1;switch(s.fb){case"arrowDown":return Er(!0,s._t,s.ut,s.zr,n,r);case"arrowUp":return Er(!1,s._t,s.ut,s.zr,n,r);case"circle":return function(o,l,h,c,u){const d=2+Ue("circle",h)/2,f=o-c,p=l-u;return Math.sqrt(f*f+p*p)<=d}(s._t,s.ut,s.zr,n,r);case"square":return function(o,l,h,c,u){const d=Ue("square",h),f=(d-1)/2,p=o-f,m=l-f;return c>=p&&c<=p+d&&u>=m&&u<=m+d}(s._t,s.ut,s.zr,n,r)}}(i,t,e)}function Rr(i){return i==="atPriceTop"||i==="atPriceBottom"||i==="atPriceMiddle"}function Fd(i,t,e,s,n,r,o,l){const h=function(m,b,g){if(Rr(b.position)&&b.price!==void 0)return b.price;if("value"in(S=m)&&typeof S.value=="number")return m.value;var S;if(function(j){return"open"in j&&"high"in j&&"low"in j&&"close"in j}(m)){if(b.position==="inBar")return m.close;if(b.position==="aboveBar")return g?m.low:m.high;if(b.position==="belowBar")return g?m.high:m.low}}(e,t,o.priceScale().options().invertScale);if(h===void 0)return;const c=Rr(t.position),u=l.timeScale(),d=Me(t.size)?Math.max(t.size,0):1,f=Ka(u.options().barSpacing)*d,p=f/2;switch(i.zr=f,t.position){case"inBar":case"atPriceMiddle":return i.ut=C(o.priceToCoordinate(h)),void(i.ri!==void 0&&(i.ri.ut=i.ut+p+r+.6*n));case"aboveBar":case"atPriceTop":{const m=c?0:s.pb;return i.ut=C(o.priceToCoordinate(h))-p-m,i.ri!==void 0&&(i.ri.ut=i.ut-p-.6*n,s.pb+=1.2*n),void(c||(s.pb+=f+r))}case"belowBar":case"atPriceBottom":{const m=c?0:s.mb;return i.ut=C(o.priceToCoordinate(h))+p+m,i.ri!==void 0&&(i.ri.ut=i.ut+p+r+.6*n,s.mb+=1.2*n),void(c||(s.mb+=f+r))}}}class Ld{constructor(t,e,s){this.wb=[],this.xt=!0,this.gb=!0,this.Gt=new Rd,this.ge=t,this.Vp=e,this.Yt={ot:[],lt:null},this.Ps=s}renderer(){if(!this.ge.options().visible)return null;this.xt&&this.Mb();const t=this.Vp.options().layout;return this.Gt.Nn(t.fontSize,t.fontFamily,this.Ps.zOrder),this.Gt.ht(this.Yt),this.Gt}bb(t){this.wb=t,this.yt("data")}yt(t){this.xt=!0,t==="data"&&(this.gb=!0)}Sb(t){this.xt=!0,this.Ps=t}zOrder(){return this.Ps.zOrder==="aboveSeries"?"top":this.Ps.zOrder}Mb(){const t=this.Vp.timeScale(),e=this.wb;this.gb&&(this.Yt.ot=e.map(c=>({wt:c.time,_t:0,ut:0,zr:0,fb:c.shape,R:c.color,Kn:c.id,xb:c.xb,ri:void 0})),this.gb=!1);const s=this.Vp.options().layout;this.Yt.lt=null;const n=t.getVisibleLogicalRange();if(n===null)return;const r=new Ie(Math.floor(n.from),Math.ceil(n.to));if(this.ge.data()[0]===null||this.Yt.ot.length===0)return;let o=NaN;const l=Ga(t.options().barSpacing),h={pb:l,mb:l};this.Yt.lt=Qa(this.Yt.ot,r,!0);for(let c=this.Yt.lt.from;c<this.Yt.lt.to;c++){const u=e[c];u.time!==o&&(h.pb=l,h.mb=l,o=u.time);const d=this.Yt.ot[c];d._t=C(t.logicalToCoordinate(u.time)),u.text!==void 0&&u.text.length>0&&(d.ri={cb:u.text,_t:0,ut:0,Qi:0,$t:0});const f=this.ge.dataByIndex(u.time,0);f!==null&&Fd(d,u,f,h,s.fontSize,l,this.ge,this.Vp)}this.xt=!1}}function Or(i){return{...Ed,...i}}class Dd{constructor(t){this.sh=null,this.wb=[],this.Cb=[],this.Pb=null,this.ge=null,this.Vp=null,this.yb=!0,this.kb=null,this.Tb=null,this.Rb=null,this.Db=!0,this.Ps=Or(t)}attached(t){this.Vb(),this.Vp=t.chart,this.ge=t.series,this.sh=new Ld(this.ge,C(this.Vp),this.Ps),this.lb=t.requestUpdate,this.ge.subscribeDataChanged(e=>this.Tg(e)),this.Db=!0,this.jM()}jM(){this.lb&&this.lb()}detached(){this.ge&&this.Pb&&this.ge.unsubscribeDataChanged(this.Pb),this.Vp=null,this.ge=null,this.sh=null,this.Pb=null}bb(t){this.Db=!0,this.wb=t,this.Vb(),this.yb=!0,this.Tb=null,this.jM()}Bb(){return this.wb}paneViews(){return this.sh?[this.sh]:[]}updateAllViews(){this.Ib()}hitTest(t,e){var s;return this.sh?((s=this.sh.renderer())==null?void 0:s.jn(t,e))??null:null}autoscaleInfo(t,e){if(this.Ps.autoScale&&this.sh){const s=this.Eb();if(s)return{priceRange:null,margins:s}}return null}hr(t){this.Ps=Or({...this.Ps,...t}),this.jM&&this.jM()}Eb(){const t=C(this.Vp).timeScale().options().barSpacing;if(this.yb||t!==this.Rb){if(this.Rb=t,this.wb.length>0){const e=Ga(t),s=1.5*Ka(t)+2*e,n=this.Ab();this.kb={above:Pr(s,n.aboveBar,n.inBar),below:Pr(s,n.belowBar,n.inBar)}}else this.kb=null;this.yb=!1}return this.kb}Ab(){return this.Tb===null&&(this.Tb=this.wb.reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.Tb}Vb(){var n;if(!this.Db||!this.Vp||!this.ge)return;const t=this.Vp.timeScale(),e=(n=this.ge)==null?void 0:n.data();if(t.getVisibleLogicalRange()==null||!this.ge||e.length===0)return void(this.Cb=[]);const s=t.timeToIndex(C(e[0].time),!0);this.Cb=this.wb.map((r,o)=>{const l=t.timeToIndex(r.time,!0),h=l<s?1:-1,c=C(this.ge).dataByIndex(l,h),u={time:t.timeToIndex(C(c).time,!1),position:r.position,shape:r.shape,color:r.color,id:r.id,xb:o,text:r.text,size:r.size,price:r.price,yw:r.time};if(r.position==="atPriceTop"||r.position==="atPriceBottom"||r.position==="atPriceMiddle"){if(r.price===void 0)throw new Error(`Price is required for position ${r.position}`);return{...u,position:r.position,price:r.price}}return{...u,position:r.position,price:r.price}}),this.Db=!1}Ib(t){this.sh&&(this.Vb(),this.sh.bb(this.Cb),this.sh.Sb(this.Ps),this.sh.yt(t))}Tg(t){this.Db=!0,this.jM()}}class Ad extends kd{constructor(t,e,s){super(t,e),s&&this.setMarkers(s)}setMarkers(t){this.ah.bb(t)}markers(){return this.ah.Bb()}}function Id(i,t,e){const s=new Ad(i,new Dd({}));return t&&s.setMarkers(t),s}({...Pa});function zd({theme:i="dark",height:t=500}={}){return _.useMemo(()=>{const e=i==="dark";return{layout:{background:{type:Di.Solid,color:e?"#1E293B":"#FFFFFF"},textColor:e?"#94A3B8":"#64748B"},grid:{vertLines:{color:e?"#334155":"#E2E8F0",style:Kt.Solid},horzLines:{color:e?"#334155":"#E2E8F0",style:Kt.Solid}},crosshair:{mode:0,vertLine:{width:1,color:"#3B82F6",style:Kt.Dashed,labelBackgroundColor:"#3B82F6"},horzLine:{width:1,color:"#3B82F6",style:Kt.Dashed,labelBackgroundColor:"#3B82F6"}},rightPriceScale:{borderColor:e?"#334155":"#E2E8F0",scaleMargins:{top:.1,bottom:.2}},timeScale:{borderColor:e?"#334155":"#E2E8F0",timeVisible:!0,secondsVisible:!1},height:t}},[i,t])}function Bd(i="dark"){return{upColor:"#26A69A",downColor:"#EF5350",borderUpColor:"#26A69A",borderDownColor:"#EF5350",wickUpColor:"#26A69A",wickDownColor:"#EF5350"}}function Tr(i="dark"){return{upColor:"#26A69A80",downColor:"#EF535080"}}const Ss=i=>Math.floor(new Date(i).getTime()/1e3),$d=(i,t)=>{const e=[];for(let s=0;s<i.length;s++)if(s<t-1)e.push(NaN);else{const n=i.slice(s-t+1,s+1).reduce((r,o)=>r+o,0);e.push(n/t)}return e},Vd=(i,t)=>{const e=[],s=2/(t+1);if(i.length<t)return i.map(()=>NaN);let n=i.slice(0,t).reduce((r,o)=>r+o,0)/t;e.push(...new Array(t-1).fill(NaN)),e.push(n);for(let r=t;r<i.length;r++)n=i[r]*s+n*(1-s),e.push(n);return e},Ud=["5s","15s","30s","1m","2m","5m","15m","30m","1h"],Fr=i=>{const t=i.trim().toLowerCase();if(t.endsWith("s")){const e=parseInt(t.slice(0,-1));return!isNaN(e)&&e>0&&e<=60}if(t.endsWith("m")){const e=parseInt(t.slice(0,-1));return!isNaN(e)&&e>0&&e<=60}if(t.endsWith("h")){const e=parseInt(t.slice(0,-1));return!isNaN(e)&&e>0&&e<=24}return!1},Lr=[{period:8,type:"EMA",color:"#FFD700",label:"MA8"},{period:21,type:"EMA",color:"#EF5350",label:"MA21"},{period:50,type:"SMA",color:"#42A5F5",label:"MA50"},{period:100,type:"SMA",color:"#26A69A",label:"MA100"}];function qd({symbol:i,positions:t=[],orders:e=[],height:s=500,showPositions:n=!0,showOrders:r=!0}){const[o,l]=_.useState(i||"MNQ"),[h,c]=_.useState("5m"),[u,d]=_.useState(""),[f,p]=_.useState(300),[m,b]=_.useState(""),[g,S]=_.useState(n),[j,N]=_.useState(r),[M,A]=_.useState(!1),[B,F]=_.useState(null),[it,q]=_.useState(Date.now()),[tt,gt]=_.useState(null),[st,ot]=_.useState(null),nt=Jt(),ft=_.useRef(null),z=_.useRef(null),Y=_.useRef(null),v=_.useRef(null),O=_.useRef([]),U=_.useRef(null),D=_.useRef([]),lt=_.useRef(new Map),Pt=_.useRef({}),[yt,At]=_.useState(null),[zt,ie]=_.useState(!0),Bt=zd({theme:"dark",height:s}),{data:P,isLoading:kt,refetch:et,isRefetching:rt,error:Et}=Rt(["tradingChartData",o,h,f],()=>{const y=new Date().toISOString();return va.getHistoricalData({symbol:o,timeframe:h,limit:f,end:y})},{enabled:!!o,staleTime:0,cacheTime:1,refetchInterval:st?st*1e3:(()=>{const y=h.toLowerCase().trim();if(y.endsWith("s")){const k=parseInt(y.slice(0,-1));return k<=30?k*2e3:k*1e3}return 6e4})(),onError:y=>{console.error("[TradingChart] Error fetching historical data:",y)},onSuccess:y=>{var k,T,I,$;if(console.log("[TradingChart] Historical data fetched:",{symbol:o,timeframe:h,barCount:((k=y==null?void 0:y.bars)==null?void 0:k.length)||0,firstBar:(T=y==null?void 0:y.bars)==null?void 0:T[0],lastBar:($=y==null?void 0:y.bars)==null?void 0:$[((I=y==null?void 0:y.bars)==null?void 0:I.length)-1]}),y&&typeof y=="object"&&"error"in y){const R=y;R.error&&console.error("[TradingChart] API returned error:",R.error)}}});_.useEffect(()=>{!M||!o||!h||(console.log(`[TradingChart] Requesting subscription to ${o} ${h} bars`),J.emit("subscribe",{types:["market_update"],symbol:o.toUpperCase(),timeframe:h.toLowerCase()}))},[M,o,h]);const Ee=_.useCallback(()=>{if(z.current){const y=z.current.timeScale().getVisibleRange();y&&gt({left:y.from,right:y.to})}nt.invalidateQueries(["tradingChartData",o,h,f]),et()},[o,h,f,nt,et]),Re=_.useCallback(y=>{c(y),d(""),gt(null)},[]),Oe=_.useCallback(y=>{d(y),Fr(y)&&(c(y.trim().toLowerCase()),gt(null))},[]),V=_.useCallback(y=>{p(y),b(""),gt(null)},[]),Qt=_.useCallback(y=>{b(y);const k=parseInt(y);!isNaN(k)&&k>=100&&k<=3e3&&(p(k),gt(null))},[]),Zt=_.useMemo(()=>{if(!h)return null;const y=it,k=h.toLowerCase().trim();let T=0;if(k.endsWith("s")?T=parseInt(k.slice(0,-1))*1e3:k.endsWith("m")?T=parseInt(k.slice(0,-1))*60*1e3:k.endsWith("h")&&(T=parseInt(k.slice(0,-1))*60*60*1e3),T===0)return null;const I=Math.floor(y/T)*T,$=y-I,R=T-$,mt=Math.max(0,Math.floor(R/1e3)),Z=Math.floor(mt/60),bt=mt%60;return`${Z}:${bt.toString().padStart(2,"0")}`},[h,it]);_.useLayoutEffect(()=>{const y=ft.current;if(!y)return;y.style.position="relative",y.style.height=`${s}px`,y.style.width="100%";let k=null,T=null,I=null,$=!1;const R=()=>{var _t,jt;if($||!y)return;const Z=y.getBoundingClientRect();if(Z.width===0||Z.height===0){requestAnimationFrame(R);return}const W=(()=>{var Wt;const ct=y.clientWidth||y.offsetWidth||((Wt=y.parentElement)==null?void 0:Wt.clientWidth)||600;return Math.max(ct,400)})(),Mt=ct=>{const Wt=new Date(ct*1e3),Vt={timeZone:"America/New_York",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return Wt.toLocaleString("en-US",Vt)},ht=ct=>{const Wt=new Date(ct*1e3),Vt={timeZone:"America/New_York"};return["1h","4h","1d"].includes(h)||h.includes("m")&&parseInt(h)>=30?(Vt.month="short",Vt.day="numeric",Vt.hour="2-digit",Vt.minute="2-digit",Vt.hour12=!1,Wt.toLocaleString("en-US",Vt)):(Vt.hour="2-digit",Vt.minute="2-digit",Vt.hour12=!1,Wt.toLocaleTimeString("en-US",Vt))},ut=md(y,{...Bt,width:W,height:s,timeScale:{...Bt.timeScale,tickMarkFormatter:ct=>ht(ct)},crosshair:{...Bt.crosshair,vertLine:{...(_t=Bt.crosshair)==null?void 0:_t.vertLine,labelVisible:!0},horzLine:{...(jt=Bt.crosshair)==null?void 0:jt.horzLine,labelVisible:!0}},localization:{timeFormatter:ct=>Mt(ct)},handleScroll:{mouseWheel:!0,pressedMouseMove:!0},handleScale:{axisPressedMouseMove:!0,axisDoubleClickReset:!0}});k=ut;const vt=ut.addSeries(jd,Bd("dark")),pt=ut.addSeries(Pd,{color:"#26A69A",priceFormat:{type:"volume"},priceScaleId:"volume"});ut.priceScale("volume").applyOptions({scaleMargins:{top:.8,bottom:0}}),ut.priceScale("right").applyOptions({scaleMargins:{top:.1,bottom:.1}});const X=[];Lr.forEach(ct=>{const Wt=ut.addSeries(wd,{color:ct.color,lineWidth:1,priceLineVisible:!1,lastValueVisible:!1});X.push(Wt)}),z.current=ut,Y.current=vt,v.current=pt,O.current=X,U.current=Id(vt,[]),A(!0),T=new ResizeObserver(ct=>{if(!ct.length||!z.current)return;const{width:Wt}=ct[0].contentRect,Vt=Math.max(Wt,400);z.current.applyOptions({width:Vt})}),T.observe(y),I=()=>{if(z.current&&y){const ct=Math.max(y.clientWidth||600,400);z.current.applyOptions({width:ct})}},window.addEventListener("resize",I)},mt=requestAnimationFrame(R);return()=>{var Z;$=!0,cancelAnimationFrame(mt),I&&window.removeEventListener("resize",I),T==null||T.disconnect(),(Z=U.current)==null||Z.detach(),U.current=null,k&&k.remove(),A(!1)}},[s,Bt]);const Ot=_.useMemo(()=>{if(!(P!=null&&P.bars)||P.bars.length===0)return null;const y=Tr("dark"),k=[...P.bars].map(R=>({time:Ss(R.timestamp),open:R.open,high:R.high,low:R.low,close:R.close,volume:R.volume})).sort((R,mt)=>R.time-mt.time);let T=null;const I=[],$=[];for(const R of k){const mt=R.time;if(T!==null&&mt===T){I[I.length-1]={time:R.time,open:R.open,high:R.high,low:R.low,close:R.close},$[$.length-1]={time:R.time,value:R.volume,color:R.close>=R.open?y.upColor:y.downColor};continue}I.push({time:R.time,open:R.open,high:R.high,low:R.low,close:R.close}),$.push({time:R.time,value:R.volume,color:R.close>=R.open?y.upColor:y.downColor}),T=mt}return{candlestickData:I,volumeData:$}},[P]),ue=_.useMemo(()=>{if(!Ot||!Ot.candlestickData.length)return null;const y=Ot.candlestickData.map(T=>T.close),k=Ot.candlestickData.map(T=>T.time);return Lr.map(T=>{const I=T.type==="EMA"?Vd(y,T.period):$d(y,T.period),$=k.map((R,mt)=>({time:R,value:I[mt]})).filter(R=>!isNaN(R.value));return{...T,data:$}})},[Ot]),$t=_.useMemo(()=>{if(!P||P.bars.length===0||!M)return null;const y=B||P.bars[P.bars.length-1],k=y.close-y.open,T=k/y.open*100,I=T.toFixed(2);return{displayBar:y,change:k,changePercentValue:T,changePercent:I}},[P,M,B]);_.useEffect(()=>{if(!M||!Ot||!Y.current||!v.current)return;const y=setTimeout(()=>{if(!(!Y.current||!v.current))try{Y.current.setData(Ot.candlestickData),v.current.setData(Ot.volumeData),zt&&ue&&O.current.length===ue.length?ue.forEach((T,I)=>{O.current[I]&&O.current[I].setData(T.data)}):zt||O.current.forEach(T=>{T.setData([])});const k=`${o.toUpperCase()}:${h.toLowerCase()}`;if(Pt.current[k]=Ot.candlestickData.map((T,I)=>{var $;return{time:Number(T.time),open:T.open,high:T.high,low:T.low,close:T.close,volume:(($=Ot.volumeData[I])==null?void 0:$.value)??0}}),z.current&&tt){const T=z.current.timeScale();try{T.setVisibleRange({from:tt.left,to:tt.right})}catch(I){console.debug("[TradingChart] Could not restore scroll position:",I)}}}catch(k){console.error("[TradingChart] Error updating chart data:",k)}},50);return()=>clearTimeout(y)},[Ot,M,o,h,f,zt,ue,tt]),_.useEffect(()=>{const y=setInterval(()=>{q(Date.now())},1e3);return()=>clearInterval(y)},[]),_.useEffect(()=>{Zt==="0:00"&&(console.log("[TradingChart] New bar created - auto-refreshing chart data"),et())},[Zt,et]),_.useEffect(()=>{if(!z.current||!M)return;const k=z.current.timeScale();let T=null,I=null,$=!1;const mt=setInterval(()=>{const Z=k.getVisibleRange();if(Z){const bt={left:Z.from,right:Z.to};if(!I){I=bt;return}T&&(Math.abs(T.left-bt.left)>1||Math.abs(T.right-bt.right)>1)&&($=!0),$&&gt(bt),T=bt}},500);return()=>clearInterval(mt)},[M]),_.useEffect(()=>{if(!z.current||!M)return;const y=I=>{const $=new Date(I*1e3),R={timeZone:"America/New_York",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return $.toLocaleString("en-US",R)},k=I=>{const $=new Date(I*1e3),R={timeZone:"America/New_York"};return["1h","4h","1d"].includes(h)||h.includes("m")&&parseInt(h)>=30?(R.month="short",R.day="numeric",R.hour="2-digit",R.minute="2-digit",R.hour12=!1,$.toLocaleString("en-US",R)):(R.hour="2-digit",R.minute="2-digit",R.hour12=!1,$.toLocaleTimeString("en-US",R))};z.current.timeScale().applyOptions({tickMarkFormatter:(I,$,R)=>k(I)}),z.current.applyOptions({localization:{timeFormatter:I=>y(I)}})},[h,M]),_.useEffect(()=>{if(!z.current||!M||!Y.current||!(P!=null&&P.bars))return;const y=z.current,k=Y.current,T=I=>{if(I.time&&I.seriesData){const $=I.seriesData.get(k);if($){const R=Number(I.time),mt=P.bars.find(Z=>Number(Ss(Z.timestamp))===R);F(mt||{timestamp:new Date(R*1e3).toISOString(),open:$.open,high:$.high,low:$.low,close:$.close,volume:0})}else F(null)}else F(null)};return y.subscribeCrosshairMove(T),()=>{}},[M,P]);const x=_.useMemo(()=>t.filter(k=>k.symbol===o),[t,o]),E=_.useMemo(()=>!g||x.length===0?[]:x.map(y=>{const k=y.side==="LONG";let T=y.timestamp||y.opened_at||y.created_at;return T||(T=new Date().toISOString()),{time:Ss(T),position:k?"belowBar":"aboveBar",color:k?"#26A69A":"#EF5350",shape:k?"arrowUp":"arrowDown",text:`${y.side} ${y.quantity}@${y.entry_price.toFixed(2)}`,size:1}}).filter(y=>y!==null),[x,g]);_.useEffect(()=>{!M||!U.current||U.current.setMarkers(E)},[E,M,o]);const L=_.useMemo(()=>e.filter(y=>y.symbol===o&&y.status==="PENDING"&&(y.price||y.stop_price)),[e,o]);_.useEffect(()=>{!M||!Y.current||(D.current.forEach(y=>{var k;try{(k=Y.current)==null||k.removePriceLine(y)}catch(T){console.warn("[TradingChart] Failed to remove price line",T)}}),D.current=[],!(!j||L.length===0)&&(console.log("[TradingChart] Updating order price lines",{relevantOrders:L.length,symbol:o}),L.forEach(y=>{if(!Y.current)return;const k=y.stop_price||y.price;if(!k)return;const T=y.side==="BUY",I=y.type||"LIMIT",$=I==="STOP"||y.stop_price;try{const R=Y.current.createPriceLine({price:k,color:T?"#10B981":"#F59E0B",lineWidth:2,lineStyle:$?Kt.Dotted:Kt.Dashed,axisLabelVisible:!0,title:`${y.side} ${y.quantity} ${I}`});D.current.push(R),lt.current.set(R,y)}catch(R){console.error("[TradingChart] Error creating price line:",R)}})))},[L,j,M]),_.useEffect(()=>{if(!M||!z.current||!Y.current||!j)return;const y=z.current,k=ft.current;if(!k)return;const T=Y.current,I=5,$=bt=>{if(!y)return null;let W=null,Mt=null,ht=null,ut=1/0;return lt.current.forEach((vt,pt)=>{const X=vt.stop_price||vt.price;if(!X)return;const _t=T.priceToCoordinate(X);if(_t===null)return;const jt=Math.abs(bt-_t);jt<ut&&jt<I&&(ut=jt,W=pt,Mt=vt,ht=X)}),W&&Mt&&ht!==null?{line:W,order:Mt,price:ht}:null},R=bt=>{if(!y||!k||yt)return;const W=k.getBoundingClientRect(),Mt=bt.clientY-W.top,ht=$(Mt);ht&&(At({order:ht.order,startPrice:ht.price,startY:Mt}),k.style.cursor="grabbing",bt.preventDefault())},mt=bt=>{if(!y||!k)return;const W=yt;if(!W){const pt=k.getBoundingClientRect(),X=bt.clientY-pt.top,_t=$(X);k.style.cursor=_t?"grab":"default";return}const Mt=k.getBoundingClientRect(),ht=bt.clientY-Mt.top,ut=T.coordinateToPrice(ht);if(ut===null||ut<=0)return;let vt=null;if(lt.current.forEach((pt,X)=>{pt.id===W.order.id&&(vt=X)}),vt&&Y.current)try{Y.current.removePriceLine(vt);const pt=Y.current.createPriceLine({price:ut,color:W.order.side==="BUY"?"#10B981":"#F59E0B",lineWidth:2,lineStyle:W.order.type==="STOP"||W.order.stop_price?Kt.Dotted:Kt.Dashed,axisLabelVisible:!0,title:`${W.order.side} ${W.order.quantity} ${W.order.type||"LIMIT"}`}),X=D.current.indexOf(vt);X!==-1&&(D.current[X]=pt),lt.current.delete(vt),lt.current.set(pt,W.order)}catch(pt){console.error("[TradingChart] Error updating price line during drag:",pt)}},Z=async bt=>{if(!k)return;const W=yt;if(!W)return;if(k.style.cursor="default",!y||!Y.current){At(null);return}const Mt=k.getBoundingClientRect(),ht=bt.clientY-Mt.top,ut=Y.current.coordinateToPrice(ht);if(ut&&ut>0&&Math.abs(ut-W.startPrice)>.01)try{const pt=(W.order.type||"LIMIT")==="STOP"||W.order.stop_price;await De.modifyOrder(W.order.id,{price:ut,order_type:pt?4:1}),console.log(`[TradingChart] Order ${W.order.id} price updated from ${W.startPrice} to ${ut}`)}catch(vt){console.error("[TradingChart] Error modifying order:",vt);const pt=D.current.find(X=>{const _t=lt.current.get(X);return(_t==null?void 0:_t.id)===W.order.id});if(pt&&Y.current)try{Y.current.removePriceLine(pt);const X=Y.current.createPriceLine({price:W.startPrice,color:W.order.side==="BUY"?"#10B981":"#F59E0B",lineWidth:2,lineStyle:W.order.type==="STOP"||W.order.stop_price?Kt.Dotted:Kt.Dashed,axisLabelVisible:!0,title:`${W.order.side} ${W.order.quantity} ${W.order.type||"LIMIT"}`}),_t=D.current.indexOf(pt);_t!==-1&&(D.current[_t]=X),lt.current.delete(pt),lt.current.set(X,W.order)}catch(X){console.error("[TradingChart] Error reverting price line:",X)}}At(null)};return k.addEventListener("mousedown",R),k.addEventListener("mousemove",mt),k.addEventListener("mouseup",Z),k.addEventListener("mouseleave",Z),()=>{k.removeEventListener("mousedown",R),k.removeEventListener("mousemove",mt),k.removeEventListener("mouseup",Z),k.removeEventListener("mouseleave",Z)}},[M,j,yt]),_.useEffect(()=>{if(!M||!o)return;const y=o.toUpperCase(),k=I=>{var _t;if(!I||!Y.current||!v.current||(I.symbol||"").toUpperCase()!==y)return;const R=(I.timeframe||"").toLowerCase(),mt=h.toLowerCase();if(R&&R!==mt)return;const Z=I.bar;if(!Z)return;const bt=I.timestamp||((_t=I.bar)==null?void 0:_t.timestamp)||new Date().toISOString(),W=Number(Ss(bt)),Mt=`${y}:${R}`,ht=Pt.current[Mt]?[...Pt.current[Mt]]:[],ut={time:W,open:Z.open,high:Z.high,low:Z.low,close:Z.close,volume:Z.volume},vt=ht[ht.length-1];if(!vt||W>=vt.time)vt&&W===vt.time?ht[ht.length-1]=ut:ht.push(ut);else{const jt=ht.findIndex(ct=>ct.time===W);jt>=0?ht[jt]=ut:(ht.push(ut),ht.sort((ct,Wt)=>ct.time-Wt.time))}const pt=Math.max(f,100);ht.length>pt+20&&ht.splice(0,ht.length-(pt+20)),Pt.current[Mt]=ht;const X=W;if(Y.current.update({time:X,open:Z.open,high:Z.high,low:Z.low,close:Z.close}),Z.volume!==void 0){const jt=Tr("dark");v.current.update({time:X,value:Z.volume,color:Z.close>=Z.open?jt.upColor:jt.downColor})}},T=I=>{if(!I)return;const $=I.data??I;(Array.isArray($)?$:[$]).forEach(k)};return J.on("market_update",T),J.on("market_update_batch",T),()=>{J.off("market_update",T),J.off("market_update_batch",T)}},[o,h,M,f]);const Q=[{value:100,label:"100"},{value:300,label:"300"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:2e3,label:"2000"},{value:3e3,label:"3000"}];return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsxs("h2",{className:"text-xl font-semibold text-slate-100",children:[o," Price Chart"]}),a.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:Ee,disabled:rt,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:opacity-50 text-white text-xs font-semibold rounded transition-colors flex items-center gap-2",title:"Refresh chart data",children:[a.jsx(Bh,{className:`w-4 h-4 ${rt?"animate-spin":""}`}),"Refresh"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-slate-400",children:"Auto:"}),a.jsxs("select",{value:st||"",onChange:y=>ot(y.target.value?parseInt(y.target.value):null),className:"bg-slate-900 border border-slate-700 rounded px-2 py-1.5 text-xs text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Auto-refresh rate (seconds, default uses timeframe-based rate)",children:[a.jsx("option",{value:"",children:"Default"}),a.jsx("option",{value:"1",children:"1s"}),a.jsx("option",{value:"5",children:"5s"}),a.jsx("option",{value:"10",children:"10s"}),a.jsx("option",{value:"30",children:"30s"}),a.jsx("option",{value:"60",children:"60s"})]})]})]}),a.jsx("input",{value:o,onChange:y=>l(y.target.value.toUpperCase()),className:"bg-slate-900 border border-slate-700 rounded px-3 py-1.5 text-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Symbol",maxLength:10}),a.jsxs("div",{className:"flex gap-1 items-center",children:[Ud.map(y=>a.jsx("button",{onClick:()=>Re(y),className:`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${h===y&&!u?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:y.toUpperCase()},y)),a.jsx("input",{type:"text",value:u,onChange:y=>Oe(y.target.value),placeholder:"Custom (e.g., 10s, 3m)",className:`px-3 py-1.5 text-xs font-semibold rounded transition-colors w-24 ${u&&Fr(u)?"bg-blue-600 text-white border-2 border-blue-400":u?"bg-red-900/50 text-red-300 border-2 border-red-500":"bg-slate-700 text-slate-300 hover:bg-slate-600 border border-slate-600"}`,title:"Enter custom timeframe (e.g., 10s, 3m, 2h)"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 text-sm flex-wrap",children:[a.jsx("span",{className:"text-slate-400",children:"Bars:"}),a.jsxs("div",{className:"flex gap-1 items-center",children:[Q.map(y=>a.jsx("button",{onClick:()=>V(y.value),className:`px-3 py-1 text-xs font-semibold rounded transition-colors ${f===y.value&&!m?"bg-green-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:y.label},y.value)),a.jsx("input",{type:"number",value:m,onChange:y=>Qt(y.target.value),placeholder:"100-3000",min:100,max:3e3,className:`px-3 py-1 text-xs font-semibold rounded transition-colors w-20 ${m&&parseInt(m)>=100&&parseInt(m)<=3e3?"bg-green-600 text-white border-2 border-green-400":m?"bg-red-900/50 text-red-300 border-2 border-red-500":"bg-slate-700 text-slate-300 hover:bg-slate-600 border border-slate-600"}`,title:"Enter custom bar count (100-3000)"})]}),a.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:zt,onChange:y=>ie(y.target.checked),className:"rounded"}),"Moving Averages"]}),a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:g,onChange:y=>S(y.target.checked),className:"rounded"}),"Show Positions"]}),a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:j,onChange:y=>N(y.target.checked),className:"rounded"}),"Show Orders"]})]})]})]}),a.jsxs("div",{className:"relative rounded overflow-hidden",style:{minHeight:s},children:[a.jsx("div",{ref:ft,className:"rounded overflow-hidden",style:{minHeight:s}}),$t&&a.jsx("div",{className:"absolute top-2 left-2 z-10 bg-slate-900/90 backdrop-blur-sm rounded px-3 py-2 text-xs font-mono border border-slate-700",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:"text-slate-400",children:[a.jsx("span",{className:"text-slate-500",children:"O"})," ",a.jsx("span",{className:"text-slate-300",children:$t.displayBar.open.toFixed(2)})]}),a.jsxs("span",{className:"text-slate-400",children:[a.jsx("span",{className:"text-slate-500",children:"H"})," ",a.jsx("span",{className:"text-green-400",children:$t.displayBar.high.toFixed(2)})]}),a.jsxs("span",{className:"text-slate-400",children:[a.jsx("span",{className:"text-slate-500",children:"L"})," ",a.jsx("span",{className:"text-red-400",children:$t.displayBar.low.toFixed(2)})]}),a.jsxs("span",{className:"text-slate-400",children:[a.jsx("span",{className:"text-slate-500",children:"C"})," ",a.jsx("span",{className:$t.change>=0?"text-green-400":"text-red-400",children:$t.displayBar.close.toFixed(2)})]}),a.jsxs("span",{className:`ml-2 ${$t.change>=0?"text-green-400":"text-red-400"}`,children:[$t.change>=0?"+":"",$t.change.toFixed(2)," (",$t.changePercentValue>=0?"+":"",$t.changePercent,"%)"]})]})}),M&&a.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-2 bg-slate-900/90 backdrop-blur-sm rounded px-2 py-1 border border-slate-700",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",title:"Live data"}),a.jsx("span",{className:"text-xs text-slate-400",children:"LIVE"})]}),Zt&&M&&a.jsx("div",{className:"absolute bottom-2 right-2 z-10 bg-slate-900/90 backdrop-blur-sm rounded px-3 py-2 border border-slate-700",children:a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsx("span",{className:"text-xs text-slate-500",children:"Next Bar"}),a.jsx("span",{className:"text-lg font-mono font-bold text-blue-400",children:Zt})]})}),Et&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-red-400 text-sm bg-slate-900/70 z-20",children:a.jsxs("div",{className:"flex flex-col items-center gap-2 max-w-md text-center px-4",children:[a.jsx("div",{className:"text-red-500 font-semibold",children:"Error loading chart data"}),a.jsx("div",{className:"text-xs text-slate-400",children:Et instanceof Error?Et.message:String(Et)}),a.jsx("button",{onClick:()=>et(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Retry"})]})}),(!P||P.bars.length===0)&&!kt&&!Et&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-slate-500 text-sm bg-slate-900/70",children:a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsxs("div",{children:["No data available for ",o]}),a.jsx("button",{onClick:()=>et(),className:"px-4 py-2 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Refresh"})]})}),(kt||!M)&&!Et&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-slate-400 text-sm bg-slate-900/70",children:a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Loading chart data..."})]})})]}),P&&P.bars.length>0&&a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400 bg-slate-900/60 rounded px-4 py-2",children:[a.jsxs("div",{className:"text-slate-500",children:[t.filter(y=>y.symbol===o).length," position(s)  ",e.filter(y=>y.symbol===o&&y.status==="PENDING").length," order(s)"]}),a.jsxs("div",{className:"text-slate-500",children:[P.bars.length," bars  ",h," timeframe"]})]})]})}function Yd(){const{accounts:i,selectedAccount:t,setSelectedAccount:e}=se(),s=t==null?void 0:t.id,n=Jt();Sa();const{data:r=[],isLoading:o}=Rt(["positions",s],Xt.getPositions,{enabled:!!s,staleTime:3e4,refetchInterval:1e4}),{data:l=[],isLoading:h}=Rt(["orders",s],De.getOrders,{enabled:!!s,staleTime:3e4,refetchInterval:1e4}),[c,u]=_.useState(null),[d,f]=_.useState(""),[p,m]=_.useState(""),[b,g]=_.useState({}),[S,j]=_.useState({}),[N,M]=_.useState({}),[A,B]=_.useState(null),[F,it]=_.useState(null),[q,tt]=_.useState({}),[gt,st]=_.useState({}),[ot,nt]=_.useState({}),[ft,z]=ge("automationTools",!0),[Y,v]=ge("positionsPagePositions",!0),[O,U]=ge("positionsPageOrders",!0),D=(x,E)=>{it({type:x,message:E}),window.setTimeout(()=>it(null),4e3)},lt=wt(x=>De.cancelOrder(x),{onSuccess:(x,E)=>{n.invalidateQueries(["orders",s]),E?D("success",`Cancel request sent for order ${E}`):D("success","Cancel request sent")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to cancel order";D("error",E)}}),Pt=wt(({orderId:x,updates:E})=>De.modifyOrder(x,E),{onSuccess:(x,E)=>{n.invalidateQueries(["orders",s]),u(null),f(""),m(""),D("success",`Order ${E.orderId} updated`)},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to modify order";D("error",E)}}),yt=wt(({positionId:x,quantity:E})=>Xt.closePosition(x,E),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),E.quantity?(g(L=>({...L,[E.positionId]:""})),D("success",`Partial close submitted for ${E.quantity} contracts`)):D("success","Close position request sent")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to close position";D("error",E)}}),At=wt(({positionId:x,stopPrice:E})=>Xt.modifyStopLoss(x,E),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),j(L=>({...L,[E.positionId]:""})),D("success","Stop loss updated")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to update stop loss";D("error",E)}}),zt=wt(({positionId:x,takeProfit:E})=>Xt.modifyTakeProfit(x,E),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),M(L=>({...L,[E.positionId]:""})),D("success","Take profit updated")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to update take profit";D("error",E)}}),ie=wt(({positionId:x,trailAmount:E})=>Xt.enableTrailingStop(x,E),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),tt(L=>({...L,[E.positionId]:""})),st(L=>({...L,[E.positionId]:!0})),D("success","Trailing stop enabled")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to enable trailing stop";D("error",E)}}),Bt=wt(x=>Xt.disableTrailingStop(x),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),st(L=>({...L,[E]:!1})),D("success","Trailing stop disabled")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to disable trailing stop";D("error",E)}}),P=wt(x=>Xt.enableBreakeven(x),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),nt(L=>({...L,[E]:!0})),D("success","Breakeven enabled - stop moved to entry price")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to enable breakeven";D("error",E)}}),kt=wt(x=>Xt.disableBreakeven(x),{onSuccess:(x,E)=>{n.invalidateQueries(["positions",s]),nt(L=>({...L,[E]:!1})),D("success","Breakeven disabled")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to disable breakeven";D("error",E)}}),et=wt(({symbol:x,quantity:E,accountName:L})=>Ch.testOvernightBreakout(x,E,L),{onSuccess:()=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),D("success","Overnight breakout test executed")},onError:x=>{var L,Q;const E=((Q=(L=x==null?void 0:x.response)==null?void 0:L.data)==null?void 0:Q.error)||(x==null?void 0:x.message)||"Failed to execute test";D("error",E)}}),rt=(x,E)=>{if(!x){D("error","Unable to close position: missing identifier");return}confirm("Are you sure you want to close this entire position?")&&yt.mutate({positionId:x,quantity:E})},Et=x=>{confirm("Are you sure you want to cancel this order?")&&lt.mutate(x)},Ee=x=>{u({id:x.id,price:x.price,quantity:x.quantity}),f(x.price?x.price.toString():""),m(x.quantity?x.quantity.toString():"")},Re=()=>{var E,L;if(!c)return;const x={};if(d&&d!==((E=c.price)==null?void 0:E.toString())&&(x.price=parseFloat(d)),p&&p!==((L=c.quantity)==null?void 0:L.toString())&&(x.quantity=parseInt(p)),Object.keys(x).length===0){u(null);return}Pt.mutate({orderId:c.id,updates:x})},Oe=x=>{if(!x.id){D("error","Position ID missing");return}const E=b[x.id]||"",L=parseInt(E,10);if(!Number.isFinite(L)||L<=0){D("error","Enter a valid quantity for partial close");return}if(L>x.quantity){D("error","Quantity exceeds current position size");return}yt.mutate({positionId:x.id,quantity:L})},V=x=>{if(!x.id){D("error","Position ID missing");return}const E=S[x.id]||"",L=parseFloat(E);if(!Number.isFinite(L)){D("error","Enter a valid stop loss price");return}At.mutate({positionId:x.id,stopPrice:L})},Qt=x=>{if(!x.id){D("error","Position ID missing");return}const E=N[x.id]||"",L=parseFloat(E);if(!Number.isFinite(L)){D("error","Enter a valid take profit price");return}zt.mutate({positionId:x.id,takeProfit:L})},Zt=x=>{if(!x){D("error","Raw details unavailable for this position");return}B(E=>E===x?null:x)},Ot=x=>{if(!x.id){D("error","Position ID missing");return}if(gt[x.id])Bt.mutate(x.id);else{const L=q[x.id]||"",Q=parseFloat(L);if(!Number.isFinite(Q)||Q<=0){D("error","Enter a valid trail amount (e.g., 25.00)");return}ie.mutate({positionId:x.id,trailAmount:Q})}},ue=x=>{if(!x.id){D("error","Position ID missing");return}ot[x.id]?kt.mutate(x.id):P.mutate(x.id)},$t=o||h;return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Positions & Orders"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Monitor and manage your open positions and orders"})]})}),F&&a.jsx("div",{className:`rounded-lg border px-4 py-2 text-sm ${F.type==="success"?"border-emerald-500/40 bg-emerald-500/10 text-emerald-200":"border-red-500/40 bg-red-500/10 text-red-300"}`,children:F.message}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ji,{accounts:i,selectedAccount:t,onAccountChange:e})}),a.jsx(qd,{symbol:"MNQ",positions:r,orders:l,height:500,showPositions:!0,showOrders:!0}),a.jsx(hc,{}),a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>z(x=>!x),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3 text-left",children:[a.jsx(Li,{className:"w-5 h-5 text-yellow-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Automation Tools"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Overnight breakout testing"})]})]}),ft?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),ft&&a.jsx("div",{className:"px-4 pb-4",children:a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:()=>et.mutate({symbol:"MNQ",quantity:1,accountName:"PRAC"}),className:"px-4 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2",disabled:et.isLoading||!s,children:[a.jsx(Ti,{className:"w-4 h-4"}),et.isLoading?"Testing...":"Test Overnight Breakout"]}),a.jsx("p",{className:"text-sm text-slate-400",children:"Simulates overnight breakout trades on practice account (MNQ, 1 contract)"})]})})})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>v(x=>!x),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsx("div",{className:"flex items-center gap-3 text-left",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Open Positions"}),a.jsx("p",{className:"text-xs text-slate-400",children:r.length>0?`${r.length} position${r.length!==1?"s":""}`:"No positions"})]})}),Y?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),Y&&a.jsx("div",{className:"px-4 pb-4",children:$t?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Loading positions..."})]}):r.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400",children:[a.jsx(_e,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No open positions"})]}):a.jsx("div",{className:"space-y-3",children:r.map(x=>{const E=x.side==="LONG",L=Number(x.unrealized_pnl??0),Q=Number(x.realized_pnl??0),y=Number(x.entry_price??0),k=Number(x.current_price??y),T=L>=0?Ks:Hi,I=L>=0?"text-green-400":"text-red-400",$=x.id??"",R=$?b[$]??"":"",mt=$?S[$]??"":"",Z=$?N[$]??"":"",bt=$?q[$]??"":"",W=$?gt[$]??!1:!1,Mt=$?ot[$]??!1:!1,ht=x.timestamp?new Date(x.timestamp).toLocaleString():"",ut=typeof x.unrealized_pnl_pct=="number"&&isFinite(x.unrealized_pnl_pct)?`${x.unrealized_pnl_pct.toFixed(2)}%`:"",vt=typeof x.tick_size=="number"&&isFinite(x.tick_size)?x.tick_size:null,pt=typeof x.point_value=="number"&&isFinite(x.point_value)?x.point_value:null,X=!!x.id,_t=A===x.id;return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600 hover:border-slate-500 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${E?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:x.side}),a.jsx("span",{className:"font-semibold",children:x.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(x.quantity??0)]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:`flex items-center gap-1 ${I}`,children:[a.jsx(T,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-semibold",children:["$",L.toFixed(2)]})]}),a.jsxs("button",{onClick:()=>rt(x.id),className:"px-3 py-1 text-xs bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors flex items-center gap-1",disabled:!X||yt.isLoading,children:[a.jsx(Yh,{className:"w-3 h-3"}),"Close"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Entry"}),a.jsxs("p",{className:"font-semibold",children:["$",y.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current"}),a.jsxs("p",{className:"font-semibold",children:["$",k.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Realized P&L"}),a.jsxs("p",{className:`font-semibold ${Q>=0?"text-green-400":"text-red-400"}`,children:["$",Q.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Unrealized %"}),a.jsx("p",{className:"font-semibold text-slate-200",children:ut})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Stop Loss"}),a.jsx("p",{className:"font-semibold text-slate-200",children:x.stop_loss!==void 0&&x.stop_loss!==null?`$${Number(x.stop_loss).toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Take Profit"}),a.jsx("p",{className:"font-semibold text-slate-200",children:x.take_profit!==void 0&&x.take_profit!==null?`$${Number(x.take_profit).toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Opened"}),a.jsx("p",{className:"font-semibold text-slate-200",children:ht})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Tick Size"}),a.jsx("p",{className:"font-semibold text-slate-200",children:vt?vt.toFixed(4):""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Point Value"}),a.jsx("p",{className:"font-semibold text-slate-200",children:pt?`$${pt.toFixed(2)}`:""})]})]}),a.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wide",children:"Adjust Stop Loss"}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsx("input",{type:"number",value:mt,onChange:jt=>{x.id&&j(ct=>({...ct,[x.id]:jt.target.value}))},placeholder:"New stop price",className:"w-28 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!X}),a.jsx("button",{onClick:()=>V(x),className:"px-3 py-1 text-xs bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors",disabled:!X||At.isLoading,children:"Update SL"})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wide",children:"Adjust Take Profit"}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsx("input",{type:"number",value:Z,onChange:jt=>{x.id&&M(ct=>({...ct,[x.id]:jt.target.value}))},placeholder:"New target price",className:"w-28 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!X}),a.jsx("button",{onClick:()=>Qt(x),className:"px-3 py-1 text-xs bg-green-500/20 text-green-300 rounded hover:bg-green-500/30 transition-colors",disabled:!X||zt.isLoading,children:"Update TP"})]})]})]}),a.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:R,onChange:jt=>{x.id&&g(ct=>({...ct,[x.id]:jt.target.value}))},placeholder:"Qty",className:"w-20 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!X}),a.jsx("button",{onClick:()=>Oe(x),className:"px-3 py-1 text-xs bg-amber-500/20 text-amber-300 rounded hover:bg-amber-500/30 transition-colors",disabled:!X||yt.isLoading,children:"Partial Close"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",step:"0.01",value:bt,onChange:jt=>{x.id&&tt(ct=>({...ct,[x.id]:jt.target.value}))},placeholder:"Trail $",className:"w-24 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!X||W}),a.jsxs("button",{onClick:()=>Ot(x),className:`px-3 py-1 text-xs rounded transition-colors flex items-center gap-1 ${W?"bg-red-500/20 text-red-300 hover:bg-red-500/30":"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30"}`,disabled:!X||ie.isLoading||Bt.isLoading,children:[a.jsx(Li,{className:"w-3 h-3"}),W?"Disable Trail":"Enable Trail"]})]}),a.jsxs("button",{onClick:()=>ue(x),className:`px-3 py-1 text-xs rounded transition-colors flex items-center gap-1 ${Mt?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-slate-600/40 text-slate-200 hover:bg-slate-600/60"}`,disabled:!X||P.isLoading||kt.isLoading,children:[a.jsx(qh,{className:"w-3 h-3"}),Mt?"Breakeven ON":"Set Breakeven"]}),a.jsx("button",{onClick:()=>Zt(x.id),className:"px-3 py-1 text-xs bg-slate-600/40 text-slate-200 rounded hover:bg-slate-600/60 transition-colors flex items-center gap-1",children:_t?a.jsxs(a.Fragment,{children:[a.jsx(te,{className:"w-3 h-3"})," Hide Details"]}):a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-3 h-3"})," View Details"]})})]}),_t&&a.jsxs("div",{className:"mt-3 bg-slate-900/60 border border-slate-700/70 rounded-lg p-3 text-xs text-left overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[a.jsx(Ma,{className:"w-4 h-4"}),a.jsx("span",{children:"Raw position payload"})]}),a.jsx("pre",{className:"whitespace-pre-wrap text-slate-200",children:JSON.stringify(x._raw??x,null,2)})]})]},x.id||`${x.symbol}-${x.entry_price}`)})})})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>U(x=>!x),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsx("div",{className:"flex items-center gap-3 text-left",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Open Orders"}),a.jsx("p",{className:"text-xs text-slate-400",children:l.length>0?`${l.length} order${l.length!==1?"s":""}`:"No orders"})]})}),O?a.jsx(te,{className:"w-4 h-4 text-slate-400"}):a.jsx(Gt,{className:"w-4 h-4 text-slate-400"})]}),O&&a.jsx("div",{className:"px-4 pb-4",children:$t?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Loading orders..."})]}):l.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400",children:[a.jsx(_e,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No open orders"})]}):a.jsx("div",{className:"space-y-3",children:l.map(x=>{const E=x.side==="BUY",L=x.type||"UNKNOWN",Q=(x.status||"PENDING").toUpperCase(),y=Q!=="FILLED"&&Q!=="CANCELLED"&&Q!=="REJECTED",k=x.stop_price?Number(x.stop_price):null,T=x.stop_loss?Number(x.stop_loss):null,I=x.take_profit?Number(x.take_profit):null,$=T||I?`${T?`SL $${T.toFixed(2)}`:""}${T&&I?" / ":""}${I?`TP $${I.toFixed(2)}`:""}`:"";return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600 hover:border-slate-500 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${E?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:x.side}),a.jsx("span",{className:"font-semibold",children:x.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(x.quantity??0)]}),a.jsx("span",{className:`px-2 py-1 rounded text-xs ${Q==="FILLED"?"bg-green-500/20 text-green-400":Q==="CANCELLED"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:Q})]}),y&&a.jsx("div",{className:"flex items-center gap-2",children:(c==null?void 0:c.id)===x.id?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"number",value:d,onChange:R=>f(R.target.value),placeholder:"Price",className:"w-20 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200"}),a.jsx("input",{type:"number",value:p,onChange:R=>m(R.target.value),placeholder:"Qty",className:"w-16 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200"}),a.jsx("button",{onClick:Re,className:"px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors",disabled:Pt.isLoading,children:"Save"}),a.jsx("button",{onClick:()=>{u(null),f(""),m("")},className:"px-2 py-1 text-xs bg-slate-600 text-slate-300 rounded hover:bg-slate-500 transition-colors",children:"Cancel"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>Ee(x),className:"px-2 py-1 text-xs bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-1",disabled:Pt.isLoading,children:[a.jsx(Ih,{className:"w-3 h-3"}),"Modify"]}),a.jsxs("button",{onClick:()=>Et(x.id),className:"px-3 py-1 text-xs bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors flex items-center gap-1",disabled:lt.isLoading,children:[a.jsx(Bs,{className:"w-3 h-3"}),"Cancel"]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm sm:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Type"}),a.jsx("p",{className:"font-semibold",children:L})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Price"}),a.jsx("p",{className:"font-semibold",children:x.price?`$${Number(x.price).toFixed(2)}`:"Market"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Stop"}),a.jsx("p",{className:"font-semibold",children:k?`$${k.toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Bracket"}),a.jsx("p",{className:"font-semibold text-xs text-slate-200",children:$})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Time in Force"}),a.jsx("p",{className:"font-semibold text-slate-200",children:x.time_in_force||"DAY"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Order ID"}),a.jsx("p",{className:"font-mono text-xs text-slate-400 truncate",children:x.id})]})]})]},x.id)})})})]})]})}const Qd=["MNQ","MES","MYM","M2K","MGC","GC"];function Wd(){const{selectedAccount:i}=se(),t=Jt(),{data:e,isLoading:s}=Rt(["strategies"],de.getStrategies,{staleTime:3e4,refetchInterval:6e4}),[n,r]=_.useState(null),[o,l]=_.useState(null),[h,c]=_.useState(null),[u,d]=_.useState(null),[f,p]=_.useState(null),[m,b]=_.useState(null),[g,S]=_.useState({symbols:[],position_size:1,max_positions:2,strategy_params:{}}),j=wt(({name:v,symbols:O})=>de.startStrategy(v,O,i==null?void 0:i.id),{onSuccess:(v,O)=>{if(t.invalidateQueries(["strategies"]),r(null),v.success)console.log(` Started strategy: ${O}`);else{const U=v.error||v.message||"Unknown error";r(`Failed to start ${O}: ${U}`),console.error(` Failed to start strategy: ${U}`)}},onError:v=>{var U,D;console.error(" Strategy start error (full):",v),console.error(" Error response:",v==null?void 0:v.response),console.error(" Error response data:",(U=v==null?void 0:v.response)==null?void 0:U.data);let O="Unknown error";(D=v==null?void 0:v.response)!=null&&D.data?O=v.response.data.error||v.response.data.message||JSON.stringify(v.response.data)||"Unknown error":v!=null&&v.message&&(O=v.message),r(`Failed to start strategy: ${O}`)}}),N=wt(({name:v})=>de.stopStrategy(v,i==null?void 0:i.id),{onSuccess:(v,O)=>{if(t.invalidateQueries(["strategies"]),r(null),v.success)console.log(` Stopped strategy: ${O}`);else{const U=v.error||v.message||"Unknown error";r(`Failed to stop ${O}: ${U}`),console.error(` Failed to stop strategy: ${U}`)}},onError:v=>{var U,D;console.error(" Strategy stop error (full):",v),console.error(" Error response:",v==null?void 0:v.response),console.error(" Error response data:",(U=v==null?void 0:v.response)==null?void 0:U.data);let O="Unknown error";(D=v==null?void 0:v.response)!=null&&D.data?O=v.response.data.error||v.response.data.message||JSON.stringify(v.response.data)||"Unknown error":v!=null&&v.message&&(O=v.message),r(`Failed to stop strategy: ${O}`)}}),M=(v,O)=>{const U=e==null?void 0:e.find(yt=>yt.name===v),D=(U==null?void 0:U.symbols)??[],lt=(O||"").toLowerCase();(U==null?void 0:U.enabled)??["running","active","enabled","started"].includes(lt)?N.mutate({name:v}):j.mutate({name:v,symbols:D})},{data:A,isLoading:B}=Rt(["strategy-stats",h,i==null?void 0:i.id],()=>de.getStrategyStats(h,i==null?void 0:i.id),{enabled:!!h&&!!i,staleTime:3e4}),{data:F,isLoading:it}=Rt(["strategy-logs",u],()=>de.getStrategyLogs(u,50),{enabled:!!u,staleTime:1e4,refetchInterval:3e4}),{data:q,isLoading:tt,refetch:gt}=Rt(["strategy-verify",f],()=>de.verifyStrategy(f),{enabled:!!f,staleTime:3e4,refetchInterval:6e4}),st=wt(({name:v})=>de.testStrategy(v,i==null?void 0:i.id),{onSuccess:()=>{t.invalidateQueries(["strategies"])}}),ot=wt(({name:v,config:O})=>de.updateStrategyConfig(v,O),{onSuccess:(v,{name:O})=>{t.invalidateQueries(["strategies"]),b(null),r(null),v.success&&console.log(` Updated config for: ${O}`)},onError:v=>{var U;console.error(" Config update error:",v);let O="Unknown error";(U=v==null?void 0:v.response)!=null&&U.data?O=v.response.data.error||v.response.data.message||JSON.stringify(v.response.data):v!=null&&v.message&&(O=v.message),r(`Failed to update config: ${O}`)}}),nt=v=>{var U,D;b(v.name);const O={};v.settings&&(v.name==="overnight_range"||v.name.toLowerCase().includes("overnight"))&&(O.overnight_start_time=v.settings.overnight_start_time||"18:00",O.overnight_end_time=v.settings.overnight_end_time||"09:30",O.market_open_time=v.settings.market_open_time||"09:30",O.atr_period=v.settings.atr_period||14,O.atr_timeframe=v.settings.atr_timeframe||"5m",O.stop_atr_multiplier=v.settings.stop_atr_multiplier||1.25,O.tp_atr_multiplier=v.settings.tp_atr_multiplier||2,O.breakeven_enabled=v.settings.breakeven_enabled!==void 0?v.settings.breakeven_enabled:!0,O.breakeven_profit_points=v.settings.breakeven_profit_points||15,O.range_break_offset=v.settings.range_break_offset||.25),S({symbols:v.symbols||[],position_size:((U=v.settings)==null?void 0:U.position_size)||1,max_positions:((D=v.settings)==null?void 0:D.max_positions)||2,strategy_params:O})},ft=v=>{ot.mutate({name:v,config:{symbols:g.symbols,position_size:g.position_size,max_positions:g.max_positions,strategy_params:g.strategy_params}})},z=v=>{g.symbols.includes(v)||S({...g,symbols:[...g.symbols,v]})},Y=v=>{S({...g,symbols:g.symbols.filter(O=>O!==v)})};return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-slate-400",children:"Loading strategies..."})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Strategies"}),a.jsx("p",{className:"text-slate-400",children:"Manage your trading strategies"})]}),n&&a.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_e,{className:"w-5 h-5 text-red-400"}),a.jsx("p",{className:"text-red-400 text-sm",children:n})]}),a.jsx("button",{onClick:()=>r(null),className:"text-red-400 hover:text-red-300",children:a.jsx(Bs,{className:"w-4 h-4"})})]}),!i&&a.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-500 text-sm",children:" Please select an account to manage strategies"})}),a.jsx("div",{className:"space-y-4",children:e&&e.length>0?e.map(v=>{var O,U,D,lt,Pt,yt,At,zt,ie,Bt,P,kt,et,rt,Et,Ee,Re,Oe;return a.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 hover:border-slate-600 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:v.name}),(()=>{const V=(v.status||"").toLowerCase(),Qt=v.is_running??["running","active","started"].includes(V),Zt=v.enabled??["running","active","enabled","started"].includes(V),Ot=Qt?"bg-green-500/20 text-green-400":Zt?"bg-blue-500/20 text-blue-400":"bg-slate-600/50 text-slate-400",ue=Qt?"running":Zt?"enabled":V||"disabled";return a.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${Ot}`,children:ue})})()]}),a.jsxs("div",{className:"text-sm text-slate-400 space-y-1",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Symbols:"})," ",v.symbols&&v.symbols.length>0?v.symbols.join(", "):"N/A"]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Position Size:"})," ",((O=v.settings)==null?void 0:O.position_size)||1," contracts"]}),v.description&&a.jsx("p",{className:"mt-2",children:v.description})]}),v.stats&&a.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Trades"}),a.jsx("p",{className:"font-semibold",children:v.stats.total_trades||0})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Win Rate"}),a.jsx("p",{className:"font-semibold",children:v.stats.win_rate?`${v.stats.win_rate.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Total P&L"}),a.jsx("p",{className:`font-semibold ${(v.stats.total_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:v.stats.total_pnl?`$${v.stats.total_pnl.toFixed(2)}`:"$0.00"})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Avg P&L"}),a.jsx("p",{className:`font-semibold ${(v.stats.avg_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:v.stats.avg_pnl?`$${v.stats.avg_pnl.toFixed(2)}`:"$0.00"})]})]})]}),a.jsx("div",{className:"flex flex-col gap-2",children:(()=>{const V=(v.status||"").toLowerCase(),Qt=v.enabled??["running","active","enabled","started"].includes(V),Zt=j.isLoading||N.isLoading?"Loading...":Qt?"Disable":"Enable",Ot=Qt?"bg-red-600 hover:bg-red-500 text-white":"bg-green-600 hover:bg-green-500 text-white";return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>M(v.name,v.status),disabled:j.isLoading||N.isLoading||!i,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${Ot} disabled:opacity-50 disabled:cursor-not-allowed`,children:Zt}),a.jsx("button",{onClick:()=>l(o===v.name?null:v.name),className:"px-4 py-2 rounded-lg font-semibold text-sm transition-colors bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center gap-2",children:o===v.name?a.jsxs(a.Fragment,{children:[a.jsx(te,{className:"w-4 h-4"})," Hide Details"]}):a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-4 h-4"})," Show Details"]})}),a.jsxs("button",{onClick:()=>{o!==v.name&&l(v.name),p(v.name),d(null),c(null),gt()},className:"px-4 py-2 rounded-lg font-semibold text-sm transition-colors bg-emerald-600 hover:bg-emerald-500 text-white flex items-center justify-center gap-2",children:[a.jsx(Ae,{className:"w-4 h-4"}),"Verify"]}),a.jsxs("button",{onClick:()=>{o!==v.name&&l(v.name),nt(v)},className:"px-4 py-2 rounded-lg font-semibold text-sm transition-colors bg-orange-500 hover:bg-orange-400 text-white flex items-center justify-center gap-2",children:[a.jsx(Fi,{className:"w-4 h-4"}),"Configure"]}),a.jsxs("button",{onClick:()=>{o!==v.name&&l(v.name),st.mutate({name:v.name})},disabled:st.isLoading||!i,className:"px-4 py-2 rounded-lg font-semibold text-sm transition-colors bg-purple-600 hover:bg-purple-500 text-white flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[st.isLoading?a.jsx(le,{className:"w-4 h-4 animate-spin"}):a.jsx(Ti,{className:"w-4 h-4"}),"Test"]})]})})()}),o===v.name&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>{c(v.name),h!==v.name&&d(null)},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${h===v.name?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(ja,{className:"w-4 h-4"}),"Stats"]}),a.jsxs("button",{onClick:()=>{d(v.name),u!==v.name&&(c(null),p(null))},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${u===v.name?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(Ah,{className:"w-4 h-4"}),"Logs"]}),a.jsxs("button",{onClick:()=>{p(v.name),f!==v.name&&(c(null),d(null))},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${f===v.name?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(Ae,{className:"w-4 h-4"}),"Verify"]}),a.jsxs("button",{onClick:()=>st.mutate({name:v.name}),disabled:st.isLoading||!i,className:"px-3 py-2 rounded text-sm font-medium transition-colors bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[st.isLoading?a.jsx(le,{className:"w-4 h-4 animate-spin"}):a.jsx(Ti,{className:"w-4 h-4"}),"Test"]}),a.jsxs("button",{onClick:()=>{m===v.name?b(null):nt(v)},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${m===v.name?"bg-orange-500/20 text-orange-300 border border-orange-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(Fi,{className:"w-4 h-4"}),"Configure"]})]}),m===v.name&&a.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 space-y-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-300",children:"Strategy Configuration"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-2",children:"Trading Symbols"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:g.symbols.map(V=>a.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-sm flex items-center gap-1",children:[V,a.jsx("button",{onClick:()=>Y(V),className:"hover:text-red-400 transition-colors",children:a.jsx(Bs,{className:"w-3 h-3"})})]},V))}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Qd.filter(V=>!g.symbols.includes(V)).map(V=>a.jsxs("button",{onClick:()=>z(V),className:"px-2 py-1 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded text-xs flex items-center gap-1 transition-colors",children:[a.jsx(zh,{className:"w-3 h-3"}),V]},V))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-2",children:"Position Size (contracts)"}),a.jsx("input",{type:"number",min:"1",max:"100",value:g.position_size,onChange:V=>S({...g,position_size:Math.max(1,parseInt(V.target.value)||1)}),className:"w-24 px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-2",children:"Max Concurrent Positions"}),a.jsx("input",{type:"number",min:"1",max:"10",value:g.max_positions,onChange:V=>S({...g,max_positions:Math.max(1,parseInt(V.target.value)||1)}),className:"w-24 px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),(v.name==="overnight_range"||v.name.toLowerCase().includes("overnight"))&&a.jsxs("div",{className:"border-t border-slate-700 pt-4 space-y-3",children:[a.jsx("h5",{className:"text-xs font-semibold text-slate-300 mb-2",children:"Overnight Range Strategy Parameters"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Overnight Start Time"}),a.jsx("input",{type:"text",placeholder:"18:00",value:((U=g.strategy_params)==null?void 0:U.overnight_start_time)||"18:00",onChange:V=>S({...g,strategy_params:{...g.strategy_params,overnight_start_time:V.target.value}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Overnight End Time"}),a.jsx("input",{type:"text",placeholder:"09:30",value:((D=g.strategy_params)==null?void 0:D.overnight_end_time)||"09:30",onChange:V=>S({...g,strategy_params:{...g.strategy_params,overnight_end_time:V.target.value}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Market Open Time"}),a.jsx("input",{type:"text",placeholder:"09:30",value:((lt=g.strategy_params)==null?void 0:lt.market_open_time)||"09:30",onChange:V=>S({...g,strategy_params:{...g.strategy_params,market_open_time:V.target.value}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"ATR Period"}),a.jsx("input",{type:"number",min:"1",max:"100",value:((Pt=g.strategy_params)==null?void 0:Pt.atr_period)||14,onChange:V=>S({...g,strategy_params:{...g.strategy_params,atr_period:parseInt(V.target.value)||14}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"ATR Timeframe"}),a.jsxs("select",{value:((yt=g.strategy_params)==null?void 0:yt.atr_timeframe)||"5m",onChange:V=>S({...g,strategy_params:{...g.strategy_params,atr_timeframe:V.target.value}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500",children:[a.jsx("option",{value:"1m",children:"1m"}),a.jsx("option",{value:"5m",children:"5m"}),a.jsx("option",{value:"15m",children:"15m"}),a.jsx("option",{value:"1h",children:"1h"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Stop ATR Multiplier"}),a.jsx("input",{type:"number",step:"0.1",min:"0.5",max:"5",value:((At=g.strategy_params)==null?void 0:At.stop_atr_multiplier)||1.25,onChange:V=>S({...g,strategy_params:{...g.strategy_params,stop_atr_multiplier:parseFloat(V.target.value)||1.25}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"TP ATR Multiplier"}),a.jsx("input",{type:"number",step:"0.1",min:"0.5",max:"10",value:((zt=g.strategy_params)==null?void 0:zt.tp_atr_multiplier)||2,onChange:V=>S({...g,strategy_params:{...g.strategy_params,tp_atr_multiplier:parseFloat(V.target.value)||2}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Breakeven Profit Points"}),a.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",value:((ie=g.strategy_params)==null?void 0:ie.breakeven_profit_points)||15,onChange:V=>S({...g,strategy_params:{...g.strategy_params,breakeven_profit_points:parseFloat(V.target.value)||15}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Range Break Offset"}),a.jsx("input",{type:"number",step:"0.01",min:"0",max:"10",value:((Bt=g.strategy_params)==null?void 0:Bt.range_break_offset)||.25,onChange:V=>S({...g,strategy_params:{...g.strategy_params,range_break_offset:parseFloat(V.target.value)||.25}}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:((P=g.strategy_params)==null?void 0:P.breakeven_enabled)!==!1,onChange:V=>S({...g,strategy_params:{...g.strategy_params,breakeven_enabled:V.target.checked}}),className:"w-4 h-4 rounded bg-slate-800 border-slate-600 text-blue-500 focus:ring-blue-500"}),a.jsx("label",{className:"text-xs text-slate-400",children:"Enable Breakeven Stop Management"})]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs("button",{onClick:()=>ft(v.name),disabled:ot.isLoading||g.symbols.length===0,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[ot.isLoading?a.jsx(le,{className:"w-4 h-4 animate-spin"}):a.jsx($h,{className:"w-4 h-4"}),"Save Changes"]}),a.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded text-sm font-medium transition-colors",children:"Cancel"})]})]}),h===v.name&&a.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4",children:B?a.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading stats..."}):A&&!A.error?a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total Trades"}),a.jsx("p",{className:"text-lg font-semibold",children:A.total_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Win Rate"}),a.jsxs("p",{className:"text-lg font-semibold",children:[((kt=A.win_rate)==null?void 0:kt.toFixed(1))||0,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total P&L"}),a.jsxs("p",{className:`text-lg font-semibold ${(A.total_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:["$",((et=A.total_pnl)==null?void 0:et.toFixed(2))||"0.00"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Profit Factor"}),a.jsx("p",{className:"text-lg font-semibold",children:((rt=A.profit_factor)==null?void 0:rt.toFixed(2))||"0.00"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Winning Trades"}),a.jsx("p",{className:"text-lg font-semibold text-green-400",children:A.winning_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Losing Trades"}),a.jsx("p",{className:"text-lg font-semibold text-red-400",children:A.losing_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Best Trade"}),a.jsxs("p",{className:"text-lg font-semibold text-green-400",children:["$",((Et=A.best_trade)==null?void 0:Et.toFixed(2))||"0.00"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Worst Trade"}),a.jsxs("p",{className:"text-lg font-semibold text-red-400",children:["$",((Ee=A.worst_trade)==null?void 0:Ee.toFixed(2))||"0.00"]})]})]}):a.jsx("div",{className:"text-center py-4 text-slate-400",children:(A==null?void 0:A.error)||"No stats available"})}),f===v.name&&a.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-4",children:"Strategy Verification"}),tt?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(le,{className:"w-6 h-6 animate-spin mx-auto text-slate-400"}),a.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Verifying strategy..."})]}):q?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:`p-3 rounded-lg border-2 ${q.will_trade?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[q.will_trade?a.jsx(Ae,{className:"w-5 h-5 text-green-400"}):a.jsx(_e,{className:"w-5 h-5 text-red-400"}),a.jsx("span",{className:`font-semibold ${q.will_trade?"text-green-400":"text-red-400"}`,children:q.will_trade?" Will Trade":" Will NOT Trade"})]}),a.jsx("div",{className:"space-y-1 text-sm",children:(Re=q.reasons)==null?void 0:Re.map((V,Qt)=>a.jsxs("p",{className:"text-slate-300",children:[" ",V]},Qt))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-500 mb-1",children:"Status"}),a.jsx("p",{className:"text-slate-200 font-medium",children:q.status})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-500 mb-1",children:"Enabled"}),a.jsx("p",{className:`font-medium ${q.enabled?"text-green-400":"text-red-400"}`,children:q.enabled?"Yes":"No"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-500 mb-1",children:"Symbols"}),a.jsx("p",{className:"text-slate-200 font-medium",children:((Oe=q.symbols)==null?void 0:Oe.join(", "))||"None"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-500 mb-1",children:"Position Size"}),a.jsx("p",{className:"text-slate-200 font-medium",children:q.position_size||"N/A"})]})]}),q.next_execution&&a.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:[a.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Next Execution"}),a.jsx("p",{className:"text-lg font-semibold text-blue-300",children:q.next_execution_human||q.next_execution}),q.hours_until_execution&&a.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["In ",q.hours_until_execution.toFixed(1)," hours"]}),q.market_open_time&&a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Market Open: ",q.market_open_time," ",q.timezone||"US/Eastern"]})]})]}):a.jsx("div",{className:"text-center py-4 text-slate-400",children:"No verification data available"})]}),u===v.name&&a.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4 max-h-96 overflow-y-auto",children:it?a.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading logs..."}):F!=null&&F.logs&&F.logs.length>0?a.jsx("div",{className:"space-y-2 font-mono text-xs",children:F.logs.map((V,Qt)=>a.jsxs("div",{className:`p-2 rounded border-l-2 ${V.level==="ERROR"||V.level==="CRITICAL"?"border-red-500 bg-red-500/10":V.level==="WARNING"?"border-yellow-500 bg-yellow-500/10":"border-slate-600 bg-slate-800/50"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"text-slate-400",children:V.timestamp}),a.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${V.level==="ERROR"||V.level==="CRITICAL"?"bg-red-500/20 text-red-300":V.level==="WARNING"?"bg-yellow-500/20 text-yellow-300":"bg-slate-700 text-slate-300"}`,children:V.level})]}),a.jsx("p",{className:"text-slate-200 break-words",children:V.message})]},Qt))}):a.jsx("div",{className:"text-center py-4 text-slate-400",children:"No logs available"})})]})]})},v.name)}):a.jsx("div",{className:"bg-slate-800 rounded-lg p-12 border border-slate-700 text-center",children:a.jsx("p",{className:"text-slate-400",children:"No strategies configured"})})})]})}function Hd(){return a.jsx(Wd,{})}function Jd(){const{accounts:i,selectedAccount:t,setSelectedAccount:e}=se(),s=Jt(),[n,r]=_.useState("auto"),[o,l]=_.useState(!0),[h,c]=_.useState(!0),[u,d]=_.useState("ws://localhost:8081"),[f,p]=_.useState("http://localhost:8080"),[m,b]=_.useState(null),{data:g,isLoading:S}=Rt(["settings","global"],()=>ss.getSettings("global"),{staleTime:6e4,refetchOnWindowFocus:!1});_.useEffect(()=>{if(g!=null&&g.settings){const F=g.settings;r(F.defaultAccount??"auto"),l(F.riskManagementEnabled??!0),c(F.discordNotificationsEnabled??!0),d(F.wsUrl||"ws://localhost:8081"),p(F.apiUrl||"http://localhost:8080")}},[g]);const j=wt(F=>ss.saveSettings(F),{onSuccess:()=>{s.invalidateQueries(["settings","global"]),b(" Settings saved successfully!"),setTimeout(()=>b(null),3e3)},onError:F=>{console.error("Failed to save settings:",F),b(" Failed to save settings"),setTimeout(()=>b(null),4e3)}}),N=()=>{j.mutate({defaultAccount:n==="auto"?null:n,riskManagementEnabled:o,discordNotificationsEnabled:h,wsUrl:u,apiUrl:f})},M=()=>{l(!o)},A=()=>{c(!h)},B=F=>{e(F),F&&r(String(F.id))};return S?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-slate-400",children:"Loading settings..."})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Configure your trading bot"})]}),m&&a.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg px-4 py-2",children:a.jsx("p",{className:"text-green-400 text-sm",children:m})})]}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ji,{accounts:i,selectedAccount:t,onAccountChange:B})}),a.jsxs("div",{className:"grid gap-6",children:[a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Account Settings"}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Default Account"}),a.jsxs("select",{value:n,onChange:F=>r(F.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",children:[a.jsx("option",{value:"auto",children:" Auto-select"}),i.map(F=>{var it;return a.jsxs("option",{value:F.id,children:[F.name," - $",((it=F.balance)==null?void 0:it.toLocaleString())||"0"]},F.id)})]}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"The account to use by default when the bot starts"})]})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Trading Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Risk Management"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Enable automatic risk controls"})]}),a.jsx("button",{onClick:M,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${o?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 hover:bg-slate-500 text-white"}`,children:o?"Enabled":"Disabled"})]}),a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Discord Notifications"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Send trade alerts to Discord"})]}),a.jsx("button",{onClick:A,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${h?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 hover:bg-slate-500 text-white"}`,children:h?"Enabled":"Disabled"})]})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"System Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"WebSocket URL"}),a.jsx("input",{type:"text",value:u,onChange:F=>d(F.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",placeholder:"ws://localhost:8081"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"WebSocket server for real-time updates"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API URL"}),a.jsx("input",{type:"text",value:f,onChange:F=>p(F.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",placeholder:"http://localhost:8080"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Backend API server URL"})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:N,className:"bg-primary-600 hover:bg-primary-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:j.isLoading,children:j.isLoading?"Saving...":"Save All Settings"})})]})]})}function Kd({children:i}){const t=so(),e=[{path:"/",icon:ja,label:"Dashboard"},{path:"/positions",icon:Ks,label:"Positions"},{path:"/strategies",icon:zs,label:"Strategies"},{path:"/settings",icon:Fi,label:"Settings"}];return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("aside",{className:"fixed left-0 top-0 h-full w-64 bg-slate-800 border-r border-slate-700",children:[a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary-400",children:"TopStepX"}),a.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Trading Dashboard"})]}),a.jsx("nav",{className:"mt-8",children:e.map(s=>{const n=s.icon,r=t.pathname===s.path;return a.jsxs(_i,{to:s.path,className:`flex items-center gap-3 px-6 py-3 transition-colors ${r?"bg-primary-600 text-white border-r-2 border-primary-400":"text-slate-300 hover:bg-slate-700"}`,children:[a.jsx(n,{className:"w-5 h-5"}),a.jsx("span",{children:s.label})]},s.path)})})]}),a.jsx("main",{className:"ml-64 p-8",children:i})]})}const Gd=new Do({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function Zd(){return a.jsx(Vo,{client:Gd,children:a.jsx(Eh,{children:a.jsx(Mh,{children:a.jsx(io,{children:a.jsx(Kd,{children:a.jsxs(no,{children:[a.jsx(fs,{path:"/",element:a.jsx(oc,{})}),a.jsx(fs,{path:"/positions",element:a.jsx(Yd,{})}),a.jsx(fs,{path:"/strategies",element:a.jsx(Hd,{})}),a.jsx(fs,{path:"/settings",element:a.jsx(Jd,{})})]})})})})})})}ji.createRoot(document.getElementById("root")).render(a.jsx(Ct.StrictMode,{children:a.jsx(Zd,{})}));
