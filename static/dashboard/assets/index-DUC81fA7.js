var qo=Object.defineProperty;var Qo=(i,t,e)=>t in i?qo(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Rt=(i,t,e)=>Qo(i,typeof t!="symbol"?t+"":t,e);import{r as M,a as Ko,b as Ho,R as st,L as Zs,u as Jo,B as Xo,d as Go,e as De}from"./react-vendor-kWENTzfD.js";import{_ as D,a as ce,R as Zo,L as Yo,C as ta,X as ea,Y as Wi,T as sa,b as ia,c as Ms}from"./chart-vendor-BXD5TvhH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();var br={exports:{}},fs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var na=M,ra=Symbol.for("react.element"),oa=Symbol.for("react.fragment"),aa=Object.prototype.hasOwnProperty,la=na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ha={key:!0,ref:!0,__self:!0,__source:!0};function vr(i,t,e){var s,n={},r=null,o=null;e!==void 0&&(r=""+e),t.key!==void 0&&(r=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)aa.call(t,s)&&!ha.hasOwnProperty(s)&&(n[s]=t[s]);if(i&&i.defaultProps)for(s in t=i.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:ra,type:i,key:r,ref:o,props:n,_owner:la.current}}fs.Fragment=oa;fs.jsx=vr;fs.jsxs=vr;br.exports=fs;var a=br.exports,Ys={},qi=Ko;Ys.createRoot=qi.createRoot,Ys.hydrateRoot=qi.hydrateRoot;var ue=function(){function i(){this.listeners=[]}var t=i.prototype;return t.subscribe=function(s){var n=this,r=s||function(){};return this.listeners.push(r),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(o){return o!==r}),n.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},i}(),ns=typeof window>"u";function at(){}function ca(i,t){return typeof i=="function"?i(t):i}function ti(i){return typeof i=="number"&&i>=0&&i!==1/0}function rs(i){return Array.isArray(i)?i:[i]}function gr(i,t){return Math.max(i+(t||0)-Date.now(),0)}function Ge(i,t,e){return Ee(i)?typeof t=="function"?D({},e,{queryKey:i,queryFn:t}):D({},t,{queryKey:i}):i}function ua(i,t,e){return Ee(i)?typeof t=="function"?D({},e,{mutationKey:i,mutationFn:t}):D({},t,{mutationKey:i}):typeof i=="function"?D({},t,{mutationFn:i}):D({},i)}function $t(i,t,e){return Ee(i)?[D({},t,{queryKey:i}),e]:[i||{},t]}function da(i,t){if(i===!0&&t===!0||i==null&&t==null)return"all";if(i===!1&&t===!1)return"none";var e=i??!t;return e?"active":"inactive"}function Qi(i,t){var e=i.active,s=i.exact,n=i.fetching,r=i.inactive,o=i.predicate,l=i.queryKey,h=i.stale;if(Ee(l)){if(s){if(t.queryHash!==bi(l,t.options))return!1}else if(!os(t.queryKey,l))return!1}var c=da(e,r);if(c==="none")return!1;if(c!=="all"){var u=t.isActive();if(c==="active"&&!u||c==="inactive"&&u)return!1}return!(typeof h=="boolean"&&t.isStale()!==h||typeof n=="boolean"&&t.isFetching()!==n||o&&!o(t))}function Ki(i,t){var e=i.exact,s=i.fetching,n=i.predicate,r=i.mutationKey;if(Ee(r)){if(!t.options.mutationKey)return!1;if(e){if(Bt(t.options.mutationKey)!==Bt(r))return!1}else if(!os(t.options.mutationKey,r))return!1}return!(typeof s=="boolean"&&t.state.status==="loading"!==s||n&&!n(t))}function bi(i,t){var e=(t==null?void 0:t.queryKeyHashFn)||Bt;return e(i)}function Bt(i){var t=rs(i);return fa(t)}function fa(i){return JSON.stringify(i,function(t,e){return ei(e)?Object.keys(e).sort().reduce(function(s,n){return s[n]=e[n],s},{}):e})}function os(i,t){return xr(rs(i),rs(t))}function xr(i,t){return i===t?!0:typeof i!=typeof t?!1:i&&t&&typeof i=="object"&&typeof t=="object"?!Object.keys(t).some(function(e){return!xr(i[e],t[e])}):!1}function as(i,t){if(i===t)return i;var e=Array.isArray(i)&&Array.isArray(t);if(e||ei(i)&&ei(t)){for(var s=e?i.length:Object.keys(i).length,n=e?t:Object.keys(t),r=n.length,o=e?[]:{},l=0,h=0;h<r;h++){var c=e?h:n[h];o[c]=as(i[c],t[c]),o[c]===i[c]&&l++}return s===r&&l===s?i:o}return t}function ma(i,t){if(i&&!t||t&&!i)return!1;for(var e in i)if(i[e]!==t[e])return!1;return!0}function ei(i){if(!Hi(i))return!1;var t=i.constructor;if(typeof t>"u")return!0;var e=t.prototype;return!(!Hi(e)||!e.hasOwnProperty("isPrototypeOf"))}function Hi(i){return Object.prototype.toString.call(i)==="[object Object]"}function Ee(i){return typeof i=="string"||Array.isArray(i)}function pa(i){return new Promise(function(t){setTimeout(t,i)})}function Ji(i){Promise.resolve().then(i).catch(function(t){return setTimeout(function(){throw t})})}function yr(){if(typeof AbortController=="function")return new AbortController}var ba=function(i){ce(t,i);function t(){var s;return s=i.call(this)||this,s.setup=function(n){var r;if(!ns&&((r=window)!=null&&r.addEventListener)){var o=function(){return n()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var e=t.prototype;return e.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},e.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},e.setEventListener=function(n){var r,o=this;this.setup=n,(r=this.cleanup)==null||r.call(this),this.cleanup=n(function(l){typeof l=="boolean"?o.setFocused(l):o.onFocus()})},e.setFocused=function(n){this.focused=n,n&&this.onFocus()},e.onFocus=function(){this.listeners.forEach(function(n){n()})},e.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},t}(ue),ge=new ba,va=function(i){ce(t,i);function t(){var s;return s=i.call(this)||this,s.setup=function(n){var r;if(!ns&&((r=window)!=null&&r.addEventListener)){var o=function(){return n()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var e=t.prototype;return e.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},e.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},e.setEventListener=function(n){var r,o=this;this.setup=n,(r=this.cleanup)==null||r.call(this),this.cleanup=n(function(l){typeof l=="boolean"?o.setOnline(l):o.onOnline()})},e.setOnline=function(n){this.online=n,n&&this.onOnline()},e.onOnline=function(){this.listeners.forEach(function(n){n()})},e.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},t}(ue),Ze=new va;function ga(i){return Math.min(1e3*Math.pow(2,i),3e4)}function ls(i){return typeof(i==null?void 0:i.cancel)=="function"}var wr=function(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent};function Ye(i){return i instanceof wr}var Sr=function(t){var e=this,s=!1,n,r,o,l;this.abort=t.abort,this.cancel=function(f){return n==null?void 0:n(f)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return r==null?void 0:r()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(f,b){o=f,l=b});var h=function(b){e.isResolved||(e.isResolved=!0,t.onSuccess==null||t.onSuccess(b),r==null||r(),o(b))},c=function(b){e.isResolved||(e.isResolved=!0,t.onError==null||t.onError(b),r==null||r(),l(b))},u=function(){return new Promise(function(b){r=b,e.isPaused=!0,t.onPause==null||t.onPause()}).then(function(){r=void 0,e.isPaused=!1,t.onContinue==null||t.onContinue()})},d=function f(){if(!e.isResolved){var b;try{b=t.fn()}catch(m){b=Promise.reject(m)}n=function(p){if(!e.isResolved&&(c(new wr(p)),e.abort==null||e.abort(),ls(b)))try{b.cancel()}catch{}},e.isTransportCancelable=ls(b),Promise.resolve(b).then(h).catch(function(m){var p,x;if(!e.isResolved){var w=(p=t.retry)!=null?p:3,_=(x=t.retryDelay)!=null?x:ga,N=typeof _=="function"?_(e.failureCount,m):_,g=w===!0||typeof w=="number"&&e.failureCount<w||typeof w=="function"&&w(e.failureCount,m);if(s||!g){c(m);return}e.failureCount++,t.onFail==null||t.onFail(e.failureCount,m),pa(N).then(function(){if(!ge.isFocused()||!Ze.isOnline())return u()}).then(function(){s?c(m):f()})}})}};d()},xa=function(){function i(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=i.prototype;return t.batch=function(s){var n;this.transactions++;try{n=s()}finally{this.transactions--,this.transactions||this.flush()}return n},t.schedule=function(s){var n=this;this.transactions?this.queue.push(s):Ji(function(){n.notifyFn(s)})},t.batchCalls=function(s){var n=this;return function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];n.schedule(function(){s.apply(void 0,o)})}},t.flush=function(){var s=this,n=this.queue;this.queue=[],n.length&&Ji(function(){s.batchNotifyFn(function(){n.forEach(function(r){s.notifyFn(r)})})})},t.setNotifyFunction=function(s){this.notifyFn=s},t.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},i}(),G=new xa,Nr=console;function hs(){return Nr}function ya(i){Nr=i}var wa=function(){function i(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=i.prototype;return t.setOptions=function(s){var n;this.options=D({},this.defaultOptions,s),this.meta=s==null?void 0:s.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},t.setDefaultOptions=function(s){this.defaultOptions=s},t.scheduleGc=function(){var s=this;this.clearGcTimeout(),ti(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(s,n){var r,o,l=this.state.data,h=ca(s,l);return(r=(o=this.options).isDataEqual)!=null&&r.call(o,l,h)?h=l:this.options.structuralSharing!==!1&&(h=as(l,h)),this.dispatch({data:h,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt}),h},t.setState=function(s,n){this.dispatch({type:"setState",state:s,setStateOptions:n})},t.cancel=function(s){var n,r=this.promise;return(n=this.retryer)==null||n.cancel(s),r?r.then(at).catch(at):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},t.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!gr(this.state.dataUpdatedAt,s)},t.onFocus=function(){var s,n=this.observers.find(function(r){return r.shouldFetchOnWindowFocus()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},t.onOnline=function(){var s,n=this.observers.find(function(r){return r.shouldFetchOnReconnect()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},t.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},t.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(n){return n!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(s,n){var r=this,o,l,h;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var c;return(c=this.retryer)==null||c.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var u=this.observers.find(function(_){return _.options.queryFn});u&&this.setOptions(u.options)}var d=rs(this.queryKey),f=yr(),b={queryKey:d,pageParam:void 0,meta:this.meta};Object.defineProperty(b,"signal",{enumerable:!0,get:function(){if(f)return r.abortSignalConsumed=!0,f.signal}});var m=function(){return r.options.queryFn?(r.abortSignalConsumed=!1,r.options.queryFn(b)):Promise.reject("Missing queryFn")},p={fetchOptions:n,options:this.options,queryKey:d,state:this.state,fetchFn:m,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var x;(x=this.options.behavior)==null||x.onFetch(p)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((l=p.fetchOptions)==null?void 0:l.meta)){var w;this.dispatch({type:"fetch",meta:(w=p.fetchOptions)==null?void 0:w.meta})}return this.retryer=new Sr({fn:p.fetchFn,abort:f==null||(h=f.abort)==null?void 0:h.bind(f),onSuccess:function(N){r.setData(N),r.cache.config.onSuccess==null||r.cache.config.onSuccess(N,r),r.cacheTime===0&&r.optionalRemove()},onError:function(N){Ye(N)&&N.silent||r.dispatch({type:"error",error:N}),Ye(N)||(r.cache.config.onError==null||r.cache.config.onError(N,r),hs().error(N)),r.cacheTime===0&&r.optionalRemove()},onFail:function(){r.dispatch({type:"failed"})},onPause:function(){r.dispatch({type:"pause"})},onContinue:function(){r.dispatch({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(s){var n=this;this.state=this.reducer(this.state,s),G.batch(function(){n.observers.forEach(function(r){r.onQueryUpdate(s)}),n.cache.notify({query:n,type:"queryUpdated",action:s})})},t.getDefaultState=function(s){var n=typeof s.initialData=="function"?s.initialData():s.initialData,r=typeof s.initialData<"u",o=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,l=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:l?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:l?"success":"idle"}},t.reducer=function(s,n){var r,o;switch(n.type){case"failed":return D({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return D({},s,{isPaused:!0});case"continue":return D({},s,{isPaused:!1});case"fetch":return D({},s,{fetchFailureCount:0,fetchMeta:(r=n.meta)!=null?r:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return D({},s,{data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=n.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var l=n.error;return Ye(l)&&l.revert&&this.revertState?D({},this.revertState):D({},s,{error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return D({},s,{isInvalidated:!0});case"setState":return D({},s,n.state);default:return s}},i}(),Sa=function(i){ce(t,i);function t(s){var n;return n=i.call(this)||this,n.config=s||{},n.queries=[],n.queriesMap={},n}var e=t.prototype;return e.build=function(n,r,o){var l,h=r.queryKey,c=(l=r.queryHash)!=null?l:bi(h,r),u=this.get(c);return u||(u=new wa({cache:this,queryKey:h,queryHash:c,options:n.defaultQueryOptions(r),state:o,defaultOptions:n.getQueryDefaults(h),meta:r.meta}),this.add(u)),u},e.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},e.remove=function(n){var r=this.queriesMap[n.queryHash];r&&(n.destroy(),this.queries=this.queries.filter(function(o){return o!==n}),r===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},e.clear=function(){var n=this;G.batch(function(){n.queries.forEach(function(r){n.remove(r)})})},e.get=function(n){return this.queriesMap[n]},e.getAll=function(){return this.queries},e.find=function(n,r){var o=$t(n,r),l=o[0];return typeof l.exact>"u"&&(l.exact=!0),this.queries.find(function(h){return Qi(l,h)})},e.findAll=function(n,r){var o=$t(n,r),l=o[0];return Object.keys(l).length>0?this.queries.filter(function(h){return Qi(l,h)}):this.queries},e.notify=function(n){var r=this;G.batch(function(){r.listeners.forEach(function(o){o(n)})})},e.onFocus=function(){var n=this;G.batch(function(){n.queries.forEach(function(r){r.onFocus()})})},e.onOnline=function(){var n=this;G.batch(function(){n.queries.forEach(function(r){r.onOnline()})})},t}(ue),Na=function(){function i(e){this.options=D({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||jr(),this.meta=e.meta}var t=i.prototype;return t.setState=function(s){this.dispatch({type:"setState",state:s})},t.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},t.removeObserver=function(s){this.observers=this.observers.filter(function(n){return n!==s})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(at).catch(at)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var s=this,n,r=this.state.status==="loading",o=Promise.resolve();return r||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(l){l!==s.state.context&&s.dispatch({type:"loading",context:l,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(l){n=l,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(n,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(n,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(n,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:n}),n}).catch(function(l){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(l,s.state.variables,s.state.context,s),hs().error(l),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(l,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,l,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:l}),l})})},t.executeMutation=function(){var s=this,n;return this.retryer=new Sr({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(s){var n=this;this.state=ja(this.state,s),G.batch(function(){n.observers.forEach(function(r){r.onMutationUpdate(s)}),n.mutationCache.notify(n)})},i}();function jr(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function ja(i,t){switch(t.type){case"failed":return D({},i,{failureCount:i.failureCount+1});case"pause":return D({},i,{isPaused:!0});case"continue":return D({},i,{isPaused:!1});case"loading":return D({},i,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return D({},i,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return D({},i,{data:void 0,error:t.error,failureCount:i.failureCount+1,isPaused:!1,status:"error"});case"setState":return D({},i,t.state);default:return i}}var _a=function(i){ce(t,i);function t(s){var n;return n=i.call(this)||this,n.config=s||{},n.mutations=[],n.mutationId=0,n}var e=t.prototype;return e.build=function(n,r,o){var l=new Na({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(r),state:o,defaultOptions:r.mutationKey?n.getMutationDefaults(r.mutationKey):void 0,meta:r.meta});return this.add(l),l},e.add=function(n){this.mutations.push(n),this.notify(n)},e.remove=function(n){this.mutations=this.mutations.filter(function(r){return r!==n}),n.cancel(),this.notify(n)},e.clear=function(){var n=this;G.batch(function(){n.mutations.forEach(function(r){n.remove(r)})})},e.getAll=function(){return this.mutations},e.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(r){return Ki(n,r)})},e.findAll=function(n){return this.mutations.filter(function(r){return Ki(n,r)})},e.notify=function(n){var r=this;G.batch(function(){r.listeners.forEach(function(o){o(n)})})},e.onFocus=function(){this.resumePausedMutations()},e.onOnline=function(){this.resumePausedMutations()},e.resumePausedMutations=function(){var n=this.mutations.filter(function(r){return r.state.isPaused});return G.batch(function(){return n.reduce(function(r,o){return r.then(function(){return o.continue().catch(at)})},Promise.resolve())})},t}(ue);function Ca(){return{onFetch:function(t){t.fetchFn=function(){var e,s,n,r,o,l,h=(e=t.fetchOptions)==null||(s=e.meta)==null?void 0:s.refetchPage,c=(n=t.fetchOptions)==null||(r=n.meta)==null?void 0:r.fetchMore,u=c==null?void 0:c.pageParam,d=(c==null?void 0:c.direction)==="forward",f=(c==null?void 0:c.direction)==="backward",b=((o=t.state.data)==null?void 0:o.pages)||[],m=((l=t.state.data)==null?void 0:l.pageParams)||[],p=yr(),x=p==null?void 0:p.signal,w=m,_=!1,N=t.options.queryFn||function(){return Promise.reject("Missing queryFn")},g=function(U,O,F,it){return w=it?[O].concat(w):[].concat(w,[O]),it?[F].concat(U):[].concat(U,[F])},j=function(U,O,F,it){if(_)return Promise.reject("Cancelled");if(typeof F>"u"&&!O&&U.length)return Promise.resolve(U);var $={queryKey:t.queryKey,signal:x,pageParam:F,meta:t.meta},W=N($),lt=Promise.resolve(W).then(function(ct){return g(U,F,ct,it)});if(ls(W)){var Z=lt;Z.cancel=W.cancel}return lt},k;if(!b.length)k=j([]);else if(d){var S=typeof u<"u",T=S?u:Xi(t.options,b);k=j(b,S,T)}else if(f){var B=typeof u<"u",P=B?u:ka(t.options,b);k=j(b,B,P,!0)}else(function(){w=[];var Q=typeof t.options.getNextPageParam>"u",U=h&&b[0]?h(b[0],0,b):!0;k=U?j([],Q,m[0]):Promise.resolve(g([],m[0],b[0]));for(var O=function($){k=k.then(function(W){var lt=h&&b[$]?h(b[$],$,b):!0;if(lt){var Z=Q?m[$]:Xi(t.options,W);return j(W,Q,Z)}return Promise.resolve(g(W,m[$],b[$]))})},F=1;F<b.length;F++)O(F)})();var X=k.then(function(Q){return{pages:Q,pageParams:w}}),K=X;return K.cancel=function(){_=!0,p==null||p.abort(),ls(k)&&k.cancel()},X}}}}function Xi(i,t){return i.getNextPageParam==null?void 0:i.getNextPageParam(t[t.length-1],t)}function ka(i,t){return i.getPreviousPageParam==null?void 0:i.getPreviousPageParam(t[0],t)}var Ma=function(){function i(e){e===void 0&&(e={}),this.queryCache=e.queryCache||new Sa,this.mutationCache=e.mutationCache||new _a,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=i.prototype;return t.mount=function(){var s=this;this.unsubscribeFocus=ge.subscribe(function(){ge.isFocused()&&Ze.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Ze.subscribe(function(){ge.isFocused()&&Ze.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},t.unmount=function(){var s,n;(s=this.unsubscribeFocus)==null||s.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},t.isFetching=function(s,n){var r=$t(s,n),o=r[0];return o.fetching=!0,this.queryCache.findAll(o).length},t.isMutating=function(s){return this.mutationCache.findAll(D({},s,{fetching:!0})).length},t.getQueryData=function(s,n){var r;return(r=this.queryCache.find(s,n))==null?void 0:r.state.data},t.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(n){var r=n.queryKey,o=n.state,l=o.data;return[r,l]})},t.setQueryData=function(s,n,r){var o=Ge(s),l=this.defaultQueryOptions(o);return this.queryCache.build(this,l).setData(n,r)},t.setQueriesData=function(s,n,r){var o=this;return G.batch(function(){return o.getQueryCache().findAll(s).map(function(l){var h=l.queryKey;return[h,o.setQueryData(h,n,r)]})})},t.getQueryState=function(s,n){var r;return(r=this.queryCache.find(s,n))==null?void 0:r.state},t.removeQueries=function(s,n){var r=$t(s,n),o=r[0],l=this.queryCache;G.batch(function(){l.findAll(o).forEach(function(h){l.remove(h)})})},t.resetQueries=function(s,n,r){var o=this,l=$t(s,n,r),h=l[0],c=l[1],u=this.queryCache,d=D({},h,{active:!0});return G.batch(function(){return u.findAll(h).forEach(function(f){f.reset()}),o.refetchQueries(d,c)})},t.cancelQueries=function(s,n,r){var o=this,l=$t(s,n,r),h=l[0],c=l[1],u=c===void 0?{}:c;typeof u.revert>"u"&&(u.revert=!0);var d=G.batch(function(){return o.queryCache.findAll(h).map(function(f){return f.cancel(u)})});return Promise.all(d).then(at).catch(at)},t.invalidateQueries=function(s,n,r){var o,l,h,c=this,u=$t(s,n,r),d=u[0],f=u[1],b=D({},d,{active:(o=(l=d.refetchActive)!=null?l:d.active)!=null?o:!0,inactive:(h=d.refetchInactive)!=null?h:!1});return G.batch(function(){return c.queryCache.findAll(d).forEach(function(m){m.invalidate()}),c.refetchQueries(b,f)})},t.refetchQueries=function(s,n,r){var o=this,l=$t(s,n,r),h=l[0],c=l[1],u=G.batch(function(){return o.queryCache.findAll(h).map(function(f){return f.fetch(void 0,D({},c,{meta:{refetchPage:h==null?void 0:h.refetchPage}}))})}),d=Promise.all(u).then(at);return c!=null&&c.throwOnError||(d=d.catch(at)),d},t.fetchQuery=function(s,n,r){var o=Ge(s,n,r),l=this.defaultQueryOptions(o);typeof l.retry>"u"&&(l.retry=!1);var h=this.queryCache.build(this,l);return h.isStaleByTime(l.staleTime)?h.fetch(l):Promise.resolve(h.state.data)},t.prefetchQuery=function(s,n,r){return this.fetchQuery(s,n,r).then(at).catch(at)},t.fetchInfiniteQuery=function(s,n,r){var o=Ge(s,n,r);return o.behavior=Ca(),this.fetchQuery(o)},t.prefetchInfiniteQuery=function(s,n,r){return this.fetchInfiniteQuery(s,n,r).then(at).catch(at)},t.cancelMutations=function(){var s=this,n=G.batch(function(){return s.mutationCache.getAll().map(function(r){return r.cancel()})});return Promise.all(n).then(at).catch(at)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(s){this.defaultOptions=s},t.setQueryDefaults=function(s,n){var r=this.queryDefaults.find(function(o){return Bt(s)===Bt(o.queryKey)});r?r.defaultOptions=n:this.queryDefaults.push({queryKey:s,defaultOptions:n})},t.getQueryDefaults=function(s){var n;return s?(n=this.queryDefaults.find(function(r){return os(s,r.queryKey)}))==null?void 0:n.defaultOptions:void 0},t.setMutationDefaults=function(s,n){var r=this.mutationDefaults.find(function(o){return Bt(s)===Bt(o.mutationKey)});r?r.defaultOptions=n:this.mutationDefaults.push({mutationKey:s,defaultOptions:n})},t.getMutationDefaults=function(s){var n;return s?(n=this.mutationDefaults.find(function(r){return os(s,r.mutationKey)}))==null?void 0:n.defaultOptions:void 0},t.defaultQueryOptions=function(s){if(s!=null&&s._defaulted)return s;var n=D({},this.defaultOptions.queries,this.getQueryDefaults(s==null?void 0:s.queryKey),s,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=bi(n.queryKey,n)),n},t.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},t.defaultMutationOptions=function(s){return s!=null&&s._defaulted?s:D({},this.defaultOptions.mutations,this.getMutationDefaults(s==null?void 0:s.mutationKey),s,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},i}(),Ea=function(i){ce(t,i);function t(s,n){var r;return r=i.call(this)||this,r.client=s,r.options=n,r.trackedProps=[],r.selectError=null,r.bindMethods(),r.setOptions(n),r}var e=t.prototype;return e.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},e.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Gi(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},e.onUnsubscribe=function(){this.listeners.length||this.destroy()},e.shouldFetchOnReconnect=function(){return si(this.currentQuery,this.options,this.options.refetchOnReconnect)},e.shouldFetchOnWindowFocus=function(){return si(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},e.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},e.setOptions=function(n,r){var o=this.options,l=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(n),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=o.queryKey),this.updateQuery();var h=this.hasListeners();h&&Zi(this.currentQuery,l,this.options,o)&&this.executeFetch(),this.updateResult(r),h&&(this.currentQuery!==l||this.options.enabled!==o.enabled||this.options.staleTime!==o.staleTime)&&this.updateStaleTimeout();var c=this.computeRefetchInterval();h&&(this.currentQuery!==l||this.options.enabled!==o.enabled||c!==this.currentRefetchInterval)&&this.updateRefetchInterval(c)},e.getOptimisticResult=function(n){var r=this.client.defaultQueryObserverOptions(n),o=this.client.getQueryCache().build(this.client,r);return this.createResult(o,r)},e.getCurrentResult=function(){return this.currentResult},e.trackResult=function(n,r){var o=this,l={},h=function(u){o.trackedProps.includes(u)||o.trackedProps.push(u)};return Object.keys(n).forEach(function(c){Object.defineProperty(l,c,{configurable:!1,enumerable:!0,get:function(){return h(c),n[c]}})}),(r.useErrorBoundary||r.suspense)&&h("error"),l},e.getNextResult=function(n){var r=this;return new Promise(function(o,l){var h=r.subscribe(function(c){c.isFetching||(h(),c.isError&&(n!=null&&n.throwOnError)?l(c.error):o(c))})})},e.getCurrentQuery=function(){return this.currentQuery},e.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},e.refetch=function(n){return this.fetch(D({},n,{meta:{refetchPage:n==null?void 0:n.refetchPage}}))},e.fetchOptimistic=function(n){var r=this,o=this.client.defaultQueryObserverOptions(n),l=this.client.getQueryCache().build(this.client,o);return l.fetch().then(function(){return r.createResult(l,o)})},e.fetch=function(n){var r=this;return this.executeFetch(n).then(function(){return r.updateResult(),r.currentResult})},e.executeFetch=function(n){this.updateQuery();var r=this.currentQuery.fetch(this.options,n);return n!=null&&n.throwOnError||(r=r.catch(at)),r},e.updateStaleTimeout=function(){var n=this;if(this.clearStaleTimeout(),!(ns||this.currentResult.isStale||!ti(this.options.staleTime))){var r=gr(this.currentResult.dataUpdatedAt,this.options.staleTime),o=r+1;this.staleTimeoutId=setTimeout(function(){n.currentResult.isStale||n.updateResult()},o)}},e.computeRefetchInterval=function(){var n;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(n=this.options.refetchInterval)!=null?n:!1},e.updateRefetchInterval=function(n){var r=this;this.clearRefetchInterval(),this.currentRefetchInterval=n,!(ns||this.options.enabled===!1||!ti(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(r.options.refetchIntervalInBackground||ge.isFocused())&&r.executeFetch()},this.currentRefetchInterval))},e.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},e.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},e.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},e.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},e.createResult=function(n,r){var o=this.currentQuery,l=this.options,h=this.currentResult,c=this.currentResultState,u=this.currentResultOptions,d=n!==o,f=d?n.state:this.currentQueryInitialState,b=d?this.currentResult:this.previousQueryResult,m=n.state,p=m.dataUpdatedAt,x=m.error,w=m.errorUpdatedAt,_=m.isFetching,N=m.status,g=!1,j=!1,k;if(r.optimisticResults){var S=this.hasListeners(),T=!S&&Gi(n,r),B=S&&Zi(n,o,r,l);(T||B)&&(_=!0,p||(N="loading"))}if(r.keepPreviousData&&!m.dataUpdateCount&&(b!=null&&b.isSuccess)&&N!=="error")k=b.data,p=b.dataUpdatedAt,N=b.status,g=!0;else if(r.select&&typeof m.data<"u")if(h&&m.data===(c==null?void 0:c.data)&&r.select===this.selectFn)k=this.selectResult;else try{this.selectFn=r.select,k=r.select(m.data),r.structuralSharing!==!1&&(k=as(h==null?void 0:h.data,k)),this.selectResult=k,this.selectError=null}catch(K){hs().error(K),this.selectError=K}else k=m.data;if(typeof r.placeholderData<"u"&&typeof k>"u"&&(N==="loading"||N==="idle")){var P;if(h!=null&&h.isPlaceholderData&&r.placeholderData===(u==null?void 0:u.placeholderData))P=h.data;else if(P=typeof r.placeholderData=="function"?r.placeholderData():r.placeholderData,r.select&&typeof P<"u")try{P=r.select(P),r.structuralSharing!==!1&&(P=as(h==null?void 0:h.data,P)),this.selectError=null}catch(K){hs().error(K),this.selectError=K}typeof P<"u"&&(N="success",k=P,j=!0)}this.selectError&&(x=this.selectError,k=this.selectResult,w=Date.now(),N="error");var X={status:N,isLoading:N==="loading",isSuccess:N==="success",isError:N==="error",isIdle:N==="idle",data:k,dataUpdatedAt:p,error:x,errorUpdatedAt:w,failureCount:m.fetchFailureCount,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>f.dataUpdateCount||m.errorUpdateCount>f.errorUpdateCount,isFetching:_,isRefetching:_&&N!=="loading",isLoadingError:N==="error"&&m.dataUpdatedAt===0,isPlaceholderData:j,isPreviousData:g,isRefetchError:N==="error"&&m.dataUpdatedAt!==0,isStale:vi(n,r),refetch:this.refetch,remove:this.remove};return X},e.shouldNotifyListeners=function(n,r){if(!r)return!0;var o=this.options,l=o.notifyOnChangeProps,h=o.notifyOnChangePropsExclusions;if(!l&&!h||l==="tracked"&&!this.trackedProps.length)return!0;var c=l==="tracked"?this.trackedProps:l;return Object.keys(n).some(function(u){var d=u,f=n[d]!==r[d],b=c==null?void 0:c.some(function(p){return p===u}),m=h==null?void 0:h.some(function(p){return p===u});return f&&!m&&(!c||b)})},e.updateResult=function(n){var r=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!ma(this.currentResult,r)){var o={cache:!0};(n==null?void 0:n.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,r)&&(o.listeners=!0),this.notify(D({},o,n))}},e.updateQuery=function(){var n=this.client.getQueryCache().build(this.client,this.options);if(n!==this.currentQuery){var r=this.currentQuery;this.currentQuery=n,this.currentQueryInitialState=n.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(r==null||r.removeObserver(this),n.addObserver(this))}},e.onQueryUpdate=function(n){var r={};n.type==="success"?r.onSuccess=!0:n.type==="error"&&!Ye(n.error)&&(r.onError=!0),this.updateResult(r),this.hasListeners()&&this.updateTimers()},e.notify=function(n){var r=this;G.batch(function(){n.onSuccess?(r.options.onSuccess==null||r.options.onSuccess(r.currentResult.data),r.options.onSettled==null||r.options.onSettled(r.currentResult.data,null)):n.onError&&(r.options.onError==null||r.options.onError(r.currentResult.error),r.options.onSettled==null||r.options.onSettled(void 0,r.currentResult.error)),n.listeners&&r.listeners.forEach(function(o){o(r.currentResult)}),n.cache&&r.client.getQueryCache().notify({query:r.currentQuery,type:"observerResultsUpdated"})})},t}(ue);function La(i,t){return t.enabled!==!1&&!i.state.dataUpdatedAt&&!(i.state.status==="error"&&t.retryOnMount===!1)}function Gi(i,t){return La(i,t)||i.state.dataUpdatedAt>0&&si(i,t,t.refetchOnMount)}function si(i,t,e){if(t.enabled!==!1){var s=typeof e=="function"?e(i):e;return s==="always"||s!==!1&&vi(i,t)}return!1}function Zi(i,t,e,s){return e.enabled!==!1&&(i!==t||s.enabled===!1)&&(!e.suspense||i.state.status!=="error")&&vi(i,e)}function vi(i,t){return i.isStaleByTime(t.staleTime)}var Ra=function(i){ce(t,i);function t(s,n){var r;return r=i.call(this)||this,r.client=s,r.setOptions(n),r.bindMethods(),r.updateResult(),r}var e=t.prototype;return e.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},e.setOptions=function(n){this.options=this.client.defaultMutationOptions(n)},e.onUnsubscribe=function(){if(!this.listeners.length){var n;(n=this.currentMutation)==null||n.removeObserver(this)}},e.onMutationUpdate=function(n){this.updateResult();var r={listeners:!0};n.type==="success"?r.onSuccess=!0:n.type==="error"&&(r.onError=!0),this.notify(r)},e.getCurrentResult=function(){return this.currentResult},e.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},e.mutate=function(n,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,D({},this.options,{variables:typeof n<"u"?n:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},e.updateResult=function(){var n=this.currentMutation?this.currentMutation.state:jr(),r=D({},n,{isLoading:n.status==="loading",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=r},e.notify=function(n){var r=this;G.batch(function(){r.mutateOptions&&(n.onSuccess?(r.mutateOptions.onSuccess==null||r.mutateOptions.onSuccess(r.currentResult.data,r.currentResult.variables,r.currentResult.context),r.mutateOptions.onSettled==null||r.mutateOptions.onSettled(r.currentResult.data,null,r.currentResult.variables,r.currentResult.context)):n.onError&&(r.mutateOptions.onError==null||r.mutateOptions.onError(r.currentResult.error,r.currentResult.variables,r.currentResult.context),r.mutateOptions.onSettled==null||r.mutateOptions.onSettled(void 0,r.currentResult.error,r.currentResult.variables,r.currentResult.context))),n.listeners&&r.listeners.forEach(function(o){o(r.currentResult)})})},t}(ue),Pa=Ho.unstable_batchedUpdates;G.setBatchNotifyFunction(Pa);var Oa=console;ya(Oa);var Yi=st.createContext(void 0),_r=st.createContext(!1);function Cr(i){return i&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Yi),window.ReactQueryClientContext):Yi}var xt=function(){var t=st.useContext(Cr(st.useContext(_r)));if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Ta=function(t){var e=t.client,s=t.contextSharing,n=s===void 0?!1:s,r=t.children;st.useEffect(function(){return e.mount(),function(){e.unmount()}},[e]);var o=Cr(n);return st.createElement(_r.Provider,{value:n},st.createElement(o.Provider,{value:e},r))};function Fa(){var i=!1;return{clearReset:function(){i=!1},reset:function(){i=!0},isReset:function(){return i}}}var za=st.createContext(Fa()),$a=function(){return st.useContext(za)};function kr(i,t,e){return typeof t=="function"?t.apply(void 0,e):typeof t=="boolean"?t:!!i}function nt(i,t,e){var s=st.useRef(!1),n=st.useState(0),r=n[1],o=ua(i,t,e),l=xt(),h=st.useRef();h.current?h.current.setOptions(o):h.current=new Ra(l,o);var c=h.current.getCurrentResult();st.useEffect(function(){s.current=!0;var d=h.current.subscribe(G.batchCalls(function(){s.current&&r(function(f){return f+1})}));return function(){s.current=!1,d()}},[]);var u=st.useCallback(function(d,f){h.current.mutate(d,f).catch(at)},[]);if(c.error&&kr(void 0,h.current.options.useErrorBoundary,[c.error]))throw c.error;return D({},c,{mutate:u,mutateAsync:c.mutate})}function Aa(i,t){var e=st.useRef(!1),s=st.useState(0),n=s[1],r=xt(),o=$a(),l=r.defaultQueryObserverOptions(i);l.optimisticResults=!0,l.onError&&(l.onError=G.batchCalls(l.onError)),l.onSuccess&&(l.onSuccess=G.batchCalls(l.onSuccess)),l.onSettled&&(l.onSettled=G.batchCalls(l.onSettled)),l.suspense&&(typeof l.staleTime!="number"&&(l.staleTime=1e3),l.cacheTime===0&&(l.cacheTime=1)),(l.suspense||l.useErrorBoundary)&&(o.isReset()||(l.retryOnMount=!1));var h=st.useState(function(){return new t(r,l)}),c=h[0],u=c.getOptimisticResult(l);if(st.useEffect(function(){e.current=!0,o.clearReset();var d=c.subscribe(G.batchCalls(function(){e.current&&n(function(f){return f+1})}));return c.updateResult(),function(){e.current=!1,d()}},[o,c]),st.useEffect(function(){c.setOptions(l,{listeners:!1})},[l,c]),l.suspense&&u.isLoading)throw c.fetchOptimistic(l).then(function(d){var f=d.data;l.onSuccess==null||l.onSuccess(f),l.onSettled==null||l.onSettled(f,null)}).catch(function(d){o.clearReset(),l.onError==null||l.onError(d),l.onSettled==null||l.onSettled(void 0,d)});if(u.isError&&!o.isReset()&&!u.isFetching&&kr(l.suspense,l.useErrorBoundary,[u.error,c.getCurrentQuery()]))throw u.error;return l.notifyOnChangeProps==="tracked"&&(u=c.trackResult(u,l)),u}function rt(i,t,e){var s=Ge(i,t,e);return Aa(s,Ea)}function Mr(i,t){return function(){return i.apply(t,arguments)}}const{toString:Da}=Object.prototype,{getPrototypeOf:gi}=Object,{iterator:ms,toStringTag:Er}=Symbol,ps=(i=>t=>{const e=Da.call(t);return i[e]||(i[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),yt=i=>(i=i.toLowerCase(),t=>ps(t)===i),bs=i=>t=>typeof t===i,{isArray:de}=Array,oe=bs("undefined");function Le(i){return i!==null&&!oe(i)&&i.constructor!==null&&!oe(i.constructor)&&ft(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const Lr=yt("ArrayBuffer");function Ia(i){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(i):t=i&&i.buffer&&Lr(i.buffer),t}const Va=bs("string"),ft=bs("function"),Rr=bs("number"),Re=i=>i!==null&&typeof i=="object",Ba=i=>i===!0||i===!1,ts=i=>{if(ps(i)!=="object")return!1;const t=gi(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Er in i)&&!(ms in i)},Ua=i=>{if(!Re(i)||Le(i))return!1;try{return Object.keys(i).length===0&&Object.getPrototypeOf(i)===Object.prototype}catch{return!1}},Wa=yt("Date"),qa=yt("File"),Qa=yt("Blob"),Ka=yt("FileList"),Ha=i=>Re(i)&&ft(i.pipe),Ja=i=>{let t;return i&&(typeof FormData=="function"&&i instanceof FormData||ft(i.append)&&((t=ps(i))==="formdata"||t==="object"&&ft(i.toString)&&i.toString()==="[object FormData]"))},Xa=yt("URLSearchParams"),[Ga,Za,Ya,tl]=["ReadableStream","Request","Response","Headers"].map(yt),el=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pe(i,t,{allOwnKeys:e=!1}={}){if(i===null||typeof i>"u")return;let s,n;if(typeof i!="object"&&(i=[i]),de(i))for(s=0,n=i.length;s<n;s++)t.call(null,i[s],s,i);else{if(Le(i))return;const r=e?Object.getOwnPropertyNames(i):Object.keys(i),o=r.length;let l;for(s=0;s<o;s++)l=r[s],t.call(null,i[l],l,i)}}function Pr(i,t){if(Le(i))return null;t=t.toLowerCase();const e=Object.keys(i);let s=e.length,n;for(;s-- >0;)if(n=e[s],t===n.toLowerCase())return n;return null}const Ut=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Or=i=>!oe(i)&&i!==Ut;function ii(){const{caseless:i,skipUndefined:t}=Or(this)&&this||{},e={},s=(n,r)=>{const o=i&&Pr(e,r)||r;ts(e[o])&&ts(n)?e[o]=ii(e[o],n):ts(n)?e[o]=ii({},n):de(n)?e[o]=n.slice():(!t||!oe(n))&&(e[o]=n)};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&Pe(arguments[n],s);return e}const sl=(i,t,e,{allOwnKeys:s}={})=>(Pe(t,(n,r)=>{e&&ft(n)?i[r]=Mr(n,e):i[r]=n},{allOwnKeys:s}),i),il=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),nl=(i,t,e,s)=>{i.prototype=Object.create(t.prototype,s),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:t.prototype}),e&&Object.assign(i.prototype,e)},rl=(i,t,e,s)=>{let n,r,o;const l={};if(t=t||{},i==null)return t;do{for(n=Object.getOwnPropertyNames(i),r=n.length;r-- >0;)o=n[r],(!s||s(o,i,t))&&!l[o]&&(t[o]=i[o],l[o]=!0);i=e!==!1&&gi(i)}while(i&&(!e||e(i,t))&&i!==Object.prototype);return t},ol=(i,t,e)=>{i=String(i),(e===void 0||e>i.length)&&(e=i.length),e-=t.length;const s=i.indexOf(t,e);return s!==-1&&s===e},al=i=>{if(!i)return null;if(de(i))return i;let t=i.length;if(!Rr(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=i[t];return e},ll=(i=>t=>i&&t instanceof i)(typeof Uint8Array<"u"&&gi(Uint8Array)),hl=(i,t)=>{const s=(i&&i[ms]).call(i);let n;for(;(n=s.next())&&!n.done;){const r=n.value;t.call(i,r[0],r[1])}},cl=(i,t)=>{let e;const s=[];for(;(e=i.exec(t))!==null;)s.push(e);return s},ul=yt("HTMLFormElement"),dl=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,s,n){return s.toUpperCase()+n}),tn=(({hasOwnProperty:i})=>(t,e)=>i.call(t,e))(Object.prototype),fl=yt("RegExp"),Tr=(i,t)=>{const e=Object.getOwnPropertyDescriptors(i),s={};Pe(e,(n,r)=>{let o;(o=t(n,r,i))!==!1&&(s[r]=o||n)}),Object.defineProperties(i,s)},ml=i=>{Tr(i,(t,e)=>{if(ft(i)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const s=i[e];if(ft(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},pl=(i,t)=>{const e={},s=n=>{n.forEach(r=>{e[r]=!0})};return de(i)?s(i):s(String(i).split(t)),e},bl=()=>{},vl=(i,t)=>i!=null&&Number.isFinite(i=+i)?i:t;function gl(i){return!!(i&&ft(i.append)&&i[Er]==="FormData"&&i[ms])}const xl=i=>{const t=new Array(10),e=(s,n)=>{if(Re(s)){if(t.indexOf(s)>=0)return;if(Le(s))return s;if(!("toJSON"in s)){t[n]=s;const r=de(s)?[]:{};return Pe(s,(o,l)=>{const h=e(o,n+1);!oe(h)&&(r[l]=h)}),t[n]=void 0,r}}return s};return e(i,0)},yl=yt("AsyncFunction"),wl=i=>i&&(Re(i)||ft(i))&&ft(i.then)&&ft(i.catch),Fr=((i,t)=>i?setImmediate:t?((e,s)=>(Ut.addEventListener("message",({source:n,data:r})=>{n===Ut&&r===e&&s.length&&s.shift()()},!1),n=>{s.push(n),Ut.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",ft(Ut.postMessage)),Sl=typeof queueMicrotask<"u"?queueMicrotask.bind(Ut):typeof process<"u"&&process.nextTick||Fr,Nl=i=>i!=null&&ft(i[ms]),y={isArray:de,isArrayBuffer:Lr,isBuffer:Le,isFormData:Ja,isArrayBufferView:Ia,isString:Va,isNumber:Rr,isBoolean:Ba,isObject:Re,isPlainObject:ts,isEmptyObject:Ua,isReadableStream:Ga,isRequest:Za,isResponse:Ya,isHeaders:tl,isUndefined:oe,isDate:Wa,isFile:qa,isBlob:Qa,isRegExp:fl,isFunction:ft,isStream:Ha,isURLSearchParams:Xa,isTypedArray:ll,isFileList:Ka,forEach:Pe,merge:ii,extend:sl,trim:el,stripBOM:il,inherits:nl,toFlatObject:rl,kindOf:ps,kindOfTest:yt,endsWith:ol,toArray:al,forEachEntry:hl,matchAll:cl,isHTMLForm:ul,hasOwnProperty:tn,hasOwnProp:tn,reduceDescriptors:Tr,freezeMethods:ml,toObjectSet:pl,toCamelCase:dl,noop:bl,toFiniteNumber:vl,findKey:Pr,global:Ut,isContextDefined:Or,isSpecCompliantForm:gl,toJSONObject:xl,isAsyncFn:yl,isThenable:wl,setImmediate:Fr,asap:Sl,isIterable:Nl};function A(i,t,e,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",t&&(this.code=t),e&&(this.config=e),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}y.inherits(A,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:y.toJSONObject(this.config),code:this.code,status:this.status}}});const zr=A.prototype,$r={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{$r[i]={value:i}});Object.defineProperties(A,$r);Object.defineProperty(zr,"isAxiosError",{value:!0});A.from=(i,t,e,s,n,r)=>{const o=Object.create(zr);y.toFlatObject(i,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const l=i&&i.message?i.message:"Error",h=t==null&&i?i.code:t;return A.call(o,l,h,e,s,n),i&&o.cause==null&&Object.defineProperty(o,"cause",{value:i,configurable:!0}),o.name=i&&i.name||"Error",r&&Object.assign(o,r),o};const jl=null;function ni(i){return y.isPlainObject(i)||y.isArray(i)}function Ar(i){return y.endsWith(i,"[]")?i.slice(0,-2):i}function en(i,t,e){return i?i.concat(t).map(function(n,r){return n=Ar(n),!e&&r?"["+n+"]":n}).join(e?".":""):t}function _l(i){return y.isArray(i)&&!i.some(ni)}const Cl=y.toFlatObject(y,{},null,function(t){return/^is[A-Z]/.test(t)});function vs(i,t,e){if(!y.isObject(i))throw new TypeError("target must be an object");t=t||new FormData,e=y.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,x){return!y.isUndefined(x[p])});const s=e.metaTokens,n=e.visitor||u,r=e.dots,o=e.indexes,h=(e.Blob||typeof Blob<"u"&&Blob)&&y.isSpecCompliantForm(t);if(!y.isFunction(n))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(y.isDate(m))return m.toISOString();if(y.isBoolean(m))return m.toString();if(!h&&y.isBlob(m))throw new A("Blob is not supported. Use a Buffer instead.");return y.isArrayBuffer(m)||y.isTypedArray(m)?h&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,p,x){let w=m;if(m&&!x&&typeof m=="object"){if(y.endsWith(p,"{}"))p=s?p:p.slice(0,-2),m=JSON.stringify(m);else if(y.isArray(m)&&_l(m)||(y.isFileList(m)||y.endsWith(p,"[]"))&&(w=y.toArray(m)))return p=Ar(p),w.forEach(function(N,g){!(y.isUndefined(N)||N===null)&&t.append(o===!0?en([p],g,r):o===null?p:p+"[]",c(N))}),!1}return ni(m)?!0:(t.append(en(x,p,r),c(m)),!1)}const d=[],f=Object.assign(Cl,{defaultVisitor:u,convertValue:c,isVisitable:ni});function b(m,p){if(!y.isUndefined(m)){if(d.indexOf(m)!==-1)throw Error("Circular reference detected in "+p.join("."));d.push(m),y.forEach(m,function(w,_){(!(y.isUndefined(w)||w===null)&&n.call(t,w,y.isString(_)?_.trim():_,p,f))===!0&&b(w,p?p.concat(_):[_])}),d.pop()}}if(!y.isObject(i))throw new TypeError("data must be an object");return b(i),t}function sn(i){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function xi(i,t){this._pairs=[],i&&vs(i,this,t)}const Dr=xi.prototype;Dr.append=function(t,e){this._pairs.push([t,e])};Dr.toString=function(t){const e=t?function(s){return t.call(this,s,sn)}:sn;return this._pairs.map(function(n){return e(n[0])+"="+e(n[1])},"").join("&")};function kl(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ir(i,t,e){if(!t)return i;const s=e&&e.encode||kl;y.isFunction(e)&&(e={serialize:e});const n=e&&e.serialize;let r;if(n?r=n(t,e):r=y.isURLSearchParams(t)?t.toString():new xi(t,e).toString(s),r){const o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+r}return i}class nn{constructor(){this.handlers=[]}use(t,e,s){return this.handlers.push({fulfilled:t,rejected:e,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){y.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Vr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ml=typeof URLSearchParams<"u"?URLSearchParams:xi,El=typeof FormData<"u"?FormData:null,Ll=typeof Blob<"u"?Blob:null,Rl={isBrowser:!0,classes:{URLSearchParams:Ml,FormData:El,Blob:Ll},protocols:["http","https","file","blob","url","data"]},yi=typeof window<"u"&&typeof document<"u",ri=typeof navigator=="object"&&navigator||void 0,Pl=yi&&(!ri||["ReactNative","NativeScript","NS"].indexOf(ri.product)<0),Ol=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Tl=yi&&window.location.href||"http://localhost",Fl=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yi,hasStandardBrowserEnv:Pl,hasStandardBrowserWebWorkerEnv:Ol,navigator:ri,origin:Tl},Symbol.toStringTag,{value:"Module"})),ht={...Fl,...Rl};function zl(i,t){return vs(i,new ht.classes.URLSearchParams,{visitor:function(e,s,n,r){return ht.isNode&&y.isBuffer(e)?(this.append(s,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...t})}function $l(i){return y.matchAll(/\w+|\[(\w*)]/g,i).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Al(i){const t={},e=Object.keys(i);let s;const n=e.length;let r;for(s=0;s<n;s++)r=e[s],t[r]=i[r];return t}function Br(i){function t(e,s,n,r){let o=e[r++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=r>=e.length;return o=!o&&y.isArray(n)?n.length:o,h?(y.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!l):((!n[o]||!y.isObject(n[o]))&&(n[o]=[]),t(e,s,n[o],r)&&y.isArray(n[o])&&(n[o]=Al(n[o])),!l)}if(y.isFormData(i)&&y.isFunction(i.entries)){const e={};return y.forEachEntry(i,(s,n)=>{t($l(s),n,e,0)}),e}return null}function Dl(i,t,e){if(y.isString(i))try{return(t||JSON.parse)(i),y.trim(i)}catch(s){if(s.name!=="SyntaxError")throw s}return(e||JSON.stringify)(i)}const Oe={transitional:Vr,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const s=e.getContentType()||"",n=s.indexOf("application/json")>-1,r=y.isObject(t);if(r&&y.isHTMLForm(t)&&(t=new FormData(t)),y.isFormData(t))return n?JSON.stringify(Br(t)):t;if(y.isArrayBuffer(t)||y.isBuffer(t)||y.isStream(t)||y.isFile(t)||y.isBlob(t)||y.isReadableStream(t))return t;if(y.isArrayBufferView(t))return t.buffer;if(y.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(r){if(s.indexOf("application/x-www-form-urlencoded")>-1)return zl(t,this.formSerializer).toString();if((l=y.isFileList(t))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return vs(l?{"files[]":t}:t,h&&new h,this.formSerializer)}}return r||n?(e.setContentType("application/json",!1),Dl(t)):t}],transformResponse:[function(t){const e=this.transitional||Oe.transitional,s=e&&e.forcedJSONParsing,n=this.responseType==="json";if(y.isResponse(t)||y.isReadableStream(t))return t;if(t&&y.isString(t)&&(s&&!this.responseType||n)){const o=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?A.from(l,A.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ht.classes.FormData,Blob:ht.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};y.forEach(["delete","get","head","post","put","patch"],i=>{Oe.headers[i]={}});const Il=y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vl=i=>{const t={};let e,s,n;return i&&i.split(`
`).forEach(function(o){n=o.indexOf(":"),e=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!e||t[e]&&Il[e])&&(e==="set-cookie"?t[e]?t[e].push(s):t[e]=[s]:t[e]=t[e]?t[e]+", "+s:s)}),t},rn=Symbol("internals");function be(i){return i&&String(i).trim().toLowerCase()}function es(i){return i===!1||i==null?i:y.isArray(i)?i.map(es):String(i)}function Bl(i){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=e.exec(i);)t[s[1]]=s[2];return t}const Ul=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function Es(i,t,e,s,n){if(y.isFunction(s))return s.call(this,t,e);if(n&&(t=e),!!y.isString(t)){if(y.isString(s))return t.indexOf(s)!==-1;if(y.isRegExp(s))return s.test(t)}}function Wl(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,s)=>e.toUpperCase()+s)}function ql(i,t){const e=y.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(i,s+e,{value:function(n,r,o){return this[s].call(this,t,n,r,o)},configurable:!0})})}let mt=class{constructor(t){t&&this.set(t)}set(t,e,s){const n=this;function r(l,h,c){const u=be(h);if(!u)throw new Error("header name must be a non-empty string");const d=y.findKey(n,u);(!d||n[d]===void 0||c===!0||c===void 0&&n[d]!==!1)&&(n[d||h]=es(l))}const o=(l,h)=>y.forEach(l,(c,u)=>r(c,u,h));if(y.isPlainObject(t)||t instanceof this.constructor)o(t,e);else if(y.isString(t)&&(t=t.trim())&&!Ul(t))o(Vl(t),e);else if(y.isObject(t)&&y.isIterable(t)){let l={},h,c;for(const u of t){if(!y.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[c=u[0]]=(h=l[c])?y.isArray(h)?[...h,u[1]]:[h,u[1]]:u[1]}o(l,e)}else t!=null&&r(e,t,s);return this}get(t,e){if(t=be(t),t){const s=y.findKey(this,t);if(s){const n=this[s];if(!e)return n;if(e===!0)return Bl(n);if(y.isFunction(e))return e.call(this,n,s);if(y.isRegExp(e))return e.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=be(t),t){const s=y.findKey(this,t);return!!(s&&this[s]!==void 0&&(!e||Es(this,this[s],s,e)))}return!1}delete(t,e){const s=this;let n=!1;function r(o){if(o=be(o),o){const l=y.findKey(s,o);l&&(!e||Es(s,s[l],l,e))&&(delete s[l],n=!0)}}return y.isArray(t)?t.forEach(r):r(t),n}clear(t){const e=Object.keys(this);let s=e.length,n=!1;for(;s--;){const r=e[s];(!t||Es(this,this[r],r,t,!0))&&(delete this[r],n=!0)}return n}normalize(t){const e=this,s={};return y.forEach(this,(n,r)=>{const o=y.findKey(s,r);if(o){e[o]=es(n),delete e[r];return}const l=t?Wl(r):String(r).trim();l!==r&&delete e[r],e[l]=es(n),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return y.forEach(this,(s,n)=>{s!=null&&s!==!1&&(e[n]=t&&y.isArray(s)?s.join(", "):s)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const s=new this(t);return e.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[rn]=this[rn]={accessors:{}}).accessors,n=this.prototype;function r(o){const l=be(o);s[l]||(ql(n,o),s[l]=!0)}return y.isArray(t)?t.forEach(r):r(t),this}};mt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);y.reduceDescriptors(mt.prototype,({value:i},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>i,set(s){this[e]=s}}});y.freezeMethods(mt);function Ls(i,t){const e=this||Oe,s=t||e,n=mt.from(s.headers);let r=s.data;return y.forEach(i,function(l){r=l.call(e,r,n.normalize(),t?t.status:void 0)}),n.normalize(),r}function Ur(i){return!!(i&&i.__CANCEL__)}function fe(i,t,e){A.call(this,i??"canceled",A.ERR_CANCELED,t,e),this.name="CanceledError"}y.inherits(fe,A,{__CANCEL__:!0});function Wr(i,t,e){const s=e.config.validateStatus;!e.status||!s||s(e.status)?i(e):t(new A("Request failed with status code "+e.status,[A.ERR_BAD_REQUEST,A.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function Ql(i){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return t&&t[1]||""}function Kl(i,t){i=i||10;const e=new Array(i),s=new Array(i);let n=0,r=0,o;return t=t!==void 0?t:1e3,function(h){const c=Date.now(),u=s[r];o||(o=c),e[n]=h,s[n]=c;let d=r,f=0;for(;d!==n;)f+=e[d++],d=d%i;if(n=(n+1)%i,n===r&&(r=(r+1)%i),c-o<t)return;const b=u&&c-u;return b?Math.round(f*1e3/b):void 0}}function Hl(i,t){let e=0,s=1e3/t,n,r;const o=(c,u=Date.now())=>{e=u,n=null,r&&(clearTimeout(r),r=null),i(...c)};return[(...c)=>{const u=Date.now(),d=u-e;d>=s?o(c,u):(n=c,r||(r=setTimeout(()=>{r=null,o(n)},s-d)))},()=>n&&o(n)]}const cs=(i,t,e=3)=>{let s=0;const n=Kl(50,250);return Hl(r=>{const o=r.loaded,l=r.lengthComputable?r.total:void 0,h=o-s,c=n(h),u=o<=l;s=o;const d={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:c||void 0,estimated:c&&l&&u?(l-o)/c:void 0,event:r,lengthComputable:l!=null,[t?"download":"upload"]:!0};i(d)},e)},on=(i,t)=>{const e=i!=null;return[s=>t[0]({lengthComputable:e,total:i,loaded:s}),t[1]]},an=i=>(...t)=>y.asap(()=>i(...t)),Jl=ht.hasStandardBrowserEnv?((i,t)=>e=>(e=new URL(e,ht.origin),i.protocol===e.protocol&&i.host===e.host&&(t||i.port===e.port)))(new URL(ht.origin),ht.navigator&&/(msie|trident)/i.test(ht.navigator.userAgent)):()=>!0,Xl=ht.hasStandardBrowserEnv?{write(i,t,e,s,n,r,o){if(typeof document>"u")return;const l=[`${i}=${encodeURIComponent(t)}`];y.isNumber(e)&&l.push(`expires=${new Date(e).toUTCString()}`),y.isString(s)&&l.push(`path=${s}`),y.isString(n)&&l.push(`domain=${n}`),r===!0&&l.push("secure"),y.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(i){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+i+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(i){this.write(i,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Gl(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function Zl(i,t){return t?i.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):i}function qr(i,t,e){let s=!Gl(t);return i&&(s||e==!1)?Zl(i,t):t}const ln=i=>i instanceof mt?{...i}:i;function Kt(i,t){t=t||{};const e={};function s(c,u,d,f){return y.isPlainObject(c)&&y.isPlainObject(u)?y.merge.call({caseless:f},c,u):y.isPlainObject(u)?y.merge({},u):y.isArray(u)?u.slice():u}function n(c,u,d,f){if(y.isUndefined(u)){if(!y.isUndefined(c))return s(void 0,c,d,f)}else return s(c,u,d,f)}function r(c,u){if(!y.isUndefined(u))return s(void 0,u)}function o(c,u){if(y.isUndefined(u)){if(!y.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function l(c,u,d){if(d in t)return s(c,u);if(d in i)return s(void 0,c)}const h={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(c,u,d)=>n(ln(c),ln(u),d,!0)};return y.forEach(Object.keys({...i,...t}),function(u){const d=h[u]||n,f=d(i[u],t[u],u);y.isUndefined(f)&&d!==l||(e[u]=f)}),e}const Qr=i=>{const t=Kt({},i);let{data:e,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:r,headers:o,auth:l}=t;if(t.headers=o=mt.from(o),t.url=Ir(qr(t.baseURL,t.url,t.allowAbsoluteUrls),i.params,i.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),y.isFormData(e)){if(ht.hasStandardBrowserEnv||ht.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(y.isFunction(e.getHeaders)){const h=e.getHeaders(),c=["content-type","content-length"];Object.entries(h).forEach(([u,d])=>{c.includes(u.toLowerCase())&&o.set(u,d)})}}if(ht.hasStandardBrowserEnv&&(s&&y.isFunction(s)&&(s=s(t)),s||s!==!1&&Jl(t.url))){const h=n&&r&&Xl.read(r);h&&o.set(n,h)}return t},Yl=typeof XMLHttpRequest<"u",th=Yl&&function(i){return new Promise(function(e,s){const n=Qr(i);let r=n.data;const o=mt.from(n.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:c}=n,u,d,f,b,m;function p(){b&&b(),m&&m(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let x=new XMLHttpRequest;x.open(n.method.toUpperCase(),n.url,!0),x.timeout=n.timeout;function w(){if(!x)return;const N=mt.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:N,config:i,request:x};Wr(function(S){e(S),p()},function(S){s(S),p()},j),x=null}"onloadend"in x?x.onloadend=w:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(w)},x.onabort=function(){x&&(s(new A("Request aborted",A.ECONNABORTED,i,x)),x=null)},x.onerror=function(g){const j=g&&g.message?g.message:"Network Error",k=new A(j,A.ERR_NETWORK,i,x);k.event=g||null,s(k),x=null},x.ontimeout=function(){let g=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const j=n.transitional||Vr;n.timeoutErrorMessage&&(g=n.timeoutErrorMessage),s(new A(g,j.clarifyTimeoutError?A.ETIMEDOUT:A.ECONNABORTED,i,x)),x=null},r===void 0&&o.setContentType(null),"setRequestHeader"in x&&y.forEach(o.toJSON(),function(g,j){x.setRequestHeader(j,g)}),y.isUndefined(n.withCredentials)||(x.withCredentials=!!n.withCredentials),l&&l!=="json"&&(x.responseType=n.responseType),c&&([f,m]=cs(c,!0),x.addEventListener("progress",f)),h&&x.upload&&([d,b]=cs(h),x.upload.addEventListener("progress",d),x.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(u=N=>{x&&(s(!N||N.type?new fe(null,i,x):N),x.abort(),x=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const _=Ql(n.url);if(_&&ht.protocols.indexOf(_)===-1){s(new A("Unsupported protocol "+_+":",A.ERR_BAD_REQUEST,i));return}x.send(r||null)})},eh=(i,t)=>{const{length:e}=i=i?i.filter(Boolean):[];if(t||e){let s=new AbortController,n;const r=function(c){if(!n){n=!0,l();const u=c instanceof Error?c:this.reason;s.abort(u instanceof A?u:new fe(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,r(new A(`timeout ${t} of ms exceeded`,A.ETIMEDOUT))},t);const l=()=>{i&&(o&&clearTimeout(o),o=null,i.forEach(c=>{c.unsubscribe?c.unsubscribe(r):c.removeEventListener("abort",r)}),i=null)};i.forEach(c=>c.addEventListener("abort",r));const{signal:h}=s;return h.unsubscribe=()=>y.asap(l),h}},sh=function*(i,t){let e=i.byteLength;if(e<t){yield i;return}let s=0,n;for(;s<e;)n=s+t,yield i.slice(s,n),s=n},ih=async function*(i,t){for await(const e of nh(i))yield*sh(e,t)},nh=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const t=i.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},hn=(i,t,e,s)=>{const n=ih(i,t);let r=0,o,l=h=>{o||(o=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:c,value:u}=await n.next();if(c){l(),h.close();return}let d=u.byteLength;if(e){let f=r+=d;e(f)}h.enqueue(new Uint8Array(u))}catch(c){throw l(c),c}},cancel(h){return l(h),n.return()}},{highWaterMark:2})},cn=64*1024,{isFunction:Ie}=y,rh=(({Request:i,Response:t})=>({Request:i,Response:t}))(y.global),{ReadableStream:un,TextEncoder:dn}=y.global,fn=(i,...t)=>{try{return!!i(...t)}catch{return!1}},oh=i=>{i=y.merge.call({skipUndefined:!0},rh,i);const{fetch:t,Request:e,Response:s}=i,n=t?Ie(t):typeof fetch=="function",r=Ie(e),o=Ie(s);if(!n)return!1;const l=n&&Ie(un),h=n&&(typeof dn=="function"?(m=>p=>m.encode(p))(new dn):async m=>new Uint8Array(await new e(m).arrayBuffer())),c=r&&l&&fn(()=>{let m=!1;const p=new e(ht.origin,{body:new un,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!p}),u=o&&l&&fn(()=>y.isReadableStream(new s("").body)),d={stream:u&&(m=>m.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!d[m]&&(d[m]=(p,x)=>{let w=p&&p[m];if(w)return w.call(p);throw new A(`Response type '${m}' is not supported`,A.ERR_NOT_SUPPORT,x)})});const f=async m=>{if(m==null)return 0;if(y.isBlob(m))return m.size;if(y.isSpecCompliantForm(m))return(await new e(ht.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(y.isArrayBufferView(m)||y.isArrayBuffer(m))return m.byteLength;if(y.isURLSearchParams(m)&&(m=m+""),y.isString(m))return(await h(m)).byteLength},b=async(m,p)=>{const x=y.toFiniteNumber(m.getContentLength());return x??f(p)};return async m=>{let{url:p,method:x,data:w,signal:_,cancelToken:N,timeout:g,onDownloadProgress:j,onUploadProgress:k,responseType:S,headers:T,withCredentials:B="same-origin",fetchOptions:P}=Qr(m),X=t||fetch;S=S?(S+"").toLowerCase():"text";let K=eh([_,N&&N.toAbortSignal()],g),Q=null;const U=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let O;try{if(k&&c&&x!=="get"&&x!=="head"&&(O=await b(T,w))!==0){let Z=new e(p,{method:"POST",body:w,duplex:"half"}),ct;if(y.isFormData(w)&&(ct=Z.headers.get("content-type"))&&T.setContentType(ct),Z.body){const[Tt,Et]=on(O,cs(an(k)));w=hn(Z.body,cn,Tt,Et)}}y.isString(B)||(B=B?"include":"omit");const F=r&&"credentials"in e.prototype,it={...P,signal:K,method:x.toUpperCase(),headers:T.normalize().toJSON(),body:w,duplex:"half",credentials:F?B:void 0};Q=r&&new e(p,it);let $=await(r?X(Q,P):X(p,it));const W=u&&(S==="stream"||S==="response");if(u&&(j||W&&U)){const Z={};["status","statusText","headers"].forEach(Lt=>{Z[Lt]=$[Lt]});const ct=y.toFiniteNumber($.headers.get("content-length")),[Tt,Et]=j&&on(ct,cs(an(j),!0))||[];$=new s(hn($.body,cn,Tt,()=>{Et&&Et(),U&&U()}),Z)}S=S||"text";let lt=await d[y.findKey(d,S)||"text"]($,m);return!W&&U&&U(),await new Promise((Z,ct)=>{Wr(Z,ct,{data:lt,headers:mt.from($.headers),status:$.status,statusText:$.statusText,config:m,request:Q})})}catch(F){throw U&&U(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new A("Network Error",A.ERR_NETWORK,m,Q),{cause:F.cause||F}):A.from(F,F&&F.code,m,Q)}}},ah=new Map,Kr=i=>{let t=i&&i.env||{};const{fetch:e,Request:s,Response:n}=t,r=[s,n,e];let o=r.length,l=o,h,c,u=ah;for(;l--;)h=r[l],c=u.get(h),c===void 0&&u.set(h,c=l?new Map:oh(t)),u=c;return c};Kr();const wi={http:jl,xhr:th,fetch:{get:Kr}};y.forEach(wi,(i,t)=>{if(i){try{Object.defineProperty(i,"name",{value:t})}catch{}Object.defineProperty(i,"adapterName",{value:t})}});const mn=i=>`- ${i}`,lh=i=>y.isFunction(i)||i===null||i===!1;function hh(i,t){i=y.isArray(i)?i:[i];const{length:e}=i;let s,n;const r={};for(let o=0;o<e;o++){s=i[o];let l;if(n=s,!lh(s)&&(n=wi[(l=String(s)).toLowerCase()],n===void 0))throw new A(`Unknown adapter '${l}'`);if(n&&(y.isFunction(n)||(n=n.get(t))))break;r[l||"#"+o]=n}if(!n){const o=Object.entries(r).map(([h,c])=>`adapter ${h} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=e?o.length>1?`since :
`+o.map(mn).join(`
`):" "+mn(o[0]):"as no adapter specified";throw new A("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n}const Hr={getAdapter:hh,adapters:wi};function Rs(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new fe(null,i)}function pn(i){return Rs(i),i.headers=mt.from(i.headers),i.data=Ls.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),Hr.getAdapter(i.adapter||Oe.adapter,i)(i).then(function(s){return Rs(i),s.data=Ls.call(i,i.transformResponse,s),s.headers=mt.from(s.headers),s},function(s){return Ur(s)||(Rs(i),s&&s.response&&(s.response.data=Ls.call(i,i.transformResponse,s.response),s.response.headers=mt.from(s.response.headers))),Promise.reject(s)})}const Jr="1.13.2",gs={};["object","boolean","number","function","string","symbol"].forEach((i,t)=>{gs[i]=function(s){return typeof s===i||"a"+(t<1?"n ":" ")+i}});const bn={};gs.transitional=function(t,e,s){function n(r,o){return"[Axios v"+Jr+"] Transitional option '"+r+"'"+o+(s?". "+s:"")}return(r,o,l)=>{if(t===!1)throw new A(n(o," has been removed"+(e?" in "+e:"")),A.ERR_DEPRECATED);return e&&!bn[o]&&(bn[o]=!0,console.warn(n(o," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(r,o,l):!0}};gs.spelling=function(t){return(e,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function ch(i,t,e){if(typeof i!="object")throw new A("options must be an object",A.ERR_BAD_OPTION_VALUE);const s=Object.keys(i);let n=s.length;for(;n-- >0;){const r=s[n],o=t[r];if(o){const l=i[r],h=l===void 0||o(l,r,i);if(h!==!0)throw new A("option "+r+" must be "+h,A.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new A("Unknown option "+r,A.ERR_BAD_OPTION)}}const ss={assertOptions:ch,validators:gs},Nt=ss.validators;let qt=class{constructor(t){this.defaults=t||{},this.interceptors={request:new nn,response:new nn}}async request(t,e){try{return await this._request(t,e)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const r=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?r&&!String(s.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+r):s.stack=r}catch{}}throw s}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Kt(this.defaults,e);const{transitional:s,paramsSerializer:n,headers:r}=e;s!==void 0&&ss.assertOptions(s,{silentJSONParsing:Nt.transitional(Nt.boolean),forcedJSONParsing:Nt.transitional(Nt.boolean),clarifyTimeoutError:Nt.transitional(Nt.boolean)},!1),n!=null&&(y.isFunction(n)?e.paramsSerializer={serialize:n}:ss.assertOptions(n,{encode:Nt.function,serialize:Nt.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),ss.assertOptions(e,{baseUrl:Nt.spelling("baseURL"),withXsrfToken:Nt.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=r&&y.merge(r.common,r[e.method]);r&&y.forEach(["delete","get","head","post","put","patch","common"],m=>{delete r[m]}),e.headers=mt.concat(o,r);const l=[];let h=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(e)===!1||(h=h&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let u,d=0,f;if(!h){const m=[pn.bind(this),void 0];for(m.unshift(...l),m.push(...c),f=m.length,u=Promise.resolve(e);d<f;)u=u.then(m[d++],m[d++]);return u}f=l.length;let b=e;for(;d<f;){const m=l[d++],p=l[d++];try{b=m(b)}catch(x){p.call(this,x);break}}try{u=pn.call(this,b)}catch(m){return Promise.reject(m)}for(d=0,f=c.length;d<f;)u=u.then(c[d++],c[d++]);return u}getUri(t){t=Kt(this.defaults,t);const e=qr(t.baseURL,t.url,t.allowAbsoluteUrls);return Ir(e,t.params,t.paramsSerializer)}};y.forEach(["delete","get","head","options"],function(t){qt.prototype[t]=function(e,s){return this.request(Kt(s||{},{method:t,url:e,data:(s||{}).data}))}});y.forEach(["post","put","patch"],function(t){function e(s){return function(r,o,l){return this.request(Kt(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}qt.prototype[t]=e(),qt.prototype[t+"Form"]=e(!0)});let uh=class Xr{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(r){e=r});const s=this;this.promise.then(n=>{if(!s._listeners)return;let r=s._listeners.length;for(;r-- >0;)s._listeners[r](n);s._listeners=null}),this.promise.then=n=>{let r;const o=new Promise(l=>{s.subscribe(l),r=l}).then(n);return o.cancel=function(){s.unsubscribe(r)},o},t(function(r,o,l){s.reason||(s.reason=new fe(r,o,l),e(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=s=>{t.abort(s)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new Xr(function(n){t=n}),cancel:t}}};function dh(i){return function(e){return i.apply(null,e)}}function fh(i){return y.isObject(i)&&i.isAxiosError===!0}const oi={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(oi).forEach(([i,t])=>{oi[t]=i});function Gr(i){const t=new qt(i),e=Mr(qt.prototype.request,t);return y.extend(e,qt.prototype,t,{allOwnKeys:!0}),y.extend(e,t,null,{allOwnKeys:!0}),e.create=function(n){return Gr(Kt(i,n))},e}const et=Gr(Oe);et.Axios=qt;et.CanceledError=fe;et.CancelToken=uh;et.isCancel=Ur;et.VERSION=Jr;et.toFormData=vs;et.AxiosError=A;et.Cancel=et.CanceledError;et.all=function(t){return Promise.all(t)};et.spread=dh;et.isAxiosError=fh;et.mergeConfig=Kt;et.AxiosHeaders=mt;et.formToJSON=i=>Br(y.isHTMLForm(i)?new FormData(i):i);et.getAdapter=Hr.getAdapter;et.HttpStatusCode=oi;et.default=et;const{Axios:Qd,AxiosError:Kd,CanceledError:Hd,isCancel:Jd,CancelToken:Xd,VERSION:Gd,all:Zd,Cancel:Yd,isAxiosError:tf,spread:ef,toFormData:sf,AxiosHeaders:nf,HttpStatusCode:rf,formToJSON:of,getAdapter:af,mergeConfig:lf}=et,V=et.create({baseURL:"",headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});console.log(" API Configuration [Build: 2025-11-10T20:00 - SIMPLIFIED]:",{baseURL:"(empty = relative to current origin)",currentOrigin:window.location.origin,hostname:window.location.hostname,note:"All API requests will be relative to current page origin"});V.interceptors.request.use(i=>{const t=localStorage.getItem("auth_token");return t&&(i.headers.Authorization=`Bearer ${t}`),i});const Si={getAccounts:async()=>(await V.get("/api/accounts")).data,getAccountInfo:async()=>(await V.get("/api/account/info")).data,switchAccount:async i=>(await V.post("/api/account/switch",{account_id:i})).data},Ct={getPositions:async()=>(await V.get(`/api/positions?_t=${Date.now()}`)).data,closePosition:async(i,t)=>{await V.post(`/api/positions/${i}/close`,{quantity:t})},modifyStopLoss:async(i,t)=>{await V.post(`/api/positions/${i}/modify-stop`,{stop_price:t})},modifyTakeProfit:async(i,t)=>{await V.post(`/api/positions/${i}/modify-tp`,{take_profit:t})},flattenAll:async()=>{await V.post("/api/positions/flatten")},enableTrailingStop:async(i,t)=>(await V.post(`/api/positions/${i}/trailing-stop`,{enabled:!0,trail_amount:t})).data,disableTrailingStop:async i=>(await V.post(`/api/positions/${i}/trailing-stop`,{enabled:!1})).data,enableBreakeven:async i=>(await V.post(`/api/positions/${i}/breakeven`,{enabled:!0})).data,disableBreakeven:async i=>(await V.post(`/api/positions/${i}/breakeven`,{enabled:!1})).data},xe={getOrders:async()=>(await V.get(`/api/orders?_t=${Date.now()}`)).data,cancelOrder:async i=>{await V.post(`/api/orders/${i}/cancel`)},cancelAll:async i=>{await V.post("/api/orders/cancel-all",i?{account_id:i}:{})},modifyOrder:async(i,t)=>(await V.post(`/api/orders/${i}/modify`,t)).data,placeOrder:async i=>{const t={...i};return t.symbol&&(t.symbol=t.symbol.trim().toUpperCase()),t.order_type&&(t.order_type=t.order_type.toLowerCase()),(await V.post("/api/orders/place",t)).data}},te={getStrategies:async()=>(await V.get("/api/strategies")).data,getStrategyStatus:async()=>(await V.get("/api/strategies/status")).data,startStrategy:async(i,t,e)=>{const s={symbols:t??[]};return e&&(s.accountId=e),(await V.post(`/api/strategies/${i}/start`,s)).data},stopStrategy:async(i,t)=>{const e={};return t&&(e.accountId=t),(await V.post(`/api/strategies/${i}/stop`,e)).data},getStrategyStats:async(i,t)=>{const e=t?`?account_id=${t}`:"";return(await V.get(`/api/strategies/${i}/stats${e}`)).data},getStrategyLogs:async(i,t)=>{const e=t?`?limit=${t}`:"";return(await V.get(`/api/strategies/${i}/logs${e}`)).data},testStrategy:async(i,t)=>{const e={};return t&&(e.account_id=t),(await V.post(`/api/strategies/${i}/test`,e)).data}},mh={getMetrics:async()=>{const i=await V.get("/api/metrics");return i.data.performance||i.data}},ph={getRisk:async i=>{const t=i?`?account_id=${encodeURIComponent(i)}`:"";return(await V.get(`/api/risk${t}`)).data}},bh={getTrades:async(i={})=>{const t=new URLSearchParams;i.accountId&&t.append("account_id",i.accountId),i.start&&t.append("start",i.start),i.end&&t.append("end",i.end),i.symbol&&t.append("symbol",i.symbol),i.type&&t.append("type",i.type),i.limit&&t.append("limit",String(i.limit)),i.cursor&&t.append("cursor",i.cursor),t.append("refresh","1"),t.append("_t",Date.now().toString());const e=t.toString();return(await V.get(`/api/trades${e?`?${e}`:""}`)).data}},Zr={getPerformanceSummary:async()=>(await V.get("/api/performance")).data,getPerformanceHistory:async(i={})=>{const t=new URLSearchParams;i.accountId&&t.append("account_id",i.accountId),i.interval&&t.append("interval",i.interval),i.start&&t.append("start",i.start),i.end&&t.append("end",i.end);const e=t.toString();return(await V.get(`/api/performance/history${e?`?${e}`:""}`)).data},getHistoricalData:async i=>{const t=new URLSearchParams;return t.append("symbol",i.symbol),i.timeframe&&t.append("timeframe",i.timeframe),i.limit&&t.append("limit",String(i.limit)),i.end&&t.append("end",i.end),(await V.get(`/api/history?${t.toString()}`)).data}},ai={getSettings:async(i="global")=>{const t=i&&i!=="global"?`?account_id=${i}`:"";return(await V.get(`/api/settings${t}`)).data},saveSettings:async i=>{const t={...i};return(await V.post("/api/settings",t)).data}},vh={getNotifications:async i=>{const t=i?`?account_id=${i}`:"";return(await V.get(`/api/notifications${t}`)).data}},gh={testOvernightBreakout:async(i,t,e)=>(await V.post("/api/test/overnight-breakout",{symbol:i||"MNQ",quantity:t||1,account_name:e||"PRAC"})).data},Yr=M.createContext(void 0);function xh({children:i}){const[t,e]=M.useState(null),{data:s=[],isLoading:n}=rt("accounts",Si.getAccounts,{refetchInterval:6e4,staleTime:3e4}),{data:r}=rt(["settings","global"],()=>ai.getSettings("global"),{staleTime:6e4,refetchOnWindowFocus:!1});return M.useEffect(()=>{var o;if(s.length>0&&!t){const l=(o=r==null?void 0:r.settings)==null?void 0:o.defaultAccount,h=l?s.find(c=>String(c.id)===String(l)||String(c.account_id)===String(l)||String(c.accountId)===String(l)):null;e(h||s[0])}},[s,t,r]),a.jsx(Yr.Provider,{value:{accounts:s,selectedAccount:t,setSelectedAccount:e,isLoading:n},children:i})}function Mt(){const i=M.useContext(Yr);if(i===void 0)throw new Error("useAccount must be used within an AccountProvider");return i}const yh=()=>{const i=window.location.hostname;return i==="localhost"||i==="127.0.0.1"?"ws://localhost:8080/ws":`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`},to=yh();console.log(" WebSocket Configuration [Build: 2025-11-10T19:45 - FIXED]:",{url:to,hostname:window.location.hostname,protocol:window.location.protocol,isLocalhost:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"});class wh{constructor(){Rt(this,"socket",null);Rt(this,"listeners",new Map);Rt(this,"reconnectAttempts",0);Rt(this,"maxReconnectAttempts",8);Rt(this,"reconnectDelay",1e3);Rt(this,"heartbeatIntervalId",null);Rt(this,"HEARTBEAT_INTERVAL",3e4);Rt(this,"manualClose",!1)}connect(){if(!(this.socket&&(this.socket.readyState===WebSocket.OPEN||this.socket.readyState===WebSocket.CONNECTING))){this.notify("socket_connecting",{timestamp:new Date().toISOString()});try{this.manualClose=!1,this.socket=new WebSocket(to),this.socket.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.notify("socket_connected",{timestamp:new Date().toISOString()}),this.startHeartbeat()},this.socket.onclose=t=>{console.log("WebSocket disconnected",t.reason||""),this.clearHeartbeat(),this.notify("socket_disconnected",{code:t.code,reason:t.reason,wasClean:t.wasClean,timestamp:new Date().toISOString()}),this.manualClose||this.attemptReconnect()},this.socket.onmessage=t=>{try{const e=JSON.parse(t.data);this.handleMessage(e)}catch(e){console.error("Error parsing WebSocket message:",e)}},this.socket.onerror=t=>{console.error("WebSocket error:",t),this.notify("socket_error",{error:t})}}catch(t){console.error("Failed to create WebSocket:",t),this.notify("socket_error",{error:t}),this.attemptReconnect()}}}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached"),this.notify("socket_failed",{attempts:this.reconnectAttempts,timestamp:new Date().toISOString()});return}this.reconnectAttempts++;const t=this.reconnectDelay*this.reconnectAttempts;console.log(`Reconnecting in ${t}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),this.notify("socket_reconnecting",{attempt:this.reconnectAttempts,delay:t,timestamp:new Date().toISOString()}),window.setTimeout(()=>{this.connect()},t)}disconnect(){this.manualClose=!0,this.clearHeartbeat(),this.socket&&(this.socket.close(),this.socket=null)}forceReconnect(){this.manualClose=!1,this.reconnectAttempts=0,this.clearHeartbeat(),this.socket&&(this.socket.close(),this.socket=null),this.connect()}on(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}off(t,e){var s;(s=this.listeners.get(t))==null||s.delete(e)}emit(t,e){var s;((s=this.socket)==null?void 0:s.readyState)===WebSocket.OPEN&&this.socket.send(JSON.stringify({action:t,payload:e}))}handleMessage(t){const e=this.listeners.get(t.type);e&&e.forEach(s=>s(t.data))}notify(t,e){const s=this.listeners.get(t);s&&s.forEach(n=>n(e))}startHeartbeat(){this.clearHeartbeat(),this.heartbeatIntervalId=window.setInterval(()=>{var t;((t=this.socket)==null?void 0:t.readyState)===WebSocket.OPEN&&this.socket.send(JSON.stringify({action:"ping",payload:{timestamp:Date.now()}}))},this.HEARTBEAT_INTERVAL)}clearHeartbeat(){this.heartbeatIntervalId!==null&&(window.clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null)}isConnected(){var t;return((t=this.socket)==null?void 0:t.readyState)===WebSocket.OPEN||!1}}const I=new wh,eo=M.createContext(void 0);function Sh({children:i}){const[t,e]=M.useState("connecting"),[s,n]=M.useState(0),[r,o]=M.useState(null),[l,h]=M.useState(null),[c,u]=M.useState(null);M.useEffect(()=>{const b=()=>{e("connecting"),u(null)},m=N=>{e("connected"),n(0),o((N==null?void 0:N.timestamp)??new Date().toISOString()),u(null)},p=N=>{e("disconnected"),h((N==null?void 0:N.timestamp)??new Date().toISOString())},x=N=>{e("reconnecting"),N!=null&&N.attempt?n(N.attempt):n(g=>g+1)},w=N=>{var j;e("error");const g=(N==null?void 0:N.error)instanceof Event?N.error.type:((j=N==null?void 0:N.error)==null?void 0:j.message)??"Unknown error";u(g)},_=N=>{e("error"),N!=null&&N.attempts&&n(N.attempts)};return I.on("socket_connecting",b),I.on("socket_connected",m),I.on("socket_disconnected",p),I.on("socket_reconnecting",x),I.on("socket_error",w),I.on("socket_failed",_),I.connect(),()=>{I.off("socket_connecting",b),I.off("socket_connected",m),I.off("socket_disconnected",p),I.off("socket_reconnecting",x),I.off("socket_error",w),I.off("socket_failed",_)}},[]);const d=M.useCallback(()=>{e("connecting"),u(null),n(0),I.forceReconnect()},[]),f=M.useMemo(()=>({status:t,reconnectAttempts:s,lastConnectedAt:r,lastDisconnectedAt:l,lastError:c,reconnect:d,isConnected:I.isConnected()}),[t,s,r,l,c,d]);return a.jsx(eo.Provider,{value:f,children:i})}function Nh(){const i=M.useContext(eo);if(!i)throw new Error("useWebSocket must be used within a WebSocketProvider");return i}const so=()=>{const i=xt();M.useEffect(()=>{const t=()=>{i.invalidateQueries("positions"),i.invalidateQueries("orders")},e=()=>{i.invalidateQueries("positions")},s=()=>{i.invalidateQueries("orders")};return I.on("marketUpdate",t),I.on("position_update",e),I.on("order_update",s),()=>{I.off("marketUpdate",t),I.off("position_update",e),I.off("order_update",s)}},[i])};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),q=(i,t)=>{const e=M.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:l="",children:h,...c},u)=>M.createElement("svg",{ref:u,...jh,width:n,height:n,stroke:s,strokeWidth:o?Number(r)*24/Number(n):r,className:["lucide",`lucide-${_h(i)}`,l].join(" "),...c},[...t.map(([d,f])=>M.createElement(d,f)),...Array.isArray(h)?h:[h]]));return e.displayName=`${i}`,e};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=q("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=q("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=q("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=q("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=q("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=q("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=q("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=q("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=q("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=q("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=q("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=q("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=q("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=q("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=q("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=q("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=q("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=q("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oh=q("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=q("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=q("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=q("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=q("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function zh({account:i,isSelected:t,onSelect:e}){const s=i.dailyPnL??i.daily_pnl??0,n=s>=0?"text-green-400":"text-red-400",r=s>=0?ys:_i;return a.jsxs("div",{className:`p-6 rounded-lg border-2 transition-all cursor-pointer ${t?"bg-slate-800 border-primary-500 shadow-lg shadow-primary-500/20":"bg-slate-800/50 border-slate-700 hover:border-slate-600"}`,onClick:e,children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:i.name}),a.jsx("p",{className:"text-sm text-slate-400",children:i.account_type})]}),a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${i.status==="active"?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400"}`,children:i.status})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mh,{className:"w-5 h-5 text-slate-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-slate-400",children:"Balance"}),a.jsxs("p",{className:"text-2xl font-bold",children:[i.currency," ",i.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),s!==0&&a.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[a.jsx(r,{className:"w-4 h-4"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm",children:"P&L"}),a.jsxs("p",{className:"text-lg font-semibold",children:[s>=0?"+":"",i.currency," ",Math.abs(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]})}function Ci({accounts:i,selectedAccount:t,onAccountChange:e}){var u;const[s,n]=M.useState(!1),r=xt(),o=d=>d.id||d.accountId||d.account_id||d.name||"unknown",l=d=>d.name||d.accountId||d.account_id||o(d),h=nt(d=>Si.switchAccount(d),{onSuccess:d=>{if(d.success&&d.account){const f={id:d.account.id||d.account.accountId||d.account.account_id||o(d.account),name:d.account.name||d.account.accountId||o(d.account),status:d.account.status||"active",balance:Number(d.account.balance??0),currency:d.account.currency||"USD",account_type:d.account.account_type||"unknown",accountId:d.account.accountId,account_id:d.account.account_id,equity:d.account.equity??d.account.balance??0,dailyPnL:d.account.dailyPnL??d.account.daily_pnl??0,daily_pnl:d.account.dailyPnL??d.account.daily_pnl??0};e(f),r.setQueryData("accountInfo",f),r.setQueryData("accounts",m=>(m==null?void 0:m.map(p=>o(p)===f.id?{...p,balance:f.balance,status:f.status}:p))||[]),["accounts","accountInfo","positions","orders","metrics","trades","performance","performanceHistory","historicalData"].forEach(m=>r.invalidateQueries({predicate:p=>p.queryKey[0]===m})),n(!1)}},onError:d=>{console.error("Failed to switch account:",d)}}),c=async d=>{const f=t?o(t):null,b=o(d);if(b===f){n(!1);return}h.mutate(b)};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>n(!s),className:"w-full bg-slate-700 hover:bg-slate-600 rounded-lg px-4 py-3 flex items-center justify-between transition-colors border border-slate-600",disabled:h.isLoading,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),a.jsx("div",{className:"text-left",children:t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium",children:l(t)}),a.jsxs("div",{className:"text-xs text-slate-400",children:["$",((u=t.balance)==null?void 0:u.toLocaleString())||"N/A"]})]}):a.jsx("div",{className:"text-slate-400",children:"Select Account"})})]}),a.jsx(Te,{className:`w-5 h-5 transition-transform ${s?"rotate-180":""}`})]}),s&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),a.jsx("div",{className:"absolute top-full mt-2 w-full bg-slate-700 border border-slate-600 rounded-lg shadow-xl z-50 max-h-96 overflow-y-auto",children:i.length===0?a.jsx("div",{className:"px-4 py-3 text-slate-400 text-sm",children:"No accounts available"}):i.map(d=>{var x;const f=o(d),b=t?o(t):null,m=f===b,p=h.isLoading&&h.variables===f;return a.jsxs("button",{onClick:()=>c(d),disabled:h.isLoading,className:`w-full px-4 py-3 flex items-center justify-between hover:bg-slate-600 transition-colors ${m?"bg-slate-600":""} ${h.isLoading?"opacity-50":""}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${d.status==="active"?"bg-green-500":"bg-slate-500"}`}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium",children:l(d)}),a.jsxs("div",{className:"text-xs text-slate-400",children:["$",((x=d.balance)==null?void 0:x.toLocaleString())||"N/A",d.status&&a.jsxs("span",{className:"ml-2 capitalize",children:[" ",d.status]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-500"}),m&&!p&&a.jsx(vn,{className:"w-5 h-5 text-primary-400"})]})]},f)})})]}),h.isError&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-400 text-sm",children:[a.jsx(ae,{className:"w-4 h-4"}),a.jsx("span",{children:"Failed to switch account"})]}),h.isSuccess&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-green-400 text-sm",children:[a.jsx(vn,{className:"w-4 h-4"}),a.jsx("span",{children:"Account switched successfully"})]})]})}function $h({metrics:i}){return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Performance Metrics"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(Ni,{className:"w-4 h-4"}),"System"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Memory"}),a.jsxs("p",{className:"font-semibold",children:[i.system.memory_mb," MB"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"CPU"}),a.jsxs("p",{className:"font-semibold",children:[i.system.cpu_percent,"%"]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-slate-400",children:"Uptime"}),a.jsx("p",{className:"font-semibold",children:i.system.uptime})]})]})]}),a.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-700",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(li,{className:"w-4 h-4"}),"API Calls"]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Total"}),a.jsx("span",{className:"font-semibold",children:i.api.total_calls})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Errors"}),a.jsx("span",{className:`font-semibold ${i.api.total_errors>0?"text-red-400":"text-green-400"}`,children:i.api.total_errors})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Error Rate"}),a.jsxs("span",{className:`font-semibold ${i.api.error_rate>1?"text-red-400":"text-green-400"}`,children:[i.api.error_rate.toFixed(2),"%"]})]})]})]}),Object.keys(i.cache).length>0&&a.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-700",children:[a.jsxs("h3",{className:"text-sm font-medium text-slate-400 flex items-center gap-2",children:[a.jsx(kh,{className:"w-4 h-4"}),"Cache"]}),a.jsx("div",{className:"space-y-2",children:Object.entries(i.cache).map(([t,e])=>a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex justify-between mb-1",children:[a.jsx("span",{className:"text-slate-400 text-xs",children:t}),a.jsx("span",{className:"font-semibold",children:e.hit_rate})]}),a.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1.5",children:a.jsx("div",{className:"bg-primary-500 h-1.5 rounded-full transition-all",style:{width:e.hit_rate}})})]},t))})]})]})]})}function Ah(){const{selectedAccount:i}=Mt(),t=i==null?void 0:i.id,{data:e=[],isLoading:s}=rt(["positions",t],Ct.getPositions,{enabled:!!t,staleTime:6e4,refetchOnWindowFocus:!1});return s?a.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:a.jsx("p",{className:"text-slate-400",children:"Loading positions..."})}):e.length===0?a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Open Positions"}),a.jsx("p",{className:"text-slate-400",children:"No open positions"})]}):a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Open Positions"}),a.jsx("div",{className:"space-y-3",children:e.map(n=>{const r=n.side==="LONG",o=Number(n.unrealized_pnl??0),l=Number(n.realized_pnl??0),h=Number(n.entry_price??0),c=Number(n.current_price??h),u=o>=0?ys:_i,d=o>=0?"text-green-400":"text-red-400";return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${r?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:n.side}),a.jsx("span",{className:"font-semibold",children:n.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(n.quantity??0)]})]}),a.jsxs("div",{className:`flex items-center gap-1 ${d}`,children:[a.jsx(u,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-semibold",children:["$",o.toFixed(2)]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Entry"}),a.jsxs("p",{className:"font-semibold",children:["$",h.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current"}),a.jsxs("p",{className:"font-semibold",children:["$",c.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Realized P&L"}),a.jsxs("p",{className:`font-semibold ${l>=0?"text-green-400":"text-red-400"}`,children:["$",l.toFixed(2)]})]})]})]},n.id||`${n.symbol}-${n.entry_price}`)})})]})}const Dh=[{label:"Trade",value:"trade"},{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"}];function Ih(){const{selectedAccount:i}=Mt(),[t,e]=M.useState("day"),{data:s,isLoading:n}=rt(["performanceHistory",i==null?void 0:i.id,t],async()=>{console.log(" PerformanceChart: Fetching performance history for account:",i==null?void 0:i.id,"interval:",t);try{const h=await Zr.getPerformanceHistory({accountId:i==null?void 0:i.id,interval:t});return console.log(" PerformanceChart: Received data:",h),h.points&&h.points.length>0&&(console.log(` PerformanceChart [${t}]: First 5 data points:`),h.points.slice(0,5).forEach((c,u)=>{console.log(`  Point ${u+1}:`,{timestamp:c.timestamp,period_pnl:c.period_pnl,cumulative_pnl:c.cumulative_pnl,trade_count:c.trade_count})}),console.log(` PerformanceChart [${t}]: Last 5 data points:`),h.points.slice(-5).forEach((c,u)=>{console.log(`  Point ${h.points.length-4+u}:`,{timestamp:c.timestamp,period_pnl:c.period_pnl,cumulative_pnl:c.cumulative_pnl,trade_count:c.trade_count})})),h}catch(h){throw console.error(" PerformanceChart: Error fetching data:",h),h}},{enabled:!!i,staleTime:6e4,onError:h=>{console.error(" PerformanceChart: Query error:",h)}}),r=M.useMemo(()=>{var m;if(!(s!=null&&s.summary))return null;const h=(m=s.points)==null?void 0:m[s.points.length-1],c=(h==null?void 0:h.cumulative_pnl)??s.summary.total_pnl??0,u=(i==null?void 0:i.balance)??(i==null?void 0:i.equity),f=(u!=null&&!Number.isNaN(Number(u))?Number(u):void 0)??s.summary.end_balance??(s.summary.start_balance??0)+c,b=s.summary.start_balance??f-c;return{...s.summary,start_balance:b,end_balance:f}},[s,i]),o=M.useMemo(()=>{if(!(s!=null&&s.points))return[];const h=(r==null?void 0:r.start_balance)??0,c=new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric",hour:t==="trade"||t==="hour"?"2-digit":void 0,minute:t==="trade"||t==="hour"?"2-digit":void 0});return s.points.map(u=>({label:c.format(new Date(u.timestamp)),cumulative:u.cumulative_pnl,period:u.period_pnl,balance:h+u.cumulative_pnl,trades:u.trade_count}))},[s,t,r]),l=()=>{const h=i==null?void 0:i.id,c=new URLSearchParams;h&&c.append("account_id",h),c.append("interval",t);const u=`/api/performance/export${c.toString()?`?${c.toString()}`:""}`;window.open(u,"_blank")};return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Performance"}),a.jsxs("button",{onClick:l,className:"px-3 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2 text-sm",disabled:!i||!s,children:[a.jsx(ro,{className:"w-4 h-4"}),"Export CSV"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Dh.map(h=>a.jsx("button",{onClick:()=>e(h.value),className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors ${t===h.value?"bg-primary-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:h.label},h.value))})]}),n?a.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400 text-sm",children:"Loading performance history..."}):o.length===0?a.jsx("div",{className:"h-64 flex items-center justify-center text-slate-500 text-sm",children:"No historical trades available for this period."}):a.jsx(Zo,{width:"100%",height:320,children:a.jsxs(Yo,{data:o,children:[a.jsx(ta,{strokeDasharray:"3 3",stroke:"#374151"}),a.jsx(ea,{dataKey:"label",stroke:"#9CA3AF",minTickGap:16}),a.jsx(Wi,{stroke:"#9CA3AF",yAxisId:"left"}),a.jsx(Wi,{stroke:"#9CA3AF",yAxisId:"right",orientation:"right"}),a.jsx(sa,{contentStyle:{backgroundColor:"#1E293B",border:"1px solid #334155",borderRadius:"8px"}}),a.jsx(ia,{}),a.jsx(Ms,{type:"monotone",dataKey:"cumulative",stroke:"#10B981",strokeWidth:2,yAxisId:"left",name:"Cumulative P&L",dot:!1}),a.jsx(Ms,{type:"monotone",dataKey:"balance",stroke:"#3B82F6",strokeWidth:2,yAxisId:"right",name:"Balance",dot:!1}),a.jsx(Ms,{type:"monotone",dataKey:"period",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"4 4",yAxisId:"left",name:"Period P&L",dot:!1})]})}),r&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm bg-slate-900/60 rounded-lg p-4 border border-slate-700/60",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Total P&L"}),a.jsxs("p",{className:`font-semibold ${r.total_pnl>=0?"text-green-400":"text-red-400"}`,children:[r.total_pnl>=0?"+":"","$",Math.abs(r.total_pnl).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Win Rate"}),a.jsxs("p",{className:"font-semibold",children:[r.win_rate.toFixed(2),"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Max Drawdown"}),a.jsxs("p",{className:"font-semibold",children:["-$",Math.abs(r.max_drawdown).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Trades"}),a.jsx("p",{className:"font-semibold",children:r.trade_count})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current Balance"}),a.jsxs("p",{className:"font-semibold",children:["$",Number(r.end_balance??0).toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}function J(i){var t=i.width,e=i.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Qt(i,t){return i.width===t.width&&i.height===t.height}var Vh=function(){function i(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return i.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(i.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),i.prototype.subscribe=function(t){var e=this,s={next:t};return this._observers.push(s),{unsubscribe:function(){e._observers=e._observers.filter(function(n){return n!==s})}}},i.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},i.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},i.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},i.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},i}();function Bh(i){return new Vh(i)}var Uh=function(){function i(t,e,s){var n;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=J({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(n=s==null?void 0:s.allowResizeObserver)!==null&&n!==void 0?n:!0,this._chooseAndInitObserver()}return i.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(i.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bitmapSize",{get:function(){return J({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),i.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=J(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},i.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},i.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(i.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),i.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},i.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},i.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},i.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Qt(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},i.prototype._emitBitmapSizeChanged=function(t,e){var s=this;this._bitmapSizeChangedListeners.forEach(function(n){return n.call(s,t,e)})},i.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,s=J(this._transformBitmapSize(t,this._canvasElementClientSize)),n=Qt(this.bitmapSize,s)?null:s;e===null&&n===null||e!==null&&n!==null&&Qt(e,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(e,n))},i.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var s=this;this._suggestedBitmapSizeChangedListeners.forEach(function(n){return n.call(s,t,e)})},i.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}qh().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},i.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=xn(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Bh(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},i.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var s=xn(this._canvasElement);if(s!==null){var n=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:s.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?Qh(r[0],n):J({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},i.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var s=e.find(function(o){return o.target===t._canvasElement});if(!(!s||!s.devicePixelContentBoxSize||!s.devicePixelContentBoxSize[0])){var n=s.devicePixelContentBoxSize[0],r=J({width:n.inlineSize,height:n.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},i}();function Wh(i,t){return new Uh(i,t.transform,t.options)}function xn(i){return i.ownerDocument.defaultView}function qh(){return new Promise(function(i){var t=new ResizeObserver(function(e){i(e.every(function(s){return"devicePixelContentBoxSize"in s})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Qh(i,t){return J({width:Math.round(i.left*t+i.width*t)-Math.round(i.left*t),height:Math.round(i.top*t+i.height*t)-Math.round(i.top*t)})}var Kh=function(){function i(t,e,s){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,s.width===0||s.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=s,this._context=t}return i.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},i.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(i.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),i}();function Ht(i,t){var e=i.canvasElementClientSize;if(e.width===0||e.height===0)return null;var s=i.bitmapSize;if(s.width===0||s.height===0)return null;var n=i.canvasElement.getContext("2d",t);return n===null?null:new Kh(n,e,s)}/*!
 * @license
 * TradingView Lightweight Charts v4.2.0
 * Copyright (c) 2024 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Hh={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Jh={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Xh={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Gh={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Zh={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Yh={color:"#26a69a",base:0},ho={color:"#2196f3"},co={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var yn,Wt;function Jt(i,t){const e={0:[],1:[i.lineWidth,i.lineWidth],2:[2*i.lineWidth,2*i.lineWidth],3:[6*i.lineWidth,6*i.lineWidth],4:[i.lineWidth,4*i.lineWidth]}[t];i.setLineDash(e)}function uo(i,t,e,s){i.beginPath();const n=i.lineWidth%2?.5:0;i.moveTo(e,t+n),i.lineTo(s,t+n),i.stroke()}function At(i,t){if(!i)throw new Error("Assertion failed"+(t?": "+t:""))}function ut(i){if(i===void 0)throw new Error("Value is undefined");return i}function C(i){if(i===null)throw new Error("Value is null");return i}function se(i){return C(ut(i))}(function(i){i[i.Simple=0]="Simple",i[i.WithSteps=1]="WithSteps",i[i.Curved=2]="Curved"})(yn||(yn={})),function(i){i[i.Solid=0]="Solid",i[i.Dotted=1]="Dotted",i[i.Dashed=2]="Dashed",i[i.LargeDashed=3]="LargeDashed",i[i.SparseDotted=4]="SparseDotted"}(Wt||(Wt={}));const wn={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function bt(i){return i<0?0:i>255?255:Math.round(i)||0}function fo(i){return i<=0||i>1?Math.min(Math.max(i,0),1):Math.round(1e4*i)/1e4}const tc=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,ec=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,sc=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,ic=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function je(i){(i=i.toLowerCase())in wn&&(i=wn[i]);{const t=ic.exec(i)||sc.exec(i);if(t)return[bt(parseInt(t[1],10)),bt(parseInt(t[2],10)),bt(parseInt(t[3],10)),fo(t.length<5?1:parseFloat(t[4]))]}{const t=ec.exec(i);if(t)return[bt(parseInt(t[1],16)),bt(parseInt(t[2],16)),bt(parseInt(t[3],16)),1]}{const t=tc.exec(i);if(t)return[bt(17*parseInt(t[1],16)),bt(17*parseInt(t[2],16)),bt(17*parseInt(t[3],16)),1]}throw new Error(`Cannot parse color: ${i}`)}function mo(i){return .199*i[0]+.687*i[1]+.114*i[2]}function ws(i){const t=je(i);return{t:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,i:mo(t)>160?"black":"white"}}class tt{constructor(){this.h=[]}l(t,e,s){const n={o:t,_:e,u:s===!0};this.h.push(n)}v(t){const e=this.h.findIndex(s=>t===s.o);e>-1&&this.h.splice(e,1)}p(t){this.h=this.h.filter(e=>e._!==t)}m(t,e,s){const n=[...this.h];this.h=this.h.filter(r=>!r.u),n.forEach(r=>r.o(t,e,s))}M(){return this.h.length>0}S(){this.h=[]}}function gt(i,...t){for(const e of t)for(const s in e)e[s]!==void 0&&(typeof e[s]!="object"||i[s]===void 0||Array.isArray(e[s])?i[s]=e[s]:gt(i[s],e[s]));return i}function kt(i){return typeof i=="number"&&isFinite(i)}function _e(i){return typeof i=="number"&&i%1==0}function Fe(i){return typeof i=="string"}function Ve(i){return typeof i=="boolean"}function Pt(i){const t=i;if(!t||typeof t!="object")return t;let e,s,n;for(s in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(s)&&(n=t[s],e[s]=n&&typeof n=="object"?Pt(n):n);return e}function nc(i){return i!==null}function Ce(i){return i===null?void 0:i}const ki="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function le(i,t,e){return t===void 0&&(t=ki),`${e=e!==void 0?`${e} `:""}${i}px ${t}`}class rc{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=t}W(){const t=this.k,e=this.j(),s=this.H();return t.P===e&&t.D===s||(t.P=e,t.D=s,t.R=le(e,s),t.L=2.5/12*e,t.B=t.L,t.A=e/12*t.T,t.I=e/12*t.T,t.N=0),t.V=this.$(),t.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class Mi{constructor(){this.Y=[]}Z(t){this.Y=t}X(t,e,s){this.Y.forEach(n=>{n.X(t,e,s)})}}class wt{X(t,e,s){t.useBitmapCoordinateSpace(n=>this.K(n,e,s))}}class oc extends wt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.G===null||this.G.tt===null)return;const n=this.G.tt,r=this.G,o=Math.max(1,Math.floor(e))%2/2,l=h=>{t.beginPath();for(let c=n.to-1;c>=n.from;--c){const u=r.it[c],d=Math.round(u.nt*e)+o,f=u.st*s,b=h*s+o;t.moveTo(d,f),t.arc(d,f,b,0,2*Math.PI)}t.fill()};r.et>0&&(t.fillStyle=r.rt,l(r.ht+r.et)),t.fillStyle=r.lt,l(r.ht)}}function ac(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}const lc={from:0,to:1};class hc{constructor(t,e){this.ut=new Mi,this.ct=[],this.dt=[],this.ft=!0,this.F=t,this.vt=e,this.ut.Z(this.ct)}bt(t){const e=this.F.wt();e.length!==this.ct.length&&(this.dt=e.map(ac),this.ct=this.dt.map(s=>{const n=new oc;return n.J(s),n}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const t=this.vt.W().mode===2,e=this.F.wt(),s=this.vt.xt(),n=this.F.St();e.forEach((r,o)=>{var l;const h=this.dt[o],c=r.kt(s);if(t||c===null||!r.yt())return void(h.tt=null);const u=C(r.Ct());h.lt=c.Tt,h.ht=c.ht,h.et=c.Pt,h.it[0]._t=c._t,h.it[0].st=r.Dt().Rt(c._t,u.Vt),h.rt=(l=c.Ot)!==null&&l!==void 0?l:this.F.Bt(h.it[0].st/r.Dt().At()),h.it[0].ot=s,h.it[0].nt=n.It(s),h.tt=lc})}}class cc extends wt{constructor(t){super(),this.zt=t}K({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.zt===null)return;const r=this.zt.Lt.yt,o=this.zt.Et.yt;if(!r&&!o)return;const l=Math.round(this.zt.nt*s),h=Math.round(this.zt.st*n);t.lineCap="butt",r&&l>=0&&(t.lineWidth=Math.floor(this.zt.Lt.et*s),t.strokeStyle=this.zt.Lt.V,t.fillStyle=this.zt.Lt.V,Jt(t,this.zt.Lt.Nt),function(c,u,d,f){c.beginPath();const b=c.lineWidth%2?.5:0;c.moveTo(u+b,d),c.lineTo(u+b,f),c.stroke()}(t,l,0,e.height)),o&&h>=0&&(t.lineWidth=Math.floor(this.zt.Et.et*n),t.strokeStyle=this.zt.Et.V,t.fillStyle=this.zt.Et.V,Jt(t,this.zt.Et.Nt),uo(t,h,0,e.width))}}class uc{constructor(t){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new cc(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.yt(),e=C(this.jt.Ht()),s=e.$t().W().crosshair,n=this.Ft;if(s.mode===2)return n.Et.yt=!1,void(n.Lt.yt=!1);n.Et.yt=t&&this.jt.Ut(e),n.Lt.yt=t&&this.jt.qt(),n.Et.et=s.horzLine.width,n.Et.Nt=s.horzLine.style,n.Et.V=s.horzLine.color,n.Lt.et=s.vertLine.width,n.Lt.Nt=s.vertLine.style,n.Lt.V=s.vertLine.color,n.nt=this.jt.Yt(),n.st=this.jt.Zt()}}function dc(i,t,e,s,n,r){i.fillRect(t+r,e,s-2*r,r),i.fillRect(t+r,e+n-r,s-2*r,r),i.fillRect(t,e,r,n),i.fillRect(t+s-r,e,r,n)}function Ss(i,t,e,s,n,r){i.save(),i.globalCompositeOperation="copy",i.fillStyle=r,i.fillRect(t,e,s,n),i.restore()}function Sn(i,t,e,s,n,r){i.beginPath(),i.roundRect?i.roundRect(t,e,s,n,r):(i.lineTo(t+s-r[1],e),r[1]!==0&&i.arcTo(t+s,e,t+s,e+r[1],r[1]),i.lineTo(t+s,e+n-r[2]),r[2]!==0&&i.arcTo(t+s,e+n,t+s-r[2],e+n,r[2]),i.lineTo(t+r[3],e+n),r[3]!==0&&i.arcTo(t,e+n,t,e+n-r[3],r[3]),i.lineTo(t,e+r[0]),r[0]!==0&&i.arcTo(t,e,t+r[0],e,r[0]))}function Nn(i,t,e,s,n,r,o=0,l=[0,0,0,0],h=""){if(i.save(),!o||!h||h===r)return Sn(i,t,e,s,n,l),i.fillStyle=r,i.fill(),void i.restore();const c=o/2;var u;Sn(i,t+c,e+c,s-o,n-o,(u=-c,l.map(d=>d===0?d:d+u))),r!=="transparent"&&(i.fillStyle=r,i.fill()),h!=="transparent"&&(i.lineWidth=o,i.strokeStyle=h,i.closePath(),i.stroke()),i.restore()}function po(i,t,e,s,n,r,o){i.save(),i.globalCompositeOperation="copy";const l=i.createLinearGradient(0,0,0,n);l.addColorStop(0,r),l.addColorStop(1,o),i.fillStyle=l,i.fillRect(t,e,s,n),i.restore()}class jn{constructor(t,e){this.J(t,e)}J(t,e){this.zt=t,this.Xt=e}At(t,e){return this.zt.yt?t.P+t.L+t.B:0}X(t,e,s,n){if(!this.zt.yt||this.zt.Kt.length===0)return;const r=this.zt.V,o=this.Xt.t,l=t.useBitmapCoordinateSpace(h=>{const c=h.context;c.font=e.R;const u=this.Gt(h,e,s,n),d=u.Jt,f=(b,m)=>{u.Qt?Nn(c,d.ti,d.ii,d.ni,d.si,b,d.ei,[d.ht,0,0,d.ht],m):Nn(c,d.ri,d.ii,d.ni,d.si,b,d.ei,[0,d.ht,d.ht,0],m)};return f(o,"transparent"),this.zt.hi&&(c.fillStyle=r,c.fillRect(d.ri,d.li,d.ai-d.ri,d.oi)),f("transparent",o),this.zt._i&&(c.fillStyle=e.O,c.fillRect(u.Qt?d.ui-d.ei:0,d.ii,d.ei,d.ci-d.ii)),u});t.useMediaCoordinateSpace(({context:h})=>{const c=l.di;h.font=e.R,h.textAlign=l.Qt?"right":"left",h.textBaseline="middle",h.fillStyle=r,h.fillText(this.zt.Kt,c.fi,(c.ii+c.ci)/2+c.pi)})}Gt(t,e,s,n){var r;const{context:o,bitmapSize:l,mediaSize:h,horizontalPixelRatio:c,verticalPixelRatio:u}=t,d=this.zt.hi||!this.zt.mi?e.T:0,f=this.zt.bi?e.C:0,b=e.L+this.Xt.wi,m=e.B+this.Xt.gi,p=e.A,x=e.I,w=this.zt.Kt,_=e.P,N=s.Mi(o,w),g=Math.ceil(s.xi(o,w)),j=_+b+m,k=e.C+p+x+g+d,S=Math.max(1,Math.floor(u));let T=Math.round(j*u);T%2!=S%2&&(T+=1);const B=f>0?Math.max(1,Math.floor(f*c)):0,P=Math.round(k*c),X=Math.round(d*c),K=(r=this.Xt.Si)!==null&&r!==void 0?r:this.Xt.ki,Q=Math.round(K*u)-Math.floor(.5*u),U=Math.floor(Q+S/2-T/2),O=U+T,F=n==="right",it=F?h.width-f:f,$=F?l.width-B:B;let W,lt,Z;return F?(W=$-P,lt=$-X,Z=it-d-p-f):(W=$+P,lt=$+X,Z=it+d+p),{Qt:F,Jt:{ii:U,li:Q,ci:O,ni:P,si:T,ht:2*c,ei:B,ti:W,ri:$,ai:lt,oi:S,ui:l.width},di:{ii:U/u,ci:O/u,fi:Z,pi:N}}}}class Ns{constructor(t){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(t||jn)(this.Ci,this.yi),this.Ri=new(t||jn)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(t,e=!1){return Math.max(this.Pi.At(t,e),this.Ri.At(t,e))}Vi(){return this.yi.Si||0}Oi(t){this.yi.Si=t}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(t){return this.Di(),this.Ci.hi=this.Ci.hi&&t.W().ticksVisible,this.Ti.hi=this.Ti.hi&&t.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class fc extends Ns{constructor(t,e,s){super(),this.jt=t,this.Li=e,this.Ei=s}zi(t,e,s){if(t.yt=!1,this.jt.W().mode===2)return;const n=this.jt.W().horzLine;if(!n.labelVisible)return;const r=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||r===null)return;const o=ws(n.labelBackgroundColor);s.t=o.t,t.V=o.i;const l=2/12*this.Li.P();s.wi=l,s.gi=l;const h=this.Ei(this.Li);s.ki=h.ki,t.Kt=this.Li.Fi(h._t,r),t.yt=!0}}const mc=/[1-9]/g;class bo{constructor(){this.zt=null}J(t){this.zt=t}X(t,e){if(this.zt===null||this.zt.yt===!1||this.zt.Kt.length===0)return;const s=t.useMediaCoordinateSpace(({context:f})=>(f.font=e.R,Math.round(e.Wi.xi(f,C(this.zt).Kt,mc))));if(s<=0)return;const n=e.ji,r=s+2*n,o=r/2,l=this.zt.Hi;let h=this.zt.ki,c=Math.floor(h-o)+.5;c<0?(h+=Math.abs(0-c),c=Math.floor(h-o)+.5):c+r>l&&(h-=Math.abs(l-(c+r)),c=Math.floor(h-o)+.5);const u=c+r,d=Math.ceil(0+e.C+e.T+e.L+e.P+e.B);t.useBitmapCoordinateSpace(({context:f,horizontalPixelRatio:b,verticalPixelRatio:m})=>{const p=C(this.zt);f.fillStyle=p.t;const x=Math.round(c*b),w=Math.round(0*m),_=Math.round(u*b),N=Math.round(d*m),g=Math.round(2*b);if(f.beginPath(),f.moveTo(x,w),f.lineTo(x,N-g),f.arcTo(x,N,x+g,N,g),f.lineTo(_-g,N),f.arcTo(_,N,_,N-g,g),f.lineTo(_,w),f.fill(),p.hi){const j=Math.round(p.ki*b),k=w,S=Math.round((k+e.T)*m);f.fillStyle=p.V;const T=Math.max(1,Math.floor(b)),B=Math.floor(.5*b);f.fillRect(j-B,k,T,S-k)}}),t.useMediaCoordinateSpace(({context:f})=>{const b=C(this.zt),m=0+e.C+e.T+e.L+e.P/2;f.font=e.R,f.textAlign="left",f.textBaseline="middle",f.fillStyle=b.V;const p=e.Wi.Mi(f,"Apr0");f.translate(c+n,m+p),f.fillText(b.Kt,0,0)})}}class pc{constructor(t,e,s){this.ft=!0,this.Wt=new bo,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=t,this.$i=e,this.Ei=s}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const t=this.Ft;if(t.yt=!1,this.vt.W().mode===2)return;const e=this.vt.W().vertLine;if(!e.labelVisible)return;const s=this.$i.St();if(s.Ni())return;t.Hi=s.Hi();const n=this.Ei();if(n===null)return;t.ki=n.ki;const r=s.Ui(this.vt.xt());t.Kt=s.qi(C(r)),t.yt=!0;const o=ws(e.labelBackgroundColor);t.t=o.t,t.V=o.i,t.hi=s.W().ticksVisible}}class Ei{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(t){this.Zi=t}Dt(){return this.Yi}Gi(t){this.Yi=t}Ji(t){return[]}Qi(){return[]}yt(){return!0}}var _n;(function(i){i[i.Normal=0]="Normal",i[i.Magnet=1]="Magnet",i[i.Hidden=2]="Hidden"})(_n||(_n={}));class bc extends Ei{constructor(t,e){super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=t,this.cn=e,this.dn=new hc(t,this),this.fn=((n,r)=>o=>{const l=r(),h=n();if(o===C(this.tn).vn())return{_t:h,ki:l};{const c=C(o.Ct());return{_t:o.pn(l,c),ki:l}}})(()=>this.nn,()=>this.an);const s=((n,r)=>()=>{const o=this.$i.St().mn(n()),l=r();return o&&Number.isFinite(l)?{ot:o,ki:l}:null})(()=>this.sn,()=>this.Yt());this.bn=new pc(this,t,s),this.wn=new uc(this)}W(){return this.cn}gn(t,e){this._n=t,this.un=e}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(t,e,s){this.hn||(this.hn=!0),this.en=!0,this.yn(t,e,s)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(t){return this.tn!==null?[this.wn,this.dn]:[]}Ut(t){return t===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(t,e){this.en&&this.tn===t||this.rn.clear();const s=[];return this.tn===t&&s.push(this.Dn(this.rn,e,this.fn)),s}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(t=>t.bt()),this.bn.bt(),this.dn.bt()}On(t){return t&&!t.vn().Ni()?t.vn():null}yn(t,e,s){this.Bn(t,e,s)&&this.Vn()}Bn(t,e,s){const n=this.ln,r=this.an,o=this.nn,l=this.sn,h=this.tn,c=this.On(s);this.sn=t,this.ln=isNaN(t)?NaN:this.$i.St().It(t),this.tn=s;const u=c!==null?c.Ct():null;return c!==null&&u!==null?(this.nn=e,this.an=c.Rt(e,u)):(this.nn=NaN,this.an=NaN),n!==this.ln||r!==this.an||l!==this.sn||o!==this.nn||h!==this.tn}Tn(){const t=this.$i.wt().map(s=>s.In().An()).filter(nc),e=t.length===0?null:Math.max(...t);this.sn=e!==null?e:NaN}Dn(t,e,s){let n=t.get(e);return n===void 0&&(n=new fc(this,e,s),t.set(e,n)),n}}function js(i){return i==="left"||i==="right"}class ot{constructor(t){this.zn=new Map,this.Ln=[],this.En=t}Nn(t,e){const s=function(n,r){return n===void 0?r:{Fn:Math.max(n.Fn,r.Fn),Wn:n.Wn||r.Wn}}(this.zn.get(t),e);this.zn.set(t,s)}jn(){return this.En}Hn(t){const e=this.zn.get(t);return e===void 0?{Fn:this.En}:{Fn:Math.max(this.En,e.Fn),Wn:e.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(t){this.Un(),this.Ln=[{qn:1,Vt:t}]}Zn(t){this.Xn(),this.Ln.push({qn:5,Vt:t})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(t){this.Un(),this.Ln.push({qn:2,Vt:t})}Jn(t){this.Un(),this.Ln.push({qn:3,Vt:t})}Qn(){return this.Ln}ts(t){for(const e of t.Ln)this.ns(e);this.En=Math.max(this.En,t.En),t.zn.forEach((e,s)=>{this.Nn(s,e)})}static ss(){return new ot(2)}static es(){return new ot(3)}ns(t){switch(t.qn){case 0:this.$n();break;case 1:this.Yn(t.Vt);break;case 2:this.Gn(t.Vt);break;case 3:this.Jn(t.Vt);break;case 4:this.Kn();break;case 5:this.Zn(t.Vt);break;case 6:this.Xn()}}Xn(){const t=this.Ln.findIndex(e=>e.qn===5);t!==-1&&this.Ln.splice(t,1)}}const Cn=".";function Ot(i,t){if(!kt(i))return"n/a";if(!_e(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?i.toString():("0000000000000000"+i.toString()).slice(-t)}class _s{constructor(t,e){if(e||(e=1),kt(t)&&_e(t)||(t=100),t<0)throw new TypeError("invalid base");this.Li=t,this.rs=e,this.hs()}format(t){const e=t<0?"":"";return t=Math.abs(t),e+this.ls(t)}hs(){if(this.os=0,this.Li>0&&this.rs>0){let t=this.Li;for(;t>1;)t/=10,this.os++}}ls(t){const e=this.Li/this.rs;let s=Math.floor(t),n="";const r=this.os!==void 0?this.os:NaN;if(e>1){let o=+(Math.round(t*e)-s*e).toFixed(this.os);o>=e&&(o-=e,s+=1),n=Cn+Ot(+o.toFixed(this.os)*this.rs,r)}else s=Math.round(s*e)/e,r>0&&(n=Cn+Ot(0,r));return s.toFixed(0)+n}}class vo extends _s{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class vc{constructor(t){this._s=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.us(t):t<999995?e+this.us(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.us(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.us(t/1e9)+"B")}us(t){let e;const s=Math.pow(10,this._s);return e=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this._s).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(n,r)=>r)}}function go(i,t,e,s,n,r,o){if(t.length===0||s.from>=t.length||s.to<=0)return;const{context:l,horizontalPixelRatio:h,verticalPixelRatio:c}=i,u=t[s.from];let d=r(i,u),f=u;if(s.to-s.from<2){const b=n/2;l.beginPath();const m={nt:u.nt-b,st:u.st},p={nt:u.nt+b,st:u.st};l.moveTo(m.nt*h,m.st*c),l.lineTo(p.nt*h,p.st*c),o(i,d,m,p)}else{const b=(p,x)=>{o(i,d,f,x),l.beginPath(),d=p,f=x};let m=f;l.beginPath(),l.moveTo(u.nt*h,u.st*c);for(let p=s.from+1;p<s.to;++p){m=t[p];const x=r(i,m);switch(e){case 0:l.lineTo(m.nt*h,m.st*c);break;case 1:l.lineTo(m.nt*h,t[p-1].st*c),x!==d&&(b(x,m),l.lineTo(m.nt*h,t[p-1].st*c)),l.lineTo(m.nt*h,m.st*c);break;case 2:{const[w,_]=gc(t,p-1,p);l.bezierCurveTo(w.nt*h,w.st*c,_.nt*h,_.st*c,m.nt*h,m.st*c);break}}e!==1&&x!==d&&(b(x,m),l.moveTo(m.nt*h,m.st*c))}(f!==m||f===m&&e===1)&&o(i,d,f,m)}}const kn=6;function Ps(i,t){return{nt:i.nt-t.nt,st:i.st-t.st}}function Mn(i,t){return{nt:i.nt/t,st:i.st/t}}function gc(i,t,e){const s=Math.max(0,t-1),n=Math.min(i.length-1,e+1);var r,o;return[(r=i[t],o=Mn(Ps(i[e],i[s]),kn),{nt:r.nt+o.nt,st:r.st+o.st}),Ps(i[e],Mn(Ps(i[n],i[t]),kn))]}function xc(i,t,e,s,n){const{context:r,horizontalPixelRatio:o,verticalPixelRatio:l}=t;r.lineTo(n.nt*o,i*l),r.lineTo(s.nt*o,i*l),r.closePath(),r.fillStyle=e,r.fill()}class xo extends wt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){var e;if(this.G===null)return;const{it:s,tt:n,cs:r,et:o,Nt:l,ds:h}=this.G,c=(e=this.G.fs)!==null&&e!==void 0?e:this.G.vs?0:t.mediaSize.height;if(n===null)return;const u=t.context;u.lineCap="butt",u.lineJoin="round",u.lineWidth=o,Jt(u,l),u.lineWidth=1,go(t,s,h,n,r,this.ps.bind(this),xc.bind(null,c))}}function hi(i,t,e){return Math.min(Math.max(i,t),e)}function Be(i,t,e){return t-i<=e}function yo(i){const t=Math.ceil(i);return t%2==0?t-1:t}class Li{bs(t,e){const s=this.ws,{gs:n,Ms:r,xs:o,Ss:l,ks:h,fs:c}=e;if(this.ys===void 0||s===void 0||s.gs!==n||s.Ms!==r||s.xs!==o||s.Ss!==l||s.fs!==c||s.ks!==h){const u=t.context.createLinearGradient(0,0,0,h);if(u.addColorStop(0,n),c!=null){const d=hi(c*t.verticalPixelRatio/h,0,1);u.addColorStop(d,r),u.addColorStop(d,o)}u.addColorStop(1,l),this.ys=u,this.ws=e}return this.ys}}class yc extends xo{constructor(){super(...arguments),this.Cs=new Li}ps(t,e){return this.Cs.bs(t,{gs:e.Ts,Ms:"",xs:"",Ss:e.Ps,ks:t.bitmapSize.height})}}function wc(i,t){const e=i.context;e.strokeStyle=t,e.stroke()}class wo extends wt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){if(this.G===null)return;const{it:e,tt:s,cs:n,ds:r,et:o,Nt:l,Rs:h}=this.G;if(s===null)return;const c=t.context;c.lineCap="butt",c.lineWidth=o*t.verticalPixelRatio,Jt(c,l),c.lineJoin="round";const u=this.Ds.bind(this);r!==void 0&&go(t,e,r,s,n,u,wc),h&&function(d,f,b,m,p){const{horizontalPixelRatio:x,verticalPixelRatio:w,context:_}=d;let N=null;const g=Math.max(1,Math.floor(x))%2/2,j=b*w+g;for(let k=m.to-1;k>=m.from;--k){const S=f[k];if(S){const T=p(d,S);T!==N&&(_.beginPath(),N!==null&&_.fill(),_.fillStyle=T,N=T);const B=Math.round(S.nt*x)+g,P=S.st*w;_.moveTo(B,P),_.arc(B,P,j,0,2*Math.PI)}}_.fill()}(t,e,h,s,u)}}class So extends wo{Ds(t,e){return e.lt}}function No(i,t,e,s,n=0,r=t.length){let o=r-n;for(;0<o;){const l=o>>1,h=n+l;s(t[h],e)===i?(n=h+1,o-=l+1):o=l}return n}const ze=No.bind(null,!0),jo=No.bind(null,!1);function Sc(i,t){return i.ot<t}function Nc(i,t){return t<i.ot}function _o(i,t,e){const s=t.Vs(),n=t.ui(),r=ze(i,s,Sc),o=jo(i,n,Nc);if(!e)return{from:r,to:o};let l=r,h=o;return r>0&&r<i.length&&i[r].ot>=s&&(l=r-1),o>0&&o<i.length&&i[o-1].ot<=n&&(h=o+1),{from:l,to:h}}class Ri{constructor(t,e,s){this.Os=!0,this.Bs=!0,this.As=!0,this.Is=[],this.zs=null,this.Ls=t,this.Es=e,this.Ns=s}bt(t){this.Os=!0,t==="data"&&(this.Bs=!0),t==="options"&&(this.As=!0)}gt(){return this.Ls.yt()?(this.Fs(),this.zs===null?null:this.Ws):null}js(){this.Is=this.Is.map(t=>Object.assign(Object.assign({},t),this.Ls.$s().Hs(t.ot)))}Us(){this.zs=null}Fs(){this.Bs&&(this.qs(),this.Bs=!1),this.As&&(this.js(),this.As=!1),this.Os&&(this.Ys(),this.Os=!1)}Ys(){const t=this.Ls.Dt(),e=this.Es.St();if(this.Us(),e.Ni()||t.Ni())return;const s=e.Zs();if(s===null||this.Ls.In().Xs()===0)return;const n=this.Ls.Ct();n!==null&&(this.zs=_o(this.Is,s,this.Ns),this.Ks(t,e,n.Vt),this.Gs())}}class Cs extends Ri{constructor(t,e){super(t,e,!0)}Ks(t,e,s){e.Js(this.Is,Ce(this.zs)),t.Qs(this.Is,s,Ce(this.zs))}te(t,e){return{ot:t,_t:e,nt:NaN,st:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>{const s=e.Vt[3];return this.ne(e.se,s,t)})}}class jc extends Cs{constructor(t,e){super(t,e),this.Ws=new Mi,this.ee=new yc,this.re=new So,this.Ws.Z([this.ee,this.re])}ne(t,e,s){return Object.assign(Object.assign({},this.te(t,e)),s.Hs(t))}Gs(){const t=this.Ls.W();this.ee.J({ds:t.lineType,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,fs:null,vs:t.invertFilledArea,tt:this.zs,cs:this.Es.St().he()}),this.re.J({ds:t.lineVisible?t.lineType:void 0,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,tt:this.zs,cs:this.Es.St().he(),Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}class _c extends wt{constructor(){super(...arguments),this.zt=null,this.le=0,this.ae=0}J(t){this.zt=t}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;this.le=this.oe(e),this.le>=2&&Math.max(1,Math.floor(e))%2!=this.le%2&&this.le--,this.ae=this.zt._e?Math.min(this.le,Math.floor(e)):this.le;let n=null;const r=this.ae<=this.le&&this.zt.he>=Math.floor(1.5*e);for(let o=this.zt.tt.from;o<this.zt.tt.to;++o){const l=this.zt.In[o];n!==l.ue&&(t.fillStyle=l.ue,n=l.ue);const h=Math.floor(.5*this.ae),c=Math.round(l.nt*e),u=c-h,d=this.ae,f=u+d-1,b=Math.min(l.ce,l.de),m=Math.max(l.ce,l.de),p=Math.round(b*s)-h,x=Math.round(m*s)+h,w=Math.max(x-p,this.ae);t.fillRect(u,p,d,w);const _=Math.ceil(1.5*this.le);if(r){if(this.zt.fe){const k=c-_;let S=Math.max(p,Math.round(l.ve*s)-h),T=S+d-1;T>p+w-1&&(T=p+w-1,S=T-d+1),t.fillRect(k,S,u-k,T-S+1)}const N=c+_;let g=Math.max(p,Math.round(l.pe*s)-h),j=g+d-1;j>p+w-1&&(j=p+w-1,g=j-d+1),t.fillRect(f+1,g,N-f,j-g+1)}}}oe(t){const e=Math.floor(t);return Math.max(e,Math.floor(function(s,n){return Math.floor(.3*s*n)}(C(this.zt).he,t)))}}class Co extends Ri{constructor(t,e){super(t,e,!1)}Ks(t,e,s){e.Js(this.Is,Ce(this.zs)),t.me(this.Is,s,Ce(this.zs))}be(t,e,s){return{ot:t,we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3],nt:NaN,ve:NaN,ce:NaN,de:NaN,pe:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>this.ne(e.se,e,t))}}class Cc extends Co{constructor(){super(...arguments),this.Ws=new _c}ne(t,e,s){return Object.assign(Object.assign({},this.be(t,e,s)),s.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),fe:t.openVisible,_e:t.thinBars,tt:this.zs})}}class kc extends xo{constructor(){super(...arguments),this.Cs=new Li}ps(t,e){const s=this.G;return this.Cs.bs(t,{gs:e.Se,Ms:e.ke,xs:e.ye,Ss:e.Ce,ks:t.bitmapSize.height,fs:s.fs})}}class Mc extends wo{constructor(){super(...arguments),this.Te=new Li}Ds(t,e){const s=this.G;return this.Te.bs(t,{gs:e.Pe,Ms:e.Pe,xs:e.Re,Ss:e.Re,ks:t.bitmapSize.height,fs:s.fs})}}class Ec extends Cs{constructor(t,e){super(t,e),this.Ws=new Mi,this.De=new kc,this.Ve=new Mc,this.Ws.Z([this.De,this.Ve])}ne(t,e,s){return Object.assign(Object.assign({},this.te(t,e)),s.Hs(t))}Gs(){const t=this.Ls.Ct();if(t===null)return;const e=this.Ls.W(),s=this.Ls.Dt().Rt(e.baseValue.price,t.Vt),n=this.Es.St().he();this.De.J({it:this.Is,et:e.lineWidth,Nt:e.lineStyle,ds:e.lineType,fs:s,vs:!1,tt:this.zs,cs:n}),this.Ve.J({it:this.Is,et:e.lineWidth,Nt:e.lineStyle,ds:e.lineVisible?e.lineType:void 0,Rs:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,fs:s,tt:this.zs,cs:n})}}class Lc extends wt{constructor(){super(...arguments),this.zt=null,this.le=0}J(t){this.zt=t}K(t){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;const{horizontalPixelRatio:e}=t;this.le=function(r,o){if(r>=2.5&&r<=4)return Math.floor(3*o);const l=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),h=Math.floor(r*l*o),c=Math.floor(r*o),u=Math.min(h,c);return Math.max(Math.floor(o),u)}(this.zt.he,e),this.le>=2&&Math.floor(e)%2!=this.le%2&&this.le--;const s=this.zt.In;this.zt.Oe&&this.Be(t,s,this.zt.tt),this.zt._i&&this.Ae(t,s,this.zt.tt);const n=this.Ie(e);(!this.zt._i||this.le>2*n)&&this.ze(t,s,this.zt.tt)}Be(t,e,s){if(this.zt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="",h=Math.min(Math.floor(r),Math.floor(this.zt.he*r));h=Math.max(Math.floor(r),Math.min(h,this.le));const c=Math.floor(.5*h);let u=null;for(let d=s.from;d<s.to;d++){const f=e[d];f.Le!==l&&(n.fillStyle=f.Le,l=f.Le);const b=Math.round(Math.min(f.ve,f.pe)*o),m=Math.round(Math.max(f.ve,f.pe)*o),p=Math.round(f.ce*o),x=Math.round(f.de*o);let w=Math.round(r*f.nt)-c;const _=w+h-1;u!==null&&(w=Math.max(u+1,w),w=Math.min(w,_));const N=_-w+1;n.fillRect(w,p,N,b-p),n.fillRect(w,m+1,N,x-m),u=_}}Ie(t){let e=Math.floor(1*t);this.le<=2*e&&(e=Math.floor(.5*(this.le-1)));const s=Math.max(Math.floor(t),e);return this.le<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Ae(t,e,s){if(this.zt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.Ie(r);let c=null;for(let u=s.from;u<s.to;u++){const d=e[u];d.Ee!==l&&(n.fillStyle=d.Ee,l=d.Ee);let f=Math.round(d.nt*r)-Math.floor(.5*this.le);const b=f+this.le-1,m=Math.round(Math.min(d.ve,d.pe)*o),p=Math.round(Math.max(d.ve,d.pe)*o);if(c!==null&&(f=Math.max(c+1,f),f=Math.min(f,b)),this.zt.he*r>2*h)dc(n,f,m,b-f+1,p-m+1,h);else{const x=b-f+1;n.fillRect(f,m,x,p-m+1)}c=b}}ze(t,e,s){if(this.zt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.Ie(r);for(let c=s.from;c<s.to;c++){const u=e[c];let d=Math.round(Math.min(u.ve,u.pe)*o),f=Math.round(Math.max(u.ve,u.pe)*o),b=Math.round(u.nt*r)-Math.floor(.5*this.le),m=b+this.le-1;if(u.ue!==l){const p=u.ue;n.fillStyle=p,l=p}this.zt._i&&(b+=h,d+=h,m-=h,f-=h),d>f||n.fillRect(b,d,m-b+1,f-d+1)}}}class Rc extends Co{constructor(){super(...arguments),this.Ws=new Lc}ne(t,e,s){return Object.assign(Object.assign({},this.be(t,e,s)),s.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),Oe:t.wickVisible,_i:t.borderVisible,tt:this.zs})}}class Pc{constructor(t,e){this.Ne=t,this.Li=e}X(t,e,s){this.Ne.draw(t,this.Li,e,s)}}class Os extends Ri{constructor(t,e,s){super(t,e,!1),this.wn=s,this.Ws=new Pc(this.wn.renderer(),n=>{const r=t.Ct();return r===null?null:t.Dt().Rt(n,r.Vt)})}Fe(t){return this.wn.priceValueBuilder(t)}We(t){return this.wn.isWhitespace(t)}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>Object.assign(Object.assign({ot:e.se,nt:NaN},t.Hs(e.se)),{je:e.He}))}Ks(t,e){e.Js(this.Is,Ce(this.zs))}Gs(){this.wn.update({bars:this.Is.map(Oc),barSpacing:this.Es.St().he(),visibleRange:this.zs},this.Ls.W())}}function Oc(i){return{x:i.nt,time:i.ot,originalData:i.je,barColor:i.ue}}class Tc extends wt{constructor(){super(...arguments),this.zt=null,this.$e=[]}J(t){this.zt=t,this.$e=[]}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return;this.$e.length||this.Ue(e);const n=Math.max(1,Math.floor(s)),r=Math.round(this.zt.qe*s)-Math.floor(n/2),o=r+n;for(let l=this.zt.tt.from;l<this.zt.tt.to;l++){const h=this.zt.it[l],c=this.$e[l-this.zt.tt.from],u=Math.round(h.st*s);let d,f;t.fillStyle=h.ue,u<=r?(d=u,f=o):(d=r,f=u-Math.floor(n/2)+n),t.fillRect(c.Vs,d,c.ui-c.Vs+1,f-d)}}Ue(t){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return void(this.$e=[]);const e=Math.ceil(this.zt.he*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.zt.he*t)-e;this.$e=new Array(this.zt.tt.to-this.zt.tt.from);for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.zt.it[r],l=Math.round(o.nt*t);let h,c;if(s%2){const u=(s-1)/2;h=l-u,c=l+u}else{const u=s/2;h=l-u,c=l+u-1}this.$e[r-this.zt.tt.from]={Vs:h,ui:c,Ye:l,Ze:o.nt*t,ot:o.ot}}for(let r=this.zt.tt.from+1;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from],l=this.$e[r-this.zt.tt.from-1];o.ot===l.ot+1&&o.Vs-l.ui!==e+1&&(l.Ye>l.Ze?l.ui=o.Vs-e-1:o.Vs=l.ui+e+1)}let n=Math.ceil(this.zt.he*t);for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from];o.ui<o.Vs&&(o.ui=o.Vs);const l=o.ui-o.Vs+1;n=Math.min(l,n)}if(e>0&&n<4)for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from];o.ui-o.Vs+1>n&&(o.Ye>o.Ze?o.ui-=1:o.Vs+=1)}}}class Fc extends Cs{constructor(){super(...arguments),this.Ws=new Tc}ne(t,e,s){return Object.assign(Object.assign({},this.te(t,e)),s.Hs(t))}Gs(){const t={it:this.Is,he:this.Es.St().he(),tt:this.zs,qe:this.Ls.Dt().Rt(this.Ls.W().base,C(this.Ls.Ct()).Vt)};this.Ws.J(t)}}class zc extends Cs{constructor(){super(...arguments),this.Ws=new So}ne(t,e,s){return Object.assign(Object.assign({},this.te(t,e)),s.Hs(t))}Gs(){const t=this.Ls.W(),e={it:this.Is,Nt:t.lineStyle,ds:t.lineVisible?t.lineType:void 0,et:t.lineWidth,Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,tt:this.zs,cs:this.Es.St().he()};this.Ws.J(e)}}const $c=/[2-9]/g;class ke{constructor(t=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Je={},this.Qe=new Map,this.tr=t}ir(){this.Xe=0,this.Qe.clear(),this.Ke=1,this.Ge=1,this.Je={}}xi(t,e,s){return this.nr(t,e,s).width}Mi(t,e,s){const n=this.nr(t,e,s);return((n.actualBoundingBoxAscent||0)-(n.actualBoundingBoxDescent||0))/2}nr(t,e,s){const n=s||$c,r=String(e).replace(n,"0");if(this.Qe.has(r))return ut(this.Qe.get(r)).sr;if(this.Xe===this.tr){const l=this.Je[this.Ge];delete this.Je[this.Ge],this.Qe.delete(l),this.Ge++,this.Xe--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Qe.set(r,{sr:o,er:this.Ke}),this.Je[this.Ke]=r,this.Xe++,this.Ke++),o}}class Ac{constructor(t){this.rr=null,this.k=null,this.hr="right",this.lr=t}ar(t,e,s){this.rr=t,this.k=e,this.hr=s}X(t){this.k!==null&&this.rr!==null&&this.rr.X(t,this.k,this.lr,this.hr)}}class ko{constructor(t,e,s){this._r=t,this.lr=new ke(50),this.ur=e,this.F=s,this.j=-1,this.Wt=new Ac(this.lr)}gt(){const t=this.F.cr(this.ur);if(t===null)return null;const e=t.dr(this.ur)?t.vr():this.ur.Dt();if(e===null)return null;const s=t.pr(e);if(s==="overlay")return null;const n=this.F.mr();return n.P!==this.j&&(this.j=n.P,this.lr.ir()),this.Wt.ar(this._r.Ii(),n,s),this.Wt}}class Dc extends wt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}br(t,e){var s;if(!(!((s=this.zt)===null||s===void 0)&&s.yt))return null;const{st:n,et:r,wr:o}=this.zt;return e>=n-r-7&&e<=n+r+7?{gr:this.zt,wr:o}:null}K({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.zt===null||this.zt.yt===!1)return;const r=Math.round(this.zt.st*n);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.zt.V,t.lineWidth=Math.floor(this.zt.et*s),Jt(t,this.zt.Nt),uo(t,r,0,e.width))}}class Pi{constructor(t){this.Mr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.Sr=new Dc,this.ft=!0,this.Ls=t,this.Es=t.$t(),this.Sr.J(this.Mr)}bt(){this.ft=!0}gt(){return this.Ls.yt()?(this.ft&&(this.kr(),this.ft=!1),this.Sr):null}}class Ic extends Pi{constructor(t){super(t)}kr(){this.Mr.yt=!1;const t=this.Ls.Dt(),e=t.yr().yr;if(e!==2&&e!==3)return;const s=this.Ls.W();if(!s.baseLineVisible||!this.Ls.yt())return;const n=this.Ls.Ct();n!==null&&(this.Mr.yt=!0,this.Mr.st=t.Rt(n.Vt,n.Vt),this.Mr.V=s.baseLineColor,this.Mr.et=s.baseLineWidth,this.Mr.Nt=s.baseLineStyle)}}class Vc extends wt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}He(){return this.zt}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:s}){const n=this.zt;if(n===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,l=Math.round(n.Ze.x*e)+o,h=n.Ze.y*s;t.fillStyle=n.Cr,t.beginPath();const c=Math.max(2,1.5*n.Tr)*e;t.arc(l,h,c,0,2*Math.PI,!1),t.fill(),t.fillStyle=n.Pr,t.beginPath(),t.arc(l,h,n.ht*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=n.Rr,t.beginPath(),t.arc(l,h,n.ht*e+r/2,0,2*Math.PI,!1),t.stroke()}}const Bc=[{Dr:0,Vr:.25,Or:4,Br:10,Ar:.25,Ir:0,zr:.4,Lr:.8},{Dr:.25,Vr:.525,Or:10,Br:14,Ar:0,Ir:0,zr:.8,Lr:0},{Dr:.525,Vr:1,Or:14,Br:14,Ar:0,Ir:0,zr:0,Lr:0}];function En(i,t,e,s){return function(n,r){if(n==="transparent")return n;const o=je(n),l=o[3];return`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${r*l})`}(i,e+(s-e)*t)}function Ln(i,t){const e=i%2600/2600;let s;for(const h of Bc)if(e>=h.Dr&&e<=h.Vr){s=h;break}At(s!==void 0,"Last price animation internal logic error");const n=(e-s.Dr)/(s.Vr-s.Dr);return{Pr:En(t,n,s.Ar,s.Ir),Rr:En(t,n,s.zr,s.Lr),ht:(r=n,o=s.Or,l=s.Br,o+(l-o)*r)};var r,o,l}class Uc{constructor(t){this.Wt=new Vc,this.ft=!0,this.Er=!0,this.Nr=performance.now(),this.Fr=this.Nr-1,this.Wr=t}jr(){this.Fr=this.Nr-1,this.bt()}Hr(){if(this.bt(),this.Wr.W().lastPriceAnimation===2){const t=performance.now(),e=this.Fr-t;if(e>0)return void(e<650&&(this.Fr+=2600));this.Nr=t,this.Fr=t+2600}}bt(){this.ft=!0}$r(){this.Er=!0}yt(){return this.Wr.W().lastPriceAnimation!==0}Ur(){switch(this.Wr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Fr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Er=!1):this.Er&&(this.qr(),this.Er=!1),this.Wt}Mt(){this.Wt.J(null);const t=this.Wr.$t().St(),e=t.Zs(),s=this.Wr.Ct();if(e===null||s===null)return;const n=this.Wr.Yr(!0);if(n.Zr||!e.Xr(n.se))return;const r={x:t.It(n.se),y:this.Wr.Dt().Rt(n._t,s.Vt)},o=n.V,l=this.Wr.W().lineWidth,h=Ln(this.Kr(),o);this.Wt.J({Cr:o,Tr:l,Pr:h.Pr,Rr:h.Rr,ht:h.ht,Ze:r})}qr(){const t=this.Wt.He();if(t!==null){const e=Ln(this.Kr(),t.Cr);t.Pr=e.Pr,t.Rr=e.Rr,t.ht=e.ht}}Kr(){return this.Ur()?performance.now()-this.Nr:2599}}function ye(i,t){return yo(Math.min(Math.max(i,12),30)*t)}function Me(i,t){switch(i){case"arrowDown":case"arrowUp":return ye(t,1);case"circle":return ye(t,.8);case"square":return ye(t,.7)}}function Mo(i){return function(t){const e=Math.ceil(t);return e%2!=0?e-1:e}(ye(i,1))}function Rn(i){return Math.max(ye(i,.1),3)}function Pn(i,t,e){return t?i:e?Math.ceil(i/2):0}function Eo(i,t,e,s,n){const r=Me("square",e),o=(r-1)/2,l=i-o,h=t-o;return s>=l&&s<=l+r&&n>=h&&n<=h+r}function On(i,t,e,s){const n=(Me("arrowUp",s)-1)/2*e.Gr,r=(yo(s/2)-1)/2*e.Gr;t.beginPath(),i?(t.moveTo(e.nt-n,e.st),t.lineTo(e.nt,e.st-n),t.lineTo(e.nt+n,e.st),t.lineTo(e.nt+r,e.st),t.lineTo(e.nt+r,e.st+n),t.lineTo(e.nt-r,e.st+n),t.lineTo(e.nt-r,e.st)):(t.moveTo(e.nt-n,e.st),t.lineTo(e.nt,e.st+n),t.lineTo(e.nt+n,e.st),t.lineTo(e.nt+r,e.st),t.lineTo(e.nt+r,e.st-n),t.lineTo(e.nt-r,e.st-n),t.lineTo(e.nt-r,e.st)),t.fill()}function Wc(i,t,e,s,n,r){return Eo(t,e,s,n,r)}class qc extends wt{constructor(){super(...arguments),this.zt=null,this.lr=new ke,this.j=-1,this.H="",this.Jr=""}J(t){this.zt=t}ar(t,e){this.j===t&&this.H===e||(this.j=t,this.H=e,this.Jr=le(t,e),this.lr.ir())}br(t,e){if(this.zt===null||this.zt.tt===null)return null;for(let s=this.zt.tt.from;s<this.zt.tt.to;s++){const n=this.zt.it[s];if(Kc(n,t,e))return{gr:n.Qr,wr:n.wr}}return null}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:s},n,r){if(this.zt!==null&&this.zt.tt!==null){t.textBaseline="middle",t.font=this.Jr;for(let o=this.zt.tt.from;o<this.zt.tt.to;o++){const l=this.zt.it[o];l.Kt!==void 0&&(l.Kt.Hi=this.lr.xi(t,l.Kt.th),l.Kt.At=this.j,l.Kt.nt=l.nt-l.Kt.Hi/2),Qc(l,t,e,s)}}}}function Qc(i,t,e,s){t.fillStyle=i.V,i.Kt!==void 0&&function(n,r,o,l,h,c){n.save(),n.scale(h,c),n.fillText(r,o,l),n.restore()}(t,i.Kt.th,i.Kt.nt,i.Kt.st,e,s),function(n,r,o){if(n.Xs!==0){switch(n.ih){case"arrowDown":return void On(!1,r,o,n.Xs);case"arrowUp":return void On(!0,r,o,n.Xs);case"circle":return void function(l,h,c){const u=(Me("circle",c)-1)/2;l.beginPath(),l.arc(h.nt,h.st,u*h.Gr,0,2*Math.PI,!1),l.fill()}(r,o,n.Xs);case"square":return void function(l,h,c){const u=Me("square",c),d=(u-1)*h.Gr/2,f=h.nt-d,b=h.st-d;l.fillRect(f,b,u*h.Gr,u*h.Gr)}(r,o,n.Xs)}n.ih}}(i,t,function(n,r,o){const l=Math.max(1,Math.floor(r))%2/2;return{nt:Math.round(n.nt*r)+l,st:n.st*o,Gr:r}}(i,e,s))}function Kc(i,t,e){return!(i.Kt===void 0||!function(s,n,r,o,l,h){const c=o/2;return l>=s&&l<=s+r&&h>=n-c&&h<=n+c}(i.Kt.nt,i.Kt.st,i.Kt.Hi,i.Kt.At,t,e))||function(s,n,r){if(s.Xs===0)return!1;switch(s.ih){case"arrowDown":case"arrowUp":return Wc(0,s.nt,s.st,s.Xs,n,r);case"circle":return function(o,l,h,c,u){const d=2+Me("circle",h)/2,f=o-c,b=l-u;return Math.sqrt(f*f+b*b)<=d}(s.nt,s.st,s.Xs,n,r);case"square":return Eo(s.nt,s.st,s.Xs,n,r)}}(i,t,e)}function Hc(i,t,e,s,n,r,o,l,h){const c=kt(e)?e:e.xe,u=kt(e)?e:e.ge,d=kt(e)?e:e.Me,f=kt(t.size)?Math.max(t.size,0):1,b=Mo(l.he())*f,m=b/2;switch(i.Xs=b,t.position){case"inBar":return i.st=o.Rt(c,h),void(i.Kt!==void 0&&(i.Kt.st=i.st+m+r+.6*n));case"aboveBar":return i.st=o.Rt(u,h)-m-s.nh,i.Kt!==void 0&&(i.Kt.st=i.st-m-.6*n,s.nh+=1.2*n),void(s.nh+=b+r);case"belowBar":return i.st=o.Rt(d,h)+m+s.sh,i.Kt!==void 0&&(i.Kt.st=i.st+m+r+.6*n,s.sh+=1.2*n),void(s.sh+=b+r)}t.position}class Jc{constructor(t,e){this.ft=!0,this.eh=!0,this.rh=!0,this.hh=null,this.ah=null,this.Wt=new qc,this.Wr=t,this.$i=e,this.zt={it:[],tt:null}}bt(t){this.ft=!0,this.rh=!0,t==="data"&&(this.eh=!0,this.ah=null)}gt(t){if(!this.Wr.yt())return null;this.ft&&this.oh();const e=this.$i.W().layout;return this.Wt.ar(e.fontSize,e.fontFamily),this.Wt.J(this.zt),this.Wt}_h(){if(this.rh){if(this.Wr.uh().length>0){const t=this.$i.St().he(),e=Rn(t),s=1.5*Mo(t)+2*e,n=this.dh();this.hh={above:Pn(s,n.aboveBar,n.inBar),below:Pn(s,n.belowBar,n.inBar)}}else this.hh=null;this.rh=!1}return this.hh}dh(){return this.ah===null&&(this.ah=this.Wr.uh().reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1})),this.ah}oh(){const t=this.Wr.Dt(),e=this.$i.St(),s=this.Wr.uh();this.eh&&(this.zt.it=s.map(u=>({ot:u.time,nt:0,st:0,Xs:0,ih:u.shape,V:u.color,Qr:u.Qr,wr:u.id,Kt:void 0})),this.eh=!1);const n=this.$i.W().layout;this.zt.tt=null;const r=e.Zs();if(r===null)return;const o=this.Wr.Ct();if(o===null||this.zt.it.length===0)return;let l=NaN;const h=Rn(e.he()),c={nh:h,sh:h};this.zt.tt=_o(this.zt.it,r,!0);for(let u=this.zt.tt.from;u<this.zt.tt.to;u++){const d=s[u];d.time!==l&&(c.nh=h,c.sh=h,l=d.time);const f=this.zt.it[u];f.nt=e.It(d.time),d.text!==void 0&&d.text.length>0&&(f.Kt={th:d.text,nt:0,st:0,Hi:0,At:0});const b=this.Wr.fh(d.time);b!==null&&Hc(f,d,b,c,n.fontSize,h,t,e,o.Vt)}this.ft=!1}}class Xc extends Pi{constructor(t){super(t)}kr(){const t=this.Mr;t.yt=!1;const e=this.Ls.W();if(!e.priceLineVisible||!this.Ls.yt())return;const s=this.Ls.Yr(e.priceLineSource===0);s.Zr||(t.yt=!0,t.st=s.ki,t.V=this.Ls.ph(s.V),t.et=e.priceLineWidth,t.Nt=e.priceLineStyle)}}class Gc extends Ns{constructor(t){super(),this.jt=t}zi(t,e,s){t.yt=!1,e.yt=!1;const n=this.jt;if(!n.yt())return;const r=n.W(),o=r.lastValueVisible,l=n.mh()!=="",h=r.seriesLastValueMode===0,c=n.Yr(!1);if(c.Zr)return;o&&(t.Kt=this.bh(c,o,h),t.yt=t.Kt.length!==0),(l||h)&&(e.Kt=this.wh(c,o,l,h),e.yt=e.Kt.length>0);const u=n.ph(c.V),d=ws(u);s.t=d.t,s.ki=c.ki,e.Ot=n.$t().Bt(c.ki/n.Dt().At()),t.Ot=u,t.V=d.i,e.V=d.i}wh(t,e,s,n){let r="";const o=this.jt.mh();return s&&o.length!==0&&(r+=`${o} `),e&&n&&(r+=this.jt.Dt().gh()?t.Mh:t.xh),r.trim()}bh(t,e,s){return e?s?this.jt.Dt().gh()?t.xh:t.Mh:t.Kt:""}}function Tn(i,t,e,s){const n=Number.isFinite(t),r=Number.isFinite(e);return n&&r?i(t,e):n||r?n?t:e:s}class pt{constructor(t,e){this.Sh=t,this.kh=e}yh(t){return t!==null&&this.Sh===t.Sh&&this.kh===t.kh}Ch(){return new pt(this.Sh,this.kh)}Th(){return this.Sh}Ph(){return this.kh}Rh(){return this.kh-this.Sh}Ni(){return this.kh===this.Sh||Number.isNaN(this.kh)||Number.isNaN(this.Sh)}ts(t){return t===null?this:new pt(Tn(Math.min,this.Th(),t.Th(),-1/0),Tn(Math.max,this.Ph(),t.Ph(),1/0))}Dh(t){if(!kt(t)||this.kh-this.Sh===0)return;const e=.5*(this.kh+this.Sh);let s=this.kh-e,n=this.Sh-e;s*=t,n*=t,this.kh=e+s,this.Sh=e+n}Vh(t){kt(t)&&(this.kh+=t,this.Sh+=t)}Oh(){return{minValue:this.Sh,maxValue:this.kh}}static Bh(t){return t===null?null:new pt(t.minValue,t.maxValue)}}class us{constructor(t,e){this.Ah=t,this.Ih=e||null}zh(){return this.Ah}Lh(){return this.Ih}Oh(){return this.Ah===null?null:{priceRange:this.Ah.Oh(),margins:this.Ih||void 0}}static Bh(t){return t===null?null:new us(pt.Bh(t.priceRange),t.margins)}}class Zc extends Pi{constructor(t,e){super(t),this.Eh=e}kr(){const t=this.Mr;t.yt=!1;const e=this.Eh.W();if(!this.Ls.yt()||!e.lineVisible)return;const s=this.Eh.Nh();s!==null&&(t.yt=!0,t.st=s,t.V=e.color,t.et=e.lineWidth,t.Nt=e.lineStyle,t.wr=this.Eh.W().id)}}class Yc extends Ns{constructor(t,e){super(),this.Wr=t,this.Eh=e}zi(t,e,s){t.yt=!1,e.yt=!1;const n=this.Eh.W(),r=n.axisLabelVisible,o=n.title!=="",l=this.Wr;if(!r||!l.yt())return;const h=this.Eh.Nh();if(h===null)return;o&&(e.Kt=n.title,e.yt=!0),e.Ot=l.$t().Bt(h/l.Dt().At()),t.Kt=this.Fh(n.price),t.yt=!0;const c=ws(n.axisLabelColor||n.color);s.t=c.t;const u=n.axisLabelTextColor||c.i;t.V=u,e.V=u,s.ki=h}Fh(t){const e=this.Wr.Ct();return e===null?"":this.Wr.Dt().Fi(t,e.Vt)}}class tu{constructor(t,e){this.Wr=t,this.cn=e,this.Wh=new Zc(t,this),this._r=new Yc(t,this),this.jh=new ko(this._r,t,t.$t())}Hh(t){gt(this.cn,t),this.bt(),this.Wr.$t().$h()}W(){return this.cn}Uh(){return this.Wh}qh(){return this.jh}Yh(){return this._r}bt(){this.Wh.bt(),this._r.bt()}Nh(){const t=this.Wr,e=t.Dt();if(t.$t().St().Ni()||e.Ni())return null;const s=t.Ct();return s===null?null:e.Rt(this.cn.price,s.Vt)}}class eu extends Ei{constructor(t){super(),this.$i=t}$t(){return this.$i}}const su={Bar:(i,t,e,s)=>{var n;const r=t.upColor,o=t.downColor,l=C(i(e,s)),h=se(l.Vt[0])<=se(l.Vt[3]);return{ue:(n=l.V)!==null&&n!==void 0?n:h?r:o}},Candlestick:(i,t,e,s)=>{var n,r,o;const l=t.upColor,h=t.downColor,c=t.borderUpColor,u=t.borderDownColor,d=t.wickUpColor,f=t.wickDownColor,b=C(i(e,s)),m=se(b.Vt[0])<=se(b.Vt[3]);return{ue:(n=b.V)!==null&&n!==void 0?n:m?l:h,Ee:(r=b.Ot)!==null&&r!==void 0?r:m?c:u,Le:(o=b.Zh)!==null&&o!==void 0?o:m?d:f}},Custom:(i,t,e,s)=>{var n;return{ue:(n=C(i(e,s)).V)!==null&&n!==void 0?n:t.color}},Area:(i,t,e,s)=>{var n,r,o,l;const h=C(i(e,s));return{ue:(n=h.lt)!==null&&n!==void 0?n:t.lineColor,lt:(r=h.lt)!==null&&r!==void 0?r:t.lineColor,Ts:(o=h.Ts)!==null&&o!==void 0?o:t.topColor,Ps:(l=h.Ps)!==null&&l!==void 0?l:t.bottomColor}},Baseline:(i,t,e,s)=>{var n,r,o,l,h,c;const u=C(i(e,s));return{ue:u.Vt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,Pe:(n=u.Pe)!==null&&n!==void 0?n:t.topLineColor,Re:(r=u.Re)!==null&&r!==void 0?r:t.bottomLineColor,Se:(o=u.Se)!==null&&o!==void 0?o:t.topFillColor1,ke:(l=u.ke)!==null&&l!==void 0?l:t.topFillColor2,ye:(h=u.ye)!==null&&h!==void 0?h:t.bottomFillColor1,Ce:(c=u.Ce)!==null&&c!==void 0?c:t.bottomFillColor2}},Line:(i,t,e,s)=>{var n,r;const o=C(i(e,s));return{ue:(n=o.V)!==null&&n!==void 0?n:t.color,lt:(r=o.V)!==null&&r!==void 0?r:t.color}},Histogram:(i,t,e,s)=>{var n;return{ue:(n=C(i(e,s)).V)!==null&&n!==void 0?n:t.color}}};class iu{constructor(t){this.Xh=(e,s)=>s!==void 0?s.Vt:this.Wr.In().Kh(e),this.Wr=t,this.Gh=su[t.Jh()]}Hs(t,e){return this.Gh(this.Xh,this.Wr.W(),t,e)}}var Fn;(function(i){i[i.NearestLeft=-1]="NearestLeft",i[i.None=0]="None",i[i.NearestRight=1]="NearestRight"})(Fn||(Fn={}));const zt=30;class nu{constructor(){this.Qh=[],this.tl=new Map,this.il=new Map}nl(){return this.Xs()>0?this.Qh[this.Qh.length-1]:null}sl(){return this.Xs()>0?this.el(0):null}An(){return this.Xs()>0?this.el(this.Qh.length-1):null}Xs(){return this.Qh.length}Ni(){return this.Xs()===0}Xr(t){return this.rl(t,0)!==null}Kh(t){return this.hl(t)}hl(t,e=0){const s=this.rl(t,e);return s===null?null:Object.assign(Object.assign({},this.ll(s)),{se:this.el(s)})}ie(){return this.Qh}al(t,e,s){if(this.Ni())return null;let n=null;for(const r of s)n=Ue(n,this.ol(t,e,r));return n}J(t){this.il.clear(),this.tl.clear(),this.Qh=t}el(t){return this.Qh[t].se}ll(t){return this.Qh[t]}rl(t,e){const s=this._l(t);if(s===null&&e!==0)switch(e){case-1:return this.ul(t);case 1:return this.cl(t);default:throw new TypeError("Unknown search mode")}return s}ul(t){let e=this.dl(t);return e>0&&(e-=1),e!==this.Qh.length&&this.el(e)<t?e:null}cl(t){const e=this.fl(t);return e!==this.Qh.length&&t<this.el(e)?e:null}_l(t){const e=this.dl(t);return e===this.Qh.length||t<this.Qh[e].se?null:e}dl(t){return ze(this.Qh,t,(e,s)=>e.se<s)}fl(t){return jo(this.Qh,t,(e,s)=>e.se>s)}vl(t,e,s){let n=null;for(let r=t;r<e;r++){const o=this.Qh[r].Vt[s];Number.isNaN(o)||(n===null?n={pl:o,ml:o}:(o<n.pl&&(n.pl=o),o>n.ml&&(n.ml=o)))}return n}ol(t,e,s){if(this.Ni())return null;let n=null;const r=C(this.sl()),o=C(this.An()),l=Math.max(t,r),h=Math.min(e,o),c=Math.ceil(l/zt)*zt,u=Math.max(c,Math.floor(h/zt)*zt);{const f=this.dl(l),b=this.fl(Math.min(h,c,e));n=Ue(n,this.vl(f,b,s))}let d=this.tl.get(s);d===void 0&&(d=new Map,this.tl.set(s,d));for(let f=Math.max(c+1,l);f<u;f+=zt){const b=Math.floor(f/zt);let m=d.get(b);if(m===void 0){const p=this.dl(b*zt),x=this.fl((b+1)*zt-1);m=this.vl(p,x,s),d.set(b,m)}n=Ue(n,m)}{const f=this.dl(u),b=this.fl(h);n=Ue(n,this.vl(f,b,s))}return n}}function Ue(i,t){return i===null?t:t===null?i:{pl:Math.min(i.pl,t.pl),ml:Math.max(i.ml,t.ml)}}class ru{constructor(t){this.bl=t}X(t,e,s){this.bl.draw(t)}wl(t,e,s){var n,r;(r=(n=this.bl).drawBackground)===null||r===void 0||r.call(n,t)}}class Ts{constructor(t){this.Qe=null,this.wn=t}gt(){var t;const e=this.wn.renderer();if(e===null)return null;if(((t=this.Qe)===null||t===void 0?void 0:t.gl)===e)return this.Qe.Ml;const s=new ru(e);return this.Qe={gl:e,Ml:s},s}xl(){var t,e,s;return(s=(e=(t=this.wn).zOrder)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:"normal"}}function Lo(i){var t,e,s,n,r;return{Kt:i.text(),ki:i.coordinate(),Si:(t=i.fixedCoordinate)===null||t===void 0?void 0:t.call(i),V:i.textColor(),t:i.backColor(),yt:(s=(e=i.visible)===null||e===void 0?void 0:e.call(i))===null||s===void 0||s,hi:(r=(n=i.tickVisible)===null||n===void 0?void 0:n.call(i))===null||r===void 0||r}}class ou{constructor(t,e){this.Wt=new bo,this.Sl=t,this.kl=e}gt(){return this.Wt.J(Object.assign({Hi:this.kl.Hi()},Lo(this.Sl))),this.Wt}}class au extends Ns{constructor(t,e){super(),this.Sl=t,this.Li=e}zi(t,e,s){const n=Lo(this.Sl);s.t=n.t,t.V=n.V;const r=2/12*this.Li.P();s.wi=r,s.gi=r,s.ki=n.ki,s.Si=n.Si,t.Kt=n.Kt,t.yt=n.yt,t.hi=n.hi}}class lu{constructor(t,e){this.yl=null,this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=t,this.Wr=e}Vl(){return this.Dl}Vn(){var t,e;(e=(t=this.Dl).updateAllViews)===null||e===void 0||e.call(t)}Pn(){var t,e,s,n;const r=(s=(e=(t=this.Dl).paneViews)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:[];if(((n=this.yl)===null||n===void 0?void 0:n.gl)===r)return this.yl.Ml;const o=r.map(l=>new Ts(l));return this.yl={gl:r,Ml:o},o}Qi(){var t,e,s,n;const r=(s=(e=(t=this.Dl).timeAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:[];if(((n=this.Cl)===null||n===void 0?void 0:n.gl)===r)return this.Cl.Ml;const o=this.Wr.$t().St(),l=r.map(h=>new ou(h,o));return this.Cl={gl:r,Ml:l},l}Rn(){var t,e,s,n;const r=(s=(e=(t=this.Dl).priceAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:[];if(((n=this.Tl)===null||n===void 0?void 0:n.gl)===r)return this.Tl.Ml;const o=this.Wr.Dt(),l=r.map(h=>new au(h,o));return this.Tl={gl:r,Ml:l},l}Ol(){var t,e,s,n;const r=(s=(e=(t=this.Dl).priceAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:[];if(((n=this.Pl)===null||n===void 0?void 0:n.gl)===r)return this.Pl.Ml;const o=r.map(l=>new Ts(l));return this.Pl={gl:r,Ml:o},o}Bl(){var t,e,s,n;const r=(s=(e=(t=this.Dl).timeAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:[];if(((n=this.Rl)===null||n===void 0?void 0:n.gl)===r)return this.Rl.Ml;const o=r.map(l=>new Ts(l));return this.Rl={gl:r,Ml:o},o}Al(t,e){var s,n,r;return(r=(n=(s=this.Dl).autoscaleInfo)===null||n===void 0?void 0:n.call(s,t,e))!==null&&r!==void 0?r:null}br(t,e){var s,n,r;return(r=(n=(s=this.Dl).hitTest)===null||n===void 0?void 0:n.call(s,t,e))!==null&&r!==void 0?r:null}}function Fs(i,t,e,s){i.forEach(n=>{t(n).forEach(r=>{r.xl()===e&&s.push(r)})})}function zs(i){return i.Pn()}function hu(i){return i.Ol()}function cu(i){return i.Bl()}class Oi extends eu{constructor(t,e,s,n,r){super(t),this.zt=new nu,this.Wh=new Xc(this),this.Il=[],this.zl=new Ic(this),this.Ll=null,this.El=null,this.Nl=[],this.Fl=[],this.Wl=null,this.jl=[],this.cn=e,this.Hl=s;const o=new Gc(this);this.rn=[o],this.jh=new ko(o,this,t),s!=="Area"&&s!=="Line"&&s!=="Baseline"||(this.Ll=new Uc(this)),this.$l(),this.Ul(r)}S(){this.Wl!==null&&clearTimeout(this.Wl)}ph(t){return this.cn.priceLineColor||t}Yr(t){const e={Zr:!0},s=this.Dt();if(this.$t().St().Ni()||s.Ni()||this.zt.Ni())return e;const n=this.$t().St().Zs(),r=this.Ct();if(n===null||r===null)return e;let o,l;if(t){const d=this.zt.nl();if(d===null)return e;o=d,l=d.se}else{const d=this.zt.hl(n.ui(),-1);if(d===null||(o=this.zt.Kh(d.se),o===null))return e;l=d.se}const h=o.Vt[3],c=this.$s().Hs(l,{Vt:o}),u=s.Rt(h,r.Vt);return{Zr:!1,_t:h,Kt:s.Fi(h,r.Vt),Mh:s.ql(h),xh:s.Yl(h,r.Vt),V:c.ue,ki:u,se:l}}$s(){return this.El!==null||(this.El=new iu(this)),this.El}W(){return this.cn}Hh(t){const e=t.priceScaleId;e!==void 0&&e!==this.cn.priceScaleId&&this.$t().Zl(this,e),gt(this.cn,t),t.priceFormat!==void 0&&(this.$l(),this.$t().Xl()),this.$t().Kl(this),this.$t().Gl(),this.wn.bt("options")}J(t,e){this.zt.J(t),this.Jl(),this.wn.bt("data"),this.dn.bt("data"),this.Ll!==null&&(e&&e.Ql?this.Ll.Hr():t.length===0&&this.Ll.jr());const s=this.$t().cr(this);this.$t().ta(s),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}ia(t){this.Nl=t,this.Jl();const e=this.$t().cr(this);this.dn.bt("data"),this.$t().ta(e),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}na(){return this.Nl}uh(){return this.Fl}sa(t){const e=new tu(this,t);return this.Il.push(e),this.$t().Kl(this),e}ea(t){const e=this.Il.indexOf(t);e!==-1&&this.Il.splice(e,1),this.$t().Kl(this)}Jh(){return this.Hl}Ct(){const t=this.ra();return t===null?null:{Vt:t.Vt[3],ha:t.ot}}ra(){const t=this.$t().St().Zs();if(t===null)return null;const e=t.Vs();return this.zt.hl(e,1)}In(){return this.zt}fh(t){const e=this.zt.Kh(t);return e===null?null:this.Hl==="Bar"||this.Hl==="Candlestick"||this.Hl==="Custom"?{we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3]}:e.Vt[3]}la(t){const e=[];Fs(this.jl,zs,"top",e);const s=this.Ll;return s!==null&&s.yt()&&(this.Wl===null&&s.Ur()&&(this.Wl=setTimeout(()=>{this.Wl=null,this.$t().aa()},0)),s.$r(),e.unshift(s)),e}Pn(){const t=[];this.oa()||t.push(this.zl),t.push(this.wn,this.Wh,this.dn);const e=this.Il.map(s=>s.Uh());return t.push(...e),Fs(this.jl,zs,"normal",t),t}_a(){return this.ua(zs,"bottom")}ca(t){return this.ua(hu,t)}da(t){return this.ua(cu,t)}fa(t,e){return this.jl.map(s=>s.br(t,e)).filter(s=>s!==null)}Ji(t){return[this.jh,...this.Il.map(e=>e.qh())]}Rn(t,e){if(e!==this.Yi&&!this.oa())return[];const s=[...this.rn];for(const n of this.Il)s.push(n.Yh());return this.jl.forEach(n=>{s.push(...n.Rn())}),s}Qi(){const t=[];return this.jl.forEach(e=>{t.push(...e.Qi())}),t}Al(t,e){if(this.cn.autoscaleInfoProvider!==void 0){const s=this.cn.autoscaleInfoProvider(()=>{const n=this.va(t,e);return n===null?null:n.Oh()});return us.Bh(s)}return this.va(t,e)}pa(){return this.cn.priceFormat.minMove}ma(){return this.ba}Vn(){var t;this.wn.bt(),this.dn.bt();for(const e of this.rn)e.bt();for(const e of this.Il)e.bt();this.Wh.bt(),this.zl.bt(),(t=this.Ll)===null||t===void 0||t.bt(),this.jl.forEach(e=>e.Vn())}Dt(){return C(super.Dt())}kt(t){if(!((this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const e=this.zt.Kh(t);return e===null?null:{_t:e.Vt[3],ht:this.wa(),Ot:this.ga(),Pt:this.Ma(),Tt:this.xa(t)}}mh(){return this.cn.title}yt(){return this.cn.visible}Sa(t){this.jl.push(new lu(t,this))}ka(t){this.jl=this.jl.filter(e=>e.Vl()!==t)}ya(){if(this.wn instanceof Os)return t=>this.wn.Fe(t)}Ca(){if(this.wn instanceof Os)return t=>this.wn.We(t)}oa(){return!js(this.Dt().Ta())}va(t,e){if(!_e(t)||!_e(e)||this.zt.Ni())return null;const s=this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline"||this.Hl==="Histogram"?[3]:[2,1],n=this.zt.al(t,e,s);let r=n!==null?new pt(n.pl,n.ml):null;if(this.Jh()==="Histogram"){const l=this.cn.base,h=new pt(l,l);r=r!==null?r.ts(h):h}let o=this.dn._h();return this.jl.forEach(l=>{const h=l.Al(t,e);if(h!=null&&h.priceRange){const b=new pt(h.priceRange.minValue,h.priceRange.maxValue);r=r!==null?r.ts(b):b}var c,u,d,f;h!=null&&h.margins&&(c=o,u=h.margins,o={above:Math.max((d=c==null?void 0:c.above)!==null&&d!==void 0?d:0,u.above),below:Math.max((f=c==null?void 0:c.below)!==null&&f!==void 0?f:0,u.below)})}),new us(r,o)}wa(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}ga(){switch(this.Hl){case"Line":case"Area":case"Baseline":{const t=this.cn.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}Ma(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}xa(t){switch(this.Hl){case"Line":case"Area":case"Baseline":{const e=this.cn.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.$s().Hs(t).ue}$l(){switch(this.cn.priceFormat.type){case"custom":this.ba={format:this.cn.priceFormat.formatter};break;case"volume":this.ba=new vc(this.cn.priceFormat.precision);break;case"percent":this.ba=new vo(this.cn.priceFormat.precision);break;default:{const t=Math.pow(10,this.cn.priceFormat.precision);this.ba=new _s(t,this.cn.priceFormat.minMove*t)}}this.Yi!==null&&this.Yi.Pa()}Jl(){const t=this.$t().St();if(!t.Ra()||this.zt.Ni())return void(this.Fl=[]);const e=C(this.zt.sl());this.Fl=this.Nl.map((s,n)=>{const r=C(t.Da(s.time,!0)),o=r<e?1:-1;return{time:C(this.zt.hl(r,o)).se,position:s.position,shape:s.shape,color:s.color,id:s.id,Qr:n,text:s.text,size:s.size,originalTime:s.originalTime}})}Ul(t){switch(this.dn=new Jc(this,this.$t()),this.Hl){case"Bar":this.wn=new Cc(this,this.$t());break;case"Candlestick":this.wn=new Rc(this,this.$t());break;case"Line":this.wn=new zc(this,this.$t());break;case"Custom":this.wn=new Os(this,this.$t(),ut(t));break;case"Area":this.wn=new jc(this,this.$t());break;case"Baseline":this.wn=new Ec(this,this.$t());break;case"Histogram":this.wn=new Fc(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.Hl)}}ua(t,e){const s=[];return Fs(this.jl,t,e,s),s}}class uu{constructor(t){this.cn=t}Va(t,e,s){let n=t;if(this.cn.mode===0)return n;const r=s.vn(),o=r.Ct();if(o===null)return n;const l=r.Rt(t,o),h=s.Oa().filter(u=>u instanceof Oi).reduce((u,d)=>{if(s.dr(d)||!d.yt())return u;const f=d.Dt(),b=d.In();if(f.Ni()||!b.Xr(e))return u;const m=b.Kh(e);if(m===null)return u;const p=se(d.Ct());return u.concat([f.Rt(m.Vt[3],p.Vt)])},[]);if(h.length===0)return n;h.sort((u,d)=>Math.abs(u-l)-Math.abs(d-l));const c=h[0];return n=r.pn(c,o),n}}class du extends wt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}K({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(this.zt===null)return;const r=Math.max(1,Math.floor(s));t.lineWidth=r,function(o,l){o.save(),o.lineWidth%2&&o.translate(.5,.5),l(),o.restore()}(t,()=>{const o=C(this.zt);if(o.Ba){t.strokeStyle=o.Aa,Jt(t,o.Ia),t.beginPath();for(const l of o.za){const h=Math.round(l.La*s);t.moveTo(h,-r),t.lineTo(h,e.height+r)}t.stroke()}if(o.Ea){t.strokeStyle=o.Na,Jt(t,o.Fa),t.beginPath();for(const l of o.Wa){const h=Math.round(l.La*n);t.moveTo(-r,h),t.lineTo(e.width+r,h)}t.stroke()}})}}class fu{constructor(t){this.Wt=new du,this.ft=!0,this.tn=t}bt(){this.ft=!0}gt(){if(this.ft){const t=this.tn.$t().W().grid,e={Ea:t.horzLines.visible,Ba:t.vertLines.visible,Na:t.horzLines.color,Aa:t.vertLines.color,Fa:t.horzLines.style,Ia:t.vertLines.style,Wa:this.tn.vn().ja(),za:(this.tn.$t().St().ja()||[]).map(s=>({La:s.coord}))};this.Wt.J(e),this.ft=!1}return this.Wt}}class mu{constructor(t){this.wn=new fu(t)}Uh(){return this.wn}}const $s={Ha:4,$a:1e-4};function ie(i,t){const e=100*(i-t)/t;return t<0?-e:e}function pu(i,t){const e=ie(i.Th(),t),s=ie(i.Ph(),t);return new pt(e,s)}function we(i,t){const e=100*(i-t)/t+100;return t<0?-e:e}function bu(i,t){const e=we(i.Th(),t),s=we(i.Ph(),t);return new pt(e,s)}function ds(i,t){const e=Math.abs(i);if(e<1e-15)return 0;const s=Math.log10(e+t.$a)+t.Ha;return i<0?-s:s}function Se(i,t){const e=Math.abs(i);if(e<1e-15)return 0;const s=Math.pow(10,e-t.Ha)-t.$a;return i<0?-s:s}function ve(i,t){if(i===null)return null;const e=ds(i.Th(),t),s=ds(i.Ph(),t);return new pt(e,s)}function We(i,t){if(i===null)return null;const e=Se(i.Th(),t),s=Se(i.Ph(),t);return new pt(e,s)}function As(i){if(i===null)return $s;const t=Math.abs(i.Ph()-i.Th());if(t>=1||t<1e-15)return $s;const e=Math.ceil(Math.abs(Math.log10(t))),s=$s.Ha+e;return{Ha:s,$a:1/Math.pow(10,s)}}class Ds{constructor(t,e){if(this.Ua=t,this.qa=e,function(s){if(s<0)return!1;for(let n=s;n>1;n/=10)if(n%10!=0)return!1;return!0}(this.Ua))this.Ya=[2,2.5,2];else{this.Ya=[];for(let s=this.Ua;s!==1;){if(s%2==0)this.Ya.push(2),s/=2;else{if(s%5!=0)throw new Error("unexpected base");this.Ya.push(2,2.5),s/=5}if(this.Ya.length>100)throw new Error("something wrong with base")}}}Za(t,e,s){const n=this.Ua===0?0:1/this.Ua;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,l=this.qa[0];for(;;){const d=Be(r,n,1e-14)&&r>n+1e-14,f=Be(r,s*l,1e-14),b=Be(r,1,1e-14);if(!(d&&f&&b))break;r/=l,l=this.qa[++o%this.qa.length]}if(r<=n+1e-14&&(r=n),r=Math.max(1,r),this.Ya.length>0&&(h=r,c=1,u=1e-14,Math.abs(h-c)<u))for(o=0,l=this.Ya[0];Be(r,s*l,1e-14)&&r>n+1e-14;)r/=l,l=this.Ya[++o%this.Ya.length];var h,c,u;return r}}class zn{constructor(t,e,s,n){this.Xa=[],this.Li=t,this.Ua=e,this.Ka=s,this.Ga=n}Za(t,e){if(t<e)throw new Error("high < low");const s=this.Li.At(),n=(t-e)*this.Ja()/s,r=new Ds(this.Ua,[2,2.5,2]),o=new Ds(this.Ua,[2,2,2.5]),l=new Ds(this.Ua,[2.5,2,2]),h=[];return h.push(r.Za(t,e,n),o.Za(t,e,n),l.Za(t,e,n)),function(c){if(c.length<1)throw Error("array is empty");let u=c[0];for(let d=1;d<c.length;++d)c[d]<u&&(u=c[d]);return u}(h)}Qa(){const t=this.Li,e=t.Ct();if(e===null)return void(this.Xa=[]);const s=t.At(),n=this.Ka(s-1,e),r=this.Ka(0,e),o=this.Li.W().entireTextOnly?this.io()/2:0,l=o,h=s-1-o,c=Math.max(n,r),u=Math.min(n,r);if(c===u)return void(this.Xa=[]);let d=this.Za(c,u),f=c%d;f+=f<0?d:0;const b=c>=u?1:-1;let m=null,p=0;for(let x=c-f;x>u;x-=d){const w=this.Ga(x,e,!0);m!==null&&Math.abs(w-m)<this.Ja()||w<l||w>h||(p<this.Xa.length?(this.Xa[p].La=w,this.Xa[p].no=t.so(x)):this.Xa.push({La:w,no:t.so(x)}),p++,m=w,t.eo()&&(d=this.Za(x*b,u)))}this.Xa.length=p}ja(){return this.Xa}io(){return this.Li.P()}Ja(){return Math.ceil(2.5*this.io())}}function Ro(i){return i.slice().sort((t,e)=>C(t.Xi())-C(e.Xi()))}var $n;(function(i){i[i.Normal=0]="Normal",i[i.Logarithmic=1]="Logarithmic",i[i.Percentage=2]="Percentage",i[i.IndexedTo100=3]="IndexedTo100"})($n||($n={}));const An=new vo,Dn=new _s(100,1);class vu{constructor(t,e,s,n){this.ro=0,this.ho=null,this.Ah=null,this.lo=null,this.ao={oo:!1,_o:null},this.uo=0,this.co=0,this.do=new tt,this.fo=new tt,this.vo=[],this.po=null,this.mo=null,this.bo=null,this.wo=null,this.ba=Dn,this.Mo=As(null),this.xo=t,this.cn=e,this.So=s,this.ko=n,this.yo=new zn(this,100,this.Co.bind(this),this.To.bind(this))}Ta(){return this.xo}W(){return this.cn}Hh(t){if(gt(this.cn,t),this.Pa(),t.mode!==void 0&&this.Po({yr:t.mode}),t.scaleMargins!==void 0){const e=ut(t.scaleMargins.top),s=ut(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(s<0||s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(e+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+s}`);this.Ro(),this.mo=null}}Do(){return this.cn.autoScale}eo(){return this.cn.mode===1}gh(){return this.cn.mode===2}Vo(){return this.cn.mode===3}yr(){return{Wn:this.cn.autoScale,Oo:this.cn.invertScale,yr:this.cn.mode}}Po(t){const e=this.yr();let s=null;t.Wn!==void 0&&(this.cn.autoScale=t.Wn),t.yr!==void 0&&(this.cn.mode=t.yr,t.yr!==2&&t.yr!==3||(this.cn.autoScale=!0),this.ao.oo=!1),e.yr===1&&t.yr!==e.yr&&(function(r,o){if(r===null)return!1;const l=Se(r.Th(),o),h=Se(r.Ph(),o);return isFinite(l)&&isFinite(h)}(this.Ah,this.Mo)?(s=We(this.Ah,this.Mo),s!==null&&this.Bo(s)):this.cn.autoScale=!0),t.yr===1&&t.yr!==e.yr&&(s=ve(this.Ah,this.Mo),s!==null&&this.Bo(s));const n=e.yr!==this.cn.mode;n&&(e.yr===2||this.gh())&&this.Pa(),n&&(e.yr===3||this.Vo())&&this.Pa(),t.Oo!==void 0&&e.Oo!==t.Oo&&(this.cn.invertScale=t.Oo,this.Ao()),this.fo.m(e,this.yr())}Io(){return this.fo}P(){return this.So.fontSize}At(){return this.ro}zo(t){this.ro!==t&&(this.ro=t,this.Ro(),this.mo=null)}Lo(){if(this.ho)return this.ho;const t=this.At()-this.Eo()-this.No();return this.ho=t,t}zh(){return this.Fo(),this.Ah}Bo(t,e){const s=this.Ah;(e||s===null&&t!==null||s!==null&&!s.yh(t))&&(this.mo=null,this.Ah=t)}Ni(){return this.Fo(),this.ro===0||!this.Ah||this.Ah.Ni()}Wo(t){return this.Oo()?t:this.At()-1-t}Rt(t,e){return this.gh()?t=ie(t,e):this.Vo()&&(t=we(t,e)),this.To(t,e)}Qs(t,e,s){this.Fo();const n=this.No(),r=C(this.zh()),o=r.Th(),l=r.Ph(),h=this.Lo()-1,c=this.Oo(),u=h/(l-o),d=s===void 0?0:s.from,f=s===void 0?t.length:s.to,b=this.jo();for(let m=d;m<f;m++){const p=t[m],x=p._t;if(isNaN(x))continue;let w=x;b!==null&&(w=b(p._t,e));const _=n+u*(w-o),N=c?_:this.ro-1-_;p.st=N}}me(t,e,s){this.Fo();const n=this.No(),r=C(this.zh()),o=r.Th(),l=r.Ph(),h=this.Lo()-1,c=this.Oo(),u=h/(l-o),d=s===void 0?0:s.from,f=s===void 0?t.length:s.to,b=this.jo();for(let m=d;m<f;m++){const p=t[m];let x=p.we,w=p.ge,_=p.Me,N=p.xe;b!==null&&(x=b(p.we,e),w=b(p.ge,e),_=b(p.Me,e),N=b(p.xe,e));let g=n+u*(x-o),j=c?g:this.ro-1-g;p.ve=j,g=n+u*(w-o),j=c?g:this.ro-1-g,p.ce=j,g=n+u*(_-o),j=c?g:this.ro-1-g,p.de=j,g=n+u*(N-o),j=c?g:this.ro-1-g,p.pe=j}}pn(t,e){const s=this.Co(t,e);return this.Ho(s,e)}Ho(t,e){let s=t;return this.gh()?s=function(n,r){return r<0&&(n=-n),n/100*r+r}(s,e):this.Vo()&&(s=function(n,r){return n-=100,r<0&&(n=-n),n/100*r+r}(s,e)),s}Oa(){return this.vo}$o(){if(this.po)return this.po;let t=[];for(let e=0;e<this.vo.length;e++){const s=this.vo[e];s.Xi()===null&&s.Ki(e+1),t.push(s)}return t=Ro(t),this.po=t,this.po}Uo(t){this.vo.indexOf(t)===-1&&(this.vo.push(t),this.Pa(),this.qo())}Yo(t){const e=this.vo.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.vo.splice(e,1),this.vo.length===0&&(this.Po({Wn:!0}),this.Bo(null)),this.Pa(),this.qo()}Ct(){let t=null;for(const e of this.vo){const s=e.Ct();s!==null&&(t===null||s.ha<t.ha)&&(t=s)}return t===null?null:t.Vt}Oo(){return this.cn.invertScale}ja(){const t=this.Ct()===null;if(this.mo!==null&&(t||this.mo.Zo===t))return this.mo.ja;this.yo.Qa();const e=this.yo.ja();return this.mo={ja:e,Zo:t},this.do.m(),e}Xo(){return this.do}Ko(t){this.gh()||this.Vo()||this.bo===null&&this.lo===null&&(this.Ni()||(this.bo=this.ro-t,this.lo=C(this.zh()).Ch()))}Go(t){if(this.gh()||this.Vo()||this.bo===null)return;this.Po({Wn:!1}),(t=this.ro-t)<0&&(t=0);let e=(this.bo+.2*(this.ro-1))/(t+.2*(this.ro-1));const s=C(this.lo).Ch();e=Math.max(e,.1),s.Dh(e),this.Bo(s)}Jo(){this.gh()||this.Vo()||(this.bo=null,this.lo=null)}Qo(t){this.Do()||this.wo===null&&this.lo===null&&(this.Ni()||(this.wo=t,this.lo=C(this.zh()).Ch()))}t_(t){if(this.Do()||this.wo===null)return;const e=C(this.zh()).Rh()/(this.Lo()-1);let s=t-this.wo;this.Oo()&&(s*=-1);const n=s*e,r=C(this.lo).Ch();r.Vh(n),this.Bo(r,!0),this.mo=null}i_(){this.Do()||this.wo!==null&&(this.wo=null,this.lo=null)}ma(){return this.ba||this.Pa(),this.ba}Fi(t,e){switch(this.cn.mode){case 2:return this.n_(ie(t,e));case 3:return this.ma().format(we(t,e));default:return this.Fh(t)}}so(t){switch(this.cn.mode){case 2:return this.n_(t);case 3:return this.ma().format(t);default:return this.Fh(t)}}ql(t){return this.Fh(t,C(this.s_()).ma())}Yl(t,e){return t=ie(t,e),this.n_(t,An)}e_(){return this.vo}r_(t){this.ao={_o:t,oo:!1}}Vn(){this.vo.forEach(t=>t.Vn())}Pa(){this.mo=null;const t=this.s_();let e=100;t!==null&&(e=Math.round(1/t.pa())),this.ba=Dn,this.gh()?(this.ba=An,e=100):this.Vo()?(this.ba=new _s(100,1),e=100):t!==null&&(this.ba=t.ma()),this.yo=new zn(this,e,this.Co.bind(this),this.To.bind(this)),this.yo.Qa()}qo(){this.po=null}s_(){return this.vo[0]||null}Eo(){return this.Oo()?this.cn.scaleMargins.bottom*this.At()+this.co:this.cn.scaleMargins.top*this.At()+this.uo}No(){return this.Oo()?this.cn.scaleMargins.top*this.At()+this.uo:this.cn.scaleMargins.bottom*this.At()+this.co}Fo(){this.ao.oo||(this.ao.oo=!0,this.h_())}Ro(){this.ho=null}To(t,e){if(this.Fo(),this.Ni())return 0;t=this.eo()&&t?ds(t,this.Mo):t;const s=C(this.zh()),n=this.No()+(this.Lo()-1)*(t-s.Th())/s.Rh();return this.Wo(n)}Co(t,e){if(this.Fo(),this.Ni())return 0;const s=this.Wo(t),n=C(this.zh()),r=n.Th()+n.Rh()*((s-this.No())/(this.Lo()-1));return this.eo()?Se(r,this.Mo):r}Ao(){this.mo=null,this.yo.Qa()}h_(){const t=this.ao._o;if(t===null)return;let e=null;const s=this.e_();let n=0,r=0;for(const h of s){if(!h.yt())continue;const c=h.Ct();if(c===null)continue;const u=h.Al(t.Vs(),t.ui());let d=u&&u.zh();if(d!==null){switch(this.cn.mode){case 1:d=ve(d,this.Mo);break;case 2:d=pu(d,c.Vt);break;case 3:d=bu(d,c.Vt)}if(e=e===null?d:e.ts(C(d)),u!==null){const f=u.Lh();f!==null&&(n=Math.max(n,f.above),r=Math.max(r,f.below))}}}if(n===this.uo&&r===this.co||(this.uo=n,this.co=r,this.mo=null,this.Ro()),e!==null){if(e.Th()===e.Ph()){const h=this.s_(),c=5*(h===null||this.gh()||this.Vo()?1:h.pa());this.eo()&&(e=We(e,this.Mo)),e=new pt(e.Th()-c,e.Ph()+c),this.eo()&&(e=ve(e,this.Mo))}if(this.eo()){const h=We(e,this.Mo),c=As(h);if(o=c,l=this.Mo,o.Ha!==l.Ha||o.$a!==l.$a){const u=this.lo!==null?We(this.lo,this.Mo):null;this.Mo=c,e=ve(h,c),u!==null&&(this.lo=ve(u,c))}}this.Bo(e)}else this.Ah===null&&(this.Bo(new pt(-.5,.5)),this.Mo=As(null));var o,l;this.ao.oo=!0}jo(){return this.gh()?ie:this.Vo()?we:this.eo()?t=>ds(t,this.Mo):null}l_(t,e,s){return e===void 0?(s===void 0&&(s=this.ma()),s.format(t)):e(t)}Fh(t,e){return this.l_(t,this.ko.priceFormatter,e)}n_(t,e){return this.l_(t,this.ko.percentageFormatter,e)}}class gu{constructor(t,e){this.vo=[],this.a_=new Map,this.ro=0,this.o_=0,this.__=1e3,this.po=null,this.u_=new tt,this.kl=t,this.$i=e,this.c_=new mu(this);const s=e.W();this.d_=this.f_("left",s.leftPriceScale),this.v_=this.f_("right",s.rightPriceScale),this.d_.Io().l(this.p_.bind(this,this.d_),this),this.v_.Io().l(this.p_.bind(this,this.v_),this),this.m_(s)}m_(t){if(t.leftPriceScale&&this.d_.Hh(t.leftPriceScale),t.rightPriceScale&&this.v_.Hh(t.rightPriceScale),t.localization&&(this.d_.Pa(),this.v_.Pa()),t.overlayPriceScales){const e=Array.from(this.a_.values());for(const s of e){const n=C(s[0].Dt());n.Hh(t.overlayPriceScales),t.localization&&n.Pa()}}}b_(t){switch(t){case"left":return this.d_;case"right":return this.v_}return this.a_.has(t)?ut(this.a_.get(t))[0].Dt():null}S(){this.$t().w_().p(this),this.d_.Io().p(this),this.v_.Io().p(this),this.vo.forEach(t=>{t.S&&t.S()}),this.u_.m()}g_(){return this.__}M_(t){this.__=t}$t(){return this.$i}Hi(){return this.o_}At(){return this.ro}x_(t){this.o_=t,this.S_()}zo(t){this.ro=t,this.d_.zo(t),this.v_.zo(t),this.vo.forEach(e=>{if(this.dr(e)){const s=e.Dt();s!==null&&s.zo(t)}}),this.S_()}Oa(){return this.vo}dr(t){const e=t.Dt();return e===null||this.d_!==e&&this.v_!==e}Uo(t,e,s){const n=s!==void 0?s:this.y_().k_+1;this.C_(t,e,n)}Yo(t){const e=this.vo.indexOf(t);At(e!==-1,"removeDataSource: invalid data source"),this.vo.splice(e,1);const s=C(t.Dt()).Ta();if(this.a_.has(s)){const r=ut(this.a_.get(s)),o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&this.a_.delete(s))}const n=t.Dt();n&&n.Oa().indexOf(t)>=0&&n.Yo(t),n!==null&&(n.qo(),this.T_(n)),this.po=null}pr(t){return t===this.d_?"left":t===this.v_?"right":"overlay"}P_(){return this.d_}R_(){return this.v_}D_(t,e){t.Ko(e)}V_(t,e){t.Go(e),this.S_()}O_(t){t.Jo()}B_(t,e){t.Qo(e)}A_(t,e){t.t_(e),this.S_()}I_(t){t.i_()}S_(){this.vo.forEach(t=>{t.Vn()})}vn(){let t=null;return this.$i.W().rightPriceScale.visible&&this.v_.Oa().length!==0?t=this.v_:this.$i.W().leftPriceScale.visible&&this.d_.Oa().length!==0?t=this.d_:this.vo.length!==0&&(t=this.vo[0].Dt()),t===null&&(t=this.v_),t}vr(){let t=null;return this.$i.W().rightPriceScale.visible?t=this.v_:this.$i.W().leftPriceScale.visible&&(t=this.d_),t}T_(t){t!==null&&t.Do()&&this.z_(t)}L_(t){const e=this.kl.Zs();t.Po({Wn:!0}),e!==null&&t.r_(e),this.S_()}E_(){this.z_(this.d_),this.z_(this.v_)}N_(){this.T_(this.d_),this.T_(this.v_),this.vo.forEach(t=>{this.dr(t)&&this.T_(t.Dt())}),this.S_(),this.$i.$h()}$o(){return this.po===null&&(this.po=Ro(this.vo)),this.po}F_(){return this.u_}W_(){return this.c_}z_(t){const e=t.e_();if(e&&e.length>0&&!this.kl.Ni()){const s=this.kl.Zs();s!==null&&t.r_(s)}t.Vn()}y_(){const t=this.$o();if(t.length===0)return{j_:0,k_:0};let e=0,s=0;for(let n=0;n<t.length;n++){const r=t[n].Xi();r!==null&&(r<e&&(e=r),r>s&&(s=r))}return{j_:e,k_:s}}C_(t,e,s){let n=this.b_(e);if(n===null&&(n=this.f_(e,this.$i.W().overlayPriceScales)),this.vo.push(t),!js(e)){const r=this.a_.get(e)||[];r.push(t),this.a_.set(e,r)}n.Uo(t),t.Gi(n),t.Ki(s),this.T_(n),this.po=null}p_(t,e,s){e.yr!==s.yr&&this.z_(t)}f_(t,e){const s=Object.assign({visible:!0,autoScale:!0},Pt(e)),n=new vu(t,s,this.$i.W().layout,this.$i.W().localization);return n.zo(this.At()),n}}class xu{constructor(t,e,s=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Qe=new Map,this.Je=new Map,this.H_=t,this.U_=e,this.tr=s}q_(t){const e=t.time,s=this.U_.cacheKey(e),n=this.Qe.get(s);if(n!==void 0)return n.Y_;if(this.Xe===this.tr){const o=this.Je.get(this.Ge);this.Je.delete(this.Ge),this.Qe.delete(ut(o)),this.Ge++,this.Xe--}const r=this.H_(t);return this.Qe.set(s,{Y_:r,er:this.Ke}),this.Je.set(this.Ke,s),this.Xe++,this.Ke++,r}}class Ne{constructor(t,e){At(t<=e,"right should be >= left"),this.Z_=t,this.X_=e}Vs(){return this.Z_}ui(){return this.X_}K_(){return this.X_-this.Z_+1}Xr(t){return this.Z_<=t&&t<=this.X_}yh(t){return this.Z_===t.Vs()&&this.X_===t.ui()}}function In(i,t){return i===null||t===null?i===t:i.yh(t)}class yu{constructor(){this.G_=new Map,this.Qe=null,this.J_=!1}Q_(t){this.J_=t,this.Qe=null}tu(t,e){this.iu(e),this.Qe=null;for(let s=e;s<t.length;++s){const n=t[s];let r=this.G_.get(n.timeWeight);r===void 0&&(r=[],this.G_.set(n.timeWeight,r)),r.push({index:s,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}nu(t,e){const s=Math.ceil(e/t);return this.Qe!==null&&this.Qe.su===s||(this.Qe={ja:this.eu(s),su:s}),this.Qe.ja}iu(t){if(t===0)return void this.G_.clear();const e=[];this.G_.forEach((s,n)=>{t<=s[0].index?e.push(n):s.splice(ze(s,t,r=>r.index<t),1/0)});for(const s of e)this.G_.delete(s)}eu(t){let e=[];for(const s of Array.from(this.G_.keys()).sort((n,r)=>r-n)){if(!this.G_.get(s))continue;const n=e;e=[];const r=n.length;let o=0;const l=ut(this.G_.get(s)),h=l.length;let c=1/0,u=-1/0;for(let d=0;d<h;d++){const f=l[d],b=f.index;for(;o<r;){const m=n[o],p=m.index;if(!(p<b)){c=p;break}o++,e.push(m),u=p,c=1/0}if(c-b>=t&&b-u>=t)e.push(f),u=b;else if(this.J_)return n}for(;o<r;o++)e.push(n[o])}return e}}class re{constructor(t){this.ru=t}hu(){return this.ru===null?null:new Ne(Math.floor(this.ru.Vs()),Math.ceil(this.ru.ui()))}lu(){return this.ru}static au(){return new re(null)}}function wu(i,t){return i.weight>t.weight?i:t}class Su{constructor(t,e,s,n){this.o_=0,this.ou=null,this._u=[],this.wo=null,this.bo=null,this.uu=new yu,this.cu=new Map,this.du=re.au(),this.fu=!0,this.vu=new tt,this.pu=new tt,this.mu=new tt,this.bu=null,this.wu=null,this.gu=[],this.cn=e,this.ko=s,this.Mu=e.rightOffset,this.xu=e.barSpacing,this.$i=t,this.U_=n,this.Su(),this.uu.Q_(e.uniformDistribution)}W(){return this.cn}ku(t){gt(this.ko,t),this.yu(),this.Su()}Hh(t,e){var s;gt(this.cn,t),this.cn.fixLeftEdge&&this.Cu(),this.cn.fixRightEdge&&this.Tu(),t.barSpacing!==void 0&&this.$i.Gn(t.barSpacing),t.rightOffset!==void 0&&this.$i.Jn(t.rightOffset),t.minBarSpacing!==void 0&&this.$i.Gn((s=t.barSpacing)!==null&&s!==void 0?s:this.xu),this.yu(),this.Su(),this.mu.m()}mn(t){var e,s;return(s=(e=this._u[t])===null||e===void 0?void 0:e.time)!==null&&s!==void 0?s:null}Ui(t){var e;return(e=this._u[t])!==null&&e!==void 0?e:null}Da(t,e){if(this._u.length<1)return null;if(this.U_.key(t)>this.U_.key(this._u[this._u.length-1].time))return e?this._u.length-1:null;const s=ze(this._u,this.U_.key(t),(n,r)=>this.U_.key(n.time)<r);return this.U_.key(t)<this.U_.key(this._u[s].time)?e?s:null:s}Ni(){return this.o_===0||this._u.length===0||this.ou===null}Ra(){return this._u.length>0}Zs(){return this.Pu(),this.du.hu()}Ru(){return this.Pu(),this.du.lu()}Du(){const t=this.Zs();if(t===null)return null;const e={from:t.Vs(),to:t.ui()};return this.Vu(e)}Vu(t){const e=Math.round(t.from),s=Math.round(t.to),n=C(this.Ou()),r=C(this.Bu());return{from:C(this.Ui(Math.max(n,e))),to:C(this.Ui(Math.min(r,s)))}}Au(t){return{from:C(this.Da(t.from,!0)),to:C(this.Da(t.to,!0))}}Hi(){return this.o_}x_(t){if(!isFinite(t)||t<=0||this.o_===t)return;const e=this.Ru(),s=this.o_;if(this.o_=t,this.fu=!0,this.cn.lockVisibleTimeRangeOnResize&&s!==0){const n=this.xu*t/s;this.xu=n}if(this.cn.fixLeftEdge&&e!==null&&e.Vs()<=0){const n=s-t;this.Mu-=Math.round(n/this.xu)+1,this.fu=!0}this.Iu(),this.zu()}It(t){if(this.Ni()||!_e(t))return 0;const e=this.Lu()+this.Mu-t;return this.o_-(e+.5)*this.xu-1}Js(t,e){const s=this.Lu(),n=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=n;o<r;o++){const l=t[o].ot,h=s+this.Mu-l,c=this.o_-(h+.5)*this.xu-1;t[o].nt=c}}Eu(t){return Math.ceil(this.Nu(t))}Jn(t){this.fu=!0,this.Mu=t,this.zu(),this.$i.Fu(),this.$i.$h()}he(){return this.xu}Gn(t){this.Wu(t),this.zu(),this.$i.Fu(),this.$i.$h()}ju(){return this.Mu}ja(){if(this.Ni())return null;if(this.wu!==null)return this.wu;const t=this.xu,e=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),s=Math.round(e/t),n=C(this.Zs()),r=Math.max(n.Vs(),n.Vs()-s),o=Math.max(n.ui(),n.ui()-s),l=this.uu.nu(t,e),h=this.Ou()+s,c=this.Bu()-s,u=this.Hu(),d=this.cn.fixLeftEdge||u,f=this.cn.fixRightEdge||u;let b=0;for(const m of l){if(!(r<=m.index&&m.index<=o))continue;let p;b<this.gu.length?(p=this.gu[b],p.coord=this.It(m.index),p.label=this.$u(m),p.weight=m.weight):(p={needAlignCoordinate:!1,coord:this.It(m.index),label:this.$u(m),weight:m.weight},this.gu.push(p)),this.xu>e/2&&!u?p.needAlignCoordinate=!1:p.needAlignCoordinate=d&&m.index<=h||f&&m.index>=c,b++}return this.gu.length=b,this.wu=this.gu,this.gu}Uu(){this.fu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}qu(t){this.fu=!0,this.ou=t,this.zu(),this.Cu()}Yu(t,e){const s=this.Nu(t),n=this.he(),r=n+e*(n/10);this.Gn(r),this.cn.rightBarStaysOnScroll||this.Jn(this.ju()+(s-this.Nu(t)))}Ko(t){this.wo&&this.i_(),this.bo===null&&this.bu===null&&(this.Ni()||(this.bo=t,this.Zu()))}Go(t){if(this.bu===null)return;const e=hi(this.o_-t,0,this.o_),s=hi(this.o_-C(this.bo),0,this.o_);e!==0&&s!==0&&this.Gn(this.bu.he*e/s)}Jo(){this.bo!==null&&(this.bo=null,this.Xu())}Qo(t){this.wo===null&&this.bu===null&&(this.Ni()||(this.wo=t,this.Zu()))}t_(t){if(this.wo===null)return;const e=(this.wo-t)/this.he();this.Mu=C(this.bu).ju+e,this.fu=!0,this.zu()}i_(){this.wo!==null&&(this.wo=null,this.Xu())}Ku(){this.Gu(this.cn.rightOffset)}Gu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.Mu,n=performance.now();this.$i.Zn({Ju:r=>(r-n)/e>=1,Qu:r=>{const o=(r-n)/e;return o>=1?t:s+(t-s)*o}})}bt(t,e){this.fu=!0,this._u=t,this.uu.tu(t,e),this.zu()}tc(){return this.vu}nc(){return this.pu}sc(){return this.mu}Lu(){return this.ou||0}ec(t){const e=t.K_();this.Wu(this.o_/e),this.Mu=t.ui()-this.Lu(),this.zu(),this.fu=!0,this.$i.Fu(),this.$i.$h()}rc(){const t=this.Ou(),e=this.Bu();t!==null&&e!==null&&this.ec(new Ne(t,e+this.cn.rightOffset))}hc(t){const e=new Ne(t.from,t.to);this.ec(e)}qi(t){return this.ko.timeFormatter!==void 0?this.ko.timeFormatter(t.originalTime):this.U_.formatHorzItem(t.time)}Hu(){const{handleScroll:t,handleScale:e}=this.$i.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}Ou(){return this._u.length===0?null:0}Bu(){return this._u.length===0?null:this._u.length-1}lc(t){return(this.o_-1-t)/this.xu}Nu(t){const e=this.lc(t),s=this.Lu()+this.Mu-e;return Math.round(1e6*s)/1e6}Wu(t){const e=this.xu;this.xu=t,this.Iu(),e!==this.xu&&(this.fu=!0,this.ac())}Pu(){if(!this.fu)return;if(this.fu=!1,this.Ni())return void this.oc(re.au());const t=this.Lu(),e=this.o_/this.xu,s=this.Mu+t,n=new Ne(s-e+1,s);this.oc(new re(n))}Iu(){const t=this._c();if(this.xu<t&&(this.xu=t,this.fu=!0),this.o_!==0){const e=.5*this.o_;this.xu>e&&(this.xu=e,this.fu=!0)}}_c(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this._u.length!==0?this.o_/this._u.length:this.cn.minBarSpacing}zu(){const t=this.uc();this.Mu>t&&(this.Mu=t,this.fu=!0);const e=this.cc();e!==null&&this.Mu<e&&(this.Mu=e,this.fu=!0)}cc(){const t=this.Ou(),e=this.ou;return t===null||e===null?null:t-e-1+(this.cn.fixLeftEdge?this.o_/this.xu:Math.min(2,this._u.length))}uc(){return this.cn.fixRightEdge?0:this.o_/this.xu-Math.min(2,this._u.length)}Zu(){this.bu={he:this.he(),ju:this.ju()}}Xu(){this.bu=null}$u(t){let e=this.cu.get(t.weight);return e===void 0&&(e=new xu(s=>this.dc(s),this.U_),this.cu.set(t.weight,e)),e.q_(t)}dc(t){return this.U_.formatTickmark(t,this.ko)}oc(t){const e=this.du;this.du=t,In(e.hu(),this.du.hu())||this.vu.m(),In(e.lu(),this.du.lu())||this.pu.m(),this.ac()}ac(){this.wu=null}yu(){this.ac(),this.cu.clear()}Su(){this.U_.updateFormatter(this.ko)}Cu(){if(!this.cn.fixLeftEdge)return;const t=this.Ou();if(t===null)return;const e=this.Zs();if(e===null)return;const s=e.Vs()-t;if(s<0){const n=this.Mu-s-1;this.Jn(n)}this.Iu()}Tu(){this.zu(),this.Iu()}}class Nu{X(t,e,s){t.useMediaCoordinateSpace(n=>this.K(n,e,s))}wl(t,e,s){t.useMediaCoordinateSpace(n=>this.fc(n,e,s))}fc(t,e,s){}}class ju extends Nu{constructor(t){super(),this.vc=new Map,this.zt=t}K(t){}fc(t){if(!this.zt.yt)return;const{context:e,mediaSize:s}=t;let n=0;for(const o of this.zt.mc){if(o.Kt.length===0)continue;e.font=o.R;const l=this.bc(e,o.Kt);l>s.width?o.Yu=s.width/l:o.Yu=1,n+=o.wc*o.Yu}let r=0;switch(this.zt.gc){case"top":r=0;break;case"center":r=Math.max((s.height-n)/2,0);break;case"bottom":r=Math.max(s.height-n,0)}e.fillStyle=this.zt.V;for(const o of this.zt.mc){e.save();let l=0;switch(this.zt.Mc){case"left":e.textAlign="left",l=o.wc/2;break;case"center":e.textAlign="center",l=s.width/2;break;case"right":e.textAlign="right",l=s.width-1-o.wc/2}e.translate(l,r),e.textBaseline="top",e.font=o.R,e.scale(o.Yu,o.Yu),e.fillText(o.Kt,0,o.xc),e.restore(),r+=o.wc*o.Yu}}bc(t,e){const s=this.Sc(t.font);let n=s.get(e);return n===void 0&&(n=t.measureText(e).width,s.set(e,n)),n}Sc(t){let e=this.vc.get(t);return e===void 0&&(e=new Map,this.vc.set(t,e)),e}}class _u{constructor(t){this.ft=!0,this.Ft={yt:!1,V:"",mc:[],gc:"center",Mc:"center"},this.Wt=new ju(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.W(),e=this.Ft;e.yt=t.visible,e.yt&&(e.V=t.color,e.Mc=t.horzAlign,e.gc=t.vertAlign,e.mc=[{Kt:t.text,R:le(t.fontSize,t.fontFamily,t.fontStyle),wc:1.2*t.fontSize,xc:0,Yu:0}])}}class Cu extends Ei{constructor(t,e){super(),this.cn=e,this.wn=new _u(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}var Vn,Bn,Un,ci,Wn;(function(i){i[i.OnTouchEnd=0]="OnTouchEnd",i[i.OnNextTap=1]="OnNextTap"})(Vn||(Vn={}));class ku{constructor(t,e,s){this.kc=[],this.yc=[],this.o_=0,this.Cc=null,this.Tc=new tt,this.Pc=new tt,this.Rc=null,this.Dc=t,this.cn=e,this.U_=s,this.Vc=new rc(this),this.kl=new Su(this,e.timeScale,this.cn.localization,s),this.vt=new bc(this,e.crosshair),this.Oc=new uu(e.crosshair),this.Bc=new Cu(this,e.watermark),this.Ac(),this.kc[0].M_(2e3),this.Ic=this.zc(0),this.Lc=this.zc(1)}Xl(){this.Ec(ot.es())}$h(){this.Ec(ot.ss())}aa(){this.Ec(new ot(1))}Kl(t){const e=this.Nc(t);this.Ec(e)}Fc(){return this.Cc}Wc(t){const e=this.Cc;this.Cc=t,e!==null&&this.Kl(e.jc),t!==null&&this.Kl(t.jc)}W(){return this.cn}Hh(t){gt(this.cn,t),this.kc.forEach(e=>e.m_(t)),t.timeScale!==void 0&&this.kl.Hh(t.timeScale),t.localization!==void 0&&this.kl.ku(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Tc.m(),this.Ic=this.zc(0),this.Lc=this.zc(1),this.Xl()}Hc(t,e){if(t==="left")return void this.Hh({leftPriceScale:e});if(t==="right")return void this.Hh({rightPriceScale:e});const s=this.$c(t);s!==null&&(s.Dt.Hh(e),this.Tc.m())}$c(t){for(const e of this.kc){const s=e.b_(t);if(s!==null)return{Ht:e,Dt:s}}return null}St(){return this.kl}Uc(){return this.kc}qc(){return this.Bc}Yc(){return this.vt}Zc(){return this.Pc}Xc(t,e){t.zo(e),this.Fu()}x_(t){this.o_=t,this.kl.x_(this.o_),this.kc.forEach(e=>e.x_(t)),this.Fu()}Ac(t){const e=new gu(this.kl,this);t!==void 0?this.kc.splice(t,0,e):this.kc.push(e);const s=t===void 0?this.kc.length-1:t,n=ot.es();return n.Nn(s,{Fn:0,Wn:!0}),this.Ec(n),e}D_(t,e,s){t.D_(e,s)}V_(t,e,s){t.V_(e,s),this.Gl(),this.Ec(this.Kc(t,2))}O_(t,e){t.O_(e),this.Ec(this.Kc(t,2))}B_(t,e,s){e.Do()||t.B_(e,s)}A_(t,e,s){e.Do()||(t.A_(e,s),this.Gl(),this.Ec(this.Kc(t,2)))}I_(t,e){e.Do()||(t.I_(e),this.Ec(this.Kc(t,2)))}L_(t,e){t.L_(e),this.Ec(this.Kc(t,2))}Gc(t){this.kl.Ko(t)}Jc(t,e){const s=this.St();if(s.Ni()||e===0)return;const n=s.Hi();t=Math.max(1,Math.min(t,n)),s.Yu(t,e),this.Fu()}Qc(t){this.td(0),this.nd(t),this.sd()}ed(t){this.kl.Go(t),this.Fu()}rd(){this.kl.Jo(),this.$h()}td(t){this.kl.Qo(t)}nd(t){this.kl.t_(t),this.Fu()}sd(){this.kl.i_(),this.$h()}wt(){return this.yc}hd(t,e,s,n,r){this.vt.gn(t,e);let o=NaN,l=this.kl.Eu(t);const h=this.kl.Zs();h!==null&&(l=Math.min(Math.max(h.Vs(),l),h.ui()));const c=n.vn(),u=c.Ct();u!==null&&(o=c.pn(e,u)),o=this.Oc.Va(o,l,n),this.vt.kn(l,o,n),this.aa(),r||this.Pc.m(this.vt.xt(),{x:t,y:e},s)}ld(t,e,s){const n=s.vn(),r=n.Ct(),o=n.Rt(t,C(r)),l=this.kl.Da(e,!0),h=this.kl.It(C(l));this.hd(h,o,null,s,!0)}ad(t){this.Yc().Cn(),this.aa(),t||this.Pc.m(null,null,null)}Gl(){const t=this.vt.Ht();if(t!==null){const e=this.vt.xn(),s=this.vt.Sn();this.hd(e,s,null,t)}this.vt.Vn()}od(t,e,s){const n=this.kl.mn(0);e!==void 0&&s!==void 0&&this.kl.bt(e,s);const r=this.kl.mn(0),o=this.kl.Lu(),l=this.kl.Zs();if(l!==null&&n!==null&&r!==null){const h=l.Xr(o),c=this.U_.key(n)>this.U_.key(r),u=t!==null&&t>o&&!c,d=this.kl.W().allowShiftVisibleRangeOnWhitespaceReplacement,f=h&&(s!==void 0||d)&&this.kl.W().shiftVisibleRangeOnNewBar;if(u&&!f){const b=t-o;this.kl.Jn(this.kl.ju()-b)}}this.kl.qu(t)}ta(t){t!==null&&t.N_()}cr(t){const e=this.kc.find(s=>s.$o().includes(t));return e===void 0?null:e}Fu(){this.Bc.Vn(),this.kc.forEach(t=>t.N_()),this.Gl()}S(){this.kc.forEach(t=>t.S()),this.kc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}_d(){return this.Vc}mr(){return this.Vc.W()}w_(){return this.Tc}ud(t,e,s){const n=this.kc[0],r=this.dd(e,t,n,s);return this.yc.push(r),this.yc.length===1?this.Xl():this.$h(),r}fd(t){const e=this.cr(t),s=this.yc.indexOf(t);At(s!==-1,"Series not found"),this.yc.splice(s,1),C(e).Yo(t),t.S&&t.S()}Zl(t,e){const s=C(this.cr(t));s.Yo(t);const n=this.$c(e);if(n===null){const r=t.Xi();s.Uo(t,e,r)}else{const r=n.Ht===s?t.Xi():void 0;n.Ht.Uo(t,e,r)}}rc(){const t=ot.ss();t.$n(),this.Ec(t)}vd(t){const e=ot.ss();e.Yn(t),this.Ec(e)}Kn(){const t=ot.ss();t.Kn(),this.Ec(t)}Gn(t){const e=ot.ss();e.Gn(t),this.Ec(e)}Jn(t){const e=ot.ss();e.Jn(t),this.Ec(e)}Zn(t){const e=ot.ss();e.Zn(t),this.Ec(e)}Un(){const t=ot.ss();t.Un(),this.Ec(t)}pd(){return this.cn.rightPriceScale.visible?"right":"left"}md(){return this.Lc}q(){return this.Ic}Bt(t){const e=this.Lc,s=this.Ic;if(e===s)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Rc===null||this.Rc.Ts!==s||this.Rc.Ps!==e)this.Rc={Ts:s,Ps:e,bd:new Map};else{const r=this.Rc.bd.get(t);if(r!==void 0)return r}const n=function(r,o,l){const[h,c,u,d]=je(r),[f,b,m,p]=je(o),x=[bt(h+l*(f-h)),bt(c+l*(b-c)),bt(u+l*(m-u)),fo(d+l*(p-d))];return`rgba(${x[0]}, ${x[1]}, ${x[2]}, ${x[3]})`}(s,e,t/100);return this.Rc.bd.set(t,n),n}Kc(t,e){const s=new ot(e);if(t!==null){const n=this.kc.indexOf(t);s.Nn(n,{Fn:e})}return s}Nc(t,e){return e===void 0&&(e=2),this.Kc(this.cr(t),e)}Ec(t){this.Dc&&this.Dc(t),this.kc.forEach(e=>e.W_().Uh().bt())}dd(t,e,s,n){const r=new Oi(this,t,e,s,n),o=t.priceScaleId!==void 0?t.priceScaleId:this.pd();return s.Uo(r,o),js(o)||r.Hh(t),r}zc(t){const e=this.cn.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}}function ui(i){return!kt(i)&&!Fe(i)}function Po(i){return kt(i)}(function(i){i[i.Disabled=0]="Disabled",i[i.Continuous=1]="Continuous",i[i.OnDataUpdate=2]="OnDataUpdate"})(Bn||(Bn={})),function(i){i[i.LastBar=0]="LastBar",i[i.LastVisible=1]="LastVisible"}(Un||(Un={})),function(i){i.Solid="solid",i.VerticalGradient="gradient"}(ci||(ci={})),function(i){i[i.Year=0]="Year",i[i.Month=1]="Month",i[i.DayOfMonth=2]="DayOfMonth",i[i.Time=3]="Time",i[i.TimeWithSeconds=4]="TimeWithSeconds"}(Wn||(Wn={}));const qn=i=>i.getUTCFullYear();function Mu(i,t,e){return t.replace(/yyyy/g,(s=>Ot(qn(s),4))(i)).replace(/yy/g,(s=>Ot(qn(s)%100,2))(i)).replace(/MMMM/g,((s,n)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(n,{month:"long"}))(i,e)).replace(/MMM/g,((s,n)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(n,{month:"short"}))(i,e)).replace(/MM/g,(s=>Ot((n=>n.getUTCMonth()+1)(s),2))(i)).replace(/dd/g,(s=>Ot((n=>n.getUTCDate())(s),2))(i))}class Oo{constructor(t="yyyy-MM-dd",e="default"){this.wd=t,this.gd=e}q_(t){return Mu(t,this.wd,this.gd)}}class Eu{constructor(t){this.Md=t||"%h:%m:%s"}q_(t){return this.Md.replace("%h",Ot(t.getUTCHours(),2)).replace("%m",Ot(t.getUTCMinutes(),2)).replace("%s",Ot(t.getUTCSeconds(),2))}}const Lu={xd:"yyyy-MM-dd",Sd:"%h:%m:%s",kd:" ",yd:"default"};class Ru{constructor(t={}){const e=Object.assign(Object.assign({},Lu),t);this.Cd=new Oo(e.xd,e.yd),this.Td=new Eu(e.Sd),this.Pd=e.kd}q_(t){return`${this.Cd.q_(t)}${this.Pd}${this.Td.q_(t)}`}}function qe(i){return 60*i*60*1e3}function Is(i){return 60*i*1e3}const Qe=[{Rd:(Qn=1,1e3*Qn),Dd:10},{Rd:Is(1),Dd:20},{Rd:Is(5),Dd:21},{Rd:Is(30),Dd:22},{Rd:qe(1),Dd:30},{Rd:qe(3),Dd:31},{Rd:qe(6),Dd:32},{Rd:qe(12),Dd:33}];var Qn;function Kn(i,t){if(i.getUTCFullYear()!==t.getUTCFullYear())return 70;if(i.getUTCMonth()!==t.getUTCMonth())return 60;if(i.getUTCDate()!==t.getUTCDate())return 50;for(let e=Qe.length-1;e>=0;--e)if(Math.floor(t.getTime()/Qe[e].Rd)!==Math.floor(i.getTime()/Qe[e].Rd))return Qe[e].Dd;return 0}function Vs(i){let t=i;if(Fe(i)&&(t=Ti(i)),!ui(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Vd:Math.round(e.getTime()/1e3),Od:t}}function Hn(i){if(!Po(i))throw new Error("time must be of type isUTCTimestamp");return{Vd:i}}function Ti(i){const t=new Date(i);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${i}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function Jn(i){Fe(i.time)&&(i.time=Ti(i.time))}class Xn{options(){return this.cn}setOptions(t){this.cn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(Jn)}(t):Jn(t)}createConverterToInternalObj(t){return C(function(e){return e.length===0?null:ui(e[0].time)||Fe(e[0].time)?Vs:Hn}(t))}key(t){return typeof t=="object"&&"Vd"in t?t.Vd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.Od===void 0?new Date(1e3*e.Vd).getTime():new Date(Date.UTC(e.Od.year,e.Od.month-1,e.Od.day)).getTime()}convertHorzItemToInternal(t){return Po(e=t)?Hn(e):ui(e)?Vs(e):Vs(Ti(e));var e}updateFormatter(t){if(!this.cn)return;const e=t.dateFormat;this.cn.timeScale.timeVisible?this.Bd=new Ru({xd:e,Sd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",kd:"   ",yd:t.locale}):this.Bd=new Oo(e,t.locale)}formatHorzItem(t){const e=t;return this.Bd.q_(new Date(1e3*e.Vd))}formatTickmark(t,e){const s=function(r,o,l){switch(r){case 0:case 10:return o?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),n=this.cn.timeScale;if(n.tickMarkFormatter!==void 0){const r=n.tickMarkFormatter(t.originalTime,s,e.locale);if(r!==null)return r}return function(r,o,l){const h={};switch(o){case 0:h.year="numeric";break;case 1:h.month="short";break;case 2:h.day="numeric";break;case 3:h.hour12=!1,h.hour="2-digit",h.minute="2-digit";break;case 4:h.hour12=!1,h.hour="2-digit",h.minute="2-digit",h.second="2-digit"}const c=r.Od===void 0?new Date(1e3*r.Vd):new Date(Date.UTC(r.Od.year,r.Od.month-1,r.Od.day));return new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()).toLocaleString(l,h)}(t.time,s,e.locale)}maxTickMarkWeight(t){let e=t.reduce(wu,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(s,n=0){if(s.length===0)return;let r=n===0?null:s[n-1].time.Vd,o=r!==null?new Date(1e3*r):null,l=0;for(let h=n;h<s.length;++h){const c=s[h],u=new Date(1e3*c.time.Vd);o!==null&&(c.timeWeight=Kn(u,o)),l+=c.time.Vd-(r||c.time.Vd),r=c.time.Vd,o=u}if(n===0&&s.length>1){const h=Math.ceil(l/(s.length-1)),c=new Date(1e3*(s[0].time.Vd-h));s[0].timeWeight=Kn(new Date(1e3*s[0].time.Vd),c)}})(t,e)}static Ad(t){return gt({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const he=typeof window<"u";function Gn(){return!!he&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Bs(){return!!he&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function di(i){return i+i%2}function Us(i,t){return i.Id-t.Id}function Ws(i,t,e){const s=(i.Id-t.Id)/(i.ot-t.ot);return Math.sign(s)*Math.min(Math.abs(s),e)}class Pu{constructor(t,e,s,n){this.zd=null,this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=0,this.jd=0,this.Hd=t,this.$d=e,this.Ud=s,this.rs=n}qd(t,e){if(this.zd!==null){if(this.zd.ot===e)return void(this.zd.Id=t);if(Math.abs(this.zd.Id-t)<this.rs)return}this.Nd=this.Ed,this.Ed=this.Ld,this.Ld=this.zd,this.zd={ot:e,Id:t}}Dr(t,e){if(this.zd===null||this.Ld===null||e-this.zd.ot>50)return;let s=0;const n=Ws(this.zd,this.Ld,this.$d),r=Us(this.zd,this.Ld),o=[n],l=[r];if(s+=r,this.Ed!==null){const c=Ws(this.Ld,this.Ed,this.$d);if(Math.sign(c)===Math.sign(n)){const u=Us(this.Ld,this.Ed);if(o.push(c),l.push(u),s+=u,this.Nd!==null){const d=Ws(this.Ed,this.Nd,this.$d);if(Math.sign(d)===Math.sign(n)){const f=Us(this.Ed,this.Nd);o.push(d),l.push(f),s+=f}}}}let h=0;for(let c=0;c<o.length;++c)h+=l[c]/s*o[c];Math.abs(h)<this.Hd||(this.Fd={Id:t,ot:e},this.jd=h,this.Wd=function(c,u){const d=Math.log(u);return Math.log(1*d/-c)/d}(Math.abs(h),this.Ud))}Qu(t){const e=C(this.Fd),s=t-e.ot;return e.Id+this.jd*(Math.pow(this.Ud,s)-1)/Math.log(this.Ud)}Ju(t){return this.Fd===null||this.Yd(t)===this.Wd}Yd(t){const e=t-C(this.Fd).ot;return Math.min(e,this.Wd)}}class Ou{constructor(t,e){this.Zd=void 0,this.Xd=void 0,this.Kd=void 0,this.en=!1,this.Gd=t,this.Jd=e,this.Qd()}bt(){this.Qd()}tf(){this.Zd&&this.Gd.removeChild(this.Zd),this.Xd&&this.Gd.removeChild(this.Xd),this.Zd=void 0,this.Xd=void 0}if(){return this.en!==this.nf()||this.Kd!==this.sf()}sf(){return mo(je(this.Jd.W().layout.textColor))>160?"dark":"light"}nf(){return this.Jd.W().layout.attributionLogo}ef(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Qd(){this.if()&&(this.tf(),this.en=this.nf(),this.en&&(this.Kd=this.sf(),this.Xd=document.createElement("style"),this.Xd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Zd=document.createElement("a"),this.Zd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.ef()}`,this.Zd.title="Charting by TradingView",this.Zd.id="tv-attr-logo",this.Zd.target="_blank",this.Zd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Zd.toggleAttribute("data-dark",this.Kd==="dark"),this.Gd.appendChild(this.Xd),this.Gd.appendChild(this.Zd)))}}function Xt(i,t){const e=C(i.ownerDocument).createElement("canvas");i.appendChild(e);const s=Wh(e,{options:{allowResizeObserver:!1},transform:(n,r)=>({width:Math.max(n.width,r.width),height:Math.max(n.height,r.height)})});return s.resizeCanvasElement(t),s}function Gt(i){var t;i.width=1,i.height=1,(t=i.getContext("2d"))===null||t===void 0||t.clearRect(0,0,1,1)}function fi(i,t,e,s){i.wl&&i.wl(t,e,s)}function is(i,t,e,s){i.X(t,e,s)}function mi(i,t,e,s){const n=i(e,s);for(const r of n){const o=r.gt();o!==null&&t(o)}}function Tu(i){he&&window.chrome!==void 0&&i.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class Fi{constructor(t,e,s){this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.cf=null,this.df=!1,this.ff=null,this.vf=null,this.pf=!1,this.mf=!1,this.bf=!1,this.wf=null,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=0,this.Tf=!1,this.Pf=!1,this.Rf=!1,this.Df=0,this.Vf=null,this.Of=!Bs(),this.Bf=n=>{this.Af(n)},this.If=n=>{if(this.zf(n)){const r=this.Lf(n);if(++this.af,this._f&&this.af>1){const{Ef:o}=this.Nf(jt(n),this.uf);o<30&&!this.bf&&this.Ff(r,this.jf.Wf),this.Hf()}}else{const r=this.Lf(n);if(++this.rf,this.hf&&this.rf>1){const{Ef:o}=this.Nf(jt(n),this.lf);o<5&&!this.mf&&this.$f(r,this.jf.Uf),this.qf()}}},this.Yf=t,this.jf=e,this.cn=s,this.Zf()}S(){this.wf!==null&&(this.wf(),this.wf=null),this.gf!==null&&(this.gf(),this.gf=null),this.xf!==null&&(this.xf(),this.xf=null),this.Sf!==null&&(this.Sf(),this.Sf=null),this.kf!==null&&(this.kf(),this.kf=null),this.Mf!==null&&(this.Mf(),this.Mf=null),this.Xf(),this.qf()}Kf(t){this.xf&&this.xf();const e=this.Gf.bind(this);if(this.xf=()=>{this.Yf.removeEventListener("mousemove",e)},this.Yf.addEventListener("mousemove",e),this.zf(t))return;const s=this.Lf(t);this.$f(s,this.jf.Jf),this.Of=!0}qf(){this.hf!==null&&clearTimeout(this.hf),this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Hf(){this._f!==null&&clearTimeout(this._f),this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Gf(t){if(this.Rf||this.vf!==null||this.zf(t))return;const e=this.Lf(t);this.$f(e,this.jf.Qf),this.Of=!0}tv(t){const e=qs(t.changedTouches,C(this.Vf));if(e===null||(this.Df=Ke(t),this.yf!==null)||this.Pf)return;this.Tf=!0;const s=this.Nf(jt(e),C(this.vf)),{iv:n,nv:r,Ef:o}=s;if(this.pf||!(o<5)){if(!this.pf){const l=.5*n,h=r>=l&&!this.cn.sv(),c=l>r&&!this.cn.ev();h||c||(this.Pf=!0),this.pf=!0,this.bf=!0,this.Xf(),this.Hf()}if(!this.Pf){const l=this.Lf(t,e);this.Ff(l,this.jf.rv),ee(t)}}}hv(t){if(t.button!==0)return;const e=this.Nf(jt(t),C(this.ff)),{Ef:s}=e;if(s>=5&&(this.mf=!0,this.qf()),this.mf){const n=this.Lf(t);this.$f(n,this.jf.lv)}}Nf(t,e){const s=Math.abs(e.nt-t.nt),n=Math.abs(e.st-t.st);return{iv:s,nv:n,Ef:s+n}}av(t){let e=qs(t.changedTouches,C(this.Vf));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.Vf=null,this.Df=Ke(t),this.Xf(),this.vf=null,this.kf&&(this.kf(),this.kf=null);const s=this.Lf(t,e);if(this.Ff(s,this.jf.ov),++this.af,this._f&&this.af>1){const{Ef:n}=this.Nf(jt(e),this.uf);n<30&&!this.bf&&this.Ff(s,this.jf.Wf),this.Hf()}else this.bf||(this.Ff(s,this.jf._v),this.jf._v&&ee(t));this.af===0&&ee(t),t.touches.length===0&&this.df&&(this.df=!1,ee(t))}Af(t){if(t.button!==0)return;const e=this.Lf(t);if(this.ff=null,this.Rf=!1,this.Sf&&(this.Sf(),this.Sf=null),Gn()&&this.Yf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Bf),!this.zf(t))if(this.$f(e,this.jf.uv),++this.rf,this.hf&&this.rf>1){const{Ef:s}=this.Nf(jt(t),this.lf);s<5&&!this.mf&&this.$f(e,this.jf.Uf),this.qf()}else this.mf||this.$f(e,this.jf.cv)}Xf(){this.cf!==null&&(clearTimeout(this.cf),this.cf=null)}dv(t){if(this.Vf!==null)return;const e=t.changedTouches[0];this.Vf=e.identifier,this.Df=Ke(t);const s=this.Yf.ownerDocument.documentElement;this.bf=!1,this.pf=!1,this.Pf=!1,this.vf=jt(e),this.kf&&(this.kf(),this.kf=null);{const r=this.tv.bind(this),o=this.av.bind(this);this.kf=()=>{s.removeEventListener("touchmove",r),s.removeEventListener("touchend",o)},s.addEventListener("touchmove",r,{passive:!1}),s.addEventListener("touchend",o,{passive:!1}),this.Xf(),this.cf=setTimeout(this.fv.bind(this,t),240)}const n=this.Lf(t,e);this.Ff(n,this.jf.vv),this._f||(this.af=0,this._f=setTimeout(this.Hf.bind(this),500),this.uf=jt(e))}pv(t){if(t.button!==0)return;const e=this.Yf.ownerDocument.documentElement;Gn()&&e.addEventListener("mouseleave",this.Bf),this.mf=!1,this.ff=jt(t),this.Sf&&(this.Sf(),this.Sf=null);{const n=this.hv.bind(this),r=this.Af.bind(this);this.Sf=()=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}if(this.Rf=!0,this.zf(t))return;const s=this.Lf(t);this.$f(s,this.jf.mv),this.hf||(this.rf=0,this.hf=setTimeout(this.qf.bind(this),500),this.lf=jt(t))}Zf(){this.Yf.addEventListener("mouseenter",this.Kf.bind(this)),this.Yf.addEventListener("touchcancel",this.Xf.bind(this));{const t=this.Yf.ownerDocument,e=s=>{this.jf.bv&&(s.composed&&this.Yf.contains(s.composedPath()[0])||s.target&&this.Yf.contains(s.target)||this.jf.bv())};this.gf=()=>{t.removeEventListener("touchstart",e)},this.wf=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}Bs()&&(this.Mf=()=>{this.Yf.removeEventListener("dblclick",this.If)},this.Yf.addEventListener("dblclick",this.If)),this.Yf.addEventListener("mouseleave",this.wv.bind(this)),this.Yf.addEventListener("touchstart",this.dv.bind(this),{passive:!0}),Tu(this.Yf),this.Yf.addEventListener("mousedown",this.pv.bind(this)),this.gv(),this.Yf.addEventListener("touchmove",()=>{},{passive:!1})}gv(){this.jf.Mv===void 0&&this.jf.xv===void 0&&this.jf.Sv===void 0||(this.Yf.addEventListener("touchstart",t=>this.kv(t.touches),{passive:!0}),this.Yf.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.yf!==null&&this.jf.xv!==void 0){const e=Zn(t.touches[0],t.touches[1])/this.Cf;this.jf.xv(this.yf,e),ee(t)}},{passive:!1}),this.Yf.addEventListener("touchend",t=>{this.kv(t.touches)}))}kv(t){t.length===1&&(this.Tf=!1),t.length!==2||this.Tf||this.df?this.yv():this.Cv(t)}Cv(t){const e=this.Yf.getBoundingClientRect()||{left:0,top:0};this.yf={nt:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,st:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Cf=Zn(t[0],t[1]),this.jf.Mv!==void 0&&this.jf.Mv(),this.Xf()}yv(){this.yf!==null&&(this.yf=null,this.jf.Sv!==void 0&&this.jf.Sv())}wv(t){if(this.xf&&this.xf(),this.zf(t)||!this.Of)return;const e=this.Lf(t);this.$f(e,this.jf.Tv),this.Of=!Bs()}fv(t){const e=qs(t.touches,C(this.Vf));if(e===null)return;const s=this.Lf(t,e);this.Ff(s,this.jf.Pv),this.bf=!0,this.df=!0}zf(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Ke(t)<this.Df+500}Ff(t,e){e&&e.call(this.jf,t)}$f(t,e){e&&e.call(this.jf,t)}Lf(t,e){const s=e||t,n=this.Yf.getBoundingClientRect()||{left:0,top:0};return{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,screenX:s.screenX,screenY:s.screenY,localX:s.clientX-n.left,localY:s.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Rv:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Dv:t.type,Vv:s.target,Ov:t.view,Bv:()=>{t.type!=="touchstart"&&ee(t)}}}}function Zn(i,t){const e=i.clientX-t.clientX,s=i.clientY-t.clientY;return Math.sqrt(e*e+s*s)}function ee(i){i.cancelable&&i.preventDefault()}function jt(i){return{nt:i.pageX,st:i.pageY}}function Ke(i){return i.timeStamp||performance.now()}function qs(i,t){for(let e=0;e<i.length;++e)if(i[e].identifier===t)return i[e];return null}function He(i){return{jc:i.jc,Av:{wr:i.Iv.externalId},zv:i.Iv.cursorStyle}}function Fu(i,t,e){for(const s of i){const n=s.gt();if(n!==null&&n.br){const r=n.br(t,e);if(r!==null)return{Ov:s,Av:r}}}return null}function Qs(i,t){return e=>{var s,n,r,o;return((n=(s=e.Dt())===null||s===void 0?void 0:s.Ta())!==null&&n!==void 0?n:"")!==t?[]:(o=(r=e.ca)===null||r===void 0?void 0:r.call(e,i))!==null&&o!==void 0?o:[]}}function Yn(i,t,e,s){if(!i.length)return;let n=0;const r=e/2,o=i[0].At(s,!0);let l=t===1?r-(i[0].Vi()-o/2):i[0].Vi()-o/2-r;l=Math.max(0,l);for(let h=1;h<i.length;h++){const c=i[h],u=i[h-1],d=u.At(s,!1),f=c.Vi(),b=u.Vi();if(t===1?f>b-d:f<b+d){const m=b-d*t;c.Oi(m);const p=m-t*d/2;if((t===1?p<0:p>e)&&l>0){const x=t===1?-1-p:p-e,w=Math.min(x,l);for(let _=n;_<i.length;_++)i[_].Oi(i[_].Vi()+t*w);l-=w}}else n=h,l=t===1?b-d-f:f-(b+d)}}class tr{constructor(t,e,s,n){this.Li=null,this.Lv=null,this.Ev=!1,this.Nv=new ke(200),this.Jr=null,this.Fv=0,this.Wv=!1,this.jv=()=>{this.Wv||this.tn.Hv().$t().$h()},this.$v=()=>{this.Wv||this.tn.Hv().$t().$h()},this.tn=t,this.cn=e,this.So=e.layout,this.Vc=s,this.Uv=n==="left",this.qv=Qs("normal",n),this.Yv=Qs("top",n),this.Zv=Qs("bottom",n),this.Xv=document.createElement("div"),this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Xv.style.width="25px",this.Xv.style.left="0",this.Xv.style.position="relative",this.Kv=Xt(this.Xv,J({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const r=this.Kv.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Gv=Xt(this.Xv,J({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const o=this.Gv.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const l={mv:this.Jv.bind(this),vv:this.Jv.bind(this),lv:this.Qv.bind(this),rv:this.Qv.bind(this),bv:this.tp.bind(this),uv:this.ip.bind(this),ov:this.ip.bind(this),Uf:this.np.bind(this),Wf:this.np.bind(this),Jf:this.sp.bind(this),Tv:this.ep.bind(this)};this.rp=new Fi(this.Gv.canvasElement,l,{sv:()=>!this.cn.handleScroll.vertTouchDrag,ev:()=>!0})}S(){this.rp.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Gt(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Gt(this.Kv.canvasElement),this.Kv.dispose(),this.Li!==null&&this.Li.Xo().p(this),this.Li=null}hp(){return this.Xv}P(){return this.So.fontSize}lp(){const t=this.Vc.W();return this.Jr!==t.R&&(this.Nv.ir(),this.Jr=t.R),t}ap(){if(this.Li===null)return 0;let t=0;const e=this.lp(),s=C(this.Kv.canvasElement.getContext("2d"));s.save();const n=this.Li.ja();s.font=this.op(),n.length>0&&(t=Math.max(this.Nv.xi(s,n[0].no),this.Nv.xi(s,n[n.length-1].no)));const r=this._p();for(let h=r.length;h--;){const c=this.Nv.xi(s,r[h].Kt());c>t&&(t=c)}const o=this.Li.Ct();if(o!==null&&this.Lv!==null){const h=this.Li.pn(1,o),c=this.Li.pn(this.Lv.height-2,o);t=Math.max(t,this.Nv.xi(s,this.Li.Fi(Math.floor(Math.min(h,c))+.11111111111111,o)),this.Nv.xi(s,this.Li.Fi(Math.ceil(Math.max(h,c))-.11111111111111,o)))}s.restore();const l=t||34;return di(Math.ceil(e.C+e.T+e.A+e.I+5+l))}up(t){this.Lv!==null&&Qt(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`)}cp(){return C(this.Lv).width}Gi(t){this.Li!==t&&(this.Li!==null&&this.Li.Xo().p(this),this.Li=t,t.Xo().l(this.do.bind(this),this))}Dt(){return this.Li}ir(){const t=this.tn.dp();this.tn.Hv().$t().L_(t,C(this.Dt()))}fp(t){if(this.Lv===null)return;if(t!==1){this.vp(),this.Kv.applySuggestedBitmapSize();const s=Ht(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.pp(n),this.Ae(n)}),this.tn.mp(s,this.Zv),this.bp(s),this.tn.mp(s,this.qv),this.wp(s))}this.Gv.applySuggestedBitmapSize();const e=Ht(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.gp(e),this.tn.mp(e,this.Yv))}Mp(){return this.Kv.bitmapSize}xp(t,e,s){const n=this.Mp();n.width>0&&n.height>0&&t.drawImage(this.Kv.canvasElement,e,s)}bt(){var t;(t=this.Li)===null||t===void 0||t.ja()}Jv(t){if(this.Li===null||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),s=this.tn.dp();this.Ev=!0,e.D_(s,this.Li,t.localY)}Qv(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),s=this.tn.dp(),n=this.Li;e.V_(s,n,t.localY)}tp(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const t=this.tn.Hv().$t(),e=this.tn.dp(),s=this.Li;this.Ev&&(this.Ev=!1,t.O_(e,s))}ip(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),s=this.tn.dp();this.Ev=!1,e.O_(s,this.Li)}np(t){this.cn.handleScale.axisDoubleClickReset.price&&this.ir()}sp(t){this.Li!==null&&(!this.tn.Hv().$t().W().handleScale.axisPressedMouseMove.price||this.Li.gh()||this.Li.Vo()||this.Sp(1))}ep(t){this.Sp(0)}_p(){const t=[],e=this.Li===null?void 0:this.Li;return(s=>{for(let n=0;n<s.length;++n){const r=s[n].Rn(this.tn.dp(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.tn.dp().$o()),t}pp({context:t,bitmapSize:e}){const{width:s,height:n}=e,r=this.tn.dp().$t(),o=r.q(),l=r.md();o===l?Ss(t,0,0,s,n,o):po(t,0,0,s,n,o,l)}Ae({context:t,bitmapSize:e,horizontalPixelRatio:s}){if(this.Lv===null||this.Li===null||!this.Li.W().borderVisible)return;t.fillStyle=this.Li.W().borderColor;const n=Math.max(1,Math.floor(this.lp().C*s));let r;r=this.Uv?e.width-n:0,t.fillRect(r,0,n,e.height)}bp(t){if(this.Lv===null||this.Li===null)return;const e=this.Li.ja(),s=this.Li.W(),n=this.lp(),r=this.Uv?this.Lv.width-n.T:0;s.borderVisible&&s.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:l,verticalPixelRatio:h})=>{o.fillStyle=s.borderColor;const c=Math.max(1,Math.floor(h)),u=Math.floor(.5*h),d=Math.round(n.T*l);o.beginPath();for(const f of e)o.rect(Math.floor(r*l),Math.round(f.La*h)-u,d,c);o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{var l;o.font=this.op(),o.fillStyle=(l=s.textColor)!==null&&l!==void 0?l:this.So.textColor,o.textAlign=this.Uv?"right":"left",o.textBaseline="middle";const h=this.Uv?Math.round(r-n.A):Math.round(r+n.T+n.A),c=e.map(u=>this.Nv.Mi(o,u.no));for(let u=e.length;u--;){const d=e[u];o.fillText(d.no,h,d.La+c[u])}})}vp(){if(this.Lv===null||this.Li===null)return;const t=[],e=this.Li.$o().slice(),s=this.tn.dp(),n=this.lp();this.Li===s.vr()&&this.tn.dp().$o().forEach(o=>{s.dr(o)&&e.push(o)});const r=this.Li;e.forEach(o=>{o.Rn(s,r).forEach(l=>{l.Oi(null),l.Bi()&&t.push(l)})}),t.forEach(o=>o.Oi(o.ki())),this.Li.W().alignLabels&&this.kp(t,n)}kp(t,e){if(this.Lv===null)return;const s=this.Lv.height/2,n=t.filter(o=>o.ki()<=s),r=t.filter(o=>o.ki()>s);n.sort((o,l)=>l.ki()-o.ki()),r.sort((o,l)=>o.ki()-l.ki());for(const o of t){const l=Math.floor(o.At(e)/2),h=o.ki();h>-l&&h<l&&o.Oi(l),h>this.Lv.height-l&&h<this.Lv.height+l&&o.Oi(this.Lv.height-l)}Yn(n,1,this.Lv.height,e),Yn(r,-1,this.Lv.height,e)}wp(t){if(this.Lv===null)return;const e=this._p(),s=this.lp(),n=this.Uv?"right":"left";e.forEach(r=>{r.Ai()&&r.gt(C(this.Li)).X(t,s,this.Nv,n)})}gp(t){if(this.Lv===null||this.Li===null)return;const e=this.tn.Hv().$t(),s=[],n=this.tn.dp(),r=e.Yc().Rn(n,this.Li);r.length&&s.push(r);const o=this.lp(),l=this.Uv?"right":"left";s.forEach(h=>{h.forEach(c=>{c.gt(C(this.Li)).X(t,o,this.Nv,l)})})}Sp(t){this.Xv.style.cursor=t===1?"ns-resize":"default"}do(){const t=this.ap();this.Fv<t&&this.tn.Hv().$t().Xl(),this.Fv=t}op(){return le(this.So.fontSize,this.So.fontFamily)}}function zu(i,t){var e,s;return(s=(e=i._a)===null||e===void 0?void 0:e.call(i,t))!==null&&s!==void 0?s:[]}function Je(i,t){var e,s;return(s=(e=i.Pn)===null||e===void 0?void 0:e.call(i,t))!==null&&s!==void 0?s:[]}function $u(i,t){var e,s;return(s=(e=i.Ji)===null||e===void 0?void 0:e.call(i,t))!==null&&s!==void 0?s:[]}function Au(i,t){var e,s;return(s=(e=i.la)===null||e===void 0?void 0:e.call(i,t))!==null&&s!==void 0?s:[]}class zi{constructor(t,e){this.Lv=J({width:0,height:0}),this.yp=null,this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=!1,this.Dp=new tt,this.Vp=new tt,this.Op=0,this.Bp=!1,this.Ap=null,this.Ip=!1,this.zp=null,this.Lp=null,this.Wv=!1,this.jv=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.$v=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.Jd=t,this.Ep=e,this.Ep.F_().l(this.Np.bind(this),this,!0),this.Fp=document.createElement("td"),this.Fp.style.padding="0",this.Fp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Fp.appendChild(s),this.Kv=Xt(s,J({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const n=this.Kv.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Gv=Xt(s,J({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const r=this.Gv.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Hp=document.createElement("tr"),this.Hp.appendChild(this.Wp),this.Hp.appendChild(this.Fp),this.Hp.appendChild(this.jp),this.$p(),this.rp=new Fi(this.Gv.canvasElement,this,{sv:()=>this.Ap===null&&!this.Jd.W().handleScroll.vertTouchDrag,ev:()=>this.Ap===null&&!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.yp!==null&&this.yp.S(),this.Cp!==null&&this.Cp.S(),this.Tp=null,this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Gt(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Gt(this.Kv.canvasElement),this.Kv.dispose(),this.Ep!==null&&this.Ep.F_().p(this),this.rp.S()}dp(){return C(this.Ep)}Up(t){var e,s;this.Ep!==null&&this.Ep.F_().p(this),this.Ep=t,this.Ep!==null&&this.Ep.F_().l(zi.prototype.Np.bind(this),this,!0),this.$p(),this.Jd.qp().indexOf(this)===this.Jd.qp().length-1?(this.Tp=(e=this.Tp)!==null&&e!==void 0?e:new Ou(this.Fp,this.Jd),this.Tp.bt()):((s=this.Tp)===null||s===void 0||s.tf(),this.Tp=null)}Hv(){return this.Jd}hp(){return this.Hp}$p(){if(this.Ep!==null&&(this.Yp(),this.$i().wt().length!==0)){if(this.yp!==null){const t=this.Ep.P_();this.yp.Gi(C(t))}if(this.Cp!==null){const t=this.Ep.R_();this.Cp.Gi(C(t))}}}Zp(){this.yp!==null&&this.yp.bt(),this.Cp!==null&&this.Cp.bt()}g_(){return this.Ep!==null?this.Ep.g_():0}M_(t){this.Ep&&this.Ep.M_(t)}Jf(t){if(!this.Ep)return;this.Xp();const e=t.localX,s=t.localY;this.Kp(e,s,t)}mv(t){this.Xp(),this.Gp(),this.Kp(t.localX,t.localY,t)}Qf(t){var e;if(!this.Ep)return;this.Xp();const s=t.localX,n=t.localY;this.Kp(s,n,t);const r=this.br(s,n);this.Jd.Jp((e=r==null?void 0:r.zv)!==null&&e!==void 0?e:null),this.$i().Wc(r&&{jc:r.jc,Av:r.Av})}cv(t){this.Ep!==null&&(this.Xp(),this.Qp(t))}Uf(t){this.Ep!==null&&this.tm(this.Vp,t)}Wf(t){this.Uf(t)}lv(t){this.Xp(),this.im(t),this.Kp(t.localX,t.localY,t)}uv(t){this.Ep!==null&&(this.Xp(),this.Bp=!1,this.nm(t))}_v(t){this.Ep!==null&&this.Qp(t)}Pv(t){if(this.Bp=!0,this.Ap===null){const e={x:t.localX,y:t.localY};this.sm(e,e,t)}}Tv(t){this.Ep!==null&&(this.Xp(),this.Ep.$t().Wc(null),this.rm())}hm(){return this.Dp}lm(){return this.Vp}Mv(){this.Op=1,this.$i().Un()}xv(t,e){if(!this.Jd.W().handleScale.pinch)return;const s=5*(e-this.Op);this.Op=e,this.$i().Jc(t.nt,s)}vv(t){this.Bp=!1,this.Ip=this.Ap!==null,this.Gp();const e=this.$i().Yc();this.Ap!==null&&e.yt()&&(this.zp={x:e.Yt(),y:e.Zt()},this.Ap={x:t.localX,y:t.localY})}rv(t){if(this.Ep===null)return;const e=t.localX,s=t.localY;if(this.Ap===null)this.im(t);else{this.Ip=!1;const n=C(this.zp),r=n.x+(e-this.Ap.x),o=n.y+(s-this.Ap.y);this.Kp(r,o,t)}}ov(t){this.Hv().W().trackingMode.exitMode===0&&(this.Ip=!0),this.am(),this.nm(t)}br(t,e){const s=this.Ep;return s===null?null:function(n,r,o){const l=n.$o(),h=function(c,u,d){var f,b;let m,p;for(const _ of c){const N=(b=(f=_.fa)===null||f===void 0?void 0:f.call(_,u,d))!==null&&b!==void 0?b:[];for(const g of N)x=g.zOrder,(!(w=m==null?void 0:m.zOrder)||x==="top"&&w!=="top"||x==="normal"&&w==="bottom")&&(m=g,p=_)}var x,w;return m&&p?{Iv:m,jc:p}:null}(l,r,o);if((h==null?void 0:h.Iv.zOrder)==="top")return He(h);for(const c of l){if(h&&h.jc===c&&h.Iv.zOrder!=="bottom"&&!h.Iv.isBackground)return He(h);const u=Fu(c.Pn(n),r,o);if(u!==null)return{jc:c,Ov:u.Ov,Av:u.Av};if(h&&h.jc===c&&h.Iv.zOrder!=="bottom"&&h.Iv.isBackground)return He(h)}return h!=null&&h.Iv?He(h):null}(s,t,e)}om(t,e){C(e==="left"?this.yp:this.Cp).up(J({width:t,height:this.Lv.height}))}_m(){return this.Lv}up(t){Qt(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Fp.style.width=t.width+"px",this.Fp.style.height=t.height+"px")}um(){const t=C(this.Ep);t.T_(t.P_()),t.T_(t.R_());for(const e of t.Oa())if(t.dr(e)){const s=e.Dt();s!==null&&t.T_(s),e.Vn()}}Mp(){return this.Kv.bitmapSize}xp(t,e,s){const n=this.Mp();n.width>0&&n.height>0&&t.drawImage(this.Kv.canvasElement,e,s)}fp(t){if(t===0||this.Ep===null)return;if(t>1&&this.um(),this.yp!==null&&this.yp.fp(t),this.Cp!==null&&this.Cp.fp(t),t!==1){this.Kv.applySuggestedBitmapSize();const s=Ht(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.pp(n)}),this.Ep&&(this.dm(s,zu),this.fm(s),this.vm(s),this.dm(s,Je),this.dm(s,$u)))}this.Gv.applySuggestedBitmapSize();const e=Ht(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.pm(e),this.dm(e,Au))}bm(){return this.yp}wm(){return this.Cp}mp(t,e){this.dm(t,e)}Np(){this.Ep!==null&&this.Ep.F_().p(this),this.Ep=null}Qp(t){this.tm(this.Dp,t)}tm(t,e){const s=e.localX,n=e.localY;t.M()&&t.m(this.$i().St().Eu(s),{x:s,y:n},e)}pp({context:t,bitmapSize:e}){const{width:s,height:n}=e,r=this.$i(),o=r.q(),l=r.md();o===l?Ss(t,0,0,s,n,l):po(t,0,0,s,n,o,l)}fm(t){const e=C(this.Ep).W_().Uh().gt();e!==null&&e.X(t,!1)}vm(t){const e=this.$i().qc();this.gm(t,Je,fi,e),this.gm(t,Je,is,e)}pm(t){this.gm(t,Je,is,this.$i().Yc())}dm(t,e){const s=C(this.Ep).$o();for(const n of s)this.gm(t,e,fi,n);for(const n of s)this.gm(t,e,is,n)}gm(t,e,s,n){const r=C(this.Ep),o=r.$t().Fc(),l=o!==null&&o.jc===n,h=o!==null&&l&&o.Av!==void 0?o.Av.gr:void 0;mi(e,c=>s(c,t,l,h),n,r)}Yp(){if(this.Ep===null)return;const t=this.Jd,e=this.Ep.P_().W().visible,s=this.Ep.R_().W().visible;e||this.yp===null||(this.Wp.removeChild(this.yp.hp()),this.yp.S(),this.yp=null),s||this.Cp===null||(this.jp.removeChild(this.Cp.hp()),this.Cp.S(),this.Cp=null);const n=t.$t()._d();e&&this.yp===null&&(this.yp=new tr(this,t.W(),n,"left"),this.Wp.appendChild(this.yp.hp())),s&&this.Cp===null&&(this.Cp=new tr(this,t.W(),n,"right"),this.jp.appendChild(this.Cp.hp()))}Mm(t){return t.Rv&&this.Bp||this.Ap!==null}xm(t){return Math.max(0,Math.min(t,this.Lv.width-1))}Sm(t){return Math.max(0,Math.min(t,this.Lv.height-1))}Kp(t,e,s){this.$i().hd(this.xm(t),this.Sm(e),s,C(this.Ep))}rm(){this.$i().ad()}am(){this.Ip&&(this.Ap=null,this.rm())}sm(t,e,s){this.Ap=t,this.Ip=!1,this.Kp(e.x,e.y,s);const n=this.$i().Yc();this.zp={x:n.Yt(),y:n.Zt()}}$i(){return this.Jd.$t()}nm(t){if(!this.Rp)return;const e=this.$i(),s=this.dp();if(e.I_(s,s.vn()),this.Pp=null,this.Rp=!1,e.sd(),this.Lp!==null){const n=performance.now(),r=e.St();this.Lp.Dr(r.ju(),n),this.Lp.Ju(n)||e.Zn(this.Lp)}}Xp(){this.Ap=null}Gp(){if(this.Ep){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)C(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Ep.vn().Ni()&&this.$i().St().Ni()}}im(t){if(this.Ep===null)return;const e=this.$i(),s=e.St();if(s.Ni())return;const n=this.Jd.W(),r=n.handleScroll,o=n.kineticScroll;if((!r.pressedMouseMove||t.Rv)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Rv))return;const l=this.Ep.vn(),h=performance.now();if(this.Pp!==null||this.Mm(t)||(this.Pp={x:t.clientX,y:t.clientY,Vd:h,km:t.localX,ym:t.localY}),this.Pp!==null&&!this.Rp&&(this.Pp.x!==t.clientX||this.Pp.y!==t.clientY)){if(t.Rv&&o.touch||!t.Rv&&o.mouse){const c=s.he();this.Lp=new Pu(.2/c,7/c,.997,15/c),this.Lp.qd(s.ju(),this.Pp.Vd)}else this.Lp=null;l.Ni()||e.B_(this.Ep,l,t.localY),e.td(t.localX),this.Rp=!0}this.Rp&&(l.Ni()||e.A_(this.Ep,l,t.localY),e.nd(t.localX),this.Lp!==null&&this.Lp.qd(s.ju(),h))}}class er{constructor(t,e,s,n,r){this.ft=!0,this.Lv=J({width:0,height:0}),this.jv=()=>this.fp(3),this.Uv=t==="left",this.Vc=s._d,this.cn=e,this.Cm=n,this.Tm=r,this.Xv=document.createElement("div"),this.Xv.style.width="25px",this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Kv=Xt(this.Xv,J({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv)}S(){this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Gt(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Xv}_m(){return this.Lv}up(t){Qt(this.Lv,t)||(this.Lv=t,this.Kv.resizeCanvasElement(t),this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.ft=!0)}fp(t){if(t<3&&!this.ft||this.Lv.width===0||this.Lv.height===0)return;this.ft=!1,this.Kv.applySuggestedBitmapSize();const e=Ht(this.Kv);e!==null&&e.useBitmapCoordinateSpace(s=>{this.pp(s),this.Ae(s)})}Mp(){return this.Kv.bitmapSize}xp(t,e,s){const n=this.Mp();n.width>0&&n.height>0&&t.drawImage(this.Kv.canvasElement,e,s)}Ae({context:t,bitmapSize:e,horizontalPixelRatio:s,verticalPixelRatio:n}){if(!this.Cm())return;t.fillStyle=this.cn.timeScale.borderColor;const r=Math.floor(this.Vc.W().C*s),o=Math.floor(this.Vc.W().C*n),l=this.Uv?e.width-r:0;t.fillRect(l,0,r,o)}pp({context:t,bitmapSize:e}){Ss(t,0,0,e.width,e.height,this.Tm())}}function $i(i){return t=>{var e,s;return(s=(e=t.da)===null||e===void 0?void 0:e.call(t,i))!==null&&s!==void 0?s:[]}}const Du=$i("normal"),Iu=$i("top"),Vu=$i("bottom");class Bu{constructor(t,e){this.Pm=null,this.Rm=null,this.k=null,this.Dm=!1,this.Lv=J({width:0,height:0}),this.Vm=new tt,this.Nv=new ke(5),this.Wv=!1,this.jv=()=>{this.Wv||this.Jd.$t().$h()},this.$v=()=>{this.Wv||this.Jd.$t().$h()},this.Jd=t,this.U_=e,this.cn=t.W().layout,this.Zd=document.createElement("tr"),this.Om=document.createElement("td"),this.Om.style.padding="0",this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Xv=document.createElement("td"),this.Xv.style.height="25px",this.Xv.style.padding="0",this.Am=document.createElement("div"),this.Am.style.width="100%",this.Am.style.height="100%",this.Am.style.position="relative",this.Am.style.overflow="hidden",this.Xv.appendChild(this.Am),this.Kv=Xt(this.Am,J({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const s=this.Kv.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Gv=Xt(this.Am,J({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const n=this.Gv.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.Zd.appendChild(this.Om),this.Zd.appendChild(this.Xv),this.Zd.appendChild(this.Bm),this.Im(),this.Jd.$t().w_().l(this.Im.bind(this),this),this.rp=new Fi(this.Gv.canvasElement,this,{sv:()=>!0,ev:()=>!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.rp.S(),this.Pm!==null&&this.Pm.S(),this.Rm!==null&&this.Rm.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Gt(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Gt(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Zd}zm(){return this.Pm}Lm(){return this.Rm}mv(t){if(this.Dm)return;this.Dm=!0;const e=this.Jd.$t();!e.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&e.Gc(t.localX)}vv(t){this.mv(t)}bv(){const t=this.Jd.$t();!t.St().Ni()&&this.Dm&&(this.Dm=!1,this.Jd.W().handleScale.axisPressedMouseMove.time&&t.rd())}lv(t){const e=this.Jd.$t();!e.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&e.ed(t.localX)}rv(t){this.lv(t)}uv(){this.Dm=!1;const t=this.Jd.$t();t.St().Ni()&&!this.Jd.W().handleScale.axisPressedMouseMove.time||t.rd()}ov(){this.uv()}Uf(){this.Jd.W().handleScale.axisDoubleClickReset.time&&this.Jd.$t().Kn()}Wf(){this.Uf()}Jf(){this.Jd.$t().W().handleScale.axisPressedMouseMove.time&&this.Sp(1)}Tv(){this.Sp(0)}_m(){return this.Lv}Em(){return this.Vm}Nm(t,e,s){Qt(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.Vm.m(t)),this.Pm!==null&&this.Pm.up(J({width:e,height:t.height})),this.Rm!==null&&this.Rm.up(J({width:s,height:t.height}))}Fm(){const t=this.Wm();return Math.ceil(t.C+t.T+t.P+t.L+t.B+t.jm)}bt(){this.Jd.$t().St().ja()}Mp(){return this.Kv.bitmapSize}xp(t,e,s){const n=this.Mp();n.width>0&&n.height>0&&t.drawImage(this.Kv.canvasElement,e,s)}fp(t){if(t===0)return;if(t!==1){this.Kv.applySuggestedBitmapSize();const s=Ht(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.pp(n),this.Ae(n),this.Hm(s,Vu)}),this.bp(s),this.Hm(s,Du)),this.Pm!==null&&this.Pm.fp(t),this.Rm!==null&&this.Rm.fp(t)}this.Gv.applySuggestedBitmapSize();const e=Ht(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.$m([...this.Jd.$t().wt(),this.Jd.$t().Yc()],e),this.Hm(e,Iu))}Hm(t,e){const s=this.Jd.$t().wt();for(const n of s)mi(e,r=>fi(r,t,!1,void 0),n,void 0);for(const n of s)mi(e,r=>is(r,t,!1,void 0),n,void 0)}pp({context:t,bitmapSize:e}){Ss(t,0,0,e.width,e.height,this.Jd.$t().md())}Ae({context:t,bitmapSize:e,verticalPixelRatio:s}){if(this.Jd.W().timeScale.borderVisible){t.fillStyle=this.Um();const n=Math.max(1,Math.floor(this.Wm().C*s));t.fillRect(0,0,e.width,n)}}bp(t){const e=this.Jd.$t().St(),s=e.ja();if(!s||s.length===0)return;const n=this.U_.maxTickMarkWeight(s),r=this.Wm(),o=e.W();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:h,verticalPixelRatio:c})=>{l.strokeStyle=this.Um(),l.fillStyle=this.Um();const u=Math.max(1,Math.floor(h)),d=Math.floor(.5*h);l.beginPath();const f=Math.round(r.T*c);for(let b=s.length;b--;){const m=Math.round(s[b].coord*h);l.rect(m-d,0,u,f)}l.fill()}),t.useMediaCoordinateSpace(({context:l})=>{const h=r.C+r.T+r.L+r.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.$(),l.font=this.op();for(const c of s)if(c.weight<n){const u=c.needAlignCoordinate?this.qm(l,c.coord,c.label):c.coord;l.fillText(c.label,u,h)}this.Jd.W().timeScale.allowBoldLabels&&(l.font=this.Ym());for(const c of s)if(c.weight>=n){const u=c.needAlignCoordinate?this.qm(l,c.coord,c.label):c.coord;l.fillText(c.label,u,h)}})}qm(t,e,s){const n=this.Nv.xi(t,s),r=n/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+n>this.Lv.width&&(e-=Math.abs(this.Lv.width-(o+n))),e}$m(t,e){const s=this.Wm();for(const n of t)for(const r of n.Qi())r.gt().X(e,s)}Um(){return this.Jd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}op(){return le(this.j(),this.cn.fontFamily)}Ym(){return le(this.j(),this.cn.fontFamily,"bold")}Wm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new ke,jm:0});const t=this.k,e=this.op();if(t.R!==e){const s=this.j();t.P=s,t.R=e,t.L=3*s/12,t.B=3*s/12,t.ji=9*s/12,t.N=0,t.jm=4*s/12,t.Wi.ir()}return this.k}Sp(t){this.Xv.style.cursor=t===1?"ew-resize":"default"}Im(){const t=this.Jd.$t(),e=t.W();e.leftPriceScale.visible||this.Pm===null||(this.Om.removeChild(this.Pm.hp()),this.Pm.S(),this.Pm=null),e.rightPriceScale.visible||this.Rm===null||(this.Bm.removeChild(this.Rm.hp()),this.Rm.S(),this.Rm=null);const s={_d:this.Jd.$t()._d()},n=()=>e.leftPriceScale.borderVisible&&t.St().W().borderVisible,r=()=>t.md();e.leftPriceScale.visible&&this.Pm===null&&(this.Pm=new er("left",e,s,n,r),this.Om.appendChild(this.Pm.hp())),e.rightPriceScale.visible&&this.Rm===null&&(this.Rm=new er("right",e,s,n,r),this.Bm.appendChild(this.Rm.hp()))}}const Uu=!!he&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(i=>i.brand.includes("Chromium"))&&!!he&&(!((Ks=navigator==null?void 0:navigator.userAgentData)===null||Ks===void 0)&&Ks.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var Ks;class Wu{constructor(t,e,s){var n;this.Zm=[],this.Xm=0,this.ro=0,this.o_=0,this.Km=0,this.Gm=0,this.Jm=null,this.Qm=!1,this.Dp=new tt,this.Vp=new tt,this.Pc=new tt,this.tb=null,this.ib=null,this.Gd=t,this.cn=e,this.U_=s,this.Zd=document.createElement("div"),this.Zd.classList.add("tv-lightweight-charts"),this.Zd.style.overflow="hidden",this.Zd.style.direction="ltr",this.Zd.style.width="100%",this.Zd.style.height="100%",(n=this.Zd).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.nb=document.createElement("table"),this.nb.setAttribute("cellspacing","0"),this.Zd.appendChild(this.nb),this.sb=this.eb.bind(this),Hs(this.cn)&&this.rb(!0),this.$i=new ku(this.Dc.bind(this),this.cn,s),this.$t().Zc().l(this.hb.bind(this),this),this.lb=new Bu(this,this.U_),this.nb.appendChild(this.lb.hp());const r=e.autoSize&&this.ab();let o=this.cn.width,l=this.cn.height;if(r||o===0||l===0){const h=t.getBoundingClientRect();o=o||h.width,l=l||h.height}this.ob(o,l),this._b(),t.appendChild(this.Zd),this.ub(),this.$i.St().sc().l(this.$i.Xl.bind(this.$i),this),this.$i.w_().l(this.$i.Xl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}qp(){return this.Zm}cb(){return this.lb}S(){this.rb(!1),this.Xm!==0&&window.cancelAnimationFrame(this.Xm),this.$i.Zc().p(this),this.$i.St().sc().p(this),this.$i.w_().p(this),this.$i.S();for(const t of this.Zm)this.nb.removeChild(t.hp()),t.hm().p(this),t.lm().p(this),t.S();this.Zm=[],C(this.lb).S(),this.Zd.parentElement!==null&&this.Zd.parentElement.removeChild(this.Zd),this.Pc.S(),this.Dp.S(),this.Vp.S(),this.fb()}ob(t,e,s=!1){if(this.ro===e&&this.o_===t)return;const n=function(l){const h=Math.floor(l.width),c=Math.floor(l.height);return J({width:h-h%2,height:c-c%2})}(J({width:t,height:e}));this.ro=n.height,this.o_=n.width;const r=this.ro+"px",o=this.o_+"px";C(this.Zd).style.height=r,C(this.Zd).style.width=o,this.nb.style.height=r,this.nb.style.width=o,s?this.pb(ot.es(),performance.now()):this.$i.Xl()}fp(t){t===void 0&&(t=ot.es());for(let e=0;e<this.Zm.length;e++)this.Zm[e].fp(t.Hn(e).Fn);this.cn.timeScale.visible&&this.lb.fp(t.jn())}Hh(t){const e=Hs(this.cn);this.$i.Hh(t);const s=Hs(this.cn);s!==e&&this.rb(s),this.ub(),this.mb(t)}hm(){return this.Dp}lm(){return this.Vp}Zc(){return this.Pc}bb(){this.Jm!==null&&(this.pb(this.Jm,performance.now()),this.Jm=null);const t=this.wb(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const s=C(e.getContext("2d"));return this.wb(s),e}gb(t){return t==="left"&&!this.Mb()||t==="right"&&!this.xb()||this.Zm.length===0?0:C(t==="left"?this.Zm[0].bm():this.Zm[0].wm()).cp()}Sb(){return this.cn.autoSize&&this.tb!==null}kb(){return this.Zd}Jp(t){this.ib=t,this.ib?this.kb().style.setProperty("cursor",t):this.kb().style.removeProperty("cursor")}yb(){return this.ib}Cb(){return ut(this.Zm[0])._m()}mb(t){(t.autoSize!==void 0||!this.tb||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.tb&&this.ab(),t.autoSize===!1&&this.tb!==null&&this.fb(),t.autoSize||t.width===void 0&&t.height===void 0||this.ob(t.width||this.o_,t.height||this.ro))}wb(t){let e=0,s=0;const n=this.Zm[0],r=(l,h)=>{let c=0;for(let u=0;u<this.Zm.length;u++){const d=this.Zm[u],f=C(l==="left"?d.bm():d.wm()),b=f.Mp();t!==null&&f.xp(t,h,c),c+=b.height}};this.Mb()&&(r("left",0),e+=C(n.bm()).Mp().width);for(let l=0;l<this.Zm.length;l++){const h=this.Zm[l],c=h.Mp();t!==null&&h.xp(t,e,s),s+=c.height}e+=n.Mp().width,this.xb()&&(r("right",e),e+=C(n.wm()).Mp().width);const o=(l,h,c)=>{C(l==="left"?this.lb.zm():this.lb.Lm()).xp(C(t),h,c)};if(this.cn.timeScale.visible){const l=this.lb.Mp();if(t!==null){let h=0;this.Mb()&&(o("left",h,s),h=C(n.bm()).Mp().width),this.lb.xp(t,h,s),h+=l.width,this.xb()&&o("right",h,s)}s+=l.height}return J({width:e,height:s})}Tb(){let t=0,e=0,s=0;for(const m of this.Zm)this.Mb()&&(e=Math.max(e,C(m.bm()).ap(),this.cn.leftPriceScale.minimumWidth)),this.xb()&&(s=Math.max(s,C(m.wm()).ap(),this.cn.rightPriceScale.minimumWidth)),t+=m.g_();e=di(e),s=di(s);const n=this.o_,r=this.ro,o=Math.max(n-e-s,0),l=this.cn.timeScale.visible;let h=l?Math.max(this.lb.Fm(),this.cn.timeScale.minimumHeight):0;var c;h=(c=h)+c%2;const u=0+h,d=r<u?0:r-u,f=d/t;let b=0;for(let m=0;m<this.Zm.length;++m){const p=this.Zm[m];p.Up(this.$i.Uc()[m]);let x=0,w=0;w=m===this.Zm.length-1?d-b:Math.round(p.g_()*f),x=Math.max(w,2),b+=x,p.up(J({width:o,height:x})),this.Mb()&&p.om(e,"left"),this.xb()&&p.om(s,"right"),p.dp()&&this.$i.Xc(p.dp(),x)}this.lb.Nm(J({width:l?o:0,height:h}),l?e:0,l?s:0),this.$i.x_(o),this.Km!==e&&(this.Km=e),this.Gm!==s&&(this.Gm=s)}rb(t){t?this.Zd.addEventListener("wheel",this.sb,{passive:!1}):this.Zd.removeEventListener("wheel",this.sb)}Pb(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Uu?1/window.devicePixelRatio:1}eb(t){if(!(t.deltaX!==0&&this.cn.handleScroll.mouseWheel||t.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const e=this.Pb(t),s=e*t.deltaX/100,n=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),n!==0&&this.cn.handleScale.mouseWheel){const r=Math.sign(n)*Math.min(1,Math.abs(n)),o=t.clientX-this.Zd.getBoundingClientRect().left;this.$t().Jc(o,r)}s!==0&&this.cn.handleScroll.mouseWheel&&this.$t().Qc(-80*s)}pb(t,e){var s;const n=t.jn();n===3&&this.Rb(),n!==3&&n!==2||(this.Db(t),this.Vb(t,e),this.lb.bt(),this.Zm.forEach(r=>{r.Zp()}),((s=this.Jm)===null||s===void 0?void 0:s.jn())===3&&(this.Jm.ts(t),this.Rb(),this.Db(this.Jm),this.Vb(this.Jm,e),t=this.Jm,this.Jm=null)),this.fp(t)}Vb(t,e){for(const s of t.Qn())this.ns(s,e)}Db(t){const e=this.$i.Uc();for(let s=0;s<e.length;s++)t.Hn(s).Wn&&e[s].E_()}ns(t,e){const s=this.$i.St();switch(t.qn){case 0:s.rc();break;case 1:s.hc(t.Vt);break;case 2:s.Gn(t.Vt);break;case 3:s.Jn(t.Vt);break;case 4:s.Uu();break;case 5:t.Vt.Ju(e)||s.Jn(t.Vt.Qu(e))}}Dc(t){this.Jm!==null?this.Jm.ts(t):this.Jm=t,this.Qm||(this.Qm=!0,this.Xm=window.requestAnimationFrame(e=>{if(this.Qm=!1,this.Xm=0,this.Jm!==null){const s=this.Jm;this.Jm=null,this.pb(s,e);for(const n of s.Qn())if(n.qn===5&&!n.Vt.Ju(e)){this.$t().Zn(n.Vt);break}}}))}Rb(){this._b()}_b(){const t=this.$i.Uc(),e=t.length,s=this.Zm.length;for(let n=e;n<s;n++){const r=ut(this.Zm.pop());this.nb.removeChild(r.hp()),r.hm().p(this),r.lm().p(this),r.S()}for(let n=s;n<e;n++){const r=new zi(this,t[n]);r.hm().l(this.Ob.bind(this),this),r.lm().l(this.Bb.bind(this),this),this.Zm.push(r),this.nb.insertBefore(r.hp(),this.lb.hp())}for(let n=0;n<e;n++){const r=t[n],o=this.Zm[n];o.dp()!==r?o.Up(r):o.$p()}this.ub(),this.Tb()}Ab(t,e,s){var n;const r=new Map;t!==null&&this.$i.wt().forEach(u=>{const d=u.In().hl(t);d!==null&&r.set(u,d)});let o;if(t!==null){const u=(n=this.$i.St().Ui(t))===null||n===void 0?void 0:n.originalTime;u!==void 0&&(o=u)}const l=this.$t().Fc(),h=l!==null&&l.jc instanceof Oi?l.jc:void 0,c=l!==null&&l.Av!==void 0?l.Av.wr:void 0;return{Ib:o,se:t??void 0,zb:e??void 0,Lb:h,Eb:r,Nb:c,Fb:s??void 0}}Ob(t,e,s){this.Dp.m(()=>this.Ab(t,e,s))}Bb(t,e,s){this.Vp.m(()=>this.Ab(t,e,s))}hb(t,e,s){this.Pc.m(()=>this.Ab(t,e,s))}ub(){const t=this.cn.timeScale.visible?"":"none";this.lb.hp().style.display=t}Mb(){return this.Zm[0].dp().P_().W().visible}xb(){return this.Zm[0].dp().R_().W().visible}ab(){return"ResizeObserver"in window&&(this.tb=new ResizeObserver(t=>{const e=t.find(s=>s.target===this.Gd);e&&this.ob(e.contentRect.width,e.contentRect.height)}),this.tb.observe(this.Gd,{box:"border-box"}),!0)}fb(){this.tb!==null&&this.tb.disconnect(),this.tb=null}}function Hs(i){return!!(i.handleScroll.mouseWheel||i.handleScale.mouseWheel)}function qu(i){return function(t){return t.open!==void 0}(i)||function(t){return t.value!==void 0}(i)}function To(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(s=Object.getOwnPropertySymbols(i);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(i,s[n])&&(e[s[n]]=i[s[n]])}return e}function sr(i,t,e,s){const n=e.value,r={se:t,ot:i,Vt:[n,n,n,n],Ib:s};return e.color!==void 0&&(r.V=e.color),r}function Qu(i,t,e,s){const n=e.value,r={se:t,ot:i,Vt:[n,n,n,n],Ib:s};return e.lineColor!==void 0&&(r.lt=e.lineColor),e.topColor!==void 0&&(r.Ts=e.topColor),e.bottomColor!==void 0&&(r.Ps=e.bottomColor),r}function Ku(i,t,e,s){const n=e.value,r={se:t,ot:i,Vt:[n,n,n,n],Ib:s};return e.topLineColor!==void 0&&(r.Pe=e.topLineColor),e.bottomLineColor!==void 0&&(r.Re=e.bottomLineColor),e.topFillColor1!==void 0&&(r.Se=e.topFillColor1),e.topFillColor2!==void 0&&(r.ke=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.ye=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.Ce=e.bottomFillColor2),r}function Hu(i,t,e,s){const n={se:t,ot:i,Vt:[e.open,e.high,e.low,e.close],Ib:s};return e.color!==void 0&&(n.V=e.color),n}function Ju(i,t,e,s){const n={se:t,ot:i,Vt:[e.open,e.high,e.low,e.close],Ib:s};return e.color!==void 0&&(n.V=e.color),e.borderColor!==void 0&&(n.Ot=e.borderColor),e.wickColor!==void 0&&(n.Zh=e.wickColor),n}function Xu(i,t,e,s,n){const r=ut(n)(e),o=Math.max(...r),l=Math.min(...r),h=r[r.length-1],c=[h,o,l,h],u=e,{time:d,color:f}=u;return{se:t,ot:i,Vt:c,Ib:s,He:To(u,["time","color"]),V:f}}function Xe(i){return i.Vt!==void 0}function ir(i,t){return t.customValues!==void 0&&(i.Wb=t.customValues),i}function Vt(i){return(t,e,s,n,r,o)=>function(l,h){return h?h(l):(c=l).open===void 0&&c.value===void 0;var c}(s,o)?ir({ot:t,se:e,Ib:n},s):ir(i(t,e,s,n,r),s)}function nr(i){return{Candlestick:Vt(Ju),Bar:Vt(Hu),Area:Vt(Qu),Baseline:Vt(Ku),Histogram:Vt(sr),Line:Vt(sr),Custom:Vt(Xu)}[i]}function rr(i){return{se:0,jb:new Map,ha:i}}function or(i,t){if(i!==void 0&&i.length!==0)return{Hb:t.key(i[0].ot),$b:t.key(i[i.length-1].ot)}}function ar(i){let t;return i.forEach(e=>{t===void 0&&(t=e.Ib)}),ut(t)}class Gu{constructor(t){this.Ub=new Map,this.qb=new Map,this.Yb=new Map,this.Zb=[],this.U_=t}S(){this.Ub.clear(),this.qb.clear(),this.Yb.clear(),this.Zb=[]}Xb(t,e){let s=this.Ub.size!==0,n=!1;const r=this.qb.get(t);if(r!==void 0)if(this.qb.size===1)s=!1,n=!0,this.Ub.clear();else for(const h of this.Zb)h.pointData.jb.delete(t)&&(n=!0);let o=[];if(e.length!==0){const h=e.map(b=>b.time),c=this.U_.createConverterToInternalObj(e),u=nr(t.Jh()),d=t.ya(),f=t.Ca();o=e.map((b,m)=>{const p=c(b.time),x=this.U_.key(p);let w=this.Ub.get(x);w===void 0&&(w=rr(p),this.Ub.set(x,w),n=!0);const _=u(p,w.se,b,h[m],d,f);return w.jb.set(t,_),_})}s&&this.Kb(),this.Gb(t,o);let l=-1;if(n){const h=[];this.Ub.forEach(c=>{h.push({timeWeight:0,time:c.ha,pointData:c,originalTime:ar(c.jb)})}),h.sort((c,u)=>this.U_.key(c.time)-this.U_.key(u.time)),l=this.Jb(h)}return this.Qb(t,l,function(h,c,u){const d=or(h,u),f=or(c,u);if(d!==void 0&&f!==void 0)return{Ql:d.$b>=f.$b&&d.Hb>=f.Hb}}(this.qb.get(t),r,this.U_))}fd(t){return this.Xb(t,[])}tw(t,e){const s=e;(function(p){p.Ib===void 0&&(p.Ib=p.time)})(s),this.U_.preprocessData(e);const n=this.U_.createConverterToInternalObj([e])(e.time),r=this.Yb.get(t);if(r!==void 0&&this.U_.key(n)<this.U_.key(r))throw new Error(`Cannot update oldest data, last time=${r}, new time=${n}`);let o=this.Ub.get(this.U_.key(n));const l=o===void 0;o===void 0&&(o=rr(n),this.Ub.set(this.U_.key(n),o));const h=nr(t.Jh()),c=t.ya(),u=t.Ca(),d=h(n,o.se,e,s.Ib,c,u);o.jb.set(t,d),this.iw(t,d);const f={Ql:Xe(d)};if(!l)return this.Qb(t,-1,f);const b={timeWeight:0,time:o.ha,pointData:o,originalTime:ar(o.jb)},m=ze(this.Zb,this.U_.key(b.time),(p,x)=>this.U_.key(p.time)<x);this.Zb.splice(m,0,b);for(let p=m;p<this.Zb.length;++p)Js(this.Zb[p].pointData,p);return this.U_.fillWeightsForPoints(this.Zb,m),this.Qb(t,m,f)}iw(t,e){let s=this.qb.get(t);s===void 0&&(s=[],this.qb.set(t,s));const n=s.length!==0?s[s.length-1]:null;n===null||this.U_.key(e.ot)>this.U_.key(n.ot)?Xe(e)&&s.push(e):Xe(e)?s[s.length-1]=e:s.splice(-1,1),this.Yb.set(t,e.ot)}Gb(t,e){e.length!==0?(this.qb.set(t,e.filter(Xe)),this.Yb.set(t,e[e.length-1].ot)):(this.qb.delete(t),this.Yb.delete(t))}Kb(){for(const t of this.Zb)t.pointData.jb.size===0&&this.Ub.delete(this.U_.key(t.time))}Jb(t){let e=-1;for(let s=0;s<this.Zb.length&&s<t.length;++s){const n=this.Zb[s],r=t[s];if(this.U_.key(n.time)!==this.U_.key(r.time)){e=s;break}r.timeWeight=n.timeWeight,Js(r.pointData,s)}if(e===-1&&this.Zb.length!==t.length&&(e=Math.min(this.Zb.length,t.length)),e===-1)return-1;for(let s=e;s<t.length;++s)Js(t[s].pointData,s);return this.U_.fillWeightsForPoints(t,e),this.Zb=t,e}nw(){if(this.qb.size===0)return null;let t=0;return this.qb.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].se))}),t}Qb(t,e,s){const n={sw:new Map,St:{Lu:this.nw()}};if(e!==-1)this.qb.forEach((r,o)=>{n.sw.set(o,{He:r,ew:o===t?s:void 0})}),this.qb.has(t)||n.sw.set(t,{He:[],ew:s}),n.St.rw=this.Zb,n.St.hw=e;else{const r=this.qb.get(t);n.sw.set(t,{He:r||[],ew:s})}return n}}function Js(i,t){i.se=t,i.jb.forEach(e=>{e.se=t})}function Ai(i){const t={value:i.Vt[3],time:i.Ib};return i.Wb!==void 0&&(t.customValues=i.Wb),t}function lr(i){const t=Ai(i);return i.V!==void 0&&(t.color=i.V),t}function Zu(i){const t=Ai(i);return i.lt!==void 0&&(t.lineColor=i.lt),i.Ts!==void 0&&(t.topColor=i.Ts),i.Ps!==void 0&&(t.bottomColor=i.Ps),t}function Yu(i){const t=Ai(i);return i.Pe!==void 0&&(t.topLineColor=i.Pe),i.Re!==void 0&&(t.bottomLineColor=i.Re),i.Se!==void 0&&(t.topFillColor1=i.Se),i.ke!==void 0&&(t.topFillColor2=i.ke),i.ye!==void 0&&(t.bottomFillColor1=i.ye),i.Ce!==void 0&&(t.bottomFillColor2=i.Ce),t}function Fo(i){const t={open:i.Vt[0],high:i.Vt[1],low:i.Vt[2],close:i.Vt[3],time:i.Ib};return i.Wb!==void 0&&(t.customValues=i.Wb),t}function td(i){const t=Fo(i);return i.V!==void 0&&(t.color=i.V),t}function ed(i){const t=Fo(i),{V:e,Ot:s,Zh:n}=i;return e!==void 0&&(t.color=e),s!==void 0&&(t.borderColor=s),n!==void 0&&(t.wickColor=n),t}function pi(i){return{Area:Zu,Line:lr,Baseline:Yu,Histogram:lr,Bar:td,Candlestick:ed,Custom:sd}[i]}function sd(i){const t=i.Ib;return Object.assign(Object.assign({},i.He),{time:t})}const id={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},nd={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},rd={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:ki,attributionLogo:!0},Xs={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},od={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},ad={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:ki,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function hr(){return{width:0,height:0,autoSize:!1,layout:rd,crosshair:id,grid:nd,overlayPriceScales:Object.assign({},Xs),leftPriceScale:Object.assign(Object.assign({},Xs),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},Xs),{visible:!0}),timeScale:od,watermark:ad,localization:{locale:he?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class ld{constructor(t,e){this.lw=t,this.aw=e}applyOptions(t){this.lw.$t().Hc(this.aw,t)}options(){return this.Li().W()}width(){return js(this.aw)?this.lw.gb(this.aw):0}Li(){return C(this.lw.$t().$c(this.aw)).Dt}}function cr(i,t,e){const s=To(i,["time","originalTime"]),n=Object.assign({time:t},s);return e!==void 0&&(n.originalTime=e),n}const hd={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class cd{constructor(t){this.Eh=t}applyOptions(t){this.Eh.Hh(t)}options(){return this.Eh.W()}ow(){return this.Eh}}class ud{constructor(t,e,s,n,r){this._w=new tt,this.Ls=t,this.uw=e,this.cw=s,this.U_=r,this.dw=n}S(){this._w.S()}priceFormatter(){return this.Ls.ma()}priceToCoordinate(t){const e=this.Ls.Ct();return e===null?null:this.Ls.Dt().Rt(t,e.Vt)}coordinateToPrice(t){const e=this.Ls.Ct();return e===null?null:this.Ls.Dt().pn(t,e.Vt)}barsInLogicalRange(t){if(t===null)return null;const e=new re(new Ne(t.from,t.to)).hu(),s=this.Ls.In();if(s.Ni())return null;const n=s.hl(e.Vs(),1),r=s.hl(e.ui(),-1),o=C(s.sl()),l=C(s.An());if(n!==null&&r!==null&&n.se>r.se)return{barsBefore:t.from-o,barsAfter:l-t.to};const h={barsBefore:n===null||n.se===o?t.from-o:n.se-o,barsAfter:r===null||r.se===l?l-t.to:l-r.se};return n!==null&&r!==null&&(h.from=n.Ib,h.to=r.Ib),h}setData(t){this.U_,this.Ls.Jh(),this.uw.fw(this.Ls,t),this.pw("full")}update(t){this.Ls.Jh(),this.uw.mw(this.Ls,t),this.pw("update")}dataByIndex(t,e){const s=this.Ls.In().hl(t,e);return s===null?null:pi(this.seriesType())(s)}data(){const t=pi(this.seriesType());return this.Ls.In().ie().map(e=>t(e))}subscribeDataChanged(t){this._w.l(t)}unsubscribeDataChanged(t){this._w.v(t)}setMarkers(t){this.U_;const e=t.map(s=>cr(s,this.U_.convertHorzItemToInternal(s.time),s.time));this.Ls.ia(e)}markers(){return this.Ls.na().map(t=>cr(t,t.originalTime,void 0))}applyOptions(t){this.Ls.Hh(t)}options(){return Pt(this.Ls.W())}priceScale(){return this.cw.priceScale(this.Ls.Dt().Ta())}createPriceLine(t){const e=gt(Pt(hd),t),s=this.Ls.sa(e);return new cd(s)}removePriceLine(t){this.Ls.ea(t.ow())}seriesType(){return this.Ls.Jh()}attachPrimitive(t){this.Ls.Sa(t),t.attached&&t.attached({chart:this.dw,series:this,requestUpdate:()=>this.Ls.$t().Xl()})}detachPrimitive(t){this.Ls.ka(t),t.detached&&t.detached()}pw(t){this._w.M()&&this._w.m(t)}}class dd{constructor(t,e,s){this.bw=new tt,this.pu=new tt,this.Vm=new tt,this.$i=t,this.kl=t.St(),this.lb=e,this.kl.tc().l(this.ww.bind(this)),this.kl.nc().l(this.gw.bind(this)),this.lb.Em().l(this.Mw.bind(this)),this.U_=s}S(){this.kl.tc().p(this),this.kl.nc().p(this),this.lb.Em().p(this),this.bw.S(),this.pu.S(),this.Vm.S()}scrollPosition(){return this.kl.ju()}scrollToPosition(t,e){e?this.kl.Gu(t,1e3):this.$i.Jn(t)}scrollToRealTime(){this.kl.Ku()}getVisibleRange(){const t=this.kl.Du();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.U_.convertHorzItemToInternal(t.from),to:this.U_.convertHorzItemToInternal(t.to)},s=this.kl.Au(e);this.$i.vd(s)}getVisibleLogicalRange(){const t=this.kl.Ru();return t===null?null:{from:t.Vs(),to:t.ui()}}setVisibleLogicalRange(t){At(t.from<=t.to,"The from index cannot be after the to index."),this.$i.vd(t)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.rc()}logicalToCoordinate(t){const e=this.$i.St();return e.Ni()?null:e.It(t)}coordinateToLogical(t){return this.kl.Ni()?null:this.kl.Eu(t)}timeToCoordinate(t){const e=this.U_.convertHorzItemToInternal(t),s=this.kl.Da(e,!1);return s===null?null:this.kl.It(s)}coordinateToTime(t){const e=this.$i.St(),s=e.Eu(t),n=e.Ui(s);return n===null?null:n.originalTime}width(){return this.lb._m().width}height(){return this.lb._m().height}subscribeVisibleTimeRangeChange(t){this.bw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.bw.v(t)}subscribeVisibleLogicalRangeChange(t){this.pu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.pu.v(t)}subscribeSizeChange(t){this.Vm.l(t)}unsubscribeSizeChange(t){this.Vm.v(t)}applyOptions(t){this.kl.Hh(t)}options(){return Object.assign(Object.assign({},Pt(this.kl.W())),{barSpacing:this.kl.he()})}ww(){this.bw.M()&&this.bw.m(this.getVisibleRange())}gw(){this.pu.M()&&this.pu.m(this.getVisibleLogicalRange())}Mw(t){this.Vm.m(t.width,t.height)}}function fd(i){if(i===void 0||i.type==="custom")return;const t=i;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let s=0;for(;s<8;s++){const n=Math.round(e);if(Math.abs(n-e)<1e-8)return s;e*=10}return s}(t.minMove))}function ur(i){return function(t){if(Ve(t.handleScale)){const s=t.handleScale;t.handleScale={axisDoubleClickReset:{time:s,price:s},axisPressedMouseMove:{time:s,price:s},mouseWheel:s,pinch:s}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:s,axisDoubleClickReset:n}=t.handleScale;Ve(s)&&(t.handleScale.axisPressedMouseMove={time:s,price:s}),Ve(n)&&(t.handleScale.axisDoubleClickReset={time:n,price:n})}const e=t.handleScroll;Ve(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(i),i}class md{constructor(t,e,s){this.xw=new Map,this.Sw=new Map,this.kw=new tt,this.yw=new tt,this.Cw=new tt,this.Tw=new Gu(e);const n=s===void 0?Pt(hr()):gt(Pt(hr()),ur(s));this.U_=e,this.lw=new Wu(t,n,e),this.lw.hm().l(o=>{this.kw.M()&&this.kw.m(this.Pw(o()))},this),this.lw.lm().l(o=>{this.yw.M()&&this.yw.m(this.Pw(o()))},this),this.lw.Zc().l(o=>{this.Cw.M()&&this.Cw.m(this.Pw(o()))},this);const r=this.lw.$t();this.Rw=new dd(r,this.lw.cb(),this.U_)}remove(){this.lw.hm().p(this),this.lw.lm().p(this),this.lw.Zc().p(this),this.Rw.S(),this.lw.S(),this.xw.clear(),this.Sw.clear(),this.kw.S(),this.yw.S(),this.Cw.S(),this.Tw.S()}resize(t,e,s){this.autoSizeActive()||this.lw.ob(t,e,s)}addCustomSeries(t,e){const s=se(t),n=Object.assign(Object.assign({},ho),s.defaultOptions());return this.Dw("Custom",n,e,s)}addAreaSeries(t){return this.Dw("Area",Gh,t)}addBaselineSeries(t){return this.Dw("Baseline",Zh,t)}addBarSeries(t){return this.Dw("Bar",Jh,t)}addCandlestickSeries(t={}){return function(e){e.borderColor!==void 0&&(e.borderUpColor=e.borderColor,e.borderDownColor=e.borderColor),e.wickColor!==void 0&&(e.wickUpColor=e.wickColor,e.wickDownColor=e.wickColor)}(t),this.Dw("Candlestick",Hh,t)}addHistogramSeries(t){return this.Dw("Histogram",Yh,t)}addLineSeries(t){return this.Dw("Line",Xh,t)}removeSeries(t){const e=ut(this.xw.get(t)),s=this.Tw.fd(e);this.lw.$t().fd(e),this.Vw(s),this.xw.delete(t),this.Sw.delete(e)}fw(t,e){this.Vw(this.Tw.Xb(t,e))}mw(t,e){this.Vw(this.Tw.tw(t,e))}subscribeClick(t){this.kw.l(t)}unsubscribeClick(t){this.kw.v(t)}subscribeCrosshairMove(t){this.Cw.l(t)}unsubscribeCrosshairMove(t){this.Cw.v(t)}subscribeDblClick(t){this.yw.l(t)}unsubscribeDblClick(t){this.yw.v(t)}priceScale(t){return new ld(this.lw,t)}timeScale(){return this.Rw}applyOptions(t){this.lw.Hh(ur(t))}options(){return this.lw.W()}takeScreenshot(){return this.lw.bb()}autoSizeActive(){return this.lw.Sb()}chartElement(){return this.lw.kb()}paneSize(){const t=this.lw.Cb();return{height:t.height,width:t.width}}setCrosshairPosition(t,e,s){const n=this.xw.get(s);if(n===void 0)return;const r=this.lw.$t().cr(n);r!==null&&this.lw.$t().ld(t,e,r)}clearCrosshairPosition(){this.lw.$t().ad(!0)}Dw(t,e,s={},n){fd(s.priceFormat);const r=gt(Pt(co),Pt(e),s),o=this.lw.$t().ud(t,r,n),l=new ud(o,this,this,this,this.U_);return this.xw.set(l,o),this.Sw.set(o,l),l}Vw(t){const e=this.lw.$t();e.od(t.St.Lu,t.St.rw,t.St.hw),t.sw.forEach((s,n)=>n.J(s.He,s.ew)),e.Fu()}Ow(t){return ut(this.Sw.get(t))}Pw(t){const e=new Map;t.Eb.forEach((n,r)=>{const o=r.Jh(),l=pi(o)(n);if(o!=="Custom")At(qu(l));else{const h=r.Ca();At(!h||h(l)===!1)}e.set(this.Ow(r),l)});const s=t.Lb!==void 0&&this.Sw.has(t.Lb)?this.Ow(t.Lb):void 0;return{time:t.Ib,logical:t.se,point:t.zb,hoveredSeries:s,hoveredObjectId:t.Nb,seriesData:e,sourceEvent:t.Fb}}}function pd(i,t,e){let s;if(Fe(i)){const r=document.getElementById(i);At(r!==null,`Cannot find element in DOM with id=${i}`),s=r}else s=i;const n=new md(s,t,e);return t.setOptions(n.options()),n}function bd(i,t){return pd(i,new Xn,Xn.Ad(t))}Object.assign(Object.assign({},co),ho);function vd({theme:i="dark",height:t=500}={}){return M.useMemo(()=>{const e=i==="dark";return{layout:{background:{type:ci.Solid,color:e?"#1E293B":"#FFFFFF"},textColor:e?"#94A3B8":"#64748B"},grid:{vertLines:{color:e?"#334155":"#E2E8F0",style:Wt.Solid},horzLines:{color:e?"#334155":"#E2E8F0",style:Wt.Solid}},crosshair:{mode:0,vertLine:{width:1,color:"#3B82F6",style:Wt.Dashed,labelBackgroundColor:"#3B82F6"},horzLine:{width:1,color:"#3B82F6",style:Wt.Dashed,labelBackgroundColor:"#3B82F6"}},rightPriceScale:{borderColor:e?"#334155":"#E2E8F0",scaleMargins:{top:.1,bottom:.2}},timeScale:{borderColor:e?"#334155":"#E2E8F0",timeVisible:!0,secondsVisible:!1},height:t}},[i,t])}function gd(i="dark"){return{upColor:"#26A69A",downColor:"#EF5350",borderUpColor:"#26A69A",borderDownColor:"#EF5350",wickUpColor:"#26A69A",wickDownColor:"#EF5350"}}function dr(i="dark"){return{upColor:"#26A69A80",downColor:"#EF535080"}}const xd=["1m","5m","15m","1h","4h","1d"];function yd({symbol:i,positions:t=[],orders:e=[],height:s=500,showPositions:n=!0,showOrders:r=!0}){const[o,l]=M.useState(i||"MNQ"),[h,c]=M.useState("5m"),[u,d]=M.useState(300),f=M.useRef(null),b=M.useRef(null),m=M.useRef(null),p=M.useRef(null),x=vd({theme:"dark",height:s}),{data:w,isLoading:_}=rt(["tradingChartData",o,h,u],()=>Zr.getHistoricalData({symbol:o,timeframe:h,limit:u,end:new Date().toISOString()}),{enabled:!!o,staleTime:3e4,refetchInterval:3e4});M.useEffect(()=>{if(!f.current)return;const g=bd(f.current,{...x,width:f.current.clientWidth}),j=g.addCandlestickSeries(gd("dark")),k=g.addHistogramSeries({color:"#26A69A",priceFormat:{type:"volume"},priceScaleId:"volume"});g.priceScale("volume").applyOptions({scaleMargins:{top:.8,bottom:0}}),b.current=g,m.current=j,p.current=k;const S=()=>{f.current&&b.current&&b.current.applyOptions({width:f.current.clientWidth})};return window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S),g.remove()}},[s]),M.useEffect(()=>{if(!(!(w!=null&&w.bars)||!m.current||!p.current))try{const g=w.bars.map(S=>({time:new Date(S.timestamp).getTime()/1e3,open:S.open,high:S.high,low:S.low,close:S.close})),j=dr("dark"),k=w.bars.map(S=>({time:new Date(S.timestamp).getTime()/1e3,value:S.volume,color:S.close>=S.open?j.upColor:j.downColor}));m.current.setData(g),p.current.setData(k),b.current&&b.current.timeScale().fitContent()}catch(g){console.error("Error updating chart data:",g)}},[w]),M.useEffect(()=>{if(!m.current||!n)return;const g=t.filter(j=>j.symbol===o&&j.timestamp).map(j=>{const k=j.side==="LONG";return{time:new Date(j.timestamp).getTime()/1e3,position:k?"belowBar":"aboveBar",color:k?"#26A69A":"#EF5350",shape:k?"arrowUp":"arrowDown",text:`${j.side} ${j.quantity}@${j.entry_price.toFixed(2)}`,size:1}});g.length>0&&m.current&&m.current.setMarkers(g)},[t,o,n]),M.useEffect(()=>{!m.current||!r||e.filter(g=>g.symbol===o&&g.status==="PENDING"&&g.price).forEach(g=>{if(!m.current)return;const j=g.side==="BUY";try{m.current.createPriceLine({price:g.price,color:j?"#10B981":"#F59E0B",lineWidth:2,lineStyle:Wt.Dashed,axisLabelVisible:!0,title:`${g.side} ${g.quantity}`})}catch(k){console.error("Error creating price line:",k)}})},[e,o,r]),M.useEffect(()=>{if(!o)return;const g=j=>{if(j.symbol===o&&!(!m.current||!p.current))try{const k=new Date(j.timestamp).getTime()/1e3;if(j.bar&&(m.current.update({time:k,open:j.bar.open,high:j.bar.high,low:j.bar.low,close:j.bar.close}),j.bar.volume)){const S=dr("dark");p.current.update({time:k,value:j.bar.volume,color:j.bar.close>=j.bar.open?S.upColor:S.downColor})}}catch(k){console.error("Error updating live chart data:",k)}};return I.on("market_update",g),()=>{I.off("market_update",g)}},[o]);const N=[{value:100,label:"100"},{value:300,label:"300"},{value:500,label:"500"},{value:1e3,label:"1000"}];return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsxs("h2",{className:"text-xl font-semibold text-slate-100",children:[o," Price Chart"]}),a.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[a.jsx("input",{value:o,onChange:g=>l(g.target.value.toUpperCase()),className:"bg-slate-900 border border-slate-700 rounded px-3 py-1.5 text-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Symbol",maxLength:10}),a.jsx("div",{className:"flex gap-1",children:xd.map(g=>a.jsx("button",{onClick:()=>c(g),className:`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${h===g?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:g.toUpperCase()},g))})]})]}),a.jsxs("div",{className:"flex items-center gap-3 text-sm flex-wrap",children:[a.jsx("span",{className:"text-slate-400",children:"Bars:"}),a.jsx("div",{className:"flex gap-1",children:N.map(g=>a.jsx("button",{onClick:()=>d(g.value),className:`px-3 py-1 text-xs font-semibold rounded transition-colors ${u===g.value?"bg-green-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:g.label},g.value))}),a.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:n,onChange:()=>l(o),className:"rounded"}),"Show Positions"]}),a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:r,onChange:()=>l(o),className:"rounded"}),"Show Orders"]})]})]})]}),_?a.jsx("div",{className:"flex items-center justify-center text-slate-400 text-sm bg-slate-900/50 rounded",style:{height:s},children:a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Loading chart data..."})]})}):!w||w.bars.length===0?a.jsxs("div",{className:"flex items-center justify-center text-slate-500 text-sm bg-slate-900/50 rounded",style:{height:s},children:["No data available for ",o]}):a.jsx("div",{ref:f,className:"rounded overflow-hidden"}),w&&w.bars.length>0&&a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400 bg-slate-900/60 rounded px-4 py-2",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{children:[a.jsx("span",{className:"text-slate-500",children:"O:"})," ",a.jsx("span",{className:"text-slate-300",children:w.bars[w.bars.length-1].open.toFixed(2)})]}),a.jsxs("span",{children:[a.jsx("span",{className:"text-slate-500",children:"H:"})," ",a.jsx("span",{className:"text-green-400",children:w.bars[w.bars.length-1].high.toFixed(2)})]}),a.jsxs("span",{children:[a.jsx("span",{className:"text-slate-500",children:"L:"})," ",a.jsx("span",{className:"text-red-400",children:w.bars[w.bars.length-1].low.toFixed(2)})]}),a.jsxs("span",{children:[a.jsx("span",{className:"text-slate-500",children:"C:"})," ",a.jsx("span",{className:w.bars[w.bars.length-1].close>=w.bars[w.bars.length-1].open?"text-green-400":"text-red-400",children:w.bars[w.bars.length-1].close.toFixed(2)})]})]}),a.jsxs("div",{className:"text-slate-500",children:[t.filter(g=>g.symbol===o).length," position(s)  ",e.filter(g=>g.symbol===o&&g.status==="PENDING").length," order(s)"]})]})]})}const Gs=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}),wd=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});function Sd(){const{selectedAccount:i}=Mt(),[t,e]=M.useState(20),{data:s,isLoading:n}=rt(["trades",i==null?void 0:i.id,t],()=>bh.getTrades({accountId:i==null?void 0:i.id,limit:t,type:"filled"}),{enabled:!!i,staleTime:3e4}),r=(s==null?void 0:s.items)??[],o=M.useMemo(()=>s!=null&&s.summary?s.summary:null,[s]),l=()=>{const h=i==null?void 0:i.id,c=new URLSearchParams;h&&c.append("account_id",h);const u=`/api/trades/export${c.toString()?`?${c.toString()}`:""}`;window.open(u,"_blank")};return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Recent Trades"}),a.jsxs("button",{onClick:l,className:"px-3 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2 text-sm",disabled:!i||r.length===0,children:[a.jsx(ro,{className:"w-4 h-4"}),"Export CSV"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"text-xs text-slate-400 flex items-center gap-2",children:["Rows",a.jsx("select",{value:t,onChange:h=>e(Number(h.target.value)),className:"bg-slate-900 border border-slate-700 text-slate-200 text-xs px-2 py-1 rounded focus:outline-none focus:ring-1 focus:ring-primary-500",children:[20,50,100].map(h=>a.jsx("option",{value:h,children:h},h))})]}),o&&a.jsxs("div",{className:"flex flex-col items-end text-xs text-slate-400",children:[a.jsxs("div",{children:["Gross PnL (shown trades):"," ",a.jsxs("span",{className:o.gross_pnl>=0?"text-green-400 font-semibold":"text-red-400 font-semibold",children:[o.gross_pnl>=0?"+":"",Gs.format(Math.abs(o.gross_pnl))]})]}),o.total_in_period&&o.displayed_count&&o.total_in_period>o.displayed_count&&a.jsxs("div",{className:"text-slate-500 mt-1",children:["Showing ",o.displayed_count," of ",o.total_in_period," total trades"]})]})]})]}),n?a.jsx("div",{className:"py-10 text-center text-slate-400 text-sm",children:"Loading trades..."}):r.length===0?a.jsx("div",{className:"py-10 text-center text-slate-500 text-sm",children:"No trades in this period."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"max-h-[32rem] overflow-y-auto pr-1",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"sticky top-0 bg-slate-800",children:a.jsxs("tr",{className:"text-slate-400 text-xs uppercase tracking-wide",children:[a.jsx("th",{className:"pb-3 text-left",children:"Time"}),a.jsx("th",{className:"pb-3 text-left",children:"Symbol"}),a.jsx("th",{className:"pb-3 text-left",children:"Side"}),a.jsx("th",{className:"pb-3 text-right",children:"Qty"}),a.jsx("th",{className:"pb-3 text-right",children:"Price"}),a.jsx("th",{className:"pb-3 text-right",children:"Net P&L"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-700/60",children:r.map(h=>{const c=h.net_pnl>=0?"text-green-400":"text-red-400";return a.jsxs("tr",{className:"hover:bg-slate-700/40 transition-colors",children:[a.jsx("td",{className:"py-2 text-slate-300",children:wd.format(new Date(h.timestamp))}),a.jsx("td",{className:"py-2 font-semibold text-slate-100",children:h.symbol}),a.jsx("td",{className:`py-2 uppercase ${h.side==="BUY"?"text-green-300":"text-red-300"}`,children:h.side}),a.jsx("td",{className:"py-2 text-right text-slate-200",children:h.quantity}),a.jsx("td",{className:"py-2 text-right text-slate-200",children:h.price?Gs.format(h.price):""}),a.jsxs("td",{className:`py-2 text-right font-semibold ${c}`,children:[h.net_pnl>=0?"+":"",Gs.format(Math.abs(h.net_pnl))]})]},h.id)})})]})})})]})}const Nd=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2}),fr=new Intl.NumberFormat(void 0,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:1}),_t=i=>i==null||Number.isNaN(i)?"":Nd.format(i),mr=i=>{if(!i)return"";try{return new Date(i).toLocaleString()}catch{return i}},pr=(i,t)=>i||t>=1?"bg-red-500":t>=.8?"bg-amber-500":"bg-emerald-500",jd=i=>i?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30":"bg-red-500/20 text-red-200 border border-red-500/30",_d={info:"bg-slate-700 text-slate-200 border border-slate-600",warning:"bg-amber-500/20 text-amber-300 border border-amber-500/40",error:"bg-red-500/20 text-red-200 border border-red-500/40",success:"bg-emerald-500/20 text-emerald-200 border border-emerald-500/40"};function Cd(){const{selectedAccount:i}=Mt(),t=i==null?void 0:i.id,e=xt(),[s,n]=M.useState(!0),{data:r,isLoading:o,error:l,refetch:h,isFetching:c}=rt(["risk",t],()=>ph.getRisk(t),{enabled:!!t,staleTime:3e4,refetchInterval:6e4,keepPreviousData:!0}),u=!!l,d=l instanceof Error?l.message:"Failed to load risk metrics.";M.useEffect(()=>{const p=x=>{x&&(t&&x.account_id&&String(x.account_id)!==String(t)||e.setQueryData(["risk",t],x))};return I.on("risk_update",p),()=>{I.off("risk_update",p)}},[t,e]);const f=M.useMemo(()=>{if(!r)return null;const p=r.dll.pct??(r.dll.limit?r.dll.used/r.dll.limit:0);return{pct:Math.min(1,Math.max(0,p||0)),limit:r.dll.limit,used:r.dll.used,remaining:r.dll.remaining,violated:r.dll.violated}},[r]),b=M.useMemo(()=>{if(!r)return null;const p=r.mll.pct??(r.mll.limit?r.mll.used/r.mll.limit:0);return{pct:Math.min(1,Math.max(0,p||0)),limit:r.mll.limit,used:r.mll.used,remaining:r.mll.remaining,violated:r.mll.violated}},[r]),m=(r==null?void 0:r.events)??[];return a.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-sm",children:[a.jsxs("button",{type:"button",onClick:()=>n(p=>!p),className:"w-full flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3 text-left",children:[r!=null&&r.compliance?a.jsx(Oh,{className:"w-5 h-5 text-emerald-400"}):a.jsx(Ph,{className:"w-5 h-5 text-red-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-200",children:"Risk Monitor"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[r!=null&&r.account_name?`${r.account_name}  `:"",r?mr(r.timestamp):"Awaiting data"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx(ne,{className:"w-4 h-4 animate-spin text-slate-400"}),s?a.jsx(xs,{className:"w-4 h-4 text-slate-400"}):a.jsx(Te,{className:"w-4 h-4 text-slate-400"})]})]}),s&&a.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[o&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[a.jsx(ne,{className:"w-4 h-4 animate-spin"}),"Loading risk metrics..."]}),u&&a.jsxs("div",{className:"flex items-center justify-between gap-3 text-sm text-red-300 bg-red-500/10 border border-red-500/30 rounded-lg px-3 py-2",children:[a.jsx("span",{children:d}),a.jsx("button",{onClick:()=>h(),className:"text-xs font-semibold text-red-200 underline",children:"Retry"})]}),!o&&!u&&r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${jd(r.compliance)}`,children:r.compliance?"Compliant":"Non-Compliant"}),r.violations.length>0&&a.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-300",children:[a.jsx(io,{className:"w-4 h-4"}),r.violations[0]]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Current Balance"}),a.jsx("p",{className:"font-semibold text-slate-100",children:_t(r.balance)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Total PnL"}),a.jsx("p",{className:`font-semibold ${r.total_pnl>=0?"text-emerald-400":"text-red-400"}`,children:_t(r.total_pnl)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Start Balance"}),a.jsx("p",{className:"font-semibold text-slate-100",children:_t(r.start_balance)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase mb-1",children:"Trailing Loss"}),a.jsx("p",{className:`font-semibold ${r.trailing_loss>0?"text-amber-300":"text-slate-200"}`,children:_t(r.trailing_loss)})]})]}),f&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[a.jsx("span",{children:"Daily Loss Limit"}),a.jsxs("span",{children:[_t(f.used)," / ",_t(f.limit)]})]}),a.jsx("div",{className:"h-2 rounded bg-slate-700 overflow-hidden",children:a.jsx("div",{className:`h-full ${pr(f.violated,f.pct)}`,style:{width:`${f.pct*100}%`}})}),a.jsx("p",{className:"text-xs text-slate-500",children:f.limit===null?"No daily loss limit configured":`Remaining: ${_t(f.remaining)} (${fr.format(1-f.pct)})`})]}),b&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[a.jsx("span",{children:"Maximum Loss Limit"}),a.jsxs("span",{children:[_t(b.used)," / ",_t(b.limit)]})]}),a.jsx("div",{className:"h-2 rounded bg-slate-700 overflow-hidden",children:a.jsx("div",{className:`h-full ${pr(b.violated,b.pct)}`,style:{width:`${b.pct*100}%`}})}),a.jsx("p",{className:"text-xs text-slate-500",children:b.limit===null?"No maximum loss limit configured":`Remaining: ${_t(b.remaining)} (${fr.format(1-b.pct)})`})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 uppercase",children:[a.jsx(ji,{className:"w-4 h-4 text-slate-300"}),"Recent Risk Events"]}),m.length===0?a.jsx("div",{className:"text-xs text-slate-500 bg-slate-900/60 border border-slate-700/60 rounded-lg px-3 py-2",children:"No recent risk events"}):a.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:m.map(p=>a.jsxs("div",{className:`px-3 py-2 rounded-lg text-xs ${_d[p.level]}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-semibold",children:p.message}),a.jsx("span",{className:"text-slate-300/80",children:mr(p.timestamp)})]}),p.meta&&a.jsx("pre",{className:"text-xs text-slate-300/70 whitespace-pre-wrap",children:JSON.stringify(p.meta,null,2)})]},p.id))})]})]})]})]})}const kd=i=>{if(!i)return"";try{const t=new Date(i),s=new Date().getTime()-t.getTime(),n=Math.floor(s/6e4);return n<1?"Just now":n<60?`${n}m ago`:n<1440?`${Math.floor(n/60)}h ago`:t.toLocaleString()}catch{return i}},Md=i=>{switch(i){case"success":return a.jsx(ji,{className:"w-4 h-4 text-emerald-400"});case"warning":return a.jsx(io,{className:"w-4 h-4 text-amber-400"});case"error":return a.jsx(ae,{className:"w-4 h-4 text-red-400"});default:return a.jsx(oo,{className:"w-4 h-4 text-blue-400"})}},Ed=i=>{switch(i){case"success":return"bg-emerald-500/10 border-emerald-500/30 text-emerald-200";case"warning":return"bg-amber-500/10 border-amber-500/30 text-amber-200";case"error":return"bg-red-500/10 border-red-500/30 text-red-200";default:return"bg-blue-500/10 border-blue-500/30 text-blue-200"}};function Ld(){const{selectedAccount:i}=Mt(),t=i==null?void 0:i.id,e=xt(),[s,n]=M.useState(!0),[r,o]=M.useState(0),{data:l,isLoading:h,error:c}=rt(["notifications",t],()=>vh.getNotifications(t),{enabled:!!t,staleTime:1e4,refetchInterval:3e4,keepPreviousData:!0});M.useEffect(()=>{const f=b=>{!b||!b.notification||t&&b.account_id&&String(b.account_id)!==String(t)||(e.invalidateQueries(["notifications",t]),s||o(m=>m+1))};return I.on("notification",f),()=>{I.off("notification",f)}},[t,e,s]),M.useEffect(()=>{s&&o(0)},[s]);const u=(l==null?void 0:l.notifications)||[],d=u.length>0;return a.jsxs("div",{className:"fixed right-4 top-20 z-40 w-80",children:[a.jsxs("button",{onClick:()=>n(!s),className:`w-full flex items-center justify-between px-4 py-2 rounded-t-lg border transition-colors ${s?"bg-slate-800 border-slate-600 text-slate-200":"bg-slate-700 hover:bg-slate-600 border-slate-500 text-slate-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ch,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Notifications"}),r>0&&a.jsx("span",{className:"px-1.5 py-0.5 text-xs font-bold bg-red-500 text-white rounded-full min-w-[1.25rem] text-center",children:r})]}),s?a.jsx(xs,{className:"w-4 h-4"}):a.jsx(Te,{className:"w-4 h-4"})]}),s&&a.jsx("div",{className:"bg-slate-800 border-x border-b border-slate-600 rounded-b-lg shadow-xl max-h-[32rem] flex flex-col",children:h?a.jsx("div",{className:"p-4 text-center text-slate-400 text-sm",children:"Loading notifications..."}):c?a.jsx("div",{className:"p-4 text-center text-red-400 text-sm",children:"Failed to load notifications"}):d?a.jsx("div",{className:"overflow-y-auto flex-1",children:u.map(f=>a.jsx("div",{className:`p-3 border-b border-slate-700/50 ${Ed(f.level)}`,children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:"mt-0.5",children:Md(f.level)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium",children:f.message}),f.meta&&a.jsxs("div",{className:"mt-1 text-xs text-slate-400",children:[f.meta.symbol&&a.jsxs("span",{className:"mr-2",children:["Symbol: ",f.meta.symbol]}),f.meta.side&&a.jsxs("span",{className:"mr-2",children:["Side: ",f.meta.side]}),f.meta.quantity&&a.jsxs("span",{children:["Qty: ",f.meta.quantity]})]}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:kd(f.timestamp)})]})]})},f.id))}):a.jsx("div",{className:"p-4 text-center text-slate-400 text-sm",children:"No notifications"})})]})}function Rd(){const i=xt(),{accounts:t,selectedAccount:e,setSelectedAccount:s}=Mt(),{status:n,reconnectAttempts:r,lastError:o,reconnect:l}=Nh();so();const h=e==null?void 0:e.id,{data:c}=rt(["accountInfo",h],Si.getAccountInfo,{enabled:!!h,staleTime:6e4,refetchOnWindowFocus:!1}),{data:u}=rt(["metrics"],mh.getMetrics,{refetchInterval:n==="connected"?!1:6e4,staleTime:3e4,refetchOnWindowFocus:!1}),d=(u==null?void 0:u.performance)||u,{data:f}=rt(["positions",h],async()=>h?(await fetch(`/api/positions?account_id=${h}`)).json():{positions:[]},{enabled:!!h,staleTime:3e4}),{data:b}=rt(["orders",h],async()=>h?(await fetch(`/api/orders?account_id=${h}`)).json():{orders:[]},{enabled:!!h,staleTime:3e4}),m=(f==null?void 0:f.positions)||[],p=(b==null?void 0:b.orders)||[];M.useEffect(()=>{let _=!0;const N=S=>{if(!_||!S)return;const T={id:S.account_id||S.accountId||S.id,name:S.account_name||S.name,status:S.status||"active",balance:Number(S.balance??0),currency:S.currency||"USD",account_type:S.account_type||"unknown",equity:Number(S.equity??S.balance??0),dailyPnL:Number(S.dailyPnL??S.daily_pnl??0),daily_pnl:Number(S.dailyPnL??S.daily_pnl??0)};T.id&&(i.setQueryData(["accountInfo",T.id],T),i.setQueryData(["accounts"],B=>B==null?void 0:B.map(P=>(P.id||P.accountId||P.account_id)===T.id?{...P,...T}:P)))},g=S=>{if(!_||!S)return;const T=S.performance||S;i.setQueryData(["metrics"],T)},j=S=>{!_||!S||h&&i.setQueryData(["positions",h],S)},k=S=>{!_||!S||Array.isArray(S)&&i.setQueryData(["accounts"],S)};return I.on("account_update",N),I.on("metrics_update",g),I.on("position_update",j),I.on("accounts_update",k),()=>{_=!1,I.off("account_update",N),I.off("metrics_update",g),I.off("position_update",j),I.off("accounts_update",k)}},[i,h]);const x=M.useMemo(()=>{switch(n){case"connected":return{label:"Connected",container:"bg-green-500/20 text-green-300",dot:"bg-green-400"};case"reconnecting":return{label:`Reconnecting (${r})`,container:"bg-amber-500/20 text-amber-200",dot:"bg-amber-300"};case"error":return{label:"Connection Error",container:"bg-red-500/20 text-red-300",dot:"bg-red-400"};default:return{label:"Disconnected",container:"bg-red-500/20 text-red-300",dot:"bg-red-400"}}},[n,r]),w=n==="error"||n==="disconnected";return a.jsxs("div",{className:"space-y-6",children:[a.jsx(Ld,{}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),a.jsx("p",{className:"text-slate-400 mt-1",children:"Real-time trading overview"})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg ${x.container}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${x.dot}`}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium",children:x.label}),o&&a.jsx("span",{className:"text-xs text-red-200 truncate max-w-[200px]",children:o})]}),w&&a.jsx("button",{onClick:l,className:"ml-2 text-xs font-semibold text-primary-300 underline",children:"Retry"})]})})]}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ci,{accounts:t,selectedAccount:e,onAccountChange:s})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(Zs,{to:"/strategies",className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors text-sm font-medium",children:[a.jsx(Ni,{className:"w-4 h-4"}),"Manage Strategies",a.jsx(gn,{className:"w-3 h-3"})]}),a.jsxs(Zs,{to:"/positions",className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-sm font-medium",children:["View All Positions & Orders",a.jsx(gn,{className:"w-3 h-3"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c&&a.jsx(zh,{account:c,isSelected:!0}),a.jsx(Ih,{}),a.jsx(yd,{symbol:"MNQ",positions:m,orders:p,height:500,showPositions:!0,showOrders:!0}),a.jsx(Ah,{})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(Cd,{}),d&&a.jsx($h,{metrics:d}),a.jsx(Sd,{})]})]})]})}const Pd="MNQ";function Od({onOrderPlaced:i}){const t=xt(),{selectedAccount:e}=Mt(),[s,n]=M.useState(Pd),[r,o]=M.useState("BUY"),[l,h]=M.useState("market"),[c,u]=M.useState("1"),[d,f]=M.useState(""),[b,m]=M.useState(""),[p,x]=M.useState(!1),[w,_]=M.useState(""),[N,g]=M.useState(""),[j,k]=M.useState(""),[S,T]=M.useState(""),[B,P]=M.useState(!1),[X,K]=M.useState(!1),[Q,U]=M.useState("DAY"),[O,F]=M.useState(null),[it,$]=M.useState(null),W=e==null?void 0:e.id,lt=nt(xe.placeOrder,{onSuccess:()=>{$("Order submitted successfully"),F(null),t.invalidateQueries(["orders",W]),t.invalidateQueries(["positions",W]),i&&i()},onError:R=>{var Y,H;console.error("Failed to submit order",R);const vt=((H=(Y=R==null?void 0:R.response)==null?void 0:Y.data)==null?void 0:H.error)||(R==null?void 0:R.message)||"Failed to submit order";F(vt),$(null)}}),Z=nt(R=>xe.cancelAll(R),{onSuccess:()=>{t.invalidateQueries(["orders",W]),$("Cancelled all open orders"),F(null)},onError:R=>{var Y,H;const vt=((H=(Y=R==null?void 0:R.response)==null?void 0:Y.data)==null?void 0:H.error)||(R==null?void 0:R.message)||"Failed to cancel orders";F(vt),$(null)}}),ct=nt(Ct.flattenAll,{onSuccess:()=>{t.invalidateQueries(["positions",W]),t.invalidateQueries(["orders",W]),$("Flatten command sent"),F(null)},onError:R=>{var Y,H;const vt=((H=(Y=R==null?void 0:R.response)==null?void 0:Y.data)==null?void 0:H.error)||(R==null?void 0:R.message)||"Failed to flatten positions";F(vt),$(null)}}),Tt=()=>{f(""),m(""),_(""),g(""),k(""),T(""),x(!1),P(!1),K(!1),U("DAY")},Et=R=>{if(R.preventDefault(),!W){F("Select an account before placing orders"),$(null);return}if(!s.trim()){F("Symbol is required"),$(null);return}const vt=Number(c);if(!Number.isFinite(vt)||vt<=0){F("Quantity must be greater than 0"),$(null);return}const Y={symbol:s,side:r,quantity:Math.floor(vt),order_type:l,account_id:W,time_in_force:Q,reduce_only:X};if(l==="limit"){const H=Number(d);if(!Number.isFinite(H)||H<=0){F("Limit price required for limit orders"),$(null);return}Y.limit_price=H}if(l==="stop"){const H=Number(b);if(!Number.isFinite(H)||H<=0){F("Stop price required for stop orders"),$(null);return}Y.stop_price=H}if(p)if(l==="stop"){const H=j?Number(j):void 0,Ft=S?Number(S):void 0;if(!H||!Ft){F("Stop loss and take profit prices are required for stop-entry brackets"),$(null);return}Y.stop_loss_price=H,Y.take_profit_price=Ft,Y.enable_bracket=!0,Y.enable_breakeven=B}else{const H=w?Number(w):void 0,Ft=N?Number(N):void 0;if(!H&&!Ft){F("Provide stop-loss and/or take-profit ticks for bracket orders"),$(null);return}H&&(Y.stop_loss_ticks=Math.floor(H)),Ft&&(Y.take_profit_ticks=Math.floor(Ft)),Y.enable_bracket=!0}lt.mutate(Y,{onSuccess:()=>{Tt()}})},Lt=lt.isLoading,me=!W;return a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Quick Order Ticket"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Place discretionary trades directly from the dashboard"})]})}),O&&a.jsxs("div",{className:"mb-4 flex items-center gap-2 rounded border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-300",children:[a.jsx(ae,{className:"h-4 w-4"}),a.jsx("span",{children:O})]}),it&&a.jsxs("div",{className:"mb-4 flex items-center gap-2 rounded border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-200",children:[a.jsx(ji,{className:"h-4 w-4"}),a.jsx("span",{children:it})]}),a.jsxs("form",{className:"space-y-5",onSubmit:Et,children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Symbol"}),a.jsx("input",{type:"text",value:s,onChange:R=>n(R.target.value.toUpperCase()),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"MNQ"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Quantity"}),a.jsx("input",{type:"number",min:1,value:c,onChange:R=>u(R.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Side"}),a.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>o("BUY"),className:`rounded px-3 py-2 text-sm font-semibold transition-colors ${r==="BUY"?"bg-emerald-500/30 text-emerald-200 ring-1 ring-emerald-400/60":"bg-slate-900 text-slate-300 hover:bg-slate-700/60"}`,children:"Buy"}),a.jsx("button",{type:"button",onClick:()=>o("SELL"),className:`rounded px-3 py-2 text-sm font-semibold transition-colors ${r==="SELL"?"bg-red-500/30 text-red-200 ring-1 ring-red-400/60":"bg-slate-900 text-slate-300 hover:bg-slate-700/60"}`,children:"Sell"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Order Type"}),a.jsxs("select",{value:l,onChange:R=>h(R.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",children:[a.jsx("option",{value:"market",children:"Market"}),a.jsx("option",{value:"limit",children:"Limit"}),a.jsx("option",{value:"stop",children:"Stop Entry"})]})]})]}),l==="limit"&&a.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Limit Price"}),a.jsx("input",{type:"number",value:d,onChange:R=>f(R.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Enter price"})]})}),l==="stop"&&a.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Price"}),a.jsx("input",{type:"number",value:b,onChange:R=>m(R.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Entry stop price"})]})}),a.jsxs("div",{className:"rounded border border-slate-700/60 bg-slate-900/40 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:p,onChange:R=>x(R.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Attach Bracket"]}),a.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Optional"})]}),p&&l!=="stop"&&a.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Loss (ticks)"}),a.jsx("input",{type:"number",value:w,onChange:R=>_(R.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"e.g. 40"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Take Profit (ticks)"}),a.jsx("input",{type:"number",value:N,onChange:R=>g(R.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"e.g. 80"})]})]}),p&&l==="stop"&&a.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Stop Loss Price"}),a.jsx("input",{type:"number",value:j,onChange:R=>k(R.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Stop loss price"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Take Profit Price"}),a.jsx("input",{type:"number",value:S,onChange:R=>T(R.target.value),className:"mt-1 w-full rounded bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",placeholder:"Take profit price"})]}),a.jsx("div",{className:"flex items-center",children:a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:B,onChange:R=>P(R.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Enable Breakeven"]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs uppercase tracking-wide text-slate-400",children:"Time in Force"}),a.jsxs("select",{value:Q,onChange:R=>U(R.target.value),className:"mt-1 w-full rounded bg-slate-900 px-3 py-2 text-sm text-slate-100 outline-none ring-1 ring-slate-700 focus:ring-primary-500",children:[a.jsx("option",{value:"DAY",children:"DAY"}),a.jsx("option",{value:"GTC",children:"GTC"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-200",children:[a.jsx("input",{type:"checkbox",checked:X,onChange:R=>K(R.target.checked),className:"h-4 w-4 rounded border-slate-600 bg-slate-800 text-primary-500 focus:ring-primary-500"}),"Reduce-Only"]})})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:Lt||me,className:"inline-flex items-center gap-2 rounded bg-primary-500 px-4 py-2 text-sm font-semibold text-slate-950 transition-colors hover:bg-primary-400 disabled:cursor-not-allowed disabled:bg-slate-600 disabled:text-slate-300",children:[Lt&&a.jsx(ne,{className:"h-4 w-4 animate-spin"}),"Place Order"]}),a.jsxs("button",{type:"button",onClick:()=>Z.mutate(W),disabled:Z.isLoading||me,className:"inline-flex items-center gap-2 rounded border border-slate-600 px-4 py-2 text-sm font-semibold text-slate-200 transition-colors hover:bg-slate-700 disabled:cursor-not-allowed disabled:text-slate-400",children:[Z.isLoading&&a.jsx(ne,{className:"h-4 w-4 animate-spin"}),"Cancel All Orders"]}),a.jsxs("button",{type:"button",onClick:()=>ct.mutate(),disabled:ct.isLoading||me,className:"inline-flex items-center gap-2 rounded border border-red-600/60 px-4 py-2 text-sm font-semibold text-red-300 transition-colors hover:bg-red-500/10 disabled:cursor-not-allowed disabled:text-red-500/60",children:[ct.isLoading&&a.jsx(ne,{className:"h-4 w-4 animate-spin"}),"Flatten Positions"]})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Tip: Brackets on market/limit orders use tick offsets. Stop entries require explicit pricing for the attached OCO legs."})]})]})}function Td(){const{accounts:i,selectedAccount:t,setSelectedAccount:e}=Mt(),s=t==null?void 0:t.id,n=xt();so();const{data:r=[],isLoading:o}=rt(["positions",s],Ct.getPositions,{enabled:!!s,staleTime:3e4,refetchInterval:1e4}),{data:l=[],isLoading:h}=rt(["orders",s],xe.getOrders,{enabled:!!s,staleTime:3e4,refetchInterval:1e4}),[c,u]=M.useState(null),[d,f]=M.useState(""),[b,m]=M.useState(""),[p,x]=M.useState({}),[w,_]=M.useState({}),[N,g]=M.useState({}),[j,k]=M.useState(null),[S,T]=M.useState(null),[B,P]=M.useState({}),[X,K]=M.useState({}),[Q,U]=M.useState({}),O=(v,E)=>{T({type:v,message:E}),window.setTimeout(()=>T(null),4e3)},F=nt(v=>xe.cancelOrder(v),{onSuccess:(v,E)=>{n.invalidateQueries(["orders",s]),E?O("success",`Cancel request sent for order ${E}`):O("success","Cancel request sent")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to cancel order";O("error",E)}}),it=nt(({orderId:v,updates:E})=>xe.modifyOrder(v,E),{onSuccess:(v,E)=>{n.invalidateQueries(["orders",s]),u(null),f(""),m(""),O("success",`Order ${E.orderId} updated`)},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to modify order";O("error",E)}}),$=nt(({positionId:v,quantity:E})=>Ct.closePosition(v,E),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),E.quantity?(x(L=>({...L,[E.positionId]:""})),O("success",`Partial close submitted for ${E.quantity} contracts`)):O("success","Close position request sent")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to close position";O("error",E)}}),W=nt(({positionId:v,stopPrice:E})=>Ct.modifyStopLoss(v,E),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),_(L=>({...L,[E.positionId]:""})),O("success","Stop loss updated")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to update stop loss";O("error",E)}}),lt=nt(({positionId:v,takeProfit:E})=>Ct.modifyTakeProfit(v,E),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),g(L=>({...L,[E.positionId]:""})),O("success","Take profit updated")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to update take profit";O("error",E)}}),Z=nt(({positionId:v,trailAmount:E})=>Ct.enableTrailingStop(v,E),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),P(L=>({...L,[E.positionId]:""})),K(L=>({...L,[E.positionId]:!0})),O("success","Trailing stop enabled")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to enable trailing stop";O("error",E)}}),ct=nt(v=>Ct.disableTrailingStop(v),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),K(L=>({...L,[E]:!1})),O("success","Trailing stop disabled")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to disable trailing stop";O("error",E)}}),Tt=nt(v=>Ct.enableBreakeven(v),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),U(L=>({...L,[E]:!0})),O("success","Breakeven enabled - stop moved to entry price")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to enable breakeven";O("error",E)}}),Et=nt(v=>Ct.disableBreakeven(v),{onSuccess:(v,E)=>{n.invalidateQueries(["positions",s]),U(L=>({...L,[E]:!1})),O("success","Breakeven disabled")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to disable breakeven";O("error",E)}}),Lt=nt(({symbol:v,quantity:E,accountName:L})=>gh.testOvernightBreakout(v,E,L),{onSuccess:()=>{n.invalidateQueries(["positions",s]),n.invalidateQueries(["orders",s]),O("success","Overnight breakout test executed")},onError:v=>{var L,z;const E=((z=(L=v==null?void 0:v.response)==null?void 0:L.data)==null?void 0:z.error)||(v==null?void 0:v.message)||"Failed to execute test";O("error",E)}}),me=(v,E)=>{if(!v){O("error","Unable to close position: missing identifier");return}confirm("Are you sure you want to close this entire position?")&&$.mutate({positionId:v,quantity:E})},R=v=>{confirm("Are you sure you want to cancel this order?")&&F.mutate(v)},vt=v=>{u({id:v.id,price:v.price,quantity:v.quantity}),f(v.price?v.price.toString():""),m(v.quantity?v.quantity.toString():"")},Y=()=>{var E,L;if(!c)return;const v={};if(d&&d!==((E=c.price)==null?void 0:E.toString())&&(v.price=parseFloat(d)),b&&b!==((L=c.quantity)==null?void 0:L.toString())&&(v.quantity=parseInt(b)),Object.keys(v).length===0){u(null);return}it.mutate({orderId:c.id,updates:v})},H=v=>{if(!v.id){O("error","Position ID missing");return}const E=p[v.id]||"",L=parseInt(E,10);if(!Number.isFinite(L)||L<=0){O("error","Enter a valid quantity for partial close");return}if(L>v.quantity){O("error","Quantity exceeds current position size");return}$.mutate({positionId:v.id,quantity:L})},Ft=v=>{if(!v.id){O("error","Position ID missing");return}const E=w[v.id]||"",L=parseFloat(E);if(!Number.isFinite(L)){O("error","Enter a valid stop loss price");return}W.mutate({positionId:v.id,stopPrice:L})},zo=v=>{if(!v.id){O("error","Position ID missing");return}const E=N[v.id]||"",L=parseFloat(E);if(!Number.isFinite(L)){O("error","Enter a valid take profit price");return}lt.mutate({positionId:v.id,takeProfit:L})},$o=v=>{if(!v){O("error","Raw details unavailable for this position");return}k(E=>E===v?null:v)},Ao=v=>{if(!v.id){O("error","Position ID missing");return}if(X[v.id])ct.mutate(v.id);else{const L=B[v.id]||"",z=parseFloat(L);if(!Number.isFinite(z)||z<=0){O("error","Enter a valid trail amount (e.g., 25.00)");return}Z.mutate({positionId:v.id,trailAmount:z})}},Do=v=>{if(!v.id){O("error","Position ID missing");return}Q[v.id]?Et.mutate(v.id):Tt.mutate(v.id)},Di=o||h;return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Positions & Orders"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Monitor and manage your open positions and orders"})]})}),S&&a.jsx("div",{className:`rounded-lg border px-4 py-2 text-sm ${S.type==="success"?"border-emerald-500/40 bg-emerald-500/10 text-emerald-200":"border-red-500/40 bg-red-500/10 text-red-300"}`,children:S.message}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ci,{accounts:i,selectedAccount:t,onAccountChange:e})}),a.jsx(Od,{}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[a.jsx(li,{className:"w-5 h-5"}),"Automation Tools"]}),a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:()=>Lt.mutate({symbol:"MNQ",quantity:1,accountName:"PRAC"}),className:"px-4 py-2 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-2",disabled:Lt.isLoading||!s,children:[a.jsx(ao,{className:"w-4 h-4"}),Lt.isLoading?"Testing...":"Test Overnight Breakout"]}),a.jsx("p",{className:"text-sm text-slate-400",children:"Simulates overnight breakout trades on practice account (MNQ, 1 contract)"})]})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Open Positions (",r.length,")"]}),Di?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Loading positions..."})]}):r.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400",children:[a.jsx(ae,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No open positions"})]}):a.jsx("div",{className:"space-y-3",children:r.map(v=>{const E=v.side==="LONG",L=Number(v.unrealized_pnl??0),z=Number(v.realized_pnl??0),$e=Number(v.entry_price??0),Ae=Number(v.current_price??$e),Zt=L>=0?ys:_i,Yt=L>=0?"text-green-400":"text-red-400",dt=v.id??"",pe=dt?p[dt]??"":"",Io=dt?w[dt]??"":"",Vo=dt?N[dt]??"":"",Bo=dt?B[dt]??"":"",ks=dt?X[dt]??!1:!1,Ii=dt?Q[dt]??!1:!1,Uo=v.timestamp?new Date(v.timestamp).toLocaleString():"",Wo=typeof v.unrealized_pnl_pct=="number"&&isFinite(v.unrealized_pnl_pct)?`${v.unrealized_pnl_pct.toFixed(2)}%`:"",Vi=typeof v.tick_size=="number"&&isFinite(v.tick_size)?v.tick_size:null,Bi=typeof v.point_value=="number"&&isFinite(v.point_value)?v.point_value:null,St=!!v.id,Ui=j===v.id;return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600 hover:border-slate-500 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${E?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:v.side}),a.jsx("span",{className:"font-semibold",children:v.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(v.quantity??0)]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:`flex items-center gap-1 ${Yt}`,children:[a.jsx(Zt,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-semibold",children:["$",L.toFixed(2)]})]}),a.jsxs("button",{onClick:()=>me(v.id),className:"px-3 py-1 text-xs bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors flex items-center gap-1",disabled:!St||$.isLoading,children:[a.jsx(Fh,{className:"w-3 h-3"}),"Close"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Entry"}),a.jsxs("p",{className:"font-semibold",children:["$",$e.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Current"}),a.jsxs("p",{className:"font-semibold",children:["$",Ae.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Realized P&L"}),a.jsxs("p",{className:`font-semibold ${z>=0?"text-green-400":"text-red-400"}`,children:["$",z.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Unrealized %"}),a.jsx("p",{className:"font-semibold text-slate-200",children:Wo})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Stop Loss"}),a.jsx("p",{className:"font-semibold text-slate-200",children:v.stop_loss!==void 0&&v.stop_loss!==null?`$${Number(v.stop_loss).toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Take Profit"}),a.jsx("p",{className:"font-semibold text-slate-200",children:v.take_profit!==void 0&&v.take_profit!==null?`$${Number(v.take_profit).toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Opened"}),a.jsx("p",{className:"font-semibold text-slate-200",children:Uo})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Tick Size"}),a.jsx("p",{className:"font-semibold text-slate-200",children:Vi?Vi.toFixed(4):""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Point Value"}),a.jsx("p",{className:"font-semibold text-slate-200",children:Bi?`$${Bi.toFixed(2)}`:""})]})]}),a.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wide",children:"Adjust Stop Loss"}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsx("input",{type:"number",value:Io,onChange:Dt=>{v.id&&_(It=>({...It,[v.id]:Dt.target.value}))},placeholder:"New stop price",className:"w-28 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!St}),a.jsx("button",{onClick:()=>Ft(v),className:"px-3 py-1 text-xs bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 transition-colors",disabled:!St||W.isLoading,children:"Update SL"})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wide",children:"Adjust Take Profit"}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsx("input",{type:"number",value:Vo,onChange:Dt=>{v.id&&g(It=>({...It,[v.id]:Dt.target.value}))},placeholder:"New target price",className:"w-28 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!St}),a.jsx("button",{onClick:()=>zo(v),className:"px-3 py-1 text-xs bg-green-500/20 text-green-300 rounded hover:bg-green-500/30 transition-colors",disabled:!St||lt.isLoading,children:"Update TP"})]})]})]}),a.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:pe,onChange:Dt=>{v.id&&x(It=>({...It,[v.id]:Dt.target.value}))},placeholder:"Qty",className:"w-20 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!St}),a.jsx("button",{onClick:()=>H(v),className:"px-3 py-1 text-xs bg-amber-500/20 text-amber-300 rounded hover:bg-amber-500/30 transition-colors",disabled:!St||$.isLoading,children:"Partial Close"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",step:"0.01",value:Bo,onChange:Dt=>{v.id&&P(It=>({...It,[v.id]:Dt.target.value}))},placeholder:"Trail $",className:"w-24 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200",disabled:!St||ks}),a.jsxs("button",{onClick:()=>Ao(v),className:`px-3 py-1 text-xs rounded transition-colors flex items-center gap-1 ${ks?"bg-red-500/20 text-red-300 hover:bg-red-500/30":"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30"}`,disabled:!St||Z.isLoading||ct.isLoading,children:[a.jsx(li,{className:"w-3 h-3"}),ks?"Disable Trail":"Enable Trail"]})]}),a.jsxs("button",{onClick:()=>Do(v),className:`px-3 py-1 text-xs rounded transition-colors flex items-center gap-1 ${Ii?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-slate-600/40 text-slate-200 hover:bg-slate-600/60"}`,disabled:!St||Tt.isLoading||Et.isLoading,children:[a.jsx(Th,{className:"w-3 h-3"}),Ii?"Breakeven ON":"Set Breakeven"]}),a.jsx("button",{onClick:()=>$o(v.id),className:"px-3 py-1 text-xs bg-slate-600/40 text-slate-200 rounded hover:bg-slate-600/60 transition-colors flex items-center gap-1",children:Ui?a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"w-3 h-3"})," Hide Details"]}):a.jsxs(a.Fragment,{children:[a.jsx(Te,{className:"w-3 h-3"})," View Details"]})})]}),Ui&&a.jsxs("div",{className:"mt-3 bg-slate-900/60 border border-slate-700/70 rounded-lg p-3 text-xs text-left overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[a.jsx(oo,{className:"w-4 h-4"}),a.jsx("span",{children:"Raw position payload"})]}),a.jsx("pre",{className:"whitespace-pre-wrap text-slate-200",children:JSON.stringify(v._raw??v,null,2)})]})]},v.id||`${v.symbol}-${v.entry_price}`)})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Open Orders (",l.length,")"]}),Di?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Loading orders..."})]}):l.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400",children:[a.jsx(ae,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No open orders"})]}):a.jsx("div",{className:"space-y-3",children:l.map(v=>{const E=v.side==="BUY",L=v.type||"UNKNOWN",z=(v.status||"PENDING").toUpperCase(),$e=z!=="FILLED"&&z!=="CANCELLED"&&z!=="REJECTED",Ae=v.stop_price?Number(v.stop_price):null,Zt=v.stop_loss?Number(v.stop_loss):null,Yt=v.take_profit?Number(v.take_profit):null,dt=Zt||Yt?`${Zt?`SL $${Zt.toFixed(2)}`:""}${Zt&&Yt?" / ":""}${Yt?`TP $${Yt.toFixed(2)}`:""}`:"";return a.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600 hover:border-slate-500 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${E?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:v.side}),a.jsx("span",{className:"font-semibold",children:v.symbol}),a.jsxs("span",{className:"text-slate-400 text-sm",children:["x",Number(v.quantity??0)]}),a.jsx("span",{className:`px-2 py-1 rounded text-xs ${z==="FILLED"?"bg-green-500/20 text-green-400":z==="CANCELLED"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:z})]}),$e&&a.jsx("div",{className:"flex items-center gap-2",children:(c==null?void 0:c.id)===v.id?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"number",value:d,onChange:pe=>f(pe.target.value),placeholder:"Price",className:"w-20 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200"}),a.jsx("input",{type:"number",value:b,onChange:pe=>m(pe.target.value),placeholder:"Qty",className:"w-16 px-2 py-1 text-xs bg-slate-900 border border-slate-600 rounded text-slate-200"}),a.jsx("button",{onClick:Y,className:"px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors",disabled:it.isLoading,children:"Save"}),a.jsx("button",{onClick:()=>{u(null),f(""),m("")},className:"px-2 py-1 text-xs bg-slate-600 text-slate-300 rounded hover:bg-slate-500 transition-colors",children:"Cancel"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>vt(v),className:"px-2 py-1 text-xs bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-colors flex items-center gap-1",disabled:it.isLoading,children:[a.jsx(Lh,{className:"w-3 h-3"}),"Modify"]}),a.jsxs("button",{onClick:()=>R(v.id),className:"px-3 py-1 text-xs bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors flex items-center gap-1",disabled:F.isLoading,children:[a.jsx(lo,{className:"w-3 h-3"}),"Cancel"]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm sm:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Type"}),a.jsx("p",{className:"font-semibold",children:L})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Price"}),a.jsx("p",{className:"font-semibold",children:v.price?`$${Number(v.price).toFixed(2)}`:"Market"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Stop"}),a.jsx("p",{className:"font-semibold",children:Ae?`$${Ae.toFixed(2)}`:""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Bracket"}),a.jsx("p",{className:"font-semibold text-xs text-slate-200",children:dt})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Time in Force"}),a.jsx("p",{className:"font-semibold text-slate-200",children:v.time_in_force||"DAY"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-400",children:"Order ID"}),a.jsx("p",{className:"font-mono text-xs text-slate-400 truncate",children:v.id})]})]})]},v.id)})})]})]})}function Fd(){const{selectedAccount:i}=Mt(),t=xt(),{data:e,isLoading:s}=rt(["strategies"],te.getStrategies,{staleTime:3e4,refetchInterval:6e4}),[n,r]=M.useState(null),[o,l]=M.useState(null),[h,c]=M.useState(null),[u,d]=M.useState(null),f=nt(({name:g,symbols:j})=>te.startStrategy(g,j,i==null?void 0:i.id),{onSuccess:(g,j)=>{if(t.invalidateQueries(["strategies"]),r(null),g.success)console.log(` Started strategy: ${j}`);else{const k=g.error||g.message||"Unknown error";r(`Failed to start ${j}: ${k}`),console.error(` Failed to start strategy: ${k}`)}},onError:g=>{var k,S;console.error(" Strategy start error (full):",g),console.error(" Error response:",g==null?void 0:g.response),console.error(" Error response data:",(k=g==null?void 0:g.response)==null?void 0:k.data);let j="Unknown error";(S=g==null?void 0:g.response)!=null&&S.data?j=g.response.data.error||g.response.data.message||JSON.stringify(g.response.data)||"Unknown error":g!=null&&g.message&&(j=g.message),r(`Failed to start strategy: ${j}`)}}),b=nt(({name:g})=>te.stopStrategy(g,i==null?void 0:i.id),{onSuccess:(g,j)=>{if(t.invalidateQueries(["strategies"]),r(null),g.success)console.log(` Stopped strategy: ${j}`);else{const k=g.error||g.message||"Unknown error";r(`Failed to stop ${j}: ${k}`),console.error(` Failed to stop strategy: ${k}`)}},onError:g=>{var k,S;console.error(" Strategy stop error (full):",g),console.error(" Error response:",g==null?void 0:g.response),console.error(" Error response data:",(k=g==null?void 0:g.response)==null?void 0:k.data);let j="Unknown error";(S=g==null?void 0:g.response)!=null&&S.data?j=g.response.data.error||g.response.data.message||JSON.stringify(g.response.data)||"Unknown error":g!=null&&g.message&&(j=g.message),r(`Failed to stop strategy: ${j}`)}}),m=(g,j)=>{const k=e==null?void 0:e.find(P=>P.name===g),S=(k==null?void 0:k.symbols)??[],T=(j||"").toLowerCase();(k==null?void 0:k.enabled)??["running","active","enabled","started"].includes(T)?b.mutate({name:g}):f.mutate({name:g,symbols:S})},{data:p,isLoading:x}=rt(["strategy-stats",h,i==null?void 0:i.id],()=>te.getStrategyStats(h,i==null?void 0:i.id),{enabled:!!h&&!!i,staleTime:3e4}),{data:w,isLoading:_}=rt(["strategy-logs",u],()=>te.getStrategyLogs(u,50),{enabled:!!u,staleTime:1e4,refetchInterval:3e4}),N=nt(({name:g})=>te.testStrategy(g,i==null?void 0:i.id),{onSuccess:()=>{t.invalidateQueries(["strategies"])}});return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-slate-400",children:"Loading strategies..."})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Strategies"}),a.jsx("p",{className:"text-slate-400",children:"Manage your trading strategies"})]}),n&&a.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ae,{className:"w-5 h-5 text-red-400"}),a.jsx("p",{className:"text-red-400 text-sm",children:n})]}),a.jsx("button",{onClick:()=>r(null),className:"text-red-400 hover:text-red-300",children:a.jsx(lo,{className:"w-4 h-4"})})]}),!i&&a.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-500 text-sm",children:" Please select an account to manage strategies"})}),a.jsx("div",{className:"space-y-4",children:e&&e.length>0?e.map(g=>{var j,k,S,T,B;return a.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 hover:border-slate-600 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:g.name}),(()=>{const P=(g.status||"").toLowerCase(),X=g.is_running??["running","active","started"].includes(P),K=g.enabled??["running","active","enabled","started"].includes(P),Q=X?"bg-green-500/20 text-green-400":K?"bg-blue-500/20 text-blue-400":"bg-slate-600/50 text-slate-400",U=X?"running":K?"enabled":P||"disabled";return a.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${Q}`,children:U})})()]}),a.jsxs("div",{className:"text-sm text-slate-400 space-y-1",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Symbols:"})," ",g.symbols&&g.symbols.length>0?g.symbols.join(", "):"N/A"]}),g.description&&a.jsx("p",{className:"mt-2",children:g.description})]}),g.stats&&a.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Trades"}),a.jsx("p",{className:"font-semibold",children:g.stats.total_trades||0})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Win Rate"}),a.jsx("p",{className:"font-semibold",children:g.stats.win_rate?`${g.stats.win_rate.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Total P&L"}),a.jsx("p",{className:`font-semibold ${(g.stats.total_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:g.stats.total_pnl?`$${g.stats.total_pnl.toFixed(2)}`:"$0.00"})]}),a.jsxs("div",{className:"bg-slate-900/50 rounded p-2",children:[a.jsx("p",{className:"text-slate-500",children:"Avg P&L"}),a.jsx("p",{className:`font-semibold ${(g.stats.avg_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:g.stats.avg_pnl?`$${g.stats.avg_pnl.toFixed(2)}`:"$0.00"})]})]})]}),a.jsx("div",{className:"flex flex-col gap-2",children:(()=>{const P=(g.status||"").toLowerCase(),X=g.enabled??["running","active","enabled","started"].includes(P),K=f.isLoading||b.isLoading?"Loading...":X?"Disable":"Enable",Q=X?"bg-red-600 hover:bg-red-500 text-white":"bg-green-600 hover:bg-green-500 text-white";return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>m(g.name,g.status),disabled:f.isLoading||b.isLoading||!i,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${Q} disabled:opacity-50 disabled:cursor-not-allowed`,children:K}),a.jsx("button",{onClick:()=>l(o===g.name?null:g.name),className:"px-4 py-2 rounded-lg font-semibold text-sm transition-colors bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center gap-2",children:o===g.name?a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"w-4 h-4"})," Hide Details"]}):a.jsxs(a.Fragment,{children:[a.jsx(Te,{className:"w-4 h-4"})," Show Details"]})})]})})()}),o===g.name&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700 space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>{c(g.name),h!==g.name&&d(null)},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${h===g.name?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(no,{className:"w-4 h-4"}),"Stats"]}),a.jsxs("button",{onClick:()=>{d(g.name),u!==g.name&&c(null)},className:`px-3 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${u===g.name?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-700 hover:bg-slate-600 text-slate-200"}`,children:[a.jsx(Eh,{className:"w-4 h-4"}),"Logs"]}),a.jsxs("button",{onClick:()=>N.mutate({name:g.name}),disabled:N.isLoading||!i,className:"px-3 py-2 rounded text-sm font-medium transition-colors bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[N.isLoading?a.jsx(ne,{className:"w-4 h-4 animate-spin"}):a.jsx(ao,{className:"w-4 h-4"}),"Test"]})]}),h===g.name&&a.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4",children:x?a.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading stats..."}):p&&!p.error?a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total Trades"}),a.jsx("p",{className:"text-lg font-semibold",children:p.total_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Win Rate"}),a.jsxs("p",{className:"text-lg font-semibold",children:[((j=p.win_rate)==null?void 0:j.toFixed(1))||0,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total P&L"}),a.jsxs("p",{className:`text-lg font-semibold ${(p.total_pnl||0)>=0?"text-green-400":"text-red-400"}`,children:["$",((k=p.total_pnl)==null?void 0:k.toFixed(2))||"0.00"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Profit Factor"}),a.jsx("p",{className:"text-lg font-semibold",children:((S=p.profit_factor)==null?void 0:S.toFixed(2))||"0.00"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Winning Trades"}),a.jsx("p",{className:"text-lg font-semibold text-green-400",children:p.winning_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Losing Trades"}),a.jsx("p",{className:"text-lg font-semibold text-red-400",children:p.losing_trades||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Best Trade"}),a.jsxs("p",{className:"text-lg font-semibold text-green-400",children:["$",((T=p.best_trade)==null?void 0:T.toFixed(2))||"0.00"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Worst Trade"}),a.jsxs("p",{className:"text-lg font-semibold text-red-400",children:["$",((B=p.worst_trade)==null?void 0:B.toFixed(2))||"0.00"]})]})]}):a.jsx("div",{className:"text-center py-4 text-slate-400",children:(p==null?void 0:p.error)||"No stats available"})}),u===g.name&&a.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4 max-h-96 overflow-y-auto",children:_?a.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading logs..."}):w!=null&&w.logs&&w.logs.length>0?a.jsx("div",{className:"space-y-2 font-mono text-xs",children:w.logs.map((P,X)=>a.jsxs("div",{className:`p-2 rounded border-l-2 ${P.level==="ERROR"||P.level==="CRITICAL"?"border-red-500 bg-red-500/10":P.level==="WARNING"?"border-yellow-500 bg-yellow-500/10":"border-slate-600 bg-slate-800/50"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"text-slate-400",children:P.timestamp}),a.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${P.level==="ERROR"||P.level==="CRITICAL"?"bg-red-500/20 text-red-300":P.level==="WARNING"?"bg-yellow-500/20 text-yellow-300":"bg-slate-700 text-slate-300"}`,children:P.level})]}),a.jsx("p",{className:"text-slate-200 break-words",children:P.message})]},X))}):a.jsx("div",{className:"text-center py-4 text-slate-400",children:"No logs available"})})]})]})},g.name)}):a.jsx("div",{className:"bg-slate-800 rounded-lg p-12 border border-slate-700 text-center",children:a.jsx("p",{className:"text-slate-400",children:"No strategies configured"})})})]})}function zd(){return a.jsx(Fd,{})}function $d(){const{accounts:i,selectedAccount:t,setSelectedAccount:e}=Mt(),s=xt(),[n,r]=M.useState("auto"),[o,l]=M.useState(!0),[h,c]=M.useState(!0),[u,d]=M.useState("ws://localhost:8081"),[f,b]=M.useState("http://localhost:8080"),[m,p]=M.useState(null),{data:x,isLoading:w}=rt(["settings","global"],()=>ai.getSettings("global"),{staleTime:6e4,refetchOnWindowFocus:!1});M.useEffect(()=>{if(x!=null&&x.settings){const S=x.settings;r(S.defaultAccount??"auto"),l(S.riskManagementEnabled??!0),c(S.discordNotificationsEnabled??!0),d(S.wsUrl||"ws://localhost:8081"),b(S.apiUrl||"http://localhost:8080")}},[x]);const _=nt(S=>ai.saveSettings(S),{onSuccess:()=>{s.invalidateQueries(["settings","global"]),p(" Settings saved successfully!"),setTimeout(()=>p(null),3e3)},onError:S=>{console.error("Failed to save settings:",S),p(" Failed to save settings"),setTimeout(()=>p(null),4e3)}}),N=()=>{_.mutate({defaultAccount:n==="auto"?null:n,riskManagementEnabled:o,discordNotificationsEnabled:h,wsUrl:u,apiUrl:f})},g=()=>{l(!o)},j=()=>{c(!h)},k=S=>{e(S),S&&r(String(S.id))};return w?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-slate-400",children:"Loading settings..."})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"Configure your trading bot"})]}),m&&a.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg px-4 py-2",children:a.jsx("p",{className:"text-green-400 text-sm",children:m})})]}),a.jsx("div",{className:"max-w-md",children:a.jsx(Ci,{accounts:i,selectedAccount:t,onAccountChange:k})}),a.jsxs("div",{className:"grid gap-6",children:[a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Account Settings"}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Default Account"}),a.jsxs("select",{value:n,onChange:S=>r(S.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",children:[a.jsx("option",{value:"auto",children:" Auto-select"}),i.map(S=>{var T;return a.jsxs("option",{value:S.id,children:[S.name," - $",((T=S.balance)==null?void 0:T.toLocaleString())||"0"]},S.id)})]}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"The account to use by default when the bot starts"})]})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Trading Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Risk Management"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Enable automatic risk controls"})]}),a.jsx("button",{onClick:g,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${o?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 hover:bg-slate-500 text-white"}`,children:o?"Enabled":"Disabled"})]}),a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Discord Notifications"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Send trade alerts to Discord"})]}),a.jsx("button",{onClick:j,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-colors ${h?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 hover:bg-slate-500 text-white"}`,children:h?"Enabled":"Disabled"})]})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"System Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"WebSocket URL"}),a.jsx("input",{type:"text",value:u,onChange:S=>d(S.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",placeholder:"ws://localhost:8081"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"WebSocket server for real-time updates"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API URL"}),a.jsx("input",{type:"text",value:f,onChange:S=>b(S.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-primary-500",placeholder:"http://localhost:8080"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Backend API server URL"})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:N,className:"bg-primary-600 hover:bg-primary-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:_.isLoading,children:_.isLoading?"Saving...":"Save All Settings"})})]})]})}function Ad({children:i}){const t=Jo(),e=[{path:"/",icon:no,label:"Dashboard"},{path:"/positions",icon:ys,label:"Positions"},{path:"/strategies",icon:Ni,label:"Strategies"},{path:"/settings",icon:Rh,label:"Settings"}];return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("aside",{className:"fixed left-0 top-0 h-full w-64 bg-slate-800 border-r border-slate-700",children:[a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary-400",children:"TopStepX"}),a.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Trading Dashboard"})]}),a.jsx("nav",{className:"mt-8",children:e.map(s=>{const n=s.icon,r=t.pathname===s.path;return a.jsxs(Zs,{to:s.path,className:`flex items-center gap-3 px-6 py-3 transition-colors ${r?"bg-primary-600 text-white border-r-2 border-primary-400":"text-slate-300 hover:bg-slate-700"}`,children:[a.jsx(n,{className:"w-5 h-5"}),a.jsx("span",{children:s.label})]},s.path)})})]}),a.jsx("main",{className:"ml-64 p-8",children:i})]})}const Dd=new Ma({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function Id(){return a.jsx(Ta,{client:Dd,children:a.jsx(Sh,{children:a.jsx(xh,{children:a.jsx(Xo,{children:a.jsx(Ad,{children:a.jsxs(Go,{children:[a.jsx(De,{path:"/",element:a.jsx(Rd,{})}),a.jsx(De,{path:"/positions",element:a.jsx(Td,{})}),a.jsx(De,{path:"/strategies",element:a.jsx(zd,{})}),a.jsx(De,{path:"/settings",element:a.jsx($d,{})})]})})})})})})}Ys.createRoot(document.getElementById("root")).render(a.jsx(st.StrictMode,{children:a.jsx(Id,{})}));
